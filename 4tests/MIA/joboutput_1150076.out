Requirement already satisfied: pyyaml in /usr/lib64/python3.12/site-packages (6.0.1)
Requirement already satisfied: setuptools in /usr/lib/python3.12/site-packages (68.2.2)
Requirement already satisfied: matplotlib in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.10.1)
Requirement already satisfied: contourpy>=1.0.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler>=0.10 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy>=1.23 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.2.4)
Requirement already satisfied: packaging>=20.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow>=8 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing>=2.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: quadprog in /dcs/21/u2110391/.local/lib/python3.12/site-packages (0.1.13)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from quadprog) (2.2.4)
Requirement already satisfied: pyparsing in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.2.3)
Requirement already satisfied: pandas in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.3)
Requirement already satisfied: numpy>=1.26.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.4)
Mon Apr 28 22:32:03 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 17%   49C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: ALT-NEGGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 22:32:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 17%   50C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['lizard', 'bicycle', 'orchids', 'worm', 'oranges', 'man', 'cockroach', 'whale', 'fox', 'cattle', 'flatfish', 'mouse', 'camel', 'computer keyboard', 'lion', 'oak', 'willow', 'beaver', 'chair', 'sea', 'baby', 'train', 'house', 'pears', 'beetle', 'chimpanzee', 'mountain', 'motorcycle', 'lobster', 'squirrel', 'lamp', 'girl', 'streetcar', 'elephant', 'ray', 'leopard', 'dinosaur', 'shark', 'roses', 'cups', 'bus', 'sweet peppers', 'otter', 'rabbit', 'forest', 'pine', 'plain', 'apples', 'raccoon', 'kangaroo', 'turtle', 'trout', 'seal', 'wardrobe', 'poppies', 'pickup truck', 'bowls', 'bed', 'tulips', 'snail', 'dolphin', 'butterfly', 'road', 'aquarium fish', 'couch', 'tractor', 'telephone', 'woman', 'mushrooms', 'caterpillar', 'table', 'rocket', 'bottles', 'wolf', 'skunk', 'spider', 'porcupine', 'skyscraper', 'bee', 'bridge', 'plates', 'shrew', 'crocodile', 'crab', 'maple', 'television', 'hamster', 'cloud', 'snake', 'sunflowers', 'palm', 'tiger', 'clock', 'bear', 'cans', 'lawn-mower', 'possum', 'boy', 'tank', 'castle']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2040  Total retain:  2500
Total correct forget:  9753  Total forget:  47500
Total correct test:  345  Total test:  500
Total correct forget test:  1940  Total test forget:  9500
After learning task 1
Task accuracies: [0.69, 0.128, 0.212, 0.218, 0.192, 0.204, 0.238, 0.2, 0.266, 0.276, 0.194, 0.204, 0.2, 0.148, 0.214, 0.172, 0.226, 0.202, 0.208, 0.178]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2462, std=0.8658
[DEBUG][MIA] Test Set Loss:   mean=1.3332, std=2.8575
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.22745098039215686, 'auc': 0.6956787109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2232, std=0.7851
[DEBUG][MIA] Test Set Loss:   mean=1.2648, std=2.6046
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.21800000000000003, 'auc': 0.6747279999999999, 'task': 1}
2 1
Total correct retain:  1787  Total retain:  2500
Total correct forget:  11453  Total forget:  47500
Total correct test:  329  Total test:  500
Total correct forget test:  2177  Total test forget:  9500
After learning task 2
Task accuracies: [0.658, 0.702, 0.214, 0.17, 0.212, 0.18, 0.24, 0.21, 0.264, 0.246, 0.132, 0.202, 0.196, 0.184, 0.26, 0.104, 0.28, 0.204, 0.22, 0.134]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0186, std=0.0931
[DEBUG][MIA] Test Set Loss:   mean=1.0858, std=2.1014
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7019607843137254, 'auc': 0.782470703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7541, std=1.5922
[DEBUG][MIA] Test Set Loss:   mean=1.5310, std=2.5688
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.18, 'auc': 0.6022799999999999, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0474, std=0.3072
[DEBUG][MIA] Test Set Loss:   mean=1.5050, std=2.8116
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2784313725490196, 'auc': 0.761077880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0608, std=0.5314
[DEBUG][MIA] Test Set Loss:   mean=1.6121, std=2.8056
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.694, 'cv_acc': 0.266, 'auc': 0.8013760000000001, 'task': 2}
3 2
Total correct retain:  1712  Total retain:  2500
Total correct forget:  13134  Total forget:  47500
Total correct test:  321  Total test:  500
Total correct forget test:  2360  Total test forget:  9500
After learning task 3
Task accuracies: [0.642, 0.62, 0.674, 0.22, 0.226, 0.208, 0.232, 0.176, 0.268, 0.228, 0.126, 0.176, 0.192, 0.166, 0.256, 0.118, 0.262, 0.172, 0.212, 0.188]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0071
[DEBUG][MIA] Test Set Loss:   mean=1.7727, std=3.0467
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7254901960784313, 'auc': 0.8311767578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9968, std=2.0792
[DEBUG][MIA] Test Set Loss:   mean=2.1618, std=3.3247
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.17200000000000001, 'auc': 0.62176, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0153, std=0.1026
[DEBUG][MIA] Test Set Loss:   mean=2.1752, std=3.5839
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6784313725490196, 'auc': 0.813507080078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6535, std=1.6949
[DEBUG][MIA] Test Set Loss:   mean=2.3467, std=3.5500
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.20800000000000002, 'auc': 0.707136, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0465, std=0.2778
[DEBUG][MIA] Test Set Loss:   mean=1.1994, std=2.9763
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.21960784313725493, 'auc': 0.62982177734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.1186, std=0.7883
[DEBUG][MIA] Test Set Loss:   mean=0.7999, std=2.1204
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.188, 'auc': 0.641736, 'task': 3}
4 3
Total correct retain:  1576  Total retain:  2500
Total correct forget:  14786  Total forget:  47500
Total correct test:  280  Total test:  500
Total correct forget test:  2680  Total test forget:  9500
After learning task 4
Task accuracies: [0.56, 0.598, 0.612, 0.81, 0.212, 0.192, 0.214, 0.186, 0.276, 0.204, 0.15, 0.19, 0.196, 0.182, 0.27, 0.166, 0.256, 0.184, 0.24, 0.222]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0447
[DEBUG][MIA] Test Set Loss:   mean=2.2642, std=3.5724
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.6862745098039216, 'auc': 0.854522705078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4736, std=2.6947
[DEBUG][MIA] Test Set Loss:   mean=2.1317, std=3.5968
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.52444, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.3645, std=3.6608
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7333333333333333, 'auc': 0.88726806640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9733, std=2.1393
[DEBUG][MIA] Test Set Loss:   mean=2.0012, std=3.2658
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.202, 'auc': 0.631432, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.1637, std=0.5967
[DEBUG][MIA] Test Set Loss:   mean=1.3393, std=2.5996
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.23921568627450984, 'auc': 0.679351806640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4974, std=1.4894
[DEBUG][MIA] Test Set Loss:   mean=1.6177, std=3.0380
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.12600000000000003, 'auc': 0.634392, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0204, std=0.1075
[DEBUG][MIA] Test Set Loss:   mean=0.9310, std=2.3303
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.23529411764705882, 'auc': 0.6905517578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0219, std=0.1360
[DEBUG][MIA] Test Set Loss:   mean=1.1999, std=2.7218
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.672, 'cv_acc': 0.22600000000000003, 'auc': 0.73472, 'task': 4}
5 4
Total correct retain:  1679  Total retain:  2500
Total correct forget:  16189  Total forget:  47500
Total correct test:  312  Total test:  500
Total correct forget test:  2907  Total test forget:  9500
After learning task 5
Task accuracies: [0.624, 0.616, 0.582, 0.71, 0.782, 0.214, 0.252, 0.168, 0.314, 0.246, 0.118, 0.166, 0.204, 0.196, 0.24, 0.094, 0.294, 0.172, 0.236, 0.21]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=2.3932, std=3.9906
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7411764705882353, 'auc': 0.82940673828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4038, std=2.9263
[DEBUG][MIA] Test Set Loss:   mean=2.2736, std=3.9017
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11200000000000002, 'auc': 0.5690320000000001, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0245
[DEBUG][MIA] Test Set Loss:   mean=2.6525, std=3.7069
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.792156862745098, 'auc': 0.888336181640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5592, std=2.8145
[DEBUG][MIA] Test Set Loss:   mean=2.4197, std=3.4735
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.182, 'auc': 0.591552, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0062, std=0.0211
[DEBUG][MIA] Test Set Loss:   mean=0.9029, std=1.9161
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2549019607843137, 'auc': 0.764801025390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9141, std=2.2663
[DEBUG][MIA] Test Set Loss:   mean=1.1649, std=2.5753
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.172, 'auc': 0.555592, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.4886, std=3.0865
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2784313725490196, 'auc': 0.70660400390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5171, std=1.3205
[DEBUG][MIA] Test Set Loss:   mean=1.4903, std=2.7572
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.17600000000000002, 'auc': 0.60548, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0096, std=0.0755
[DEBUG][MIA] Test Set Loss:   mean=0.8352, std=2.4288
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.20392156862745098, 'auc': 0.688629150390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0213, std=0.1703
[DEBUG][MIA] Test Set Loss:   mean=0.9260, std=2.2965
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.20600000000000002, 'auc': 0.6959040000000001, 'task': 5}
6 5
Total correct retain:  1606  Total retain:  2500
Total correct forget:  17478  Total forget:  47500
Total correct test:  292  Total test:  500
Total correct forget test:  3168  Total test forget:  9500
After learning task 6
Task accuracies: [0.584, 0.62, 0.526, 0.73, 0.688, 0.808, 0.272, 0.158, 0.348, 0.238, 0.114, 0.18, 0.19, 0.186, 0.236, 0.1, 0.29, 0.154, 0.226, 0.272]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.7373, std=2.9442
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7529411764705882, 'auc': 0.800445556640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5877, std=3.0259
[DEBUG][MIA] Test Set Loss:   mean=2.0543, std=3.4587
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.13, 'auc': 0.5517920000000001, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0237
[DEBUG][MIA] Test Set Loss:   mean=2.9012, std=4.3709
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7333333333333333, 'auc': 0.897705078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6521, std=3.0061
[DEBUG][MIA] Test Set Loss:   mean=2.7801, std=3.8835
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.098, 'auc': 0.6151439999999999, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0722, std=0.3189
[DEBUG][MIA] Test Set Loss:   mean=1.5907, std=3.0260
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.27450980392156865, 'auc': 0.713714599609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3136, std=2.7618
[DEBUG][MIA] Test Set Loss:   mean=1.7240, std=2.8984
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.17200000000000001, 'auc': 0.581816, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=1.5561, std=2.7774
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2784313725490196, 'auc': 0.80364990234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7592, std=1.9428
[DEBUG][MIA] Test Set Loss:   mean=1.8452, std=2.9859
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.14999999999999997, 'auc': 0.642936, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0260
[DEBUG][MIA] Test Set Loss:   mean=1.3604, std=2.8861
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2980392156862745, 'auc': 0.769500732421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5871, std=1.5954
[DEBUG][MIA] Test Set Loss:   mean=1.1506, std=2.4834
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.21399999999999997, 'auc': 0.572472, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0713, std=0.3124
[DEBUG][MIA] Test Set Loss:   mean=1.4390, std=2.9003
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2627450980392157, 'auc': 0.750457763671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0425, std=0.3672
[DEBUG][MIA] Test Set Loss:   mean=1.4132, std=2.6757
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.22200000000000003, 'auc': 0.736952, 'task': 6}
7 6
Total correct retain:  1618  Total retain:  2500
Total correct forget:  18955  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  3359  Total test forget:  9500
After learning task 7
Task accuracies: [0.604, 0.6, 0.558, 0.652, 0.644, 0.692, 0.73, 0.15, 0.334, 0.286, 0.1, 0.15, 0.184, 0.198, 0.244, 0.184, 0.26, 0.174, 0.228, 0.35]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.5426, std=3.6835
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.6941176470588235, 'auc': 0.839019775390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3016, std=2.5331
[DEBUG][MIA] Test Set Loss:   mean=2.0102, std=3.1578
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.13199999999999998, 'auc': 0.5868080000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0242, std=0.1175
[DEBUG][MIA] Test Set Loss:   mean=2.8576, std=3.7594
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7019607843137254, 'auc': 0.823944091796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1729, std=3.5074
[DEBUG][MIA] Test Set Loss:   mean=2.8611, std=4.5621
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.096, 'auc': 0.45383199999999996, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0318, std=0.2518
[DEBUG][MIA] Test Set Loss:   mean=1.7161, std=3.3194
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.24313725490196075, 'auc': 0.737762451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3367, std=2.6657
[DEBUG][MIA] Test Set Loss:   mean=1.8765, std=3.3924
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.5571039999999999, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0411
[DEBUG][MIA] Test Set Loss:   mean=1.9207, std=3.3992
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.6941176470588235, 'auc': 0.739898681640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8854, std=2.0166
[DEBUG][MIA] Test Set Loss:   mean=2.0954, std=3.3605
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.156, 'auc': 0.5969359999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=1.8661, std=3.0257
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.29411764705882354, 'auc': 0.86590576171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7918, std=1.8084
[DEBUG][MIA] Test Set Loss:   mean=1.8971, std=3.2689
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.11200000000000002, 'auc': 0.58704, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.8357, std=3.3260
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7372549019607842, 'auc': 0.8192138671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2676, std=1.0579
[DEBUG][MIA] Test Set Loss:   mean=1.8354, std=3.0995
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.22000000000000003, 'auc': 0.711152, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0784, std=0.3577
[DEBUG][MIA] Test Set Loss:   mean=1.4822, std=3.1186
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20392156862745098, 'auc': 0.66033935546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1256, std=0.8212
[DEBUG][MIA] Test Set Loss:   mean=1.1645, std=2.6296
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.2, 'auc': 0.675584, 'task': 7}
8 7
Total correct retain:  1595  Total retain:  2500
Total correct forget:  20264  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  3542  Total test forget:  9500
After learning task 8
Task accuracies: [0.588, 0.608, 0.528, 0.664, 0.622, 0.642, 0.65, 0.762, 0.326, 0.26, 0.108, 0.182, 0.186, 0.178, 0.218, 0.184, 0.238, 0.16, 0.218, 0.35]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0083, std=0.0423
[DEBUG][MIA] Test Set Loss:   mean=2.5711, std=4.4781
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6666666666666667, 'auc': 0.8258056640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8148, std=3.0100
[DEBUG][MIA] Test Set Loss:   mean=2.2012, std=3.5954
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.554304, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=2.7505, std=4.0759
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7490196078431373, 'auc': 0.89215087890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0241, std=3.6407
[DEBUG][MIA] Test Set Loss:   mean=2.8190, std=4.3111
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.09, 'auc': 0.43445599999999995, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0698, std=0.4354
[DEBUG][MIA] Test Set Loss:   mean=2.0108, std=3.3690
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2784313725490196, 'auc': 0.737762451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1339, std=2.3392
[DEBUG][MIA] Test Set Loss:   mean=2.0442, std=3.4674
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11000000000000001, 'auc': 0.571472, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.5368, std=2.4409
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.30588235294117644, 'auc': 0.872283935546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0325, std=2.5917
[DEBUG][MIA] Test Set Loss:   mean=1.6311, std=3.0104
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.09, 'auc': 0.573304, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0338
[DEBUG][MIA] Test Set Loss:   mean=1.6264, std=2.9748
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2980392156862745, 'auc': 0.80511474609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1165, std=2.5095
[DEBUG][MIA] Test Set Loss:   mean=1.8343, std=3.4729
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.138, 'auc': 0.567304, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0172
[DEBUG][MIA] Test Set Loss:   mean=1.8160, std=3.3872
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2823529411764706, 'auc': 0.80072021484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5485, std=1.4197
[DEBUG][MIA] Test Set Loss:   mean=1.8279, std=3.0570
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.19, 'auc': 0.6525599999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0079, std=0.0377
[DEBUG][MIA] Test Set Loss:   mean=1.3491, std=2.9546
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2666666666666667, 'auc': 0.763824462890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3908, std=1.2612
[DEBUG][MIA] Test Set Loss:   mean=1.3915, std=2.8788
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.21600000000000003, 'auc': 0.60536, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0443
[DEBUG][MIA] Test Set Loss:   mean=1.4903, std=3.1008
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.21960784313725487, 'auc': 0.7080078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0119, std=0.0512
[DEBUG][MIA] Test Set Loss:   mean=1.3277, std=2.6178
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.20800000000000002, 'auc': 0.7348719999999999, 'task': 8}
Total correct retain:  1640  Total retain:  2500
Total correct forget:  21561  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  3820  Total test forget:  9500
After learning task 9
Task accuracies: [0.614, 0.6, 0.558, 0.666, 0.676, 0.664, 0.634, 0.714, 0.758, 0.284, 0.14, 0.178, 0.19, 0.208, 0.25, 0.182, 0.258, 0.166, 0.174, 0.34]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0221
[DEBUG][MIA] Test Set Loss:   mean=2.5526, std=4.1172
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7254901960784313, 'auc': 0.8309326171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3351, std=3.8950
[DEBUG][MIA] Test Set Loss:   mean=2.1651, std=3.7577
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.12, 'auc': 0.5189280000000001, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0448
[DEBUG][MIA] Test Set Loss:   mean=3.2510, std=4.9357
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7568627450980392, 'auc': 0.84576416015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2734, std=3.9002
[DEBUG][MIA] Test Set Loss:   mean=2.8720, std=4.4772
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.118, 'auc': 0.562688, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0364, std=0.1985
[DEBUG][MIA] Test Set Loss:   mean=1.4492, std=3.0580
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.23921568627450984, 'auc': 0.720977783203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8918, std=2.3615
[DEBUG][MIA] Test Set Loss:   mean=1.4497, std=3.1285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.13799999999999998, 'auc': 0.57172, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0112
[DEBUG][MIA] Test Set Loss:   mean=2.2562, std=4.0190
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2941176470588235, 'auc': 0.804534912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5116, std=3.0730
[DEBUG][MIA] Test Set Loss:   mean=2.2230, std=3.4865
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10400000000000001, 'auc': 0.5843039999999999, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0558
[DEBUG][MIA] Test Set Loss:   mean=2.3474, std=4.0550
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.25882352941176473, 'auc': 0.769683837890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1081, std=2.8256
[DEBUG][MIA] Test Set Loss:   mean=1.7462, std=3.6168
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.188, 'auc': 0.577912, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.5354, std=2.2703
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.30588235294117644, 'auc': 0.824066162109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7842, std=1.8396
[DEBUG][MIA] Test Set Loss:   mean=2.0527, std=3.2049
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.142, 'auc': 0.671568, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0347
[DEBUG][MIA] Test Set Loss:   mean=1.6032, std=2.8779
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.28627450980392155, 'auc': 0.73748779296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8883, std=2.3624
[DEBUG][MIA] Test Set Loss:   mean=1.7209, std=3.1136
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.202, 'auc': 0.591032, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0064
[DEBUG][MIA] Test Set Loss:   mean=1.8455, std=3.1561
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2980392156862745, 'auc': 0.777984619140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1824, std=0.7300
[DEBUG][MIA] Test Set Loss:   mean=1.6339, std=3.0962
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.632, 'cv_acc': 0.24, 'auc': 0.681248, 'task': 8}
Total correct retain:  1657  Total retain:  2500
Total correct forget:  23292  Total forget:  47500
Total correct test:  309  Total test:  500
Total correct forget test:  4051  Total test forget:  9500
After learning task 10
Task accuracies: [0.618, 0.59, 0.556, 0.738, 0.65, 0.676, 0.612, 0.664, 0.686, 0.852, 0.134, 0.172, 0.184, 0.224, 0.218, 0.192, 0.246, 0.176, 0.23, 0.302]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0293
[DEBUG][MIA] Test Set Loss:   mean=2.2996, std=3.5711
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7176470588235293, 'auc': 0.83013916015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8320, std=3.5523
[DEBUG][MIA] Test Set Loss:   mean=2.7718, std=4.1955
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10800000000000001, 'auc': 0.5866720000000001, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0060, std=0.0308
[DEBUG][MIA] Test Set Loss:   mean=3.3586, std=4.3841
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7372549019607842, 'auc': 0.851898193359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6130, std=4.2638
[DEBUG][MIA] Test Set Loss:   mean=3.1197, std=4.2792
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.16799999999999998, 'auc': 0.566392, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0898, std=0.5393
[DEBUG][MIA] Test Set Loss:   mean=1.9997, std=4.1323
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.22745098039215686, 'auc': 0.716827392578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3732, std=3.0162
[DEBUG][MIA] Test Set Loss:   mean=1.6211, std=3.6243
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.146, 'auc': 0.53572, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.9164, std=3.7279
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2901960784313725, 'auc': 0.84930419921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6355, std=3.3820
[DEBUG][MIA] Test Set Loss:   mean=1.8483, std=3.5440
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.134, 'auc': 0.525288, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0541
[DEBUG][MIA] Test Set Loss:   mean=1.9443, std=3.4056
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7372549019607844, 'auc': 0.767547607421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0312, std=2.1676
[DEBUG][MIA] Test Set Loss:   mean=1.9924, std=3.4233
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.16999999999999998, 'auc': 0.57392, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0064
[DEBUG][MIA] Test Set Loss:   mean=2.3392, std=3.9151
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7294117647058823, 'auc': 0.82330322265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9804, std=2.2488
[DEBUG][MIA] Test Set Loss:   mean=2.0909, std=3.0129
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.192, 'auc': 0.624368, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0172
[DEBUG][MIA] Test Set Loss:   mean=1.6750, std=2.9125
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2823529411764706, 'auc': 0.77593994140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6212, std=1.7915
[DEBUG][MIA] Test Set Loss:   mean=1.4967, std=2.9297
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.184, 'auc': 0.637632, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.8816, std=3.2746
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.29411764705882354, 'auc': 0.79119873046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4075, std=1.2407
[DEBUG][MIA] Test Set Loss:   mean=1.8526, std=3.2324
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.184, 'auc': 0.644736, 'task': 8}
Total correct retain:  1684  Total retain:  2500
Total correct forget:  24593  Total forget:  47500
Total correct test:  317  Total test:  500
Total correct forget test:  4226  Total test forget:  9500
After learning task 11
Task accuracies: [0.634, 0.568, 0.508, 0.684, 0.642, 0.634, 0.568, 0.664, 0.68, 0.802, 0.774, 0.188, 0.19, 0.208, 0.232, 0.254, 0.25, 0.192, 0.204, 0.21]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6822, std=1.5920
[DEBUG][MIA] Test Set Loss:   mean=2.3432, std=3.6767
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.25098039215686274, 'auc': 0.691925048828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5313, std=4.0019
[DEBUG][MIA] Test Set Loss:   mean=2.7798, std=4.1108
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.536824, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6797, std=1.3933
[DEBUG][MIA] Test Set Loss:   mean=3.3842, std=5.0840
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.5568627450980392, 'auc': 0.681671142578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0948, std=4.2440
[DEBUG][MIA] Test Set Loss:   mean=3.7668, std=4.9486
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11800000000000002, 'auc': 0.5453760000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6651, std=1.6912
[DEBUG][MIA] Test Set Loss:   mean=2.5037, std=4.3885
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.22745098039215686, 'auc': 0.685638427734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0412, std=3.4888
[DEBUG][MIA] Test Set Loss:   mean=2.5251, std=4.0267
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.094, 'auc': 0.527344, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1784, std=0.5809
[DEBUG][MIA] Test Set Loss:   mean=2.1790, std=3.1581
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.25098039215686274, 'auc': 0.77777099609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8359, std=3.3520
[DEBUG][MIA] Test Set Loss:   mean=2.0199, std=3.1747
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11200000000000002, 'auc': 0.5622560000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4376, std=0.9225
[DEBUG][MIA] Test Set Loss:   mean=2.0920, std=3.2470
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.5764705882352941, 'auc': 0.6468505859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4708, std=2.5427
[DEBUG][MIA] Test Set Loss:   mean=2.4486, std=3.5950
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.10200000000000001, 'auc': 0.5678, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5335, std=3.0038
[DEBUG][MIA] Test Set Loss:   mean=4.3226, std=6.4498
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.24705882352941178, 'auc': 0.662994384765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.0491, std=4.6483
[DEBUG][MIA] Test Set Loss:   mean=4.5644, std=6.4452
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.13599999999999998, 'auc': 0.5691919999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5731, std=1.6058
[DEBUG][MIA] Test Set Loss:   mean=2.4246, std=3.9555
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2235294117647059, 'auc': 0.64764404296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3586, std=2.4815
[DEBUG][MIA] Test Set Loss:   mean=2.3198, std=3.7785
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.11000000000000001, 'auc': 0.5546639999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2820, std=0.7779
[DEBUG][MIA] Test Set Loss:   mean=2.3135, std=3.5262
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2627450980392157, 'auc': 0.68896484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.8634, std=2.0715
[DEBUG][MIA] Test Set Loss:   mean=1.8264, std=3.3154
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.178, 'auc': 0.5645999999999999, 'task': 8}
Total correct retain:  1428  Total retain:  2500
Total correct forget:  19909  Total forget:  47500
Total correct test:  255  Total test:  500
Total correct forget test:  3593  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.51, 0.558, 0.438, 0.582, 0.586, 0.574, 0.464, 0.608, 0.616, 0.696, 0.368, 0.19, 0.184, 0.15, 0.246, 0.178, 0.226, 0.162, 0.172, 0.188]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4585, std=1.3411
[DEBUG][MIA] Test Set Loss:   mean=4.4766, std=6.1049
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.22745098039215686, 'auc': 0.76800537109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.4184, std=4.7965
[DEBUG][MIA] Test Set Loss:   mean=3.6027, std=5.2208
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11200000000000002, 'auc': 0.518776, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1802, std=0.5682
[DEBUG][MIA] Test Set Loss:   mean=5.0558, std=6.5752
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6941176470588235, 'auc': 0.80126953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0570, std=4.2891
[DEBUG][MIA] Test Set Loss:   mean=3.9596, std=5.7312
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10800000000000001, 'auc': 0.54004, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3983, std=1.1052
[DEBUG][MIA] Test Set Loss:   mean=2.3597, std=4.6560
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.22745098039215686, 'auc': 0.689483642578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9377, std=4.1852
[DEBUG][MIA] Test Set Loss:   mean=2.4347, std=4.5782
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.548808, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0425, std=0.2029
[DEBUG][MIA] Test Set Loss:   mean=2.6251, std=4.1452
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6666666666666666, 'auc': 0.790069580078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6191, std=3.2575
[DEBUG][MIA] Test Set Loss:   mean=2.6734, std=4.1419
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13, 'auc': 0.597456, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2699, std=0.8852
[DEBUG][MIA] Test Set Loss:   mean=2.1967, std=3.8351
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.6549019607843137, 'auc': 0.756927490234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8911, std=2.8301
[DEBUG][MIA] Test Set Loss:   mean=2.5666, std=3.8767
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.136, 'auc': 0.550256, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8014, std=1.9440
[DEBUG][MIA] Test Set Loss:   mean=5.3139, std=7.2628
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.4, 'auc': 0.74615478515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.8072, std=4.5324
[DEBUG][MIA] Test Set Loss:   mean=4.1161, std=6.0911
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.182, 'auc': 0.585136, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6767, std=2.0492
[DEBUG][MIA] Test Set Loss:   mean=3.2896, std=4.9436
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.18039215686274512, 'auc': 0.716400146484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6232, std=3.1060
[DEBUG][MIA] Test Set Loss:   mean=2.4736, std=4.2920
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.088, 'auc': 0.5585439999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2157, std=0.7953
[DEBUG][MIA] Test Set Loss:   mean=2.1024, std=3.8696
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2705882352941177, 'auc': 0.67877197265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.8291, std=1.8851
[DEBUG][MIA] Test Set Loss:   mean=2.4973, std=4.2330
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.17400000000000002, 'auc': 0.6244799999999999, 'task': 8}
Total correct retain:  1479  Total retain:  2500
Total correct forget:  19161  Total forget:  47500
Total correct test:  270  Total test:  500
Total correct forget test:  3453  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.54, 0.528, 0.468, 0.636, 0.562, 0.574, 0.452, 0.638, 0.618, 0.336, 0.37, 0.146, 0.194, 0.154, 0.252, 0.172, 0.256, 0.16, 0.202, 0.188]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=80.2800, std=90.6099
[DEBUG][MIA] Test Set Loss:   mean=75.2783, std=88.4707
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10980392156862746, 'auc': 0.47698974609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=70.4617, std=74.2746
[DEBUG][MIA] Test Set Loss:   mean=86.4424, std=96.6355
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.47048, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=63.2561, std=65.7891
[DEBUG][MIA] Test Set Loss:   mean=54.9894, std=62.1443
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09803921568627451, 'auc': 0.472198486328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=65.0141, std=67.8042
[DEBUG][MIA] Test Set Loss:   mean=56.1424, std=62.9666
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10400000000000001, 'auc': 0.528184, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=40.3525, std=39.3917
[DEBUG][MIA] Test Set Loss:   mean=48.6305, std=43.6261
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.15294117647058822, 'auc': 0.46026611328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=47.9380, std=49.0431
[DEBUG][MIA] Test Set Loss:   mean=48.3510, std=45.3099
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.094, 'auc': 0.490064, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=72.9792, std=67.1391
[DEBUG][MIA] Test Set Loss:   mean=71.7790, std=69.0673
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.48980712890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=75.4301, std=66.9581
[DEBUG][MIA] Test Set Loss:   mean=74.3470, std=69.8424
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.08, 'auc': 0.4935999999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=37.9724, std=36.4046
[DEBUG][MIA] Test Set Loss:   mean=44.1403, std=39.4148
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.538543701171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=37.0638, std=40.3321
[DEBUG][MIA] Test Set Loss:   mean=43.7211, std=41.8975
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.136, 'auc': 0.557424, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=56.7643, std=65.2404
[DEBUG][MIA] Test Set Loss:   mean=51.2351, std=54.1179
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.0784313725490196, 'auc': 0.501251220703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=48.6385, std=58.0184
[DEBUG][MIA] Test Set Loss:   mean=47.5750, std=60.5928
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.098, 'auc': 0.48460800000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=57.3138, std=66.9606
[DEBUG][MIA] Test Set Loss:   mean=51.5011, std=63.8099
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.522430419921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=61.8456, std=70.9175
[DEBUG][MIA] Test Set Loss:   mean=54.4807, std=66.5768
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.098, 'auc': 0.5250400000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=977.7479, std=701.3281
[DEBUG][MIA] Test Set Loss:   mean=973.0970, std=720.6408
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.49468994140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1044.5900, std=778.0660
[DEBUG][MIA] Test Set Loss:   mean=1071.3213, std=706.5955
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.1, 'auc': 0.46965599999999996, 'task': 8}
Total correct retain:  513  Total retain:  2500
Total correct forget:  10399  Total forget:  47500
Total correct test:  101  Total test:  500
Total correct forget test:  2075  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.202, 0.24, 0.238, 0.232, 0.21, 0.192, 0.276, 0.28, 0.2, 0.214, 0.216, 0.2, 0.2, 0.2, 0.2, 0.198, 0.212, 0.2, 0.24, 0.202]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=48.6377, std=73.0279
[DEBUG][MIA] Test Set Loss:   mean=49.8841, std=72.4621
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.492950439453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=59.3626, std=86.0752
[DEBUG][MIA] Test Set Loss:   mean=67.0294, std=89.7333
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.11399999999999999, 'auc': 0.47686400000000007, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=34.5911, std=37.9994
[DEBUG][MIA] Test Set Loss:   mean=30.2884, std=35.5642
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09803921568627451, 'auc': 0.526214599609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=29.8718, std=33.6145
[DEBUG][MIA] Test Set Loss:   mean=32.9600, std=36.0023
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.5170239999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=25.0648, std=26.5606
[DEBUG][MIA] Test Set Loss:   mean=26.5320, std=26.0545
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.48486328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=31.7422, std=32.7913
[DEBUG][MIA] Test Set Loss:   mean=25.6791, std=26.4127
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.10400000000000001, 'auc': 0.45036, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=38.1452, std=42.4900
[DEBUG][MIA] Test Set Loss:   mean=38.9271, std=44.1361
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09803921568627451, 'auc': 0.51898193359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=33.3189, std=38.4236
[DEBUG][MIA] Test Set Loss:   mean=34.7067, std=39.7090
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11200000000000002, 'auc': 0.5068159999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=26.0566, std=39.3691
[DEBUG][MIA] Test Set Loss:   mean=28.7217, std=43.0048
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.1411764705882353, 'auc': 0.518524169921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=25.7943, std=39.2234
[DEBUG][MIA] Test Set Loss:   mean=32.3877, std=46.0274
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11000000000000001, 'auc': 0.45256, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=46.9762, std=59.6594
[DEBUG][MIA] Test Set Loss:   mean=37.6339, std=51.4882
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.5362548828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=33.0120, std=47.5294
[DEBUG][MIA] Test Set Loss:   mean=39.1242, std=59.9793
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.12, 'auc': 0.47240800000000005, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=400.4759, std=368.3002
[DEBUG][MIA] Test Set Loss:   mean=318.1111, std=337.0785
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10980392156862746, 'auc': 0.573974609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=340.2874, std=356.8690
[DEBUG][MIA] Test Set Loss:   mean=340.2690, std=347.3486
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.496816, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=797.7410, std=603.9587
[DEBUG][MIA] Test Set Loss:   mean=829.0292, std=600.4780
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09803921568627451, 'auc': 0.49481201171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=788.8677, std=577.2282
[DEBUG][MIA] Test Set Loss:   mean=827.6758, std=658.0197
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.088, 'auc': 0.508704, 'task': 8}
Total correct retain:  545  Total retain:  2500
Total correct forget:  9865  Total forget:  47500
Total correct test:  106  Total test:  500
Total correct forget test:  1965  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.212, 0.236, 0.272, 0.13, 0.204, 0.214, 0.26, 0.206, 0.2, 0.21, 0.2, 0.2, 0.198, 0.2, 0.2, 0.2, 0.21, 0.198, 0.2, 0.192]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8829, std=5.1855
[DEBUG][MIA] Test Set Loss:   mean=5.0723, std=13.1249
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09803921568627451, 'auc': 0.46514892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.7305, std=8.9528
[DEBUG][MIA] Test Set Loss:   mean=4.9290, std=10.6757
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.096, 'auc': 0.512528, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8267, std=5.8413
[DEBUG][MIA] Test Set Loss:   mean=3.6620, std=5.2866
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.09803921568627451, 'auc': 0.600250244140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.3715, std=4.9432
[DEBUG][MIA] Test Set Loss:   mean=3.5236, std=5.0059
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.094, 'auc': 0.5044639999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4593, std=3.1894
[DEBUG][MIA] Test Set Loss:   mean=2.4997, std=4.7423
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09411764705882353, 'auc': 0.45208740234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5101, std=6.3440
[DEBUG][MIA] Test Set Loss:   mean=2.3064, std=5.0586
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.507072, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8520, std=6.6921
[DEBUG][MIA] Test Set Loss:   mean=4.2833, std=7.1814
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.1607843137254902, 'auc': 0.59881591796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7366, std=6.6072
[DEBUG][MIA] Test Set Loss:   mean=3.8434, std=5.3899
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.481304, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7448, std=4.2532
[DEBUG][MIA] Test Set Loss:   mean=2.6430, std=3.7751
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.09411764705882353, 'auc': 0.60101318359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7604, std=4.2812
[DEBUG][MIA] Test Set Loss:   mean=2.7512, std=4.6125
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.499824, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.3408, std=11.1052
[DEBUG][MIA] Test Set Loss:   mean=6.7427, std=11.1844
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.15686274509803919, 'auc': 0.525054931640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.3651, std=10.7333
[DEBUG][MIA] Test Set Loss:   mean=7.7381, std=11.9824
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11000000000000001, 'auc': 0.554416, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=45.1018, std=70.5065
[DEBUG][MIA] Test Set Loss:   mean=48.8704, std=64.2903
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12941176470588237, 'auc': 0.4632568359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=45.1848, std=66.4443
[DEBUG][MIA] Test Set Loss:   mean=49.9182, std=72.1736
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.122, 'auc': 0.47705600000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=73.9158, std=82.0487
[DEBUG][MIA] Test Set Loss:   mean=80.6142, std=103.3698
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.08235294117647059, 'auc': 0.517608642578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=87.4589, std=113.1355
[DEBUG][MIA] Test Set Loss:   mean=91.6764, std=105.3259
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.122, 'auc': 0.470408, 'task': 8}
Total correct retain:  1038  Total retain:  2500
Total correct forget:  14468  Total forget:  47500
Total correct test:  184  Total test:  500
Total correct forget test:  2772  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.368, 0.456, 0.412, 0.634, 0.416, 0.462, 0.348, 0.332, 0.256, 0.276, 0.256, 0.18, 0.224, 0.14, 0.22, 0.218, 0.17, 0.158, 0.222, 0.164]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.1090, std=12.2126
[DEBUG][MIA] Test Set Loss:   mean=5.5977, std=12.0201
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.1215686274509804, 'auc': 0.56304931640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6005, std=7.5545
[DEBUG][MIA] Test Set Loss:   mean=5.1880, std=10.0241
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11200000000000002, 'auc': 0.52932, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8861, std=4.2658
[DEBUG][MIA] Test Set Loss:   mean=3.6181, std=4.5093
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.1803921568627451, 'auc': 0.66558837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0212, std=4.4773
[DEBUG][MIA] Test Set Loss:   mean=3.5908, std=4.5066
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.09, 'auc': 0.539472, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1745, std=6.3197
[DEBUG][MIA] Test Set Loss:   mean=2.5337, std=6.2148
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.17254901960784313, 'auc': 0.584869384765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1955, std=4.3999
[DEBUG][MIA] Test Set Loss:   mean=2.5242, std=5.5166
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11400000000000002, 'auc': 0.503104, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1067, std=3.9842
[DEBUG][MIA] Test Set Loss:   mean=3.5592, std=4.4723
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.17254901960784313, 'auc': 0.6409912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4162, std=4.6193
[DEBUG][MIA] Test Set Loss:   mean=3.4627, std=4.7187
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10800000000000001, 'auc': 0.505544, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.0307, std=12.8272
[DEBUG][MIA] Test Set Loss:   mean=7.8484, std=12.6521
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.537628173828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.6628, std=13.3404
[DEBUG][MIA] Test Set Loss:   mean=7.9142, std=12.4301
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11599999999999999, 'auc': 0.470368, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.7427, std=7.7765
[DEBUG][MIA] Test Set Loss:   mean=5.7729, std=10.0784
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.11372549019607844, 'auc': 0.589141845703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0989, std=6.4231
[DEBUG][MIA] Test Set Loss:   mean=5.9811, std=8.8123
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.442, 'cv_acc': 0.086, 'auc': 0.43021599999999993, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=41.2849, std=61.0370
[DEBUG][MIA] Test Set Loss:   mean=41.3571, std=50.0196
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627451, 'auc': 0.476531982421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=40.8359, std=54.4834
[DEBUG][MIA] Test Set Loss:   mean=40.4993, std=55.0305
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.09, 'auc': 0.49899200000000005, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=64.0038, std=70.6318
[DEBUG][MIA] Test Set Loss:   mean=84.7657, std=94.4355
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09411764705882353, 'auc': 0.564056396484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=82.2311, std=96.9238
[DEBUG][MIA] Test Set Loss:   mean=76.3308, std=87.7282
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10400000000000001, 'auc': 0.488336, 'task': 8}
Total correct retain:  1203  Total retain:  2500
Total correct forget:  14243  Total forget:  47500
Total correct test:  220  Total test:  500
Total correct forget test:  2708  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.44, 0.448, 0.418, 0.642, 0.404, 0.298, 0.356, 0.34, 0.276, 0.276, 0.272, 0.122, 0.224, 0.15, 0.222, 0.204, 0.19, 0.174, 0.23, 0.17]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=12.8290, std=45.3750
[DEBUG][MIA] Test Set Loss:   mean=17.3485, std=35.9916
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09803921568627451, 'auc': 0.384124755859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=17.0421, std=34.9532
[DEBUG][MIA] Test Set Loss:   mean=15.8844, std=31.9653
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10400000000000001, 'auc': 0.451848, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5307, std=6.7525
[DEBUG][MIA] Test Set Loss:   mean=5.8664, std=8.9217
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.12549019607843137, 'auc': 0.6201171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3924, std=11.0528
[DEBUG][MIA] Test Set Loss:   mean=6.2529, std=10.3353
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.12200000000000003, 'auc': 0.539264, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1735, std=15.1758
[DEBUG][MIA] Test Set Loss:   mean=6.5579, std=12.4586
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.08235294117647059, 'auc': 0.408966064453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.5325, std=17.1949
[DEBUG][MIA] Test Set Loss:   mean=8.7412, std=17.7778
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.469936, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=21.2794, std=30.2274
[DEBUG][MIA] Test Set Loss:   mean=22.0391, std=23.5681
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09803921568627451, 'auc': 0.450897216796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=26.2610, std=33.9648
[DEBUG][MIA] Test Set Loss:   mean=25.7128, std=29.2905
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.5130239999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=22.2405, std=38.6796
[DEBUG][MIA] Test Set Loss:   mean=24.5158, std=38.5462
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.52069091796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=27.6794, std=43.9536
[DEBUG][MIA] Test Set Loss:   mean=24.9370, std=39.7382
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.478304, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.3319, std=23.6055
[DEBUG][MIA] Test Set Loss:   mean=9.4339, std=13.9488
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.12549019607843137, 'auc': 0.57574462890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6957, std=13.7442
[DEBUG][MIA] Test Set Loss:   mean=9.4071, std=18.8196
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.539728, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=95.5293, std=169.2537
[DEBUG][MIA] Test Set Loss:   mean=69.9679, std=128.1490
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.531280517578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=107.0149, std=196.4085
[DEBUG][MIA] Test Set Loss:   mean=101.2017, std=174.7233
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.096, 'auc': 0.488856, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=205.6312, std=289.7520
[DEBUG][MIA] Test Set Loss:   mean=193.7994, std=338.5134
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.12156862745098038, 'auc': 0.44293212890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=229.0921, std=337.9132
[DEBUG][MIA] Test Set Loss:   mean=216.7880, std=311.2813
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11000000000000001, 'auc': 0.518192, 'task': 8}
Total correct retain:  1086  Total retain:  2500
Total correct forget:  13172  Total forget:  47500
Total correct test:  197  Total test:  500
Total correct forget test:  2532  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.394, 0.416, 0.386, 0.468, 0.29, 0.268, 0.362, 0.358, 0.298, 0.268, 0.27, 0.154, 0.204, 0.154, 0.192, 0.202, 0.192, 0.166, 0.2, 0.216]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.1563, std=22.9460
[DEBUG][MIA] Test Set Loss:   mean=12.4029, std=29.4769
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.08235294117647059, 'auc': 0.436431884765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.4535, std=26.3602
[DEBUG][MIA] Test Set Loss:   mean=11.1839, std=25.2339
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.452, 'cv_acc': 0.096, 'auc': 0.44623199999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.2019, std=9.7623
[DEBUG][MIA] Test Set Loss:   mean=7.2757, std=10.2205
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.20784313725490194, 'auc': 0.56463623046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.3014, std=9.0671
[DEBUG][MIA] Test Set Loss:   mean=8.0229, std=9.8866
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10800000000000001, 'auc': 0.569544, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.6063, std=29.1492
[DEBUG][MIA] Test Set Loss:   mean=23.4567, std=32.3872
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.442535400390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=20.6546, std=31.4503
[DEBUG][MIA] Test Set Loss:   mean=19.4742, std=26.6199
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.48012, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=27.2759, std=42.0205
[DEBUG][MIA] Test Set Loss:   mean=25.8970, std=42.1031
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.1176470588235294, 'auc': 0.514068603515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=25.7169, std=39.6603
[DEBUG][MIA] Test Set Loss:   mean=25.7054, std=38.8714
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10800000000000001, 'auc': 0.502784, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=18.2490, std=30.0948
[DEBUG][MIA] Test Set Loss:   mean=19.9692, std=32.2950
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09803921568627451, 'auc': 0.5413818359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.7889, std=29.4414
[DEBUG][MIA] Test Set Loss:   mean=20.9197, std=35.8014
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10200000000000001, 'auc': 0.47344, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.4619, std=19.3517
[DEBUG][MIA] Test Set Loss:   mean=9.4046, std=13.9834
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.10980392156862746, 'auc': 0.496002197265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.4829, std=10.4618
[DEBUG][MIA] Test Set Loss:   mean=8.6101, std=12.7626
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.096, 'auc': 0.5028079999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=84.2888, std=159.3086
[DEBUG][MIA] Test Set Loss:   mean=62.2320, std=108.7177
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.530029296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=104.7672, std=183.1059
[DEBUG][MIA] Test Set Loss:   mean=98.4463, std=171.7345
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.1, 'auc': 0.508952, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=108.2566, std=143.9691
[DEBUG][MIA] Test Set Loss:   mean=155.1438, std=212.3071
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.11372549019607843, 'auc': 0.42462158203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=159.3668, std=280.6486
[DEBUG][MIA] Test Set Loss:   mean=156.4771, std=235.0553
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11399999999999999, 'auc': 0.5191680000000001, 'task': 8}
Total correct retain:  992  Total retain:  2500
Total correct forget:  11966  Total forget:  47500
Total correct test:  195  Total test:  500
Total correct forget test:  2321  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.39, 0.37, 0.256, 0.278, 0.274, 0.274, 0.328, 0.358, 0.296, 0.278, 0.282, 0.144, 0.216, 0.156, 0.22, 0.208, 0.132, 0.19, 0.216, 0.166]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2674, std=16.0174
[DEBUG][MIA] Test Set Loss:   mean=7.2735, std=9.9584
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.08627450980392157, 'auc': 0.60357666015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.1579, std=9.5316
[DEBUG][MIA] Test Set Loss:   mean=6.9461, std=9.3513
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10200000000000001, 'auc': 0.517992, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1629, std=7.3747
[DEBUG][MIA] Test Set Loss:   mean=7.9411, std=9.9194
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10588235294117647, 'auc': 0.628173828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8075, std=7.0712
[DEBUG][MIA] Test Set Loss:   mean=6.8930, std=7.5323
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.09, 'auc': 0.447696, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=12.4578, std=14.2505
[DEBUG][MIA] Test Set Loss:   mean=16.3689, std=18.6362
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.12156862745098038, 'auc': 0.44293212890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.5038, std=15.3070
[DEBUG][MIA] Test Set Loss:   mean=14.1403, std=16.5642
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11000000000000001, 'auc': 0.49272799999999994, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=13.9003, std=15.6272
[DEBUG][MIA] Test Set Loss:   mean=15.6736, std=14.6904
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.5496826171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=15.5473, std=19.1650
[DEBUG][MIA] Test Set Loss:   mean=16.2613, std=16.9638
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.5263119999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.5103, std=14.0215
[DEBUG][MIA] Test Set Loss:   mean=10.4245, std=12.2537
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.13725490196078433, 'auc': 0.52935791015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=11.1335, std=14.1197
[DEBUG][MIA] Test Set Loss:   mean=10.9776, std=15.2109
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.511104, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.2143, std=11.9251
[DEBUG][MIA] Test Set Loss:   mean=8.4426, std=14.1516
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.13725490196078433, 'auc': 0.568634033203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.9313, std=8.3036
[DEBUG][MIA] Test Set Loss:   mean=7.3273, std=12.4223
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.096, 'auc': 0.501752, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=73.8239, std=110.2537
[DEBUG][MIA] Test Set Loss:   mean=49.9836, std=74.3301
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.44842529296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=56.1435, std=86.5141
[DEBUG][MIA] Test Set Loss:   mean=63.8882, std=94.0757
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.11400000000000002, 'auc': 0.4570240000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=79.1441, std=89.1850
[DEBUG][MIA] Test Set Loss:   mean=97.9796, std=130.7636
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.12941176470588234, 'auc': 0.528411865234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=88.5674, std=118.2115
[DEBUG][MIA] Test Set Loss:   mean=89.9789, std=104.5981
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.09, 'auc': 0.524416, 'task': 8}
Total correct retain:  1207  Total retain:  2500
Total correct forget:  12171  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  2393  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.444, 0.348, 0.318, 0.26, 0.286, 0.262, 0.354, 0.36, 0.312, 0.292, 0.31, 0.158, 0.216, 0.15, 0.232, 0.206, 0.162, 0.186, 0.212, 0.162]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 9, 5, 6, 8, 8, 6, 7, 6, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3067, std=6.4865
[DEBUG][MIA] Test Set Loss:   mean=5.5103, std=7.3263
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10588235294117647, 'auc': 0.5552978515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 8 5 5 8 7 5 9 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 8 8 7 9 5 6 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.9253, std=8.0700
[DEBUG][MIA] Test Set Loss:   mean=5.6407, std=7.7194
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.491392, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 13, 14, 12, 13, 10, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.3605, std=5.1764
[DEBUG][MIA] Test Set Loss:   mean=4.5551, std=6.7285
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.16862745098039217, 'auc': 0.55145263671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 11 12 10 12 10 10 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 14 13 12 14 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7972, std=6.8084
[DEBUG][MIA] Test Set Loss:   mean=4.7664, std=5.5451
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08399999999999999, 'auc': 0.513792, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 16, 18, 16, 15, 19, 16, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.8514, std=7.8465
[DEBUG][MIA] Test Set Loss:   mean=8.3586, std=9.0671
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10196078431372549, 'auc': 0.550201416015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 18 17 17 18 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 19 18 17 19 15 19 18 19 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.5980, std=9.1971
[DEBUG][MIA] Test Set Loss:   mean=8.0091, std=8.6823
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10200000000000001, 'auc': 0.4866400000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 20, 22, 23, 20, 22, 23, 21, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.8370, std=10.1207
[DEBUG][MIA] Test Set Loss:   mean=11.7210, std=11.7803
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.07450980392156863, 'auc': 0.5538330078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 22 22 24 20 21 21 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 21 23 23 24 21 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.1984, std=11.2436
[DEBUG][MIA] Test Set Loss:   mean=12.7519, std=11.2037
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.08, 'auc': 0.515256, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 26, 29, 25, 25, 29, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4375, std=6.8468
[DEBUG][MIA] Test Set Loss:   mean=6.9727, std=6.9084
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.12549019607843137, 'auc': 0.5308837890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 28 26 26 27 25 28 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 26 25 26 25 25 25 28 29 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.8685, std=7.4358
[DEBUG][MIA] Test Set Loss:   mean=6.9944, std=7.6202
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.098, 'auc': 0.537528, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 33, 32, 34, 30, 32, 30, 30, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.9321, std=8.2747
[DEBUG][MIA] Test Set Loss:   mean=7.1260, std=8.0676
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.18823529411764706, 'auc': 0.612152099609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 31 33 34 30 33 33 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 33 34 33 33 34 31 33 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.0579, std=8.2015
[DEBUG][MIA] Test Set Loss:   mean=7.0718, std=8.6741
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.098, 'auc': 0.536912, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 35, 36, 37, 38, 35, 37, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=37.3807, std=42.1276
[DEBUG][MIA] Test Set Loss:   mean=32.2167, std=39.6019
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.17254901960784313, 'auc': 0.451873779296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 38 35 37 35 35 37 38 36 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 39 38 37 37 35 39 38 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=28.9977, std=37.4247
[DEBUG][MIA] Test Set Loss:   mean=33.9255, std=42.1908
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10800000000000001, 'auc': 0.5298640000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 44, 41, 40, 40, 42, 41, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=58.3222, std=65.6355
[DEBUG][MIA] Test Set Loss:   mean=59.7501, std=78.1349
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.50726318359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 41 42 44 43 43 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 41 41 41 41 41 40 43 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=61.1995, std=62.4820
[DEBUG][MIA] Test Set Loss:   mean=61.7094, std=62.4092
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.5013920000000001, 'task': 8}
Total correct retain:  952  Total retain:  2500
Total correct forget:  13044  Total forget:  47500
Total correct test:  167  Total test:  500
Total correct forget test:  2561  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.334, 0.412, 0.356, 0.294, 0.27, 0.304, 0.33, 0.368, 0.34, 0.3, 0.292, 0.19, 0.206, 0.14, 0.192, 0.216, 0.268, 0.2, 0.218, 0.226]
Number of constraint violations:  0
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: neggrad
alpha: 0.5
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 4
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Tue Apr 29 00:12:27 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 42%   69C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  4
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['skunk', 'dolphin', 'otter', 'cattle', 'flatfish', 'lobster', 'ray', 'television', 'palm', 'couch', 'road', 'crocodile', 'baby', 'tiger', 'fox', 'mountain', 'shrew', 'lamp', 'cans', 'possum', 'bridge', 'boy', 'forest', 'girl', 'clock', 'bus', 'turtle', 'apples', 'maple', 'motorcycle', 'trout', 'crab', 'bed', 'aquarium fish', 'bee', 'squirrel', 'tank', 'dinosaur', 'skyscraper', 'woman', 'sweet peppers', 'rabbit', 'chair', 'caterpillar', 'cups', 'plain', 'train', 'orchids', 'beetle', 'computer keyboard', 'pine', 'worm', 'bicycle', 'castle', 'shark', 'cloud', 'wardrobe', 'sea', 'rocket', 'porcupine', 'sunflowers', 'raccoon', 'oak', 'lawn-mower', 'tractor', 'poppies', 'camel', 'mouse', 'plates', 'pears', 'bottles', 'streetcar', 'telephone', 'table', 'oranges', 'roses', 'house', 'bowls', 'chimpanzee', 'tulips', 'elephant', 'spider', 'whale', 'willow', 'butterfly', 'kangaroo', 'hamster', 'beaver', 'bear', 'man', 'leopard', 'pickup truck', 'wolf', 'mushrooms', 'seal', 'lizard', 'snail', 'cockroach', 'snake', 'lion']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2120  Total retain:  2500
Total correct forget:  8906  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  1836  Total test forget:  9500
After learning task 1
Task accuracies: [0.614, 0.194, 0.19, 0.26, 0.176, 0.15, 0.22, 0.206, 0.19, 0.108, 0.254, 0.152, 0.22, 0.21, 0.194, 0.226, 0.11, 0.252, 0.15, 0.21]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0368
[DEBUG][MIA] Test Set Loss:   mean=0.9969, std=2.2269
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.26274509803921564, 'auc': 0.71234130859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.1554
[DEBUG][MIA] Test Set Loss:   mean=1.0984, std=2.4091
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.23200000000000004, 'auc': 0.71224, 'task': 1}
2 1
Total correct retain:  1721  Total retain:  2500
Total correct forget:  11273  Total forget:  47500
Total correct test:  285  Total test:  500
Total correct forget test:  2113  Total test forget:  9500
After learning task 2
Task accuracies: [0.57, 0.75, 0.21, 0.19, 0.164, 0.272, 0.158, 0.142, 0.186, 0.24, 0.26, 0.146, 0.168, 0.232, 0.184, 0.224, 0.126, 0.208, 0.17, 0.196]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.5725, std=3.0146
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.2823529411764706, 'auc': 0.88201904296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3555, std=1.0950
[DEBUG][MIA] Test Set Loss:   mean=1.3877, std=2.8840
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.184, 'auc': 0.632224, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 13, 11, 14, 14, 11, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0077, std=0.0401
[DEBUG][MIA] Test Set Loss:   mean=1.1383, std=2.1942
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2627450980392157, 'auc': 0.68658447265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 14 14 10 13 14 11 11 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0165, std=0.1090
[DEBUG][MIA] Test Set Loss:   mean=1.1433, std=2.1719
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.256, 'auc': 0.735112, 'task': 2}
3 2
Total correct retain:  1498  Total retain:  2500
Total correct forget:  12923  Total forget:  47500
Total correct test:  267  Total test:  500
Total correct forget test:  2358  Total test forget:  9500
After learning task 3
Task accuracies: [0.534, 0.686, 0.746, 0.222, 0.148, 0.13, 0.188, 0.156, 0.192, 0.244, 0.214, 0.14, 0.278, 0.324, 0.192, 0.214, 0.092, 0.192, 0.164, 0.194]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.4604, std=2.4018
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7254901960784315, 'auc': 0.83453369140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8460, std=1.9534
[DEBUG][MIA] Test Set Loss:   mean=1.4827, std=2.6051
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.188, 'auc': 0.57128, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 13, 11, 14, 14, 11, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.6356, std=3.1622
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7098039215686275, 'auc': 0.759124755859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 14 14 10 13 14 11 11 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5139, std=1.3243
[DEBUG][MIA] Test Set Loss:   mean=1.5701, std=2.8046
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.2, 'auc': 0.64136, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 17, 15, 17, 19, 18, 15, 19, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0094, std=0.0459
[DEBUG][MIA] Test Set Loss:   mean=1.0522, std=2.4376
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2666666666666667, 'auc': 0.73358154296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 15 19 19 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0104, std=0.0632
[DEBUG][MIA] Test Set Loss:   mean=1.1962, std=2.6067
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.236, 'auc': 0.7376240000000001, 'task': 3}
4 3
Total correct retain:  1394  Total retain:  2500
Total correct forget:  14279  Total forget:  47500
Total correct test:  246  Total test:  500
Total correct forget test:  2564  Total test forget:  9500
After learning task 4
Task accuracies: [0.492, 0.646, 0.654, 0.75, 0.132, 0.108, 0.192, 0.2, 0.206, 0.326, 0.22, 0.144, 0.24, 0.25, 0.23, 0.218, 0.076, 0.204, 0.144, 0.188]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0100
[DEBUG][MIA] Test Set Loss:   mean=2.0072, std=3.0887
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7294117647058824, 'auc': 0.8189697265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3950, std=2.6407
[DEBUG][MIA] Test Set Loss:   mean=2.0713, std=3.3245
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.1, 'auc': 0.56276, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 13, 11, 14, 14, 11, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.1273, std=2.3766
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.29411764705882354, 'auc': 0.77838134765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 14 14 10 13 14 11 11 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8547, std=2.1358
[DEBUG][MIA] Test Set Loss:   mean=1.7820, std=3.2071
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.152, 'auc': 0.58792, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 17, 15, 17, 19, 18, 15, 19, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.1923, std=2.2718
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2823529411764706, 'auc': 0.772308349609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 15 19 19 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3852, std=1.0289
[DEBUG][MIA] Test Set Loss:   mean=1.5287, std=2.8321
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.192, 'auc': 0.6129519999999999, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 24, 20, 21, 22, 22, 24, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0109, std=0.0438
[DEBUG][MIA] Test Set Loss:   mean=1.2433, std=2.6142
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.26666666666666666, 'auc': 0.7371826171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 24 21 21 23 23 21 22 20 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0083, std=0.0879
[DEBUG][MIA] Test Set Loss:   mean=1.3881, std=2.8122
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.68, 'cv_acc': 0.262, 'auc': 0.750344, 'task': 4}
5 4
Total correct retain:  1361  Total retain:  2500
Total correct forget:  15660  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  2826  Total test forget:  9500
After learning task 5
Task accuracies: [0.444, 0.604, 0.684, 0.69, 0.738, 0.072, 0.208, 0.206, 0.194, 0.272, 0.19, 0.214, 0.258, 0.342, 0.2, 0.176, 0.08, 0.19, 0.156, 0.178]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=1.9074, std=2.9912
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.30196078431372547, 'auc': 0.832672119140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1699, std=2.6813
[DEBUG][MIA] Test Set Loss:   mean=1.8211, std=3.3379
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.154, 'auc': 0.548368, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 13, 11, 14, 14, 11, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.7446, std=3.0440
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2901960784313725, 'auc': 0.85980224609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 14 14 10 13 14 11 11 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2363, std=2.7146
[DEBUG][MIA] Test Set Loss:   mean=1.8060, std=3.1351
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.172, 'auc': 0.560808, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 17, 15, 17, 19, 18, 15, 19, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.5028, std=2.6280
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.28627450980392155, 'auc': 0.8157958984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 15 19 19 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7752, std=1.7979
[DEBUG][MIA] Test Set Loss:   mean=1.4678, std=2.7978
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.178, 'auc': 0.5780879999999999, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 24, 20, 21, 22, 22, 24, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.7879, std=3.1304
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.29411764705882354, 'auc': 0.787506103515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 24 21 21 23 23 21 22 20 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2121, std=0.8764
[DEBUG][MIA] Test Set Loss:   mean=1.6552, std=3.0569
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.22600000000000003, 'auc': 0.683008, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 25, 26, 29, 28, 26, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 26 25 28 27 28 25 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=0.7518, std=2.7307
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.17254901960784313, 'auc': 0.67852783203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 28 26 26 29 27 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 26 25 28 27 28 25 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0244
[DEBUG][MIA] Test Set Loss:   mean=0.5214, std=1.9351
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.172, 'auc': 0.6483920000000001, 'task': 5}
6 5
Total correct retain:  1422  Total retain:  2500
Total correct forget:  18003  Total forget:  47500
Total correct test:  223  Total test:  500
Total correct forget test:  3244  Total test forget:  9500
After learning task 6
Task accuracies: [0.446, 0.66, 0.634, 0.66, 0.67, 0.886, 0.21, 0.214, 0.17, 0.312, 0.222, 0.2, 0.242, 0.366, 0.19, 0.208, 0.064, 0.188, 0.2, 0.192]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 8, 6, 7, 5, 9, 6, 7, 5, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.7104, std=2.8267
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2823529411764706, 'auc': 0.851104736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 8 7 8 6 7 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 6 6 9 8 5 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0040, std=2.0619
[DEBUG][MIA] Test Set Loss:   mean=2.0642, std=3.5054
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13000000000000003, 'auc': 0.5648799999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 13, 11, 14, 14, 11, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.8884, std=3.3329
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.28627450980392155, 'auc': 0.800994873046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 14 14 10 13 14 11 11 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 14 11 11 10 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9965, std=2.4180
[DEBUG][MIA] Test Set Loss:   mean=1.6318, std=3.1613
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12600000000000003, 'auc': 0.5802480000000001, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 17, 15, 17, 19, 18, 15, 19, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.9391, std=3.3643
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.27450980392156865, 'auc': 0.797698974609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 19 15 19 15 19 19 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 17 15 18 15 18 16 19 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8977, std=2.2938
[DEBUG][MIA] Test Set Loss:   mean=1.4920, std=3.1404
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.18, 'auc': 0.552896, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 24, 20, 21, 22, 22, 24, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.9343, std=3.0098
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7215686274509804, 'auc': 0.8526611328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 24 21 21 23 23 21 22 20 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 24 21 24 21 21 23 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5488, std=2.0227
[DEBUG][MIA] Test Set Loss:   mean=2.1136, std=3.4572
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.23199999999999998, 'auc': 0.65352, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 25, 26, 29, 28, 26, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 26 25 28 27 28 25 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=0.7544, std=1.7722
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.22745098039215686, 'auc': 0.68731689453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 28 26 26 29 27 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 26 25 28 27 28 25 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2410, std=0.9525
[DEBUG][MIA] Test Set Loss:   mean=0.8250, std=1.9140
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.156, 'auc': 0.5930160000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 30, 34, 33, 33, 33, 32, 34, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 30 34 31 31 33 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0066, std=0.0449
[DEBUG][MIA] Test Set Loss:   mean=0.9671, std=2.3367
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2235294117647059, 'auc': 0.685821533203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 34 31 31 33 33 32 34 30 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 30 34 31 31 33 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0202
[DEBUG][MIA] Test Set Loss:   mean=1.0871, std=2.6337
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.23200000000000004, 'auc': 0.6977679999999999, 'task': 6}
7 6
Total correct retain:  1358  Total retain:  2500
Total correct forget:  19548  Total forget:  47500
Total correct test:  232  Total test:  500
Total correct forget test:  3461  Total test forget:  9500
After learning task 7
Task accuracies: [0.464, 0.652, 0.676, 0.652, 0.6, 0.788, 0.79, 0.198, 0.158, 0.342, 0.238, 0.15, 0.172, 0.412, 0.234, 0.178, 0.084, 0.192, 0.204, 0.202]
Training task:  8
