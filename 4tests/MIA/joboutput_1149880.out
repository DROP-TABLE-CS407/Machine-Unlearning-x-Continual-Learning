Requirement already satisfied: pyyaml in /usr/lib64/python3.12/site-packages (6.0.1)
Requirement already satisfied: setuptools in /usr/lib/python3.12/site-packages (68.2.2)
Requirement already satisfied: matplotlib in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.10.1)
Requirement already satisfied: contourpy>=1.0.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler>=0.10 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy>=1.23 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.2.4)
Requirement already satisfied: packaging>=20.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow>=8 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing>=2.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: quadprog in /dcs/21/u2110391/.local/lib/python3.12/site-packages (0.1.13)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from quadprog) (2.2.4)
Requirement already satisfied: pyparsing in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.2.3)
Requirement already satisfied: pandas in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.3)
Requirement already satisfied: numpy>=1.26.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.4)
Mon Apr 28 12:32:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 30%   52C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: neggem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 12:33:11 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 30%   52C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['sea', 'couch', 'mountain', 'road', 'bed', 'bottles', 'camel', 'sweet peppers', 'cattle', 'dolphin', 'plain', 'poppies', 'butterfly', 'otter', 'forest', 'porcupine', 'chimpanzee', 'leopard', 'cups', 'mushrooms', 'cloud', 'ray', 'possum', 'crocodile', 'trout', 'computer keyboard', 'lamp', 'lion', 'caterpillar', 'cockroach', 'worm', 'fox', 'flatfish', 'shrew', 'wolf', 'lizard', 'shark', 'maple', 'rocket', 'television', 'tulips', 'clock', 'mouse', 'oak', 'kangaroo', 'lobster', 'squirrel', 'whale', 'sunflowers', 'hamster', 'tank', 'spider', 'bicycle', 'snail', 'house', 'man', 'baby', 'bus', 'turtle', 'roses', 'train', 'tractor', 'woman', 'pears', 'bowls', 'bridge', 'chair', 'plates', 'orchids', 'castle', 'boy', 'oranges', 'wardrobe', 'pine', 'raccoon', 'dinosaur', 'snake', 'bee', 'table', 'palm', 'rabbit', 'beaver', 'bear', 'elephant', 'motorcycle', 'tiger', 'seal', 'lawn-mower', 'apples', 'aquarium fish', 'cans', 'beetle', 'telephone', 'crab', 'streetcar', 'skunk', 'willow', 'girl', 'pickup truck', 'skyscraper']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2054  Total retain:  2500
Total correct forget:  9614  Total forget:  47500
Total correct test:  351  Total test:  500
Total correct forget test:  1881  Total test forget:  9500
After learning task 1
Task accuracies: [0.702, 0.196, 0.096, 0.23, 0.216, 0.21, 0.202, 0.194, 0.272, 0.19, 0.2, 0.196, 0.156, 0.198, 0.204, 0.32, 0.2, 0.166, 0.198, 0.118]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2534, std=0.8202
[DEBUG][MIA] Test Set Loss:   mean=1.7508, std=3.0922
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.24705882352941178, 'auc': 0.7056884765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2567, std=1.0895
[DEBUG][MIA] Test Set Loss:   mean=1.4640, std=2.5907
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.23200000000000004, 'auc': 0.692576, 'task': 1}
2 1
Total correct retain:  1713  Total retain:  2500
Total correct forget:  11328  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  2159  Total test forget:  9500
After learning task 2
Task accuracies: [0.63, 0.66, 0.13, 0.208, 0.24, 0.23, 0.194, 0.234, 0.254, 0.222, 0.204, 0.198, 0.21, 0.138, 0.23, 0.18, 0.194, 0.186, 0.22, 0.186]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0251
[DEBUG][MIA] Test Set Loss:   mean=1.6251, std=2.7254
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7568627450980392, 'auc': 0.795867919921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6747, std=1.5289
[DEBUG][MIA] Test Set Loss:   mean=2.0922, std=3.3429
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.162, 'auc': 0.662176, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1771, std=0.7163
[DEBUG][MIA] Test Set Loss:   mean=1.1167, std=3.0563
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.1647058823529412, 'auc': 0.587066650390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0407, std=0.1985
[DEBUG][MIA] Test Set Loss:   mean=1.0638, std=2.6580
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.182, 'auc': 0.6619919999999999, 'task': 2}
3 2
Total correct retain:  1546  Total retain:  2500
Total correct forget:  13036  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  2449  Total test forget:  9500
After learning task 3
Task accuracies: [0.578, 0.588, 0.81, 0.184, 0.296, 0.226, 0.188, 0.22, 0.224, 0.226, 0.21, 0.228, 0.194, 0.138, 0.196, 0.198, 0.204, 0.196, 0.184, 0.188]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0078
[DEBUG][MIA] Test Set Loss:   mean=2.1075, std=3.0009
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7411764705882353, 'auc': 0.8382568359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3166, std=2.2326
[DEBUG][MIA] Test Set Loss:   mean=2.2047, std=3.3600
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.18, 'auc': 0.580952, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0129, std=0.0688
[DEBUG][MIA] Test Set Loss:   mean=1.6253, std=3.2982
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2627450980392157, 'auc': 0.69049072265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4664, std=1.3152
[DEBUG][MIA] Test Set Loss:   mean=1.6506, std=3.1645
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.16999999999999998, 'auc': 0.611224, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0562, std=0.2828
[DEBUG][MIA] Test Set Loss:   mean=1.5750, std=2.7186
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.24705882352941178, 'auc': 0.782806396484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0626, std=0.2389
[DEBUG][MIA] Test Set Loss:   mean=1.3544, std=2.5554
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.25, 'auc': 0.7183360000000001, 'task': 3}
4 3
Total correct retain:  1547  Total retain:  2500
Total correct forget:  14492  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  2592  Total test forget:  9500
After learning task 4
Task accuracies: [0.552, 0.54, 0.706, 0.686, 0.214, 0.266, 0.166, 0.186, 0.216, 0.228, 0.216, 0.23, 0.222, 0.136, 0.192, 0.234, 0.186, 0.186, 0.214, 0.16]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0155, std=0.0594
[DEBUG][MIA] Test Set Loss:   mean=2.6445, std=4.1166
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7176470588235294, 'auc': 0.802215576171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5619, std=2.9629
[DEBUG][MIA] Test Set Loss:   mean=2.8574, std=4.0757
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.132, 'auc': 0.602136, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0526, std=0.1485
[DEBUG][MIA] Test Set Loss:   mean=2.0081, std=3.4351
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2784313725490196, 'auc': 0.71881103515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7257, std=1.8891
[DEBUG][MIA] Test Set Loss:   mean=1.6181, std=2.9697
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.194, 'auc': 0.579824, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0130, std=0.0657
[DEBUG][MIA] Test Set Loss:   mean=2.0115, std=3.2022
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7098039215686275, 'auc': 0.837493896484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5072, std=1.4004
[DEBUG][MIA] Test Set Loss:   mean=1.7368, std=2.7528
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.22600000000000003, 'auc': 0.6432880000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1424, std=0.6320
[DEBUG][MIA] Test Set Loss:   mean=1.1371, std=2.3863
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.22745098039215686, 'auc': 0.715606689453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0551, std=0.2826
[DEBUG][MIA] Test Set Loss:   mean=1.0960, std=2.6218
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.23200000000000004, 'auc': 0.692272, 'task': 4}
5 4
Total correct retain:  1615  Total retain:  2500
Total correct forget:  16186  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  2871  Total test forget:  9500
After learning task 5
Task accuracies: [0.612, 0.556, 0.67, 0.596, 0.742, 0.24, 0.19, 0.196, 0.256, 0.248, 0.188, 0.226, 0.23, 0.156, 0.204, 0.24, 0.204, 0.202, 0.198, 0.2]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0095
[DEBUG][MIA] Test Set Loss:   mean=2.3566, std=3.4510
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7607843137254903, 'auc': 0.84100341796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7703, std=2.9050
[DEBUG][MIA] Test Set Loss:   mean=2.2324, std=3.5056
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.146, 'auc': 0.52276, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0272, std=0.1877
[DEBUG][MIA] Test Set Loss:   mean=1.6109, std=3.5465
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25098039215686274, 'auc': 0.727447509765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8274, std=1.9823
[DEBUG][MIA] Test Set Loss:   mean=1.5235, std=3.1235
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.126, 'auc': 0.5474960000000001, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0074, std=0.0356
[DEBUG][MIA] Test Set Loss:   mean=2.3487, std=3.5959
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7529411764705882, 'auc': 0.861175537109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0360, std=2.2629
[DEBUG][MIA] Test Set Loss:   mean=2.1157, std=3.5193
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.16999999999999998, 'auc': 0.593104, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0334, std=0.1672
[DEBUG][MIA] Test Set Loss:   mean=1.4682, std=2.9088
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26666666666666666, 'auc': 0.743988037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4474, std=1.2708
[DEBUG][MIA] Test Set Loss:   mean=1.5254, std=2.8328
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.146, 'auc': 0.6437359999999999, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0365, std=0.2415
[DEBUG][MIA] Test Set Loss:   mean=1.4747, std=3.1651
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2235294117647059, 'auc': 0.695953369140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0264, std=0.1839
[DEBUG][MIA] Test Set Loss:   mean=1.1695, std=2.8486
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.21000000000000002, 'auc': 0.732256, 'task': 5}
6 5
Total correct retain:  1468  Total retain:  2500
Total correct forget:  17537  Total forget:  47500
Total correct test:  268  Total test:  500
Total correct forget test:  3119  Total test forget:  9500
After learning task 6
Task accuracies: [0.536, 0.556, 0.702, 0.582, 0.694, 0.784, 0.184, 0.228, 0.226, 0.254, 0.204, 0.238, 0.236, 0.126, 0.2, 0.196, 0.194, 0.212, 0.196, 0.226]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0482
[DEBUG][MIA] Test Set Loss:   mean=2.0238, std=2.9973
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7294117647058823, 'auc': 0.830780029296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7893, std=2.9314
[DEBUG][MIA] Test Set Loss:   mean=1.9318, std=3.1635
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.12000000000000002, 'auc': 0.525112, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0609, std=0.5228
[DEBUG][MIA] Test Set Loss:   mean=1.7347, std=2.9828
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.25098039215686274, 'auc': 0.73516845703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7420, std=1.6554
[DEBUG][MIA] Test Set Loss:   mean=1.5696, std=2.9195
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.10800000000000001, 'auc': 0.545912, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0120, std=0.0841
[DEBUG][MIA] Test Set Loss:   mean=2.2625, std=3.3538
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7058823529411764, 'auc': 0.853851318359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4209, std=2.6732
[DEBUG][MIA] Test Set Loss:   mean=2.6946, std=3.6586
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.13, 'auc': 0.636472, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0793, std=0.3669
[DEBUG][MIA] Test Set Loss:   mean=1.8758, std=2.8790
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.42745098039215684, 'auc': 0.754364013671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8377, std=1.8670
[DEBUG][MIA] Test Set Loss:   mean=1.8841, std=3.1463
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.12000000000000002, 'auc': 0.600864, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=1.5727, std=2.9888
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.27450980392156865, 'auc': 0.770416259765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4435, std=1.3400
[DEBUG][MIA] Test Set Loss:   mean=1.3825, std=2.8635
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.22200000000000003, 'auc': 0.590616, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0109, std=0.0627
[DEBUG][MIA] Test Set Loss:   mean=1.4404, std=2.6999
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.25490196078431376, 'auc': 0.757049560546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0131, std=0.0965
[DEBUG][MIA] Test Set Loss:   mean=1.5120, std=2.8538
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.22000000000000003, 'auc': 0.774016, 'task': 6}
7 6
Total correct retain:  1559  Total retain:  2500
Total correct forget:  19063  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  3368  Total test forget:  9500
After learning task 7
Task accuracies: [0.552, 0.592, 0.69, 0.56, 0.662, 0.712, 0.726, 0.186, 0.304, 0.236, 0.204, 0.218, 0.264, 0.102, 0.19, 0.2, 0.194, 0.222, 0.208, 0.266]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0293, std=0.2172
[DEBUG][MIA] Test Set Loss:   mean=2.5783, std=4.2462
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7647058823529411, 'auc': 0.801513671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7478, std=3.0128
[DEBUG][MIA] Test Set Loss:   mean=2.6845, std=4.1508
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11000000000000001, 'auc': 0.585008, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0687, std=0.4029
[DEBUG][MIA] Test Set Loss:   mean=1.6364, std=2.7845
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26666666666666666, 'auc': 0.756256103515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8471, std=1.9559
[DEBUG][MIA] Test Set Loss:   mean=1.7541, std=3.2151
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11800000000000002, 'auc': 0.5896560000000001, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0096, std=0.0344
[DEBUG][MIA] Test Set Loss:   mean=2.7145, std=3.6779
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7568627450980392, 'auc': 0.854644775390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7513, std=3.4068
[DEBUG][MIA] Test Set Loss:   mean=2.7275, std=3.9863
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.12400000000000003, 'auc': 0.593968, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0402
[DEBUG][MIA] Test Set Loss:   mean=1.5725, std=2.9119
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2980392156862745, 'auc': 0.834930419921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1099, std=2.3783
[DEBUG][MIA] Test Set Loss:   mean=1.6017, std=2.9326
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.18, 'auc': 0.5665199999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0065
[DEBUG][MIA] Test Set Loss:   mean=1.4210, std=2.8378
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2823529411764706, 'auc': 0.790618896484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4178, std=1.2298
[DEBUG][MIA] Test Set Loss:   mean=1.4649, std=2.9297
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.158, 'auc': 0.62876, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0106
[DEBUG][MIA] Test Set Loss:   mean=1.9983, std=3.2792
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.30196078431372547, 'auc': 0.84185791015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1892, std=0.6942
[DEBUG][MIA] Test Set Loss:   mean=1.4026, std=2.5941
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.23399999999999999, 'auc': 0.7197520000000001, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0734, std=0.5056
[DEBUG][MIA] Test Set Loss:   mean=0.8705, std=2.5961
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.20784313725490197, 'auc': 0.612640380859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0266, std=0.1494
[DEBUG][MIA] Test Set Loss:   mean=0.9359, std=2.2951
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.198, 'auc': 0.62436, 'task': 7}
8 7
Total correct retain:  1648  Total retain:  2500
Total correct forget:  20447  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  3582  Total test forget:  9500
After learning task 8
Task accuracies: [0.576, 0.574, 0.688, 0.528, 0.666, 0.706, 0.664, 0.806, 0.276, 0.24, 0.224, 0.23, 0.232, 0.098, 0.196, 0.232, 0.19, 0.208, 0.158, 0.248]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0118, std=0.0535
[DEBUG][MIA] Test Set Loss:   mean=3.1791, std=4.6575
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7254901960784313, 'auc': 0.806671142578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2938, std=3.7875
[DEBUG][MIA] Test Set Loss:   mean=2.4809, std=4.1122
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11400000000000002, 'auc': 0.514184, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1025, std=0.5823
[DEBUG][MIA] Test Set Loss:   mean=1.9752, std=3.4833
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.27450980392156865, 'auc': 0.728790283203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3182, std=2.8873
[DEBUG][MIA] Test Set Loss:   mean=2.0509, std=4.0934
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.086, 'auc': 0.568208, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0198, std=0.0916
[DEBUG][MIA] Test Set Loss:   mean=2.6616, std=4.0998
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7294117647058823, 'auc': 0.8402099609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7725, std=3.0488
[DEBUG][MIA] Test Set Loss:   mean=2.7306, std=4.1082
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.15399999999999997, 'auc': 0.575032, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0123, std=0.0713
[DEBUG][MIA] Test Set Loss:   mean=2.0735, std=3.0600
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6823529411764706, 'auc': 0.822540283203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4520, std=2.8533
[DEBUG][MIA] Test Set Loss:   mean=1.7186, std=2.7979
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.138, 'auc': 0.5391440000000001, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0144
[DEBUG][MIA] Test Set Loss:   mean=1.3798, std=2.6579
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.26666666666666666, 'auc': 0.842132568359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9272, std=2.1506
[DEBUG][MIA] Test Set Loss:   mean=1.5888, std=2.8335
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.11400000000000002, 'auc': 0.6119840000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.7114, std=2.6090
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7294117647058824, 'auc': 0.878021240234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5244, std=1.5183
[DEBUG][MIA] Test Set Loss:   mean=1.6696, std=2.5800
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.184, 'auc': 0.6661199999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0168, std=0.1479
[DEBUG][MIA] Test Set Loss:   mean=1.0398, std=2.2870
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.24705882352941178, 'auc': 0.71417236328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2247, std=0.9656
[DEBUG][MIA] Test Set Loss:   mean=1.0336, std=2.2256
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.166, 'auc': 0.6238400000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0510, std=0.2106
[DEBUG][MIA] Test Set Loss:   mean=0.9322, std=3.0136
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.2, 'auc': 0.589813232421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0102, std=0.0503
[DEBUG][MIA] Test Set Loss:   mean=0.7583, std=1.9992
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.198, 'auc': 0.610896, 'task': 8}
Total correct retain:  1640  Total retain:  2500
Total correct forget:  21795  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  3775  Total test forget:  9500
After learning task 9
Task accuracies: [0.576, 0.556, 0.706, 0.534, 0.62, 0.68, 0.622, 0.754, 0.826, 0.252, 0.212, 0.206, 0.202, 0.138, 0.186, 0.214, 0.194, 0.206, 0.192, 0.25]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0149
[DEBUG][MIA] Test Set Loss:   mean=2.7753, std=4.5407
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7254901960784312, 'auc': 0.81475830078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1893, std=4.0143
[DEBUG][MIA] Test Set Loss:   mean=2.7261, std=4.5730
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.08399999999999999, 'auc': 0.560512, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0309, std=0.2302
[DEBUG][MIA] Test Set Loss:   mean=1.4290, std=3.1061
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2784313725490196, 'auc': 0.700531005859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9600, std=2.3146
[DEBUG][MIA] Test Set Loss:   mean=1.6615, std=3.3728
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10800000000000001, 'auc': 0.545096, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0283, std=0.1449
[DEBUG][MIA] Test Set Loss:   mean=2.9807, std=4.5086
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7529411764705883, 'auc': 0.794403076171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4624, std=4.1531
[DEBUG][MIA] Test Set Loss:   mean=3.1234, std=4.4563
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.146, 'auc': 0.5681280000000001, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0199, std=0.1256
[DEBUG][MIA] Test Set Loss:   mean=1.9147, std=2.7529
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2666666666666667, 'auc': 0.820709228515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3981, std=2.8623
[DEBUG][MIA] Test Set Loss:   mean=2.2011, std=3.3250
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.096, 'auc': 0.5585519999999999, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0092
[DEBUG][MIA] Test Set Loss:   mean=1.8437, std=3.2789
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2901960784313725, 'auc': 0.791534423828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9169, std=2.2190
[DEBUG][MIA] Test Set Loss:   mean=1.5180, std=2.9289
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.16399999999999998, 'auc': 0.5896480000000001, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0327
[DEBUG][MIA] Test Set Loss:   mean=1.4107, std=2.4684
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7490196078431373, 'auc': 0.838897705078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8361, std=2.1090
[DEBUG][MIA] Test Set Loss:   mean=1.7356, std=2.8114
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.174, 'auc': 0.644096, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0120, std=0.0678
[DEBUG][MIA] Test Set Loss:   mean=1.1386, std=2.6763
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.25098039215686274, 'auc': 0.679656982421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4165, std=1.1651
[DEBUG][MIA] Test Set Loss:   mean=1.2804, std=2.6552
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.146, 'auc': 0.580152, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.1111, std=2.5032
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.20784313725490194, 'auc': 0.734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2197, std=0.7550
[DEBUG][MIA] Test Set Loss:   mean=1.2736, std=2.8825
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.158, 'auc': 0.5964160000000001, 'task': 8}
Total correct retain:  1623  Total retain:  2500
Total correct forget:  23142  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  4066  Total test forget:  9500
After learning task 10
Task accuracies: [0.6, 0.576, 0.692, 0.5, 0.624, 0.67, 0.618, 0.76, 0.768, 0.812, 0.228, 0.234, 0.21, 0.098, 0.174, 0.248, 0.216, 0.218, 0.254, 0.232]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0096, std=0.0580
[DEBUG][MIA] Test Set Loss:   mean=2.6053, std=3.9373
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7450980392156863, 'auc': 0.849609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.2832, std=4.2022
[DEBUG][MIA] Test Set Loss:   mean=2.7207, std=4.1855
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.448, 'cv_acc': 0.12400000000000003, 'auc': 0.45020000000000004, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0113, std=0.0529
[DEBUG][MIA] Test Set Loss:   mean=1.9613, std=3.4614
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.27450980392156865, 'auc': 0.682952880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3701, std=3.3212
[DEBUG][MIA] Test Set Loss:   mean=1.9514, std=3.4515
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.11800000000000002, 'auc': 0.545272, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0208
[DEBUG][MIA] Test Set Loss:   mean=2.7897, std=4.4492
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.780392156862745, 'auc': 0.84844970703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7998, std=3.2062
[DEBUG][MIA] Test Set Loss:   mean=2.9642, std=4.2010
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.12600000000000003, 'auc': 0.579688, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1059, std=0.6182
[DEBUG][MIA] Test Set Loss:   mean=1.9199, std=2.9121
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25098039215686274, 'auc': 0.819915771484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6204, std=2.8858
[DEBUG][MIA] Test Set Loss:   mean=2.2257, std=3.2344
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11800000000000002, 'auc': 0.573208, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.7640, std=3.0811
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7137254901960783, 'auc': 0.806488037109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1209, std=2.3547
[DEBUG][MIA] Test Set Loss:   mean=1.6187, std=2.9157
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.15999999999999998, 'auc': 0.54468, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=2.0388, std=3.3743
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7372549019607844, 'auc': 0.892822265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9073, std=1.9513
[DEBUG][MIA] Test Set Loss:   mean=2.0568, std=3.2080
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.15, 'auc': 0.646504, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0349, std=0.2392
[DEBUG][MIA] Test Set Loss:   mean=1.1153, std=2.7348
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.25098039215686274, 'auc': 0.701202392578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9477, std=2.2011
[DEBUG][MIA] Test Set Loss:   mean=1.1533, std=2.1968
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.17, 'auc': 0.5491199999999999, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0110
[DEBUG][MIA] Test Set Loss:   mean=0.7957, std=1.9047
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.24705882352941178, 'auc': 0.716400146484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3801, std=1.0954
[DEBUG][MIA] Test Set Loss:   mean=0.9134, std=1.9173
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.16599999999999998, 'auc': 0.5893200000000001, 'task': 8}
Total correct retain:  1568  Total retain:  2500
Total correct forget:  23961  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  4129  Total test forget:  9500
After learning task 11
Task accuracies: [0.578, 0.528, 0.68, 0.524, 0.584, 0.66, 0.61, 0.712, 0.772, 0.756, 0.688, 0.248, 0.234, 0.114, 0.178, 0.206, 0.218, 0.164, 0.216, 0.166]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0514, std=0.3092
[DEBUG][MIA] Test Set Loss:   mean=2.5340, std=3.1497
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7176470588235293, 'auc': 0.829559326171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7513, std=2.7847
[DEBUG][MIA] Test Set Loss:   mean=2.0613, std=2.8941
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.12400000000000003, 'auc': 0.554752, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1171, std=0.4643
[DEBUG][MIA] Test Set Loss:   mean=1.4038, std=2.5892
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.25098039215686274, 'auc': 0.616363525390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1032, std=2.3781
[DEBUG][MIA] Test Set Loss:   mean=1.3553, std=2.3808
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.128, 'auc': 0.539048, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0636, std=0.2171
[DEBUG][MIA] Test Set Loss:   mean=2.4724, std=3.6613
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7333333333333332, 'auc': 0.818115234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7201, std=2.8910
[DEBUG][MIA] Test Set Loss:   mean=2.4470, std=3.5252
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.144, 'auc': 0.585824, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2469, std=0.7098
[DEBUG][MIA] Test Set Loss:   mean=1.7414, std=2.5654
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.41568627450980394, 'auc': 0.680999755859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0135, std=1.9365
[DEBUG][MIA] Test Set Loss:   mean=1.7963, std=2.6775
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.10400000000000001, 'auc': 0.592448, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0934, std=0.2973
[DEBUG][MIA] Test Set Loss:   mean=1.4910, std=2.5302
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5764705882352941, 'auc': 0.748077392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0720, std=1.9690
[DEBUG][MIA] Test Set Loss:   mean=1.6263, std=2.6107
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.15, 'auc': 0.561296, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0195, std=0.0505
[DEBUG][MIA] Test Set Loss:   mean=1.5942, std=2.3392
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7411764705882353, 'auc': 0.80157470703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7591, std=1.6732
[DEBUG][MIA] Test Set Loss:   mean=1.6883, std=2.6155
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.16399999999999998, 'auc': 0.6388320000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2280, std=0.5305
[DEBUG][MIA] Test Set Loss:   mean=1.1512, std=1.9763
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.23529411764705882, 'auc': 0.6571044921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0184, std=1.9660
[DEBUG][MIA] Test Set Loss:   mean=1.4317, std=2.3638
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11400000000000002, 'auc': 0.538768, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0601, std=0.1456
[DEBUG][MIA] Test Set Loss:   mean=1.2687, std=2.4127
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2784313725490196, 'auc': 0.69830322265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6081, std=1.6792
[DEBUG][MIA] Test Set Loss:   mean=1.0660, std=2.1982
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.13800000000000004, 'auc': 0.554016, 'task': 8}
Total correct retain:  1421  Total retain:  2500
Total correct forget:  21302  Total forget:  47500
Total correct test:  265  Total test:  500
Total correct forget test:  3790  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.53, 0.51, 0.666, 0.494, 0.588, 0.636, 0.588, 0.662, 0.728, 0.708, 0.248, 0.224, 0.198, 0.148, 0.178, 0.252, 0.214, 0.174, 0.2, 0.164]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0316, std=0.0851
[DEBUG][MIA] Test Set Loss:   mean=2.0960, std=2.8369
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.6901960784313725, 'auc': 0.82061767578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7703, std=2.7336
[DEBUG][MIA] Test Set Loss:   mean=2.0304, std=2.9864
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.12000000000000002, 'auc': 0.538752, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0868, std=0.2603
[DEBUG][MIA] Test Set Loss:   mean=1.2613, std=2.0875
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26666666666666666, 'auc': 0.73529052734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8661, std=1.7670
[DEBUG][MIA] Test Set Loss:   mean=1.2746, std=2.3405
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11400000000000002, 'auc': 0.5530079999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2655, std=0.8288
[DEBUG][MIA] Test Set Loss:   mean=2.3006, std=3.3455
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7019607843137254, 'auc': 0.769744873046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8990, std=2.7131
[DEBUG][MIA] Test Set Loss:   mean=2.6839, std=3.5231
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.092, 'auc': 0.563848, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1407, std=0.3369
[DEBUG][MIA] Test Set Loss:   mean=1.3660, std=2.2185
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.7215686274509803, 'auc': 0.6888427734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0998, std=1.8539
[DEBUG][MIA] Test Set Loss:   mean=1.4848, std=2.1557
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.5311760000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0580, std=0.1735
[DEBUG][MIA] Test Set Loss:   mean=1.1145, std=1.9913
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6627450980392158, 'auc': 0.7540283203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8898, std=1.6397
[DEBUG][MIA] Test Set Loss:   mean=1.1707, std=2.1424
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.152, 'auc': 0.5280480000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0853, std=0.1986
[DEBUG][MIA] Test Set Loss:   mean=1.7816, std=2.4711
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7137254901960783, 'auc': 0.810546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8187, std=1.5750
[DEBUG][MIA] Test Set Loss:   mean=1.5799, std=2.4078
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.194, 'auc': 0.595712, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1183, std=0.2809
[DEBUG][MIA] Test Set Loss:   mean=0.9476, std=1.5194
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.5607843137254902, 'auc': 0.7103271484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7752, std=1.5932
[DEBUG][MIA] Test Set Loss:   mean=0.9875, std=1.5432
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.122, 'auc': 0.562032, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0346, std=0.0785
[DEBUG][MIA] Test Set Loss:   mean=0.9270, std=1.6298
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2627450980392157, 'auc': 0.70965576171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6103, std=1.2511
[DEBUG][MIA] Test Set Loss:   mean=0.9932, std=1.9602
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.14599999999999996, 'auc': 0.553616, 'task': 8}
Total correct retain:  1600  Total retain:  2500
Total correct forget:  20006  Total forget:  47500
Total correct test:  286  Total test:  500
Total correct forget test:  3597  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.572, 0.532, 0.694, 0.48, 0.62, 0.672, 0.56, 0.688, 0.734, 0.208, 0.312, 0.22, 0.194, 0.138, 0.19, 0.214, 0.214, 0.178, 0.198, 0.148]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0366, std=0.0994
[DEBUG][MIA] Test Set Loss:   mean=1.8315, std=2.5399
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7294117647058824, 'auc': 0.82366943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4735, std=2.3508
[DEBUG][MIA] Test Set Loss:   mean=1.7492, std=2.3543
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.16999999999999998, 'auc': 0.5623199999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0649, std=0.2710
[DEBUG][MIA] Test Set Loss:   mean=0.8580, std=1.7108
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2705882352941177, 'auc': 0.67388916015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8682, std=1.6716
[DEBUG][MIA] Test Set Loss:   mean=0.9799, std=1.7585
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.513056, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.1067, std=0.2886
[DEBUG][MIA] Test Set Loss:   mean=1.9896, std=2.3129
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7098039215686275, 'auc': 0.84814453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6406, std=2.2532
[DEBUG][MIA] Test Set Loss:   mean=1.9796, std=2.6751
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.096, 'auc': 0.460608, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1162, std=0.3771
[DEBUG][MIA] Test Set Loss:   mean=1.3103, std=1.8530
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6627450980392157, 'auc': 0.765380859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9884, std=1.5802
[DEBUG][MIA] Test Set Loss:   mean=1.3697, std=1.9176
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11200000000000002, 'auc': 0.547888, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0361, std=0.0857
[DEBUG][MIA] Test Set Loss:   mean=1.2658, std=2.2189
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6588235294117647, 'auc': 0.77490234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9453, std=1.9262
[DEBUG][MIA] Test Set Loss:   mean=1.1910, std=1.9631
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.14600000000000002, 'auc': 0.569328, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0479, std=0.1062
[DEBUG][MIA] Test Set Loss:   mean=1.2404, std=1.7212
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6862745098039216, 'auc': 0.8046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8971, std=1.5222
[DEBUG][MIA] Test Set Loss:   mean=1.5775, std=2.0766
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.16799999999999998, 'auc': 0.598464, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0920, std=0.3691
[DEBUG][MIA] Test Set Loss:   mean=0.8627, std=1.4633
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.3607843137254902, 'auc': 0.753662109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6566, std=1.2211
[DEBUG][MIA] Test Set Loss:   mean=0.9189, std=1.4963
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12800000000000003, 'auc': 0.535344, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.4128, std=3.7991
[DEBUG][MIA] Test Set Loss:   mean=3.9365, std=4.0182
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10196078431372549, 'auc': 0.46099853515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.4401, std=3.4935
[DEBUG][MIA] Test Set Loss:   mean=3.8125, std=3.6779
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.09, 'auc': 0.46881600000000007, 'task': 8}
Total correct retain:  1579  Total retain:  2500
Total correct forget:  19054  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  3473  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.564, 0.542, 0.742, 0.534, 0.602, 0.666, 0.55, 0.708, 0.27, 0.218, 0.316, 0.23, 0.2, 0.12, 0.176, 0.26, 0.22, 0.228, 0.208, 0.156]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0566, std=0.1503
[DEBUG][MIA] Test Set Loss:   mean=1.9814, std=2.3696
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7058823529411764, 'auc': 0.815673828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4920, std=2.2138
[DEBUG][MIA] Test Set Loss:   mean=1.6710, std=2.2178
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11600000000000002, 'auc': 0.544216, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0878, std=0.2751
[DEBUG][MIA] Test Set Loss:   mean=1.2553, std=2.0707
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.23137254901960783, 'auc': 0.69293212890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9874, std=1.7013
[DEBUG][MIA] Test Set Loss:   mean=1.0128, std=1.7983
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.13999999999999999, 'auc': 0.5259119999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.1864, std=0.3607
[DEBUG][MIA] Test Set Loss:   mean=2.2124, std=2.6760
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.6705882352941177, 'auc': 0.80865478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9104, std=2.4389
[DEBUG][MIA] Test Set Loss:   mean=2.0316, std=2.5823
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10200000000000001, 'auc': 0.5228240000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1183, std=0.3542
[DEBUG][MIA] Test Set Loss:   mean=1.6833, std=2.4839
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.6392156862745099, 'auc': 0.77630615234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0098, std=1.7427
[DEBUG][MIA] Test Set Loss:   mean=1.4192, std=2.1453
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10800000000000001, 'auc': 0.574496, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0588, std=0.1378
[DEBUG][MIA] Test Set Loss:   mean=1.2514, std=2.0467
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6352941176470589, 'auc': 0.77130126953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8019, std=1.5122
[DEBUG][MIA] Test Set Loss:   mean=1.5375, std=2.1951
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.092, 'auc': 0.629024, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1335, std=0.2557
[DEBUG][MIA] Test Set Loss:   mean=1.6365, std=2.0567
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.6627450980392157, 'auc': 0.80328369140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0076, std=1.5970
[DEBUG][MIA] Test Set Loss:   mean=1.4551, std=1.8380
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.156, 'auc': 0.583936, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4197, std=4.2923
[DEBUG][MIA] Test Set Loss:   mean=3.4477, std=3.2548
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4375, 'cv_acc': 0.11372549019607843, 'auc': 0.4658203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.0417, std=3.8662
[DEBUG][MIA] Test Set Loss:   mean=4.1680, std=3.6928
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10600000000000001, 'auc': 0.479904, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7190, std=2.5782
[DEBUG][MIA] Test Set Loss:   mean=2.6470, std=2.3302
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12941176470588237, 'auc': 0.5054931640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7620, std=2.4452
[DEBUG][MIA] Test Set Loss:   mean=2.7519, std=2.2878
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10600000000000001, 'auc': 0.506704, 'task': 8}
Total correct retain:  1568  Total retain:  2500
Total correct forget:  17238  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  3147  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.552, 0.532, 0.72, 0.484, 0.626, 0.64, 0.544, 0.19, 0.246, 0.236, 0.274, 0.216, 0.226, 0.176, 0.176, 0.24, 0.234, 0.198, 0.19, 0.146]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0691, std=0.1415
[DEBUG][MIA] Test Set Loss:   mean=1.9756, std=2.4350
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7372549019607844, 'auc': 0.8372802734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3830, std=1.8646
[DEBUG][MIA] Test Set Loss:   mean=1.7993, std=2.1825
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.11200000000000002, 'auc': 0.439808, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1461, std=0.3303
[DEBUG][MIA] Test Set Loss:   mean=0.9281, std=1.6781
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2666666666666667, 'auc': 0.632659912109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0448, std=1.9837
[DEBUG][MIA] Test Set Loss:   mean=1.1065, std=1.8553
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11800000000000002, 'auc': 0.51096, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0337, std=0.0652
[DEBUG][MIA] Test Set Loss:   mean=1.2101, std=1.7705
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.8117647058823529, 'auc': 0.85595703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1834, std=1.6156
[DEBUG][MIA] Test Set Loss:   mean=1.5140, std=2.0285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.122, 'auc': 0.560784, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2699, std=0.7370
[DEBUG][MIA] Test Set Loss:   mean=1.1224, std=1.6143
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.3843137254901961, 'auc': 0.70721435546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0954, std=1.6883
[DEBUG][MIA] Test Set Loss:   mean=1.3524, std=1.9139
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.549472, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0918, std=0.1792
[DEBUG][MIA] Test Set Loss:   mean=1.1839, std=1.7291
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.6901960784313725, 'auc': 0.7685546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8365, std=1.2618
[DEBUG][MIA] Test Set Loss:   mean=1.1045, std=1.5481
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.172, 'auc': 0.5616319999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9619, std=1.7441
[DEBUG][MIA] Test Set Loss:   mean=2.6295, std=1.9105
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.09019607843137253, 'auc': 0.614990234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4985, std=1.9444
[DEBUG][MIA] Test Set Loss:   mean=2.5465, std=1.8079
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.47912, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.2808, std=3.1336
[DEBUG][MIA] Test Set Loss:   mean=3.4661, std=3.2550
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10588235294117647, 'auc': 0.52435302734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4097, std=3.4718
[DEBUG][MIA] Test Set Loss:   mean=3.1139, std=2.9628
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.09, 'auc': 0.495584, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.5782, std=2.4761
[DEBUG][MIA] Test Set Loss:   mean=2.4039, std=2.0626
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.13333333333333333, 'auc': 0.501708984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.4811, std=2.0897
[DEBUG][MIA] Test Set Loss:   mean=2.5253, std=2.0511
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.485936, 'task': 8}
Total correct retain:  1510  Total retain:  2500
Total correct forget:  16510  Total forget:  47500
Total correct test:  274  Total test:  500
Total correct forget test:  3063  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.548, 0.51, 0.678, 0.566, 0.572, 0.642, 0.21, 0.266, 0.326, 0.272, 0.318, 0.222, 0.192, 0.142, 0.204, 0.228, 0.22, 0.184, 0.21, 0.164]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0198, std=0.0300
[DEBUG][MIA] Test Set Loss:   mean=1.4097, std=1.8559
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7921568627450981, 'auc': 0.85980224609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1461, std=1.6408
[DEBUG][MIA] Test Set Loss:   mean=1.3572, std=1.7408
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.12400000000000003, 'auc': 0.5460160000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0580, std=0.1467
[DEBUG][MIA] Test Set Loss:   mean=0.9226, std=1.4703
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.5725490196078432, 'auc': 0.71905517578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6123, std=1.0867
[DEBUG][MIA] Test Set Loss:   mean=0.9896, std=1.5772
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11600000000000002, 'auc': 0.557136, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0810, std=0.1736
[DEBUG][MIA] Test Set Loss:   mean=1.3636, std=1.5615
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.823529411764706, 'auc': 0.88397216796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1834, std=1.6003
[DEBUG][MIA] Test Set Loss:   mean=1.4701, std=1.7574
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.126, 'auc': 0.564128, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3038, std=0.5865
[DEBUG][MIA] Test Set Loss:   mean=1.2680, std=1.4154
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.4980392156862745, 'auc': 0.73291015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1123, std=1.5335
[DEBUG][MIA] Test Set Loss:   mean=1.2210, std=1.5054
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11599999999999999, 'auc': 0.538912, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4614, std=0.9536
[DEBUG][MIA] Test Set Loss:   mean=1.8555, std=0.9382
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.11764705882352941, 'auc': 0.61376953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7056, std=1.0694
[DEBUG][MIA] Test Set Loss:   mean=1.7142, std=1.0017
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.5096959999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8690, std=1.5782
[DEBUG][MIA] Test Set Loss:   mean=1.9795, std=1.4796
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.23137254901960783, 'auc': 0.54638671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8768, std=1.4446
[DEBUG][MIA] Test Set Loss:   mean=2.3177, std=1.5871
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.11399999999999999, 'auc': 0.581008, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8251, std=2.2685
[DEBUG][MIA] Test Set Loss:   mean=2.7321, std=2.2297
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09411764705882353, 'auc': 0.49139404296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.5383, std=2.1914
[DEBUG][MIA] Test Set Loss:   mean=2.8007, std=2.2186
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.54264, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9568, std=1.7960
[DEBUG][MIA] Test Set Loss:   mean=2.1464, std=1.6057
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.11372549019607843, 'auc': 0.55224609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0942, std=1.6149
[DEBUG][MIA] Test Set Loss:   mean=2.2436, std=1.6874
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.12, 'auc': 0.47624, 'task': 8}
Total correct retain:  1471  Total retain:  2500
Total correct forget:  16077  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  3003  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.532, 0.57, 0.71, 0.512, 0.572, 0.236, 0.232, 0.234, 0.32, 0.31, 0.328, 0.25, 0.278, 0.174, 0.204, 0.232, 0.224, 0.15, 0.244, 0.226]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0730, std=0.1164
[DEBUG][MIA] Test Set Loss:   mean=1.3571, std=1.5810
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7490196078431371, 'auc': 0.832275390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3391, std=1.7709
[DEBUG][MIA] Test Set Loss:   mean=1.4397, std=1.7170
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11000000000000001, 'auc': 0.531696, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1968, std=0.4834
[DEBUG][MIA] Test Set Loss:   mean=1.0642, std=1.5832
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.5764705882352941, 'auc': 0.69781494140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7690, std=1.3217
[DEBUG][MIA] Test Set Loss:   mean=1.1451, std=1.7251
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.118, 'auc': 0.546976, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0667, std=0.1007
[DEBUG][MIA] Test Set Loss:   mean=1.4282, std=1.6554
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.81640625, 'cv_acc': 0.7882352941176471, 'auc': 0.8934326171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2194, std=1.6866
[DEBUG][MIA] Test Set Loss:   mean=1.2612, std=1.5048
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.539056, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0609, std=2.6085
[DEBUG][MIA] Test Set Loss:   mean=2.2977, std=2.3479
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.5762939453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3558, std=2.2649
[DEBUG][MIA] Test Set Loss:   mean=2.3202, std=2.2978
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10800000000000001, 'auc': 0.503136, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2423, std=0.6801
[DEBUG][MIA] Test Set Loss:   mean=1.4953, std=0.7947
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.19607843137254902, 'auc': 0.58782958984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5202, std=0.7540
[DEBUG][MIA] Test Set Loss:   mean=1.5822, std=0.8026
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.09, 'auc': 0.5245280000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7683, std=1.2773
[DEBUG][MIA] Test Set Loss:   mean=2.3127, std=1.4689
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.1568627450980392, 'auc': 0.6131591796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9659, std=1.3457
[DEBUG][MIA] Test Set Loss:   mean=2.1282, std=1.3086
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.5480959999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2145, std=1.7495
[DEBUG][MIA] Test Set Loss:   mean=2.5393, std=1.9819
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10588235294117647, 'auc': 0.45538330078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.7305, std=2.0559
[DEBUG][MIA] Test Set Loss:   mean=2.8572, std=2.0548
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.09, 'auc': 0.483888, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9344, std=1.4147
[DEBUG][MIA] Test Set Loss:   mean=2.1010, std=1.3955
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10588235294117647, 'auc': 0.46160888671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9630, std=1.4350
[DEBUG][MIA] Test Set Loss:   mean=2.1073, std=1.3495
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.11200000000000002, 'auc': 0.46059199999999995, 'task': 8}
Total correct retain:  1660  Total retain:  2500
Total correct forget:  14804  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  2784  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.604, 0.54, 0.646, 0.534, 0.298, 0.268, 0.206, 0.224, 0.322, 0.314, 0.288, 0.244, 0.228, 0.23, 0.158, 0.258, 0.188, 0.154, 0.26, 0.208]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0529, std=0.0645
[DEBUG][MIA] Test Set Loss:   mean=1.4065, std=1.4160
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.7725490196078431, 'auc': 0.86505126953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0451, std=1.3873
[DEBUG][MIA] Test Set Loss:   mean=1.2652, std=1.3633
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10400000000000001, 'auc': 0.563264, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1603, std=0.3196
[DEBUG][MIA] Test Set Loss:   mean=1.0321, std=1.6325
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.5333333333333333, 'auc': 0.667236328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7750, std=1.1416
[DEBUG][MIA] Test Set Loss:   mean=0.8851, std=1.3562
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11600000000000002, 'auc': 0.508096, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3609, std=0.9905
[DEBUG][MIA] Test Set Loss:   mean=1.7662, std=1.0682
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.2901960784313726, 'auc': 0.62188720703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6586, std=1.0241
[DEBUG][MIA] Test Set Loss:   mean=1.8871, std=1.0807
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.1, 'auc': 0.564432, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5449, std=1.5515
[DEBUG][MIA] Test Set Loss:   mean=1.9593, std=1.6917
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.08235294117647059, 'auc': 0.4056396484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8154, std=1.5628
[DEBUG][MIA] Test Set Loss:   mean=1.8942, std=1.6714
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10600000000000001, 'auc': 0.50864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1897, std=0.4840
[DEBUG][MIA] Test Set Loss:   mean=1.4423, std=0.5011
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.19607843137254904, 'auc': 0.65826416015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3752, std=0.5346
[DEBUG][MIA] Test Set Loss:   mean=1.4141, std=0.5354
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11000000000000001, 'auc': 0.522384, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4342, std=0.7665
[DEBUG][MIA] Test Set Loss:   mean=1.6382, std=0.6980
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.14509803921568626, 'auc': 0.61981201171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6420, std=0.7982
[DEBUG][MIA] Test Set Loss:   mean=1.6208, std=0.7983
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.096, 'auc': 0.505456, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.4248, std=1.6529
[DEBUG][MIA] Test Set Loss:   mean=2.4721, std=1.5796
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.11764705882352941, 'auc': 0.5166015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.3159, std=1.4685
[DEBUG][MIA] Test Set Loss:   mean=2.1606, std=1.4353
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.13, 'auc': 0.468112, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8475, std=1.3913
[DEBUG][MIA] Test Set Loss:   mean=1.9953, std=1.2401
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.08235294117647059, 'auc': 0.4451904296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0478, std=1.3220
[DEBUG][MIA] Test Set Loss:   mean=1.9630, std=1.2156
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10200000000000001, 'auc': 0.48465600000000003, 'task': 8}
Total correct retain:  1476  Total retain:  2500
Total correct forget:  14230  Total forget:  47500
Total correct test:  269  Total test:  500
Total correct forget test:  2684  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.538, 0.554, 0.684, 0.238, 0.4, 0.394, 0.264, 0.234, 0.248, 0.34, 0.198, 0.208, 0.204, 0.204, 0.102, 0.258, 0.192, 0.178, 0.242, 0.226]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2213, std=0.4405
[DEBUG][MIA] Test Set Loss:   mean=1.5449, std=1.8044
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7764705882352942, 'auc': 0.8155517578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6084, std=1.8726
[DEBUG][MIA] Test Set Loss:   mean=1.6948, std=1.7547
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10400000000000001, 'auc': 0.527216, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.0508, std=5.9593
[DEBUG][MIA] Test Set Loss:   mean=4.3880, std=5.3825
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10196078431372549, 'auc': 0.39971923828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8694, std=5.0187
[DEBUG][MIA] Test Set Loss:   mean=4.4603, std=5.4308
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.096, 'auc': 0.453504, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1728, std=0.8132
[DEBUG][MIA] Test Set Loss:   mean=1.6676, std=1.1455
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.1607843137254902, 'auc': 0.62384033203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6069, std=1.0183
[DEBUG][MIA] Test Set Loss:   mean=1.7679, std=1.1816
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.5263040000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0796, std=1.4966
[DEBUG][MIA] Test Set Loss:   mean=2.0956, std=1.4370
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.07058823529411765, 'auc': 0.48834228515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1599, std=1.5184
[DEBUG][MIA] Test Set Loss:   mean=2.2269, std=1.6328
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.086, 'auc': 0.49387200000000003, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4802, std=0.6176
[DEBUG][MIA] Test Set Loss:   mean=1.6258, std=0.6685
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1176470588235294, 'auc': 0.5577392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5905, std=0.7139
[DEBUG][MIA] Test Set Loss:   mean=1.6066, std=0.6979
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11599999999999999, 'auc': 0.509968, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9003, std=0.9434
[DEBUG][MIA] Test Set Loss:   mean=1.9792, std=1.0118
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.52130126953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9668, std=1.0125
[DEBUG][MIA] Test Set Loss:   mean=1.9787, std=0.9985
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.503088, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2899, std=1.4925
[DEBUG][MIA] Test Set Loss:   mean=2.1995, std=1.5134
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09411764705882353, 'auc': 0.52740478515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.1453, std=1.4234
[DEBUG][MIA] Test Set Loss:   mean=2.1241, std=1.3817
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.501232, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9138, std=1.1562
[DEBUG][MIA] Test Set Loss:   mean=1.9187, std=1.0548
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09803921568627451, 'auc': 0.51666259765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9692, std=1.0813
[DEBUG][MIA] Test Set Loss:   mean=2.0403, std=1.0831
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.086, 'auc': 0.47897600000000007, 'task': 8}
Total correct retain:  1421  Total retain:  2500
Total correct forget:  12349  Total forget:  47500
Total correct test:  260  Total test:  500
Total correct forget test:  2402  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.52, 0.478, 0.242, 0.31, 0.296, 0.348, 0.222, 0.228, 0.254, 0.194, 0.176, 0.198, 0.252, 0.218, 0.29, 0.252, 0.23, 0.222, 0.14, 0.254]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 6, 8, 6, 9, 7, 7, 5, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9122, std=1.1191
[DEBUG][MIA] Test Set Loss:   mean=2.1127, std=1.1769
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.23137254901960783, 'auc': 0.55242919921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 5 7 6 6 7 8 8 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 5 6 7 5 8 7 5 7 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1505, std=1.2314
[DEBUG][MIA] Test Set Loss:   mean=2.0372, std=1.1954
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10200000000000001, 'auc': 0.468784, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 10, 13, 11, 10, 14, 12, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2347, std=3.8138
[DEBUG][MIA] Test Set Loss:   mean=3.2249, std=3.4522
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.54534912109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 14 11 11 12 11 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 10 10 14 13 11 11 11 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5972, std=3.8001
[DEBUG][MIA] Test Set Loss:   mean=3.7948, std=4.0374
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11400000000000002, 'auc': 0.498976, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 18, 18, 15, 17, 17, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4332, std=0.4984
[DEBUG][MIA] Test Set Loss:   mean=1.5185, std=0.4980
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.2, 'auc': 0.54962158203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 19 17 17 19 15 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 16 15 17 15 18 16 16 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5467, std=0.4655
[DEBUG][MIA] Test Set Loss:   mean=1.5800, std=0.4915
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.094, 'auc': 0.480672, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 22, 20, 24, 23, 24, 23, 24, 20, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7981, std=1.0686
[DEBUG][MIA] Test Set Loss:   mean=1.8491, std=1.0802
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.46319580078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 20 22 22 22 20 22 21 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [20 21 24 21 24 22 20 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9610, std=1.1468
[DEBUG][MIA] Test Set Loss:   mean=1.9642, std=1.1641
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.5016320000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 28, 27, 27, 25, 25, 28, 28, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5490, std=0.5860
[DEBUG][MIA] Test Set Loss:   mean=1.7131, std=0.6157
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.10588235294117647, 'auc': 0.6005859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 27 28 28 26 27 27 26 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 25 29 27 28 27 25 27 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5507, std=0.5424
[DEBUG][MIA] Test Set Loss:   mean=1.6181, std=0.5833
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.524992, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 32, 31, 32, 30, 31, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6454, std=0.6732
[DEBUG][MIA] Test Set Loss:   mean=1.8072, std=0.6324
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4296875, 'cv_acc': 0.09019607843137255, 'auc': 0.4130859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 34 31 32 32 31 30 34 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 31 32 31 32 33 32 30 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8021, std=0.6939
[DEBUG][MIA] Test Set Loss:   mean=1.7492, std=0.6452
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08, 'auc': 0.485184, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 38, 37, 37, 38, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9368, std=0.9028
[DEBUG][MIA] Test Set Loss:   mean=1.8611, std=0.9554
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.09803921568627451, 'auc': 0.45867919921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 36 39 37 37 38 36 38 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 36 38 37 38 39 37 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9701, std=1.0175
[DEBUG][MIA] Test Set Loss:   mean=2.0410, std=1.0691
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.096, 'auc': 0.488016, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 40, 40, 43, 40, 43, 42, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8157, std=0.7646
[DEBUG][MIA] Test Set Loss:   mean=1.8052, std=0.6585
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.5093994140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 40 42 44 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 41 43 40 41 41 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.7942, std=0.6783
[DEBUG][MIA] Test Set Loss:   mean=1.7437, std=0.6587
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.094, 'auc': 0.48420799999999997, 'task': 8}
Total correct retain:  1247  Total retain:  2500
Total correct forget:  11359  Total forget:  47500
Total correct test:  242  Total test:  500
Total correct forget test:  2194  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.484, 0.224, 0.256, 0.26, 0.264, 0.298, 0.236, 0.202, 0.228, 0.212, 0.172, 0.21, 0.218, 0.212, 0.242, 0.27, 0.204, 0.238, 0.2, 0.242]
Number of constraint violations:  5681
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: negagem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 13:42:37 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 40%   60C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['crocodile', 'boy', 'train', 'lobster', 'cattle', 'whale', 'table', 'pine', 'wolf', 'oranges', 'orchids', 'lion', 'dolphin', 'lizard', 'tank', 'plates', 'girl', 'tiger', 'leopard', 'crab', 'sweet peppers', 'bed', 'possum', 'computer keyboard', 'rabbit', 'clock', 'otter', 'skyscraper', 'bear', 'elephant', 'pickup truck', 'apples', 'turtle', 'wardrobe', 'trout', 'plain', 'aquarium fish', 'worm', 'castle', 'raccoon', 'fox', 'ray', 'motorcycle', 'cups', 'porcupine', 'sunflowers', 'bowls', 'road', 'butterfly', 'bus', 'chimpanzee', 'dinosaur', 'lawn-mower', 'caterpillar', 'house', 'poppies', 'oak', 'seal', 'camel', 'spider', 'shark', 'palm', 'snake', 'hamster', 'beaver', 'beetle', 'mouse', 'maple', 'kangaroo', 'tractor', 'snail', 'man', 'woman', 'cloud', 'bridge', 'sea', 'couch', 'bottles', 'shrew', 'forest', 'mushrooms', 'telephone', 'baby', 'rocket', 'bicycle', 'bee', 'cockroach', 'roses', 'willow', 'cans', 'skunk', 'pears', 'chair', 'television', 'lamp', 'streetcar', 'mountain', 'tulips', 'flatfish', 'squirrel']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2298  Total retain:  2500
Total correct forget:  10368  Total forget:  47500
Total correct test:  324  Total test:  500
Total correct forget test:  2097  Total test forget:  9500
After learning task 1
Task accuracies: [0.648, 0.162, 0.24, 0.142, 0.228, 0.186, 0.186, 0.27, 0.262, 0.21, 0.2, 0.204, 0.19, 0.204, 0.312, 0.23, 0.198, 0.238, 0.224, 0.308]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=0.6792, std=1.8377
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2, 'auc': 0.62158203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0372, std=0.2804
[DEBUG][MIA] Test Set Loss:   mean=0.5737, std=1.7272
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.192, 'auc': 0.672624, 'task': 1}
2 1
Total correct retain:  1721  Total retain:  2500
Total correct forget:  12545  Total forget:  47500
Total correct test:  270  Total test:  500
Total correct forget test:  2440  Total test forget:  9500
After learning task 2
Task accuracies: [0.54, 0.846, 0.25, 0.166, 0.216, 0.194, 0.232, 0.25, 0.246, 0.162, 0.21, 0.216, 0.174, 0.2, 0.256, 0.226, 0.198, 0.306, 0.268, 0.264]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0202, std=0.0415
[DEBUG][MIA] Test Set Loss:   mean=0.2545, std=0.7102
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.7166666666666667, 'auc': 0.6220703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4922, std=1.0590
[DEBUG][MIA] Test Set Loss:   mean=0.7479, std=1.5953
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.162, 'auc': 0.5416479999999999, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0342
[DEBUG][MIA] Test Set Loss:   mean=0.9788, std=1.7168
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.13333333333333333, 'auc': 0.76416015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0247, std=0.1589
[DEBUG][MIA] Test Set Loss:   mean=0.9585, std=2.2403
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.23399999999999999, 'auc': 0.694576, 'task': 2}
3 2
Total correct retain:  1461  Total retain:  2500
Total correct forget:  13359  Total forget:  47500
Total correct test:  248  Total test:  500
Total correct forget test:  2541  Total test forget:  9500
After learning task 3
Task accuracies: [0.496, 0.754, 0.782, 0.16, 0.216, 0.146, 0.256, 0.246, 0.238, 0.21, 0.236, 0.194, 0.144, 0.2, 0.202, 0.24, 0.188, 0.226, 0.204, 0.24]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0329, std=0.1260
[DEBUG][MIA] Test Set Loss:   mean=1.3911, std=2.0990
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.33333333333333337, 'auc': 0.859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7398, std=1.3710
[DEBUG][MIA] Test Set Loss:   mean=1.1568, std=1.8389
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12800000000000003, 'auc': 0.540296, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0135
[DEBUG][MIA] Test Set Loss:   mean=1.5320, std=2.0751
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.6666666666666667, 'auc': 0.7763671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9499, std=1.8143
[DEBUG][MIA] Test Set Loss:   mean=1.4342, std=2.3561
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.20800000000000002, 'auc': 0.580328, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0191, std=0.0739
[DEBUG][MIA] Test Set Loss:   mean=0.4653, std=1.1569
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.2833333333333333, 'auc': 0.77685546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0271
[DEBUG][MIA] Test Set Loss:   mean=1.1478, std=2.0869
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.704, 'cv_acc': 0.262, 'auc': 0.785576, 'task': 3}
4 3
Total correct retain:  1172  Total retain:  2500
Total correct forget:  14195  Total forget:  47500
Total correct test:  203  Total test:  500
Total correct forget test:  2560  Total test forget:  9500
After learning task 4
Task accuracies: [0.406, 0.652, 0.604, 0.702, 0.222, 0.138, 0.248, 0.178, 0.198, 0.122, 0.204, 0.17, 0.188, 0.202, 0.204, 0.21, 0.196, 0.236, 0.192, 0.254]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0165, std=0.0275
[DEBUG][MIA] Test Set Loss:   mean=1.4182, std=2.1602
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333334, 'auc': 0.7861328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0603, std=2.0123
[DEBUG][MIA] Test Set Loss:   mean=1.3570, std=2.0878
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.5511039999999999, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0105
[DEBUG][MIA] Test Set Loss:   mean=2.2789, std=2.9915
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.7833333333333333, 'auc': 0.9189453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2804, std=1.8284
[DEBUG][MIA] Test Set Loss:   mean=1.5085, std=2.1316
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.136, 'auc': 0.549312, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.4458, std=2.2655
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7666666666666667, 'auc': 0.9619140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9501, std=1.6813
[DEBUG][MIA] Test Set Loss:   mean=1.8252, std=2.2142
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.254, 'auc': 0.643568, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0242, std=0.1132
[DEBUG][MIA] Test Set Loss:   mean=1.6028, std=2.0175
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.31666666666666665, 'auc': 0.84375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0239, std=0.1528
[DEBUG][MIA] Test Set Loss:   mean=1.6483, std=2.7875
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.718, 'cv_acc': 0.674, 'auc': 0.791688, 'task': 4}
5 4
Total correct retain:  1269  Total retain:  2500
Total correct forget:  15158  Total forget:  47500
Total correct test:  221  Total test:  500
Total correct forget test:  2673  Total test forget:  9500
After learning task 5
Task accuracies: [0.442, 0.622, 0.542, 0.49, 0.658, 0.162, 0.302, 0.226, 0.176, 0.112, 0.208, 0.198, 0.118, 0.204, 0.248, 0.212, 0.198, 0.25, 0.192, 0.228]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.3216, std=1.9175
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7166666666666667, 'auc': 0.9697265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1540, std=1.8524
[DEBUG][MIA] Test Set Loss:   mean=1.2927, std=1.8915
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.086, 'auc': 0.5262560000000001, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.4564, std=2.0659
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7666666666666666, 'auc': 0.927734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5672, std=2.1908
[DEBUG][MIA] Test Set Loss:   mean=1.6546, std=2.2994
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.49281600000000003, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0118, std=0.0173
[DEBUG][MIA] Test Set Loss:   mean=1.4015, std=1.7054
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7666666666666667, 'auc': 0.9150390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1351, std=1.6414
[DEBUG][MIA] Test Set Loss:   mean=1.7325, std=2.0797
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.202, 'auc': 0.592688, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0221, std=0.0589
[DEBUG][MIA] Test Set Loss:   mean=2.3852, std=3.2821
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8166666666666668, 'auc': 0.8564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5763, std=1.3507
[DEBUG][MIA] Test Set Loss:   mean=1.9568, std=2.6422
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.21799999999999997, 'auc': 0.691808, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0629, std=0.3452
[DEBUG][MIA] Test Set Loss:   mean=1.6329, std=3.1438
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7, 'auc': 0.73828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0217, std=0.1409
[DEBUG][MIA] Test Set Loss:   mean=1.3853, std=2.5638
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.288, 'auc': 0.7484, 'task': 5}
6 5
Total correct retain:  1156  Total retain:  2500
Total correct forget:  16195  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  2904  Total test forget:  9500
After learning task 6
Task accuracies: [0.444, 0.656, 0.554, 0.516, 0.54, 0.688, 0.2, 0.178, 0.17, 0.168, 0.2, 0.24, 0.15, 0.198, 0.242, 0.27, 0.192, 0.268, 0.156, 0.222]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=1.4025, std=2.3203
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7166666666666666, 'auc': 0.873046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4691, std=2.5042
[DEBUG][MIA] Test Set Loss:   mean=1.4046, std=2.2256
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.509104, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.3004, std=2.7114
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.8166666666666668, 'auc': 0.93359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6142, std=2.4354
[DEBUG][MIA] Test Set Loss:   mean=1.7551, std=2.5431
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.538384, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0079, std=0.0132
[DEBUG][MIA] Test Set Loss:   mean=1.7905, std=2.1681
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7833333333333333, 'auc': 0.802734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4392, std=2.1212
[DEBUG][MIA] Test Set Loss:   mean=2.3412, std=2.8888
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.176, 'auc': 0.5970719999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=2.7047, std=3.5802
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.8, 'auc': 0.9248046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9262, std=1.9295
[DEBUG][MIA] Test Set Loss:   mean=1.9841, std=2.8650
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.20600000000000002, 'auc': 0.629496, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0085
[DEBUG][MIA] Test Set Loss:   mean=1.6126, std=2.2885
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6166666666666667, 'auc': 0.8740234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3681, std=0.9342
[DEBUG][MIA] Test Set Loss:   mean=1.4898, std=2.3786
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.40800000000000003, 'auc': 0.666648, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0153
[DEBUG][MIA] Test Set Loss:   mean=0.3901, std=1.0439
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.13333333333333333, 'auc': 0.62451171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0129, std=0.0813
[DEBUG][MIA] Test Set Loss:   mean=0.5300, std=1.6752
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.176, 'auc': 0.6293759999999999, 'task': 6}
7 6
Total correct retain:  1182  Total retain:  2500
Total correct forget:  17523  Total forget:  47500
Total correct test:  228  Total test:  500
Total correct forget test:  3108  Total test forget:  9500
After learning task 7
Task accuracies: [0.456, 0.64, 0.578, 0.466, 0.534, 0.594, 0.872, 0.176, 0.198, 0.194, 0.186, 0.214, 0.118, 0.202, 0.206, 0.258, 0.196, 0.248, 0.128, 0.208]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=2.0723, std=2.7113
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.31666666666666665, 'auc': 0.8544921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9512, std=2.1670
[DEBUG][MIA] Test Set Loss:   mean=1.2606, std=2.2946
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11400000000000002, 'auc': 0.5320320000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0067, std=0.0130
[DEBUG][MIA] Test Set Loss:   mean=2.3781, std=2.9159
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.75, 'auc': 0.9287109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7864, std=2.6644
[DEBUG][MIA] Test Set Loss:   mean=1.7649, std=2.5261
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11000000000000001, 'auc': 0.511944, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0235, std=0.0661
[DEBUG][MIA] Test Set Loss:   mean=2.6858, std=3.3570
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333334, 'auc': 0.927734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8018, std=2.3304
[DEBUG][MIA] Test Set Loss:   mean=2.4902, std=2.8506
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.168, 'auc': 0.580976, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0067
[DEBUG][MIA] Test Set Loss:   mean=2.1189, std=3.2027
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333333, 'auc': 0.8876953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9793, std=1.7935
[DEBUG][MIA] Test Set Loss:   mean=2.1142, std=2.8496
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.16599999999999998, 'auc': 0.6197440000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0065
[DEBUG][MIA] Test Set Loss:   mean=2.4804, std=3.1757
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7833333333333333, 'auc': 0.888671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6260, std=1.6337
[DEBUG][MIA] Test Set Loss:   mean=1.7746, std=2.6801
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.16999999999999998, 'auc': 0.650704, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.3555, std=2.9524
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2833333333333333, 'auc': 0.84375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2197, std=0.6526
[DEBUG][MIA] Test Set Loss:   mean=0.7126, std=1.6223
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.156, 'auc': 0.602312, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0129
[DEBUG][MIA] Test Set Loss:   mean=0.8231, std=2.0934
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.09999999999999999, 'auc': 0.6611328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0296
[DEBUG][MIA] Test Set Loss:   mean=0.3387, std=1.1512
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.194, 'auc': 0.6117440000000001, 'task': 7}
8 7
Total correct retain:  1148  Total retain:  2500
Total correct forget:  18820  Total forget:  47500
Total correct test:  231  Total test:  500
Total correct forget test:  3420  Total test forget:  9500
After learning task 8
Task accuracies: [0.462, 0.71, 0.546, 0.454, 0.51, 0.608, 0.806, 0.888, 0.164, 0.166, 0.202, 0.16, 0.086, 0.204, 0.228, 0.254, 0.2, 0.262, 0.19, 0.202]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.3179, std=2.1603
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7, 'auc': 0.8037109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2334, std=2.0590
[DEBUG][MIA] Test Set Loss:   mean=1.5439, std=2.3885
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.08, 'auc': 0.558768, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.4847, std=2.1820
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333333, 'auc': 0.9169921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3777, std=2.3091
[DEBUG][MIA] Test Set Loss:   mean=1.4828, std=2.1812
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.088, 'auc': 0.532528, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=2.1726, std=3.1813
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8, 'auc': 0.91015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6804, std=2.3525
[DEBUG][MIA] Test Set Loss:   mean=2.2301, std=2.8049
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.132, 'auc': 0.5620959999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.3131, std=1.4788
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7999999999999999, 'auc': 0.9228515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3343, std=1.9646
[DEBUG][MIA] Test Set Loss:   mean=2.2842, std=2.7603
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.12400000000000003, 'auc': 0.60536, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.7935, std=2.7978
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7666666666666666, 'auc': 0.865234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8599, std=1.5779
[DEBUG][MIA] Test Set Loss:   mean=1.9143, std=2.7217
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.18, 'auc': 0.6192960000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0072
[DEBUG][MIA] Test Set Loss:   mean=1.3455, std=2.1371
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2666666666666667, 'auc': 0.8408203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7885, std=1.5687
[DEBUG][MIA] Test Set Loss:   mean=1.1359, std=2.0146
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.178, 'auc': 0.545064, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=0.7674, std=1.3922
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2833333333333333, 'auc': 0.7978515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5877, std=1.4155
[DEBUG][MIA] Test Set Loss:   mean=0.9670, std=2.0523
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.134, 'auc': 0.5755520000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.0277, std=1.6721
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2333333333333333, 'auc': 0.61083984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0258
[DEBUG][MIA] Test Set Loss:   mean=0.9796, std=2.0631
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.20600000000000002, 'auc': 0.7137359999999999, 'task': 8}
Total correct retain:  1270  Total retain:  2500
Total correct forget:  19898  Total forget:  47500
Total correct test:  244  Total test:  500
Total correct forget test:  3602  Total test forget:  9500
After learning task 9
Task accuracies: [0.488, 0.646, 0.59, 0.464, 0.462, 0.556, 0.706, 0.756, 0.798, 0.154, 0.194, 0.186, 0.076, 0.22, 0.198, 0.354, 0.19, 0.26, 0.18, 0.214]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.3661, std=2.0322
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.23333333333333334, 'auc': 0.9375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1587, std=2.1580
[DEBUG][MIA] Test Set Loss:   mean=0.9479, std=1.7167
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.176, 'auc': 0.49984000000000006, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=2.0587, std=2.9821
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8166666666666667, 'auc': 0.958984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5022, std=2.1943
[DEBUG][MIA] Test Set Loss:   mean=1.5466, std=2.4454
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10400000000000001, 'auc': 0.488144, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0059
[DEBUG][MIA] Test Set Loss:   mean=2.2173, std=2.7567
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.75, 'auc': 0.9521484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5694, std=2.1755
[DEBUG][MIA] Test Set Loss:   mean=1.6820, std=2.1244
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.142, 'auc': 0.532896, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=2.7075, std=3.2673
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.8166666666666667, 'auc': 0.939453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4208, std=2.1660
[DEBUG][MIA] Test Set Loss:   mean=2.3483, std=3.0367
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.16599999999999998, 'auc': 0.597248, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=2.8902, std=3.0287
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666666, 'auc': 0.9384765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0452, std=2.0601
[DEBUG][MIA] Test Set Loss:   mean=1.6515, std=2.4591
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.174, 'auc': 0.5945039999999999, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=0.9396, std=1.8883
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.25, 'auc': 0.765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7012, std=1.4306
[DEBUG][MIA] Test Set Loss:   mean=1.1830, std=2.0523
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.10800000000000001, 'auc': 0.540864, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=0.6362, std=1.3236
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2333333333333333, 'auc': 0.8984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6981, std=1.5808
[DEBUG][MIA] Test Set Loss:   mean=0.9240, std=1.9735
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11600000000000002, 'auc': 0.541672, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=0.5403, std=1.0253
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25, 'auc': 0.876953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2427, std=0.6696
[DEBUG][MIA] Test Set Loss:   mean=1.2377, std=2.4196
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.152, 'auc': 0.6377599999999999, 'task': 8}
Total correct retain:  1262  Total retain:  2500
Total correct forget:  21888  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  3981  Total test forget:  9500
After learning task 10
Task accuracies: [0.516, 0.678, 0.606, 0.51, 0.498, 0.588, 0.69, 0.748, 0.746, 0.844, 0.2, 0.19, 0.072, 0.226, 0.29, 0.3, 0.192, 0.208, 0.164, 0.212]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.4147, std=0.7356
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.7666666666666667, 'auc': 0.80126953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3341, std=2.2834
[DEBUG][MIA] Test Set Loss:   mean=1.4699, std=2.3009
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.094, 'auc': 0.547512, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0094
[DEBUG][MIA] Test Set Loss:   mean=1.3010, std=2.0788
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7833333333333333, 'auc': 0.8974609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6700, std=2.4778
[DEBUG][MIA] Test Set Loss:   mean=1.8933, std=2.6743
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.53672, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0213
[DEBUG][MIA] Test Set Loss:   mean=2.0774, std=3.5432
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8166666666666667, 'auc': 0.9189453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8246, std=2.6900
[DEBUG][MIA] Test Set Loss:   mean=2.2009, std=2.8468
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.092, 'auc': 0.531632, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=3.2254, std=3.9727
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.75, 'auc': 0.9873046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4444, std=2.1497
[DEBUG][MIA] Test Set Loss:   mean=2.3897, std=3.1221
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.12999999999999998, 'auc': 0.58588, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.1732, std=1.9320
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2833333333333333, 'auc': 0.94140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5942, std=2.5396
[DEBUG][MIA] Test Set Loss:   mean=1.8163, std=2.8417
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.158, 'auc': 0.5196879999999999, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.4645, std=2.3248
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.30000000000000004, 'auc': 0.8974609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8658, std=1.9594
[DEBUG][MIA] Test Set Loss:   mean=1.4625, std=2.5513
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.11599999999999999, 'auc': 0.581448, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=0.7861, std=1.3905
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.3, 'auc': 0.9462890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0926, std=2.0949
[DEBUG][MIA] Test Set Loss:   mean=1.1584, std=2.1819
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.15199999999999997, 'auc': 0.515432, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.2848, std=1.9230
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.3166666666666667, 'auc': 0.9287109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6883, std=1.4888
[DEBUG][MIA] Test Set Loss:   mean=1.4301, std=2.3406
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.18, 'auc': 0.616048, 'task': 8}
Total correct retain:  1131  Total retain:  2500
Total correct forget:  22306  Total forget:  47500
Total correct test:  218  Total test:  500
Total correct forget test:  4085  Total test forget:  9500
After learning task 11
Task accuracies: [0.436, 0.624, 0.544, 0.514, 0.506, 0.58, 0.684, 0.676, 0.656, 0.766, 0.842, 0.174, 0.116, 0.222, 0.18, 0.276, 0.148, 0.228, 0.192, 0.242]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.4251, std=2.7101
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.26666666666666666, 'auc': 0.8720703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6320, std=2.8108
[DEBUG][MIA] Test Set Loss:   mean=1.6683, std=2.7122
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.098, 'auc': 0.5228799999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.7208, std=2.1085
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7166666666666666, 'auc': 0.921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7525, std=2.7471
[DEBUG][MIA] Test Set Loss:   mean=2.4400, std=3.2599
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10200000000000001, 'auc': 0.567176, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0202, std=0.0551
[DEBUG][MIA] Test Set Loss:   mean=1.2742, std=2.3591
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666666, 'auc': 0.845703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2686, std=2.9386
[DEBUG][MIA] Test Set Loss:   mean=2.1064, std=2.9285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10600000000000001, 'auc': 0.490416, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.0632, std=2.8334
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.896484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8760, std=2.6907
[DEBUG][MIA] Test Set Loss:   mean=2.3667, std=3.2490
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11400000000000002, 'auc': 0.534712, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=3.2138, std=4.0622
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8333333333333333, 'auc': 0.9072265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4664, std=2.4523
[DEBUG][MIA] Test Set Loss:   mean=2.2875, std=3.5856
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.148, 'auc': 0.5601200000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0053
[DEBUG][MIA] Test Set Loss:   mean=2.3429, std=3.4648
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.25, 'auc': 0.8232421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9592, std=2.0228
[DEBUG][MIA] Test Set Loss:   mean=1.5010, std=2.7213
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.124, 'auc': 0.550576, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0073
[DEBUG][MIA] Test Set Loss:   mean=2.3708, std=2.9556
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.3333333333333333, 'auc': 0.8671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4707, std=2.6987
[DEBUG][MIA] Test Set Loss:   mean=1.5740, std=2.8714
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.086, 'auc': 0.505504, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.3875, std=2.7649
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.3166666666666667, 'auc': 0.8388671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6546, std=1.6432
[DEBUG][MIA] Test Set Loss:   mean=1.4014, std=2.3588
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.158, 'auc': 0.6354799999999999, 'task': 8}
Total correct retain:  1123  Total retain:  2500
Total correct forget:  20551  Total forget:  47500
Total correct test:  216  Total test:  500
Total correct forget test:  3776  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.432, 0.62, 0.538, 0.502, 0.524, 0.552, 0.688, 0.652, 0.642, 0.748, 0.328, 0.176, 0.122, 0.216, 0.174, 0.266, 0.148, 0.216, 0.192, 0.248]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=3.0799, std=4.0474
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.33333333333333337, 'auc': 0.876953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3511, std=2.4543
[DEBUG][MIA] Test Set Loss:   mean=1.7225, std=2.7756
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.534968, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.5784, std=4.0506
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.9541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7669, std=2.6148
[DEBUG][MIA] Test Set Loss:   mean=2.3796, std=3.2429
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.098, 'auc': 0.55424, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0112, std=0.0294
[DEBUG][MIA] Test Set Loss:   mean=2.8620, std=3.2376
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7833333333333333, 'auc': 0.8798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1383, std=3.0105
[DEBUG][MIA] Test Set Loss:   mean=2.6190, std=3.2333
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.094, 'auc': 0.5549999999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.4460, std=2.1467
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.9794921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7632, std=2.6802
[DEBUG][MIA] Test Set Loss:   mean=2.2893, std=2.8937
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.16, 'auc': 0.57536, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0091
[DEBUG][MIA] Test Set Loss:   mean=3.3236, std=4.0181
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7166666666666667, 'auc': 0.9130859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4263, std=2.5267
[DEBUG][MIA] Test Set Loss:   mean=2.4942, std=3.6590
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.154, 'auc': 0.581952, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=0.8489, std=2.0281
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.3166666666666667, 'auc': 0.7607421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8735, std=1.9444
[DEBUG][MIA] Test Set Loss:   mean=1.2510, std=2.3559
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.154, 'auc': 0.580352, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.6707, std=2.7062
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.3166666666666667, 'auc': 0.818359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0701, std=1.9662
[DEBUG][MIA] Test Set Loss:   mean=1.5350, std=2.7670
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.13200000000000003, 'auc': 0.5383439999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5237, std=2.4559
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666666, 'auc': 0.857421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6794, std=1.5072
[DEBUG][MIA] Test Set Loss:   mean=1.8082, std=2.9716
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.12000000000000002, 'auc': 0.626872, 'task': 8}
Total correct retain:  1126  Total retain:  2500
Total correct forget:  19583  Total forget:  47500
Total correct test:  220  Total test:  500
Total correct forget test:  3591  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.44, 0.63, 0.532, 0.472, 0.496, 0.562, 0.708, 0.684, 0.654, 0.418, 0.298, 0.17, 0.122, 0.216, 0.176, 0.262, 0.148, 0.212, 0.188, 0.234]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.2883, std=2.1873
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7499999999999999, 'auc': 0.9150390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5652, std=2.6995
[DEBUG][MIA] Test Set Loss:   mean=2.0435, std=3.1042
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.092, 'auc': 0.5439839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.7930, std=2.8488
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8333333333333333, 'auc': 0.93359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9038, std=2.6233
[DEBUG][MIA] Test Set Loss:   mean=1.8033, std=2.7082
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11400000000000002, 'auc': 0.487296, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.9629, std=2.4416
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.31666666666666665, 'auc': 0.978515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3132, std=3.1359
[DEBUG][MIA] Test Set Loss:   mean=2.4633, std=3.3032
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10600000000000001, 'auc': 0.513936, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.9872, std=3.5912
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7833333333333334, 'auc': 0.89892578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8228, std=2.8434
[DEBUG][MIA] Test Set Loss:   mean=2.3870, std=3.1898
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.564696, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.5261, std=2.2131
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2833333333333333, 'auc': 0.83935546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2806, std=2.4502
[DEBUG][MIA] Test Set Loss:   mean=2.1189, std=3.4495
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.132, 'auc': 0.607216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.5067, std=2.6853
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.3, 'auc': 0.904296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0869, std=2.1995
[DEBUG][MIA] Test Set Loss:   mean=1.3845, std=2.5034
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.553816, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=1.3896, std=2.8778
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6833333333333333, 'auc': 0.8720703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3737, std=2.4956
[DEBUG][MIA] Test Set Loss:   mean=1.5206, std=2.6093
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.509232, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0455, std=2.9996
[DEBUG][MIA] Test Set Loss:   mean=6.4274, std=7.0748
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25, 'auc': 0.69384765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5913, std=4.7795
[DEBUG][MIA] Test Set Loss:   mean=6.5005, std=6.1693
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.098, 'auc': 0.57368, 'task': 8}
Total correct retain:  1068  Total retain:  2500
Total correct forget:  18132  Total forget:  47500
Total correct test:  212  Total test:  500
Total correct forget test:  3413  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.424, 0.604, 0.556, 0.496, 0.502, 0.59, 0.682, 0.656, 0.302, 0.422, 0.29, 0.162, 0.11, 0.232, 0.182, 0.29, 0.13, 0.224, 0.164, 0.232]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0078
[DEBUG][MIA] Test Set Loss:   mean=1.4954, std=2.6653
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666667, 'auc': 0.828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3866, std=2.4334
[DEBUG][MIA] Test Set Loss:   mean=1.5710, std=2.7551
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.096, 'auc': 0.519768, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.0637
[DEBUG][MIA] Test Set Loss:   mean=2.2777, std=3.2426
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8333333333333333, 'auc': 0.86328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1430, std=3.1854
[DEBUG][MIA] Test Set Loss:   mean=2.5636, std=3.3703
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.098, 'auc': 0.568864, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0370, std=0.1049
[DEBUG][MIA] Test Set Loss:   mean=2.0193, std=2.6700
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.84375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3250, std=3.2129
[DEBUG][MIA] Test Set Loss:   mean=2.3442, std=3.1659
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.08199999999999999, 'auc': 0.510976, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0230, std=0.0772
[DEBUG][MIA] Test Set Loss:   mean=3.1804, std=4.0357
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7833333333333334, 'auc': 0.86328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8437, std=2.9935
[DEBUG][MIA] Test Set Loss:   mean=2.7318, std=3.6450
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.092, 'auc': 0.576504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.4912, std=2.5464
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666666, 'auc': 0.837890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3117, std=2.3410
[DEBUG][MIA] Test Set Loss:   mean=2.3237, std=3.4890
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.098, 'auc': 0.591056, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=2.0784, std=2.8430
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333333, 'auc': 0.875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8921, std=1.9117
[DEBUG][MIA] Test Set Loss:   mean=1.5661, std=2.7030
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.094, 'auc': 0.5998560000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3769, std=1.0425
[DEBUG][MIA] Test Set Loss:   mean=4.5231, std=4.2573
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.4833333333333333, 'auc': 0.85791015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2828, std=5.0517
[DEBUG][MIA] Test Set Loss:   mean=4.1517, std=4.8612
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11600000000000002, 'auc': 0.5010479999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1954, std=1.7475
[DEBUG][MIA] Test Set Loss:   mean=4.5977, std=4.7053
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4833333333333333, 'auc': 0.72265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.4856, std=3.9370
[DEBUG][MIA] Test Set Loss:   mean=4.2215, std=4.4364
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.16999999999999998, 'auc': 0.537704, 'task': 8}
Total correct retain:  1069  Total retain:  2500
Total correct forget:  17571  Total forget:  47500
Total correct test:  199  Total test:  500
Total correct forget test:  3255  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.398, 0.622, 0.516, 0.506, 0.512, 0.59, 0.65, 0.354, 0.358, 0.312, 0.356, 0.186, 0.124, 0.218, 0.182, 0.278, 0.142, 0.19, 0.18, 0.234]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.4832, std=2.7304
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.33333333333333337, 'auc': 0.91796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2702, std=2.3021
[DEBUG][MIA] Test Set Loss:   mean=1.8308, std=2.8630
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.11000000000000001, 'auc': 0.45188799999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0107, std=0.0517
[DEBUG][MIA] Test Set Loss:   mean=1.8190, std=2.6075
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8333333333333334, 'auc': 0.9375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5108, std=3.4578
[DEBUG][MIA] Test Set Loss:   mean=2.3845, std=3.1297
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11200000000000002, 'auc': 0.5141439999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0320, std=0.0824
[DEBUG][MIA] Test Set Loss:   mean=2.0638, std=2.3823
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6833333333333333, 'auc': 0.80859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4997, std=3.3084
[DEBUG][MIA] Test Set Loss:   mean=2.7355, std=3.4627
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.1, 'auc': 0.47312, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0072, std=0.0326
[DEBUG][MIA] Test Set Loss:   mean=1.1179, std=1.4957
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8666666666666668, 'auc': 0.9375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6430, std=2.6827
[DEBUG][MIA] Test Set Loss:   mean=2.3230, std=2.9490
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.152, 'auc': 0.5814079999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=0.9877, std=1.5603
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666667, 'auc': 0.88330078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3088, std=2.3535
[DEBUG][MIA] Test Set Loss:   mean=2.1546, std=3.4137
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.192, 'auc': 0.580952, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2746, std=2.0067
[DEBUG][MIA] Test Set Loss:   mean=5.8795, std=6.0439
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5333333333333333, 'auc': 0.634765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.8772, std=5.4018
[DEBUG][MIA] Test Set Loss:   mean=6.7912, std=6.3581
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.12400000000000003, 'auc': 0.53128, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5393, std=1.4020
[DEBUG][MIA] Test Set Loss:   mean=2.7722, std=3.4428
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.6833333333333333, 'auc': 0.7294921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8964, std=4.0702
[DEBUG][MIA] Test Set Loss:   mean=3.2868, std=4.4903
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.519072, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1916, std=1.7781
[DEBUG][MIA] Test Set Loss:   mean=2.9040, std=3.6737
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.65, 'auc': 0.6328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.1583, std=3.9844
[DEBUG][MIA] Test Set Loss:   mean=4.2269, std=4.9076
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.144, 'auc': 0.566496, 'task': 8}
Total correct retain:  1152  Total retain:  2500
Total correct forget:  16719  Total forget:  47500
Total correct test:  210  Total test:  500
Total correct forget test:  3087  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.42, 0.606, 0.498, 0.444, 0.482, 0.586, 0.248, 0.458, 0.39, 0.372, 0.362, 0.186, 0.11, 0.2, 0.178, 0.26, 0.156, 0.198, 0.192, 0.248]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.8809, std=3.9740
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7333333333333333, 'auc': 0.9384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6776, std=2.6303
[DEBUG][MIA] Test Set Loss:   mean=1.7529, std=2.6615
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.088, 'auc': 0.509416, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.5127, std=1.6474
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.9453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9826, std=2.9255
[DEBUG][MIA] Test Set Loss:   mean=2.0667, std=2.9084
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11199999999999999, 'auc': 0.523456, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0133, std=0.0504
[DEBUG][MIA] Test Set Loss:   mean=1.6496, std=3.3190
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.7833333333333333, 'auc': 0.8623046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4702, std=3.1124
[DEBUG][MIA] Test Set Loss:   mean=2.4006, std=3.1960
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.50136, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0120, std=0.0424
[DEBUG][MIA] Test Set Loss:   mean=2.6684, std=3.4731
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8166666666666667, 'auc': 0.9599609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1800, std=3.3304
[DEBUG][MIA] Test Set Loss:   mean=2.9354, std=3.7409
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11400000000000002, 'auc': 0.555856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4551, std=2.4859
[DEBUG][MIA] Test Set Loss:   mean=8.5241, std=6.2887
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.5333333333333333, 'auc': 0.76708984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0963, std=5.9105
[DEBUG][MIA] Test Set Loss:   mean=6.7530, std=6.4253
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11800000000000002, 'auc': 0.5251600000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.8772, std=3.1132
[DEBUG][MIA] Test Set Loss:   mean=7.6294, std=6.7381
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.3833333333333333, 'auc': 0.720703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.4364, std=6.4391
[DEBUG][MIA] Test Set Loss:   mean=8.0449, std=7.1435
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.092, 'auc': 0.517624, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3970, std=0.6143
[DEBUG][MIA] Test Set Loss:   mean=5.6294, std=5.2882
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.5833333333333334, 'auc': 0.81396484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8793, std=4.9345
[DEBUG][MIA] Test Set Loss:   mean=3.6855, std=4.4436
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11400000000000002, 'auc': 0.49611199999999994, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.7812, std=2.5777
[DEBUG][MIA] Test Set Loss:   mean=8.0484, std=7.1696
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6, 'auc': 0.74169921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.3406, std=4.7568
[DEBUG][MIA] Test Set Loss:   mean=5.5909, std=5.6856
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10800000000000001, 'auc': 0.549616, 'task': 8}
Total correct retain:  1143  Total retain:  2500
Total correct forget:  15608  Total forget:  47500
Total correct test:  219  Total test:  500
Total correct forget test:  2940  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.438, 0.598, 0.524, 0.508, 0.476, 0.28, 0.248, 0.39, 0.344, 0.392, 0.362, 0.18, 0.126, 0.22, 0.186, 0.28, 0.132, 0.21, 0.17, 0.254]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1366, std=0.5111
[DEBUG][MIA] Test Set Loss:   mean=1.9890, std=2.9208
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7666666666666666, 'auc': 0.73486328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4017, std=3.2116
[DEBUG][MIA] Test Set Loss:   mean=2.6264, std=3.5008
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.122, 'auc': 0.504112, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0445
[DEBUG][MIA] Test Set Loss:   mean=2.1290, std=2.7830
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.6833333333333333, 'auc': 0.8857421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3564, std=3.3434
[DEBUG][MIA] Test Set Loss:   mean=2.3377, std=3.1990
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.088, 'auc': 0.5145360000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.9462, std=2.4075
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7333333333333334, 'auc': 0.9296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4271, std=3.3830
[DEBUG][MIA] Test Set Loss:   mean=2.4014, std=3.2948
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10200000000000001, 'auc': 0.515568, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0419, std=1.4679
[DEBUG][MIA] Test Set Loss:   mean=7.4529, std=5.0172
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.8166666666666667, 'auc': 0.87255859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.0104, std=5.9971
[DEBUG][MIA] Test Set Loss:   mean=7.6437, std=6.4309
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.132, 'auc': 0.52876, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.0229, std=3.4985
[DEBUG][MIA] Test Set Loss:   mean=5.0293, std=5.6705
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.5833333333333333, 'auc': 0.609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.2091, std=5.1401
[DEBUG][MIA] Test Set Loss:   mean=6.1973, std=6.0098
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.154, 'auc': 0.53976, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.3124, std=2.6716
[DEBUG][MIA] Test Set Loss:   mean=7.3479, std=5.6637
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5, 'auc': 0.72509765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.1154, std=5.3645
[DEBUG][MIA] Test Set Loss:   mean=7.5795, std=6.2572
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11200000000000002, 'auc': 0.563936, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8375, std=3.4944
[DEBUG][MIA] Test Set Loss:   mean=6.3878, std=7.0513
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.21666666666666665, 'auc': 0.640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7266, std=5.9570
[DEBUG][MIA] Test Set Loss:   mean=6.0346, std=5.8969
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.09, 'auc': 0.474728, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.9685, std=4.9448
[DEBUG][MIA] Test Set Loss:   mean=9.4713, std=5.8745
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.23333333333333334, 'auc': 0.71337890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.0810, std=6.2208
[DEBUG][MIA] Test Set Loss:   mean=8.3544, std=6.9582
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.096, 'auc': 0.504312, 'task': 8}
Total correct retain:  933  Total retain:  2500
Total correct forget:  13423  Total forget:  47500
Total correct test:  181  Total test:  500
Total correct forget test:  2543  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.362, 0.508, 0.53, 0.466, 0.246, 0.27, 0.224, 0.318, 0.258, 0.366, 0.214, 0.15, 0.116, 0.23, 0.2, 0.266, 0.132, 0.214, 0.166, 0.212]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0145, std=0.0336
[DEBUG][MIA] Test Set Loss:   mean=2.3665, std=3.0998
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7166666666666667, 'auc': 0.759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2659, std=3.4331
[DEBUG][MIA] Test Set Loss:   mean=2.6476, std=3.4043
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.092, 'auc': 0.5267839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0124
[DEBUG][MIA] Test Set Loss:   mean=1.8948, std=3.0418
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.935546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1472, std=2.9759
[DEBUG][MIA] Test Set Loss:   mean=2.1221, std=2.9140
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.13, 'auc': 0.507552, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5514, std=1.0144
[DEBUG][MIA] Test Set Loss:   mean=9.6169, std=6.1771
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.890625, 'cv_acc': 0.8, 'auc': 0.919921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8422, std=5.3402
[DEBUG][MIA] Test Set Loss:   mean=7.0541, std=6.3706
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.11000000000000001, 'auc': 0.4591759999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1762, std=2.3772
[DEBUG][MIA] Test Set Loss:   mean=9.3851, std=8.6830
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6333333333333333, 'auc': 0.7197265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.1293, std=6.6946
[DEBUG][MIA] Test Set Loss:   mean=8.8589, std=7.1991
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11800000000000002, 'auc': 0.49240800000000007, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1423, std=2.8039
[DEBUG][MIA] Test Set Loss:   mean=6.6177, std=6.2226
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25, 'auc': 0.732421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.1633, std=5.9111
[DEBUG][MIA] Test Set Loss:   mean=6.9199, std=6.6462
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.154, 'auc': 0.5215040000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.5135, std=2.7402
[DEBUG][MIA] Test Set Loss:   mean=7.6341, std=7.6186
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.3666666666666667, 'auc': 0.6826171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6589, std=6.3838
[DEBUG][MIA] Test Set Loss:   mean=7.9435, std=6.9813
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.09, 'auc': 0.5007280000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6646, std=2.2102
[DEBUG][MIA] Test Set Loss:   mean=5.5701, std=5.9625
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5166666666666666, 'auc': 0.67578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.2923, std=5.3593
[DEBUG][MIA] Test Set Loss:   mean=5.1835, std=5.5357
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.096, 'auc': 0.48515199999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6263, std=4.6216
[DEBUG][MIA] Test Set Loss:   mean=6.4020, std=6.7795
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2833333333333333, 'auc': 0.61279296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9691, std=6.4542
[DEBUG][MIA] Test Set Loss:   mean=8.3983, std=7.4623
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11400000000000002, 'auc': 0.543552, 'task': 8}
Total correct retain:  1050  Total retain:  2500
Total correct forget:  12979  Total forget:  47500
Total correct test:  205  Total test:  500
Total correct forget test:  2457  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.41, 0.534, 0.54, 0.264, 0.218, 0.266, 0.224, 0.34, 0.26, 0.382, 0.224, 0.158, 0.118, 0.222, 0.2, 0.268, 0.118, 0.2, 0.162, 0.216]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0094, std=0.0198
[DEBUG][MIA] Test Set Loss:   mean=2.0240, std=2.9037
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7166666666666667, 'auc': 0.7607421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9489, std=2.6077
[DEBUG][MIA] Test Set Loss:   mean=2.2224, std=2.9604
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.096, 'auc': 0.488072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4122, std=2.5987
[DEBUG][MIA] Test Set Loss:   mean=6.1607, std=5.3522
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5999999999999999, 'auc': 0.7265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0162, std=5.1912
[DEBUG][MIA] Test Set Loss:   mean=6.9459, std=6.1369
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10200000000000001, 'auc': 0.469152, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5968, std=1.2335
[DEBUG][MIA] Test Set Loss:   mean=6.0820, std=4.8043
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333332, 'auc': 0.80859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.6503, std=5.2080
[DEBUG][MIA] Test Set Loss:   mean=6.0716, std=5.4351
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12600000000000003, 'auc': 0.517752, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6218, std=3.1327
[DEBUG][MIA] Test Set Loss:   mean=12.3605, std=6.2922
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666666, 'auc': 0.873046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.5725, std=6.7150
[DEBUG][MIA] Test Set Loss:   mean=9.5331, std=6.8326
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.10200000000000001, 'auc': 0.45510399999999995, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.2907, std=2.9250
[DEBUG][MIA] Test Set Loss:   mean=6.7045, std=7.6109
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.5666666666666667, 'auc': 0.5927734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0458, std=5.6551
[DEBUG][MIA] Test Set Loss:   mean=7.0769, std=6.5258
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11000000000000001, 'auc': 0.53852, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.8220, std=2.9498
[DEBUG][MIA] Test Set Loss:   mean=6.1099, std=5.2575
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.5833333333333334, 'auc': 0.640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.4811, std=6.0726
[DEBUG][MIA] Test Set Loss:   mean=8.5208, std=6.7929
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.12400000000000003, 'auc': 0.5389200000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2390, std=2.4088
[DEBUG][MIA] Test Set Loss:   mean=5.6654, std=5.6796
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4666666666666667, 'auc': 0.6572265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.3266, std=5.8752
[DEBUG][MIA] Test Set Loss:   mean=5.9443, std=5.7383
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.098, 'auc': 0.484712, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8367, std=3.6669
[DEBUG][MIA] Test Set Loss:   mean=7.0516, std=7.8007
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.16666666666666669, 'auc': 0.578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.6059, std=6.1014
[DEBUG][MIA] Test Set Loss:   mean=7.9953, std=7.2490
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10400000000000001, 'auc': 0.54064, 'task': 8}
Total correct retain:  1052  Total retain:  2500
Total correct forget:  12118  Total forget:  47500
Total correct test:  205  Total test:  500
Total correct forget test:  2307  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.41, 0.534, 0.25, 0.27, 0.208, 0.248, 0.218, 0.31, 0.24, 0.366, 0.226, 0.164, 0.122, 0.214, 0.2, 0.288, 0.154, 0.214, 0.166, 0.222]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 6, 5, 5, 7, 5, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.3513, std=4.7677
[DEBUG][MIA] Test Set Loss:   mean=9.9392, std=7.6668
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.65, 'auc': 0.6240234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 7 6 6 8 9 5 8 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 5 7 5 7 5 5 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.9008, std=7.5607
[DEBUG][MIA] Test Set Loss:   mean=10.5978, std=7.7213
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11200000000000002, 'auc': 0.524696, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([13, 10, 12, 11, 11, 10, 11, 11, 11, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0371, std=3.6169
[DEBUG][MIA] Test Set Loss:   mean=7.1378, std=5.1572
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.6333333333333333, 'auc': 0.6240234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 14 10 13 12 11 11 10 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 11 11 14 10 13 12 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.9096, std=6.2118
[DEBUG][MIA] Test Set Loss:   mean=8.3797, std=6.3714
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11399999999999999, 'auc': 0.518768, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([18, 16, 17, 16, 19, 19, 15, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0472, std=2.6779
[DEBUG][MIA] Test Set Loss:   mean=8.1002, std=5.9138
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6333333333333333, 'auc': 0.787109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 19 16 18 18 15 17 19 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 19 19 19 16 19 16 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.8851, std=6.6137
[DEBUG][MIA] Test Set Loss:   mean=8.2742, std=6.4210
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11000000000000001, 'auc': 0.5178639999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 21, 21, 23, 22, 20, 22, 21, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4410, std=3.8012
[DEBUG][MIA] Test Set Loss:   mean=10.2063, std=6.8800
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.6500000000000001, 'auc': 0.796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 22 24 20 22 20 22 22 22 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 20 23 22 23 20 20 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.7543, std=6.4196
[DEBUG][MIA] Test Set Loss:   mean=10.0632, std=7.1164
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.10600000000000001, 'auc': 0.559544, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 27, 27, 27, 26, 25, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.0334, std=3.0515
[DEBUG][MIA] Test Set Loss:   mean=7.2773, std=6.1718
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.3666666666666667, 'auc': 0.720703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 26 29 27 29 29 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 29 29 25 25 27 29 25 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4317, std=5.6457
[DEBUG][MIA] Test Set Loss:   mean=7.3746, std=6.5268
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11000000000000001, 'auc': 0.530192, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([30, 33, 31, 32, 31, 34, 30, 34, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5144, std=3.9223
[DEBUG][MIA] Test Set Loss:   mean=9.8524, std=8.3410
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.36666666666666664, 'auc': 0.66845703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 32 33 31 33 31 34 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 30 34 31 34 30 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8710, std=6.3665
[DEBUG][MIA] Test Set Loss:   mean=9.2557, std=6.9214
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12000000000000002, 'auc': 0.5580160000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([36, 39, 37, 37, 36, 37, 38, 39, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0880, std=3.1553
[DEBUG][MIA] Test Set Loss:   mean=6.2485, std=4.6413
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.5666666666666667, 'auc': 0.7060546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 37 39 37 39 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 36 35 39 37 35 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.2020, std=6.1622
[DEBUG][MIA] Test Set Loss:   mean=6.0053, std=5.6150
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.08399999999999999, 'auc': 0.49917599999999995, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 40, 44, 44, 44, 43, 44, 41, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.1231, std=4.9361
[DEBUG][MIA] Test Set Loss:   mean=9.0292, std=7.4656
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.26666666666666666, 'auc': 0.650390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 41 40 44 44 42 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 44 40 44 41 43 41 40 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.1471, std=6.8655
[DEBUG][MIA] Test Set Loss:   mean=9.2195, std=7.0166
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10200000000000001, 'auc': 0.546168, 'task': 8}
Total correct retain:  988  Total retain:  2500
Total correct forget:  10554  Total forget:  47500
Total correct test:  201  Total test:  500
Total correct forget test:  2049  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.402, 0.208, 0.218, 0.224, 0.208, 0.238, 0.208, 0.316, 0.232, 0.34, 0.21, 0.15, 0.136, 0.22, 0.194, 0.238, 0.172, 0.184, 0.192, 0.21]
Number of constraint violations:  148
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: RL-AGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 13:59:31 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 46%   62C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['seal', 'pears', 'aquarium fish', 'mushrooms', 'computer keyboard', 'baby', 'bee', 'man', 'lion', 'snail', 'road', 'table', 'pine', 'crab', 'tiger', 'snake', 'sea', 'tractor', 'cans', 'hamster', 'couch', 'lamp', 'leopard', 'possum', 'mountain', 'dinosaur', 'house', 'boy', 'ray', 'mouse', 'bridge', 'otter', 'roses', 'chimpanzee', 'motorcycle', 'skyscraper', 'train', 'beetle', 'crocodile', 'bear', 'rocket', 'fox', 'television', 'beaver', 'bowls', 'cockroach', 'caterpillar', 'sunflowers', 'dolphin', 'kangaroo', 'squirrel', 'willow', 'trout', 'shark', 'bed', 'clock', 'porcupine', 'wardrobe', 'cups', 'shrew', 'turtle', 'raccoon', 'bottles', 'pickup truck', 'sweet peppers', 'lobster', 'apples', 'maple', 'oak', 'poppies', 'castle', 'plain', 'telephone', 'orchids', 'woman', 'worm', 'tulips', 'elephant', 'rabbit', 'cloud', 'chair', 'skunk', 'lawn-mower', 'spider', 'whale', 'palm', 'cattle', 'bus', 'lizard', 'butterfly', 'camel', 'girl', 'plates', 'forest', 'flatfish', 'tank', 'streetcar', 'bicycle', 'oranges', 'wolf']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2294  Total retain:  2500
Total correct forget:  9857  Total forget:  47500
Total correct test:  343  Total test:  500
Total correct forget test:  1996  Total test forget:  9500
After learning task 1
Task accuracies: [0.686, 0.214, 0.21, 0.25, 0.204, 0.174, 0.226, 0.196, 0.168, 0.198, 0.2, 0.276, 0.222, 0.222, 0.158, 0.28, 0.204, 0.196, 0.2, 0.194]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1183, std=0.4644
[DEBUG][MIA] Test Set Loss:   mean=0.9134, std=1.5440
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.6666666666666666, 'auc': 0.7568359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0450, std=0.2054
[DEBUG][MIA] Test Set Loss:   mean=1.5401, std=2.6942
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.712, 'cv_acc': 0.40800000000000003, 'auc': 0.802936, 'task': 1}
2 1
Total correct retain:  1618  Total retain:  2500
Total correct forget:  11163  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2101  Total test forget:  9500
After learning task 2
Task accuracies: [0.556, 0.66, 0.204, 0.156, 0.204, 0.216, 0.244, 0.244, 0.196, 0.198, 0.19, 0.196, 0.234, 0.17, 0.14, 0.218, 0.178, 0.206, 0.176, 0.172]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0490, std=0.0743
[DEBUG][MIA] Test Set Loss:   mean=1.5041, std=2.4159
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.8666666666666668, 'auc': 0.791015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9015, std=1.5961
[DEBUG][MIA] Test Set Loss:   mean=1.9833, std=2.5359
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.246, 'auc': 0.63952, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0349, std=0.1806
[DEBUG][MIA] Test Set Loss:   mean=2.1846, std=4.3323
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.23333333333333334, 'auc': 0.80517578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0692, std=0.5177
[DEBUG][MIA] Test Set Loss:   mean=1.1842, std=2.5908
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.22200000000000003, 'auc': 0.6999759999999999, 'task': 2}
3 2
Total correct retain:  1426  Total retain:  2500
Total correct forget:  12863  Total forget:  47500
Total correct test:  257  Total test:  500
Total correct forget test:  2385  Total test forget:  9500
After learning task 3
Task accuracies: [0.514, 0.496, 0.76, 0.122, 0.228, 0.206, 0.228, 0.26, 0.194, 0.226, 0.17, 0.224, 0.246, 0.24, 0.274, 0.302, 0.134, 0.136, 0.162, 0.162]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0282, std=0.0450
[DEBUG][MIA] Test Set Loss:   mean=2.1582, std=2.4251
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8, 'auc': 0.88671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5881, std=2.0982
[DEBUG][MIA] Test Set Loss:   mean=2.1326, std=2.4698
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.172, 'auc': 0.5792, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0098
[DEBUG][MIA] Test Set Loss:   mean=1.3094, std=2.6648
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.33333333333333337, 'auc': 0.84765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7810, std=1.5765
[DEBUG][MIA] Test Set Loss:   mean=1.4611, std=2.4307
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.20400000000000001, 'auc': 0.5881759999999999, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0123
[DEBUG][MIA] Test Set Loss:   mean=1.3890, std=3.0970
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.23333333333333334, 'auc': 0.67578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0223, std=0.1422
[DEBUG][MIA] Test Set Loss:   mean=1.2281, std=2.7587
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.658, 'cv_acc': 0.22800000000000004, 'auc': 0.73784, 'task': 3}
4 3
Total correct retain:  1286  Total retain:  2500
Total correct forget:  14329  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  2613  Total test forget:  9500
After learning task 4
Task accuracies: [0.516, 0.438, 0.632, 0.788, 0.204, 0.266, 0.224, 0.162, 0.192, 0.182, 0.138, 0.208, 0.25, 0.2, 0.23, 0.294, 0.216, 0.196, 0.23, 0.176]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0215, std=0.0838
[DEBUG][MIA] Test Set Loss:   mean=2.8043, std=2.3969
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.875, 'cv_acc': 0.75, 'auc': 0.9501953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7396, std=2.3315
[DEBUG][MIA] Test Set Loss:   mean=2.4217, std=2.6780
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.136, 'auc': 0.584992, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0112
[DEBUG][MIA] Test Set Loss:   mean=2.3833, std=3.3473
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8166666666666667, 'auc': 0.8564453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8341, std=1.6171
[DEBUG][MIA] Test Set Loss:   mean=1.4681, std=2.1845
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.168, 'auc': 0.594352, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0172
[DEBUG][MIA] Test Set Loss:   mean=1.0568, std=1.7694
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.33333333333333337, 'auc': 0.8681640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4024, std=1.0266
[DEBUG][MIA] Test Set Loss:   mean=1.1130, std=2.1909
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.22000000000000003, 'auc': 0.599448, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0182
[DEBUG][MIA] Test Set Loss:   mean=1.1463, std=2.6799
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2333333333333333, 'auc': 0.7685546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0323, std=0.2475
[DEBUG][MIA] Test Set Loss:   mean=1.0926, std=2.4224
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.672, 'cv_acc': 0.248, 'auc': 0.7635599999999999, 'task': 4}
5 4
Total correct retain:  1270  Total retain:  2500
Total correct forget:  15453  Total forget:  47500
Total correct test:  234  Total test:  500
Total correct forget test:  2825  Total test forget:  9500
After learning task 5
Task accuracies: [0.468, 0.424, 0.624, 0.702, 0.756, 0.238, 0.2, 0.202, 0.224, 0.176, 0.18, 0.216, 0.218, 0.222, 0.21, 0.27, 0.214, 0.194, 0.182, 0.198]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0207, std=0.0577
[DEBUG][MIA] Test Set Loss:   mean=2.6157, std=2.2908
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.890625, 'cv_acc': 0.7, 'auc': 0.9384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9420, std=2.6253
[DEBUG][MIA] Test Set Loss:   mean=2.2206, std=2.6466
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11400000000000002, 'auc': 0.54352, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.3218, std=2.2155
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.892578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4326, std=2.2062
[DEBUG][MIA] Test Set Loss:   mean=1.6617, std=2.4441
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.16599999999999998, 'auc': 0.5165279999999999, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=1.1743, std=2.1679
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.8, 'auc': 0.853515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7433, std=1.3914
[DEBUG][MIA] Test Set Loss:   mean=1.9166, std=2.9886
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.134, 'auc': 0.6234560000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=2.3056, std=2.7733
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.33333333333333337, 'auc': 0.923828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6661, std=1.4303
[DEBUG][MIA] Test Set Loss:   mean=1.8749, std=2.7324
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.15999999999999998, 'auc': 0.657792, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0255
[DEBUG][MIA] Test Set Loss:   mean=1.4973, std=2.1949
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.3166666666666667, 'auc': 0.9033203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0660, std=0.3529
[DEBUG][MIA] Test Set Loss:   mean=1.2986, std=2.3339
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.252, 'auc': 0.755048, 'task': 5}
6 5
Total correct retain:  1291  Total retain:  2500
Total correct forget:  16693  Total forget:  47500
Total correct test:  259  Total test:  500
Total correct forget test:  3007  Total test forget:  9500
After learning task 6
Task accuracies: [0.518, 0.462, 0.566, 0.612, 0.61, 0.694, 0.178, 0.204, 0.19, 0.182, 0.18, 0.216, 0.236, 0.29, 0.236, 0.326, 0.242, 0.2, 0.168, 0.222]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0098, std=0.0154
[DEBUG][MIA] Test Set Loss:   mean=1.0478, std=1.6460
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7, 'auc': 0.84765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9279, std=2.6385
[DEBUG][MIA] Test Set Loss:   mean=2.2962, std=2.8878
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.088, 'auc': 0.46144, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=1.5474, std=2.4382
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7499999999999999, 'auc': 0.8515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5871, std=2.2850
[DEBUG][MIA] Test Set Loss:   mean=1.6237, std=2.4947
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.16199999999999998, 'auc': 0.4906880000000001, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0094
[DEBUG][MIA] Test Set Loss:   mean=2.8505, std=3.7394
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.5, 'auc': 0.8232421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6019, std=2.5684
[DEBUG][MIA] Test Set Loss:   mean=1.6853, std=2.4835
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.098, 'auc': 0.51468, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.0807, std=1.7072
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.8166666666666667, 'auc': 0.8798828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7789, std=1.4102
[DEBUG][MIA] Test Set Loss:   mean=1.9641, std=2.9174
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.14799999999999996, 'auc': 0.618008, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0133, std=0.0263
[DEBUG][MIA] Test Set Loss:   mean=1.6896, std=1.7578
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7, 'auc': 0.86328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6462, std=1.3771
[DEBUG][MIA] Test Set Loss:   mean=1.8486, std=2.5674
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.20400000000000001, 'auc': 0.6680640000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0891, std=0.3173
[DEBUG][MIA] Test Set Loss:   mean=0.7911, std=2.6834
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.2166666666666667, 'auc': 0.7158203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0315, std=0.2204
[DEBUG][MIA] Test Set Loss:   mean=0.8780, std=2.1254
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.2, 'auc': 0.660408, 'task': 6}
7 6
Total correct retain:  1230  Total retain:  2500
Total correct forget:  17518  Total forget:  47500
Total correct test:  239  Total test:  500
Total correct forget test:  3220  Total test forget:  9500
After learning task 7
Task accuracies: [0.478, 0.464, 0.562, 0.608, 0.572, 0.576, 0.806, 0.156, 0.23, 0.164, 0.228, 0.2, 0.196, 0.356, 0.182, 0.312, 0.258, 0.198, 0.176, 0.196]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0121, std=0.0293
[DEBUG][MIA] Test Set Loss:   mean=2.0191, std=2.9917
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8833333333333332, 'auc': 0.87109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1972, std=2.9769
[DEBUG][MIA] Test Set Loss:   mean=2.4257, std=2.7906
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10600000000000001, 'auc': 0.540736, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0183
[DEBUG][MIA] Test Set Loss:   mean=1.8460, std=2.4585
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333334, 'auc': 0.810546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7695, std=2.5098
[DEBUG][MIA] Test Set Loss:   mean=2.0790, std=3.0050
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.14799999999999996, 'auc': 0.49551999999999996, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=0.8126, std=1.6212
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6666666666666666, 'auc': 0.791015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3121, std=2.0652
[DEBUG][MIA] Test Set Loss:   mean=1.4810, std=2.5077
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11200000000000002, 'auc': 0.511624, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=2.1183, std=2.8241
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.31666666666666665, 'auc': 0.9296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0115, std=1.8834
[DEBUG][MIA] Test Set Loss:   mean=1.5196, std=2.2929
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.158, 'auc': 0.578224, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=2.3560, std=2.9663
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.75, 'auc': 0.953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9834, std=1.9482
[DEBUG][MIA] Test Set Loss:   mean=1.9257, std=2.5266
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.202, 'auc': 0.631328, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.8973, std=3.4307
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666667, 'auc': 0.798828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5095, std=1.3169
[DEBUG][MIA] Test Set Loss:   mean=1.1936, std=2.2414
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.176, 'auc': 0.578664, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0235, std=0.1245
[DEBUG][MIA] Test Set Loss:   mean=0.9796, std=1.5834
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.08333333333333333, 'auc': 0.818359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0308, std=0.2467
[DEBUG][MIA] Test Set Loss:   mean=0.6786, std=1.6540
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.22999999999999998, 'auc': 0.647424, 'task': 7}
8 7
Total correct retain:  1173  Total retain:  2500
Total correct forget:  18779  Total forget:  47500
Total correct test:  233  Total test:  500
Total correct forget test:  3371  Total test forget:  9500
After learning task 8
Task accuracies: [0.466, 0.444, 0.566, 0.612, 0.584, 0.542, 0.692, 0.79, 0.21, 0.188, 0.176, 0.212, 0.18, 0.328, 0.2, 0.252, 0.22, 0.196, 0.178, 0.172]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0163, std=0.0287
[DEBUG][MIA] Test Set Loss:   mean=2.6351, std=2.8464
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.85, 'auc': 0.96484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0234, std=2.7487
[DEBUG][MIA] Test Set Loss:   mean=2.4212, std=2.9345
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.076, 'auc': 0.55128, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0069, std=0.0131
[DEBUG][MIA] Test Set Loss:   mean=1.6246, std=2.1189
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7166666666666666, 'auc': 0.912109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7411, std=2.5094
[DEBUG][MIA] Test Set Loss:   mean=1.9570, std=2.5170
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.096, 'auc': 0.5302399999999999, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.0748, std=1.7120
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.75, 'auc': 0.8427734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2955, std=1.9946
[DEBUG][MIA] Test Set Loss:   mean=1.6272, std=2.3678
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10600000000000001, 'auc': 0.5443439999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=2.1531, std=2.2895
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.7499999999999999, 'auc': 0.9541015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2564, std=2.3252
[DEBUG][MIA] Test Set Loss:   mean=1.6359, std=2.2888
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.132, 'auc': 0.574456, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=1.9499, std=2.9589
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7666666666666666, 'auc': 0.927734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0323, std=1.8968
[DEBUG][MIA] Test Set Loss:   mean=1.8914, std=2.4557
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.21200000000000002, 'auc': 0.6282719999999999, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.6931, std=2.4452
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2833333333333333, 'auc': 0.9130859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6488, std=1.4418
[DEBUG][MIA] Test Set Loss:   mean=1.4181, std=2.2960
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.126, 'auc': 0.5987600000000001, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0180
[DEBUG][MIA] Test Set Loss:   mean=1.0286, std=1.6550
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.30000000000000004, 'auc': 0.853515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4458, std=1.1410
[DEBUG][MIA] Test Set Loss:   mean=0.9926, std=1.7282
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.22199999999999998, 'auc': 0.605016, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0286
[DEBUG][MIA] Test Set Loss:   mean=1.0294, std=1.5928
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.21666666666666665, 'auc': 0.80224609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0134, std=0.0927
[DEBUG][MIA] Test Set Loss:   mean=0.8047, std=2.2799
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.244, 'auc': 0.672496, 'task': 8}
Total correct retain:  1226  Total retain:  2500
Total correct forget:  20082  Total forget:  47500
Total correct test:  260  Total test:  500
Total correct forget test:  3634  Total test forget:  9500
After learning task 9
Task accuracies: [0.52, 0.436, 0.542, 0.592, 0.57, 0.528, 0.67, 0.7, 0.816, 0.17, 0.176, 0.222, 0.202, 0.33, 0.266, 0.278, 0.224, 0.212, 0.142, 0.192]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=2.0895, std=2.6129
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7833333333333334, 'auc': 0.9072265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0232, std=2.6890
[DEBUG][MIA] Test Set Loss:   mean=2.1668, std=2.9842
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11200000000000002, 'auc': 0.5161439999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.8629, std=2.3973
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666666, 'auc': 0.8603515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7785, std=2.4440
[DEBUG][MIA] Test Set Loss:   mean=1.8559, std=2.7164
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.1, 'auc': 0.502672, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.7807, std=3.6801
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7000000000000001, 'auc': 0.9462890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8813, std=2.8963
[DEBUG][MIA] Test Set Loss:   mean=1.7285, std=2.9121
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.1, 'auc': 0.49551199999999995, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0106
[DEBUG][MIA] Test Set Loss:   mean=1.4579, std=2.2073
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.904296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0030, std=1.9628
[DEBUG][MIA] Test Set Loss:   mean=1.7648, std=2.5852
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.144, 'auc': 0.608096, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.2375, std=1.7787
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.8, 'auc': 0.876953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3058, std=2.1899
[DEBUG][MIA] Test Set Loss:   mean=1.7594, std=2.3132
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.15199999999999997, 'auc': 0.593488, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.5137, std=2.0737
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333333, 'auc': 0.8251953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9759, std=1.7521
[DEBUG][MIA] Test Set Loss:   mean=1.4558, std=2.1481
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.138, 'auc': 0.5780000000000001, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0097
[DEBUG][MIA] Test Set Loss:   mean=1.1048, std=1.7552
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666666, 'auc': 0.859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0502, std=2.0143
[DEBUG][MIA] Test Set Loss:   mean=1.1931, std=2.0817
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.15999999999999998, 'auc': 0.507264, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0090, std=0.0256
[DEBUG][MIA] Test Set Loss:   mean=0.8263, std=1.2380
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666666, 'auc': 0.8271484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3053, std=0.9130
[DEBUG][MIA] Test Set Loss:   mean=1.1566, std=1.8884
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.21799999999999997, 'auc': 0.6560640000000001, 'task': 8}
Total correct retain:  1110  Total retain:  2500
Total correct forget:  21096  Total forget:  47500
Total correct test:  221  Total test:  500
Total correct forget test:  3804  Total test forget:  9500
After learning task 10
Task accuracies: [0.442, 0.46, 0.572, 0.626, 0.568, 0.5, 0.622, 0.682, 0.682, 0.856, 0.174, 0.242, 0.25, 0.23, 0.18, 0.23, 0.17, 0.216, 0.164, 0.184]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0539, std=0.2306
[DEBUG][MIA] Test Set Loss:   mean=3.9269, std=4.1307
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.8166666666666667, 'auc': 0.9423828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3080, std=3.1496
[DEBUG][MIA] Test Set Loss:   mean=2.5104, std=2.9119
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10200000000000001, 'auc': 0.457552, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.6119, std=2.4103
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.8955078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8921, std=2.7146
[DEBUG][MIA] Test Set Loss:   mean=1.6321, std=2.7458
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.094, 'auc': 0.48019199999999995, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.8897, std=2.9290
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7, 'auc': 0.8798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4624, std=2.2285
[DEBUG][MIA] Test Set Loss:   mean=1.7529, std=2.8487
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.088, 'auc': 0.51152, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.4888, std=2.4666
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7833333333333333, 'auc': 0.91796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4704, std=2.4392
[DEBUG][MIA] Test Set Loss:   mean=1.9702, std=3.0292
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11200000000000002, 'auc': 0.558752, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=2.0843, std=2.3575
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.8, 'auc': 0.935546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1258, std=1.9503
[DEBUG][MIA] Test Set Loss:   mean=1.8277, std=2.3881
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.128, 'auc': 0.6051839999999999, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.3557, std=2.0287
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7333333333333333, 'auc': 0.86865234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2538, std=2.0785
[DEBUG][MIA] Test Set Loss:   mean=1.8131, std=2.5618
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.15399999999999997, 'auc': 0.559312, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=0.9728, std=1.8979
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7333333333333333, 'auc': 0.81640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0198, std=1.8445
[DEBUG][MIA] Test Set Loss:   mean=1.3219, std=2.4090
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.166, 'auc': 0.524752, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.2226, std=2.0782
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666666, 'auc': 0.9375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6505, std=1.3400
[DEBUG][MIA] Test Set Loss:   mean=1.2893, std=2.0585
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.134, 'auc': 0.602936, 'task': 8}
Total correct retain:  1233  Total retain:  2500
Total correct forget:  22478  Total forget:  47500
Total correct test:  251  Total test:  500
Total correct forget test:  4055  Total test forget:  9500
After learning task 11
Task accuracies: [0.502, 0.458, 0.624, 0.598, 0.568, 0.546, 0.582, 0.692, 0.642, 0.722, 0.796, 0.23, 0.222, 0.26, 0.17, 0.234, 0.184, 0.216, 0.174, 0.192]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1446, std=0.6775
[DEBUG][MIA] Test Set Loss:   mean=2.6799, std=2.8441
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8833333333333334, 'auc': 0.947265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1643, std=2.9082
[DEBUG][MIA] Test Set Loss:   mean=2.7456, std=3.4863
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10200000000000001, 'auc': 0.54528, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.9369, std=3.2284
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.31666666666666665, 'auc': 0.9326171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7596, std=2.8639
[DEBUG][MIA] Test Set Loss:   mean=1.9558, std=3.2059
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.1, 'auc': 0.513736, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.0321, std=2.2727
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7666666666666666, 'auc': 0.9033203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3191, std=2.1447
[DEBUG][MIA] Test Set Loss:   mean=1.9103, std=3.0265
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.126, 'auc': 0.557264, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=2.0193, std=2.8770
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7333333333333334, 'auc': 0.95703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3915, std=2.3810
[DEBUG][MIA] Test Set Loss:   mean=1.8779, std=2.9299
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.15799999999999997, 'auc': 0.55616, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.4604, std=2.4378
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.9296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4996, std=2.5093
[DEBUG][MIA] Test Set Loss:   mean=1.7110, std=2.4963
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10200000000000001, 'auc': 0.544632, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=2.0856, std=3.3396
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666667, 'auc': 0.89453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4879, std=2.4424
[DEBUG][MIA] Test Set Loss:   mean=1.7689, std=2.5628
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11400000000000002, 'auc': 0.5391360000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.1501, std=2.2094
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.25, 'auc': 0.921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9373, std=1.9132
[DEBUG][MIA] Test Set Loss:   mean=1.2755, std=2.2391
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.15199999999999997, 'auc': 0.5657360000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.6822, std=1.1627
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7999999999999999, 'auc': 0.9130859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7418, std=1.5303
[DEBUG][MIA] Test Set Loss:   mean=1.2707, std=2.0980
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.146, 'auc': 0.586464, 'task': 8}
Total correct retain:  1211  Total retain:  2500
Total correct forget:  20226  Total forget:  47500
Total correct test:  244  Total test:  500
Total correct forget test:  3709  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.488, 0.438, 0.616, 0.586, 0.558, 0.554, 0.566, 0.664, 0.658, 0.68, 0.212, 0.236, 0.234, 0.242, 0.172, 0.226, 0.19, 0.21, 0.184, 0.192]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0093, std=0.0383
[DEBUG][MIA] Test Set Loss:   mean=3.6284, std=3.5273
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.921875, 'cv_acc': 0.7833333333333333, 'auc': 0.9716796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4399, std=3.1676
[DEBUG][MIA] Test Set Loss:   mean=3.1265, std=3.6555
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.092, 'auc': 0.44441600000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5723, std=2.6859
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7333333333333333, 'auc': 0.8798828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7283, std=2.9338
[DEBUG][MIA] Test Set Loss:   mean=2.0950, std=3.5149
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.5311600000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.7586, std=2.7372
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333333, 'auc': 0.91162109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7518, std=2.9089
[DEBUG][MIA] Test Set Loss:   mean=2.0651, std=3.2035
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.126, 'auc': 0.52364, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=3.3112, std=4.2580
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.94140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1374, std=2.1099
[DEBUG][MIA] Test Set Loss:   mean=2.3764, std=3.3797
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.138, 'auc': 0.6304879999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=2.9334, std=3.7107
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333333, 'auc': 0.90234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7186, std=2.9333
[DEBUG][MIA] Test Set Loss:   mean=1.9927, std=2.9364
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12800000000000003, 'auc': 0.528848, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.6157, std=2.7515
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8, 'auc': 0.8623046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3415, std=2.3423
[DEBUG][MIA] Test Set Loss:   mean=2.0452, std=2.7056
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11200000000000002, 'auc': 0.5927840000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.4747, std=2.6565
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.3, 'auc': 0.919921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9557, std=1.8259
[DEBUG][MIA] Test Set Loss:   mean=1.4028, std=2.5460
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.146, 'auc': 0.5285040000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0740, std=0.4056
[DEBUG][MIA] Test Set Loss:   mean=1.5527, std=2.5219
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2666666666666667, 'auc': 0.8837890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.8191, std=1.6479
[DEBUG][MIA] Test Set Loss:   mean=1.4048, std=2.4125
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.16599999999999998, 'auc': 0.57668, 'task': 8}
Total correct retain:  1223  Total retain:  2500
Total correct forget:  19046  Total forget:  47500
Total correct test:  250  Total test:  500
Total correct forget test:  3498  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.5, 0.428, 0.608, 0.586, 0.558, 0.556, 0.564, 0.684, 0.634, 0.278, 0.21, 0.242, 0.232, 0.258, 0.184, 0.238, 0.184, 0.192, 0.164, 0.196]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0859, std=0.4678
[DEBUG][MIA] Test Set Loss:   mean=3.2960, std=3.6817
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7166666666666666, 'auc': 0.9453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5698, std=3.3375
[DEBUG][MIA] Test Set Loss:   mean=3.1961, std=3.8828
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.092, 'auc': 0.459648, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=2.8620, std=3.7818
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.3333333333333333, 'auc': 0.9140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7775, std=2.9108
[DEBUG][MIA] Test Set Loss:   mean=2.1497, std=3.4373
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.544728, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0067
[DEBUG][MIA] Test Set Loss:   mean=2.2148, std=3.4058
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7, 'auc': 0.859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8470, std=2.9011
[DEBUG][MIA] Test Set Loss:   mean=2.1646, std=3.4063
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.098, 'auc': 0.527656, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.7258, std=2.9892
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666666, 'auc': 0.912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2633, std=2.2496
[DEBUG][MIA] Test Set Loss:   mean=2.4815, std=3.5184
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.10800000000000001, 'auc': 0.598016, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.8348, std=2.6878
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.8, 'auc': 0.921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3893, std=2.3093
[DEBUG][MIA] Test Set Loss:   mean=1.9192, std=2.8509
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12200000000000003, 'auc': 0.577976, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0168
[DEBUG][MIA] Test Set Loss:   mean=2.4954, std=3.6447
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7, 'auc': 0.822265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4903, std=2.7147
[DEBUG][MIA] Test Set Loss:   mean=2.0955, std=3.2024
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.13, 'auc': 0.5484239999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0327, std=0.1037
[DEBUG][MIA] Test Set Loss:   mean=1.1180, std=2.4621
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.33333333333333337, 'auc': 0.8427734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2219, std=2.3163
[DEBUG][MIA] Test Set Loss:   mean=1.5957, std=2.8767
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.16799999999999998, 'auc': 0.527568, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.8847, std=2.6057
[DEBUG][MIA] Test Set Loss:   mean=8.0727, std=4.5902
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.55, 'auc': 0.8154296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.3053, std=5.5359
[DEBUG][MIA] Test Set Loss:   mean=7.4849, std=5.8951
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10200000000000001, 'auc': 0.561584, 'task': 8}
Total correct retain:  1256  Total retain:  2500
Total correct forget:  17203  Total forget:  47500
Total correct test:  245  Total test:  500
Total correct forget test:  3228  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.49, 0.434, 0.602, 0.572, 0.554, 0.546, 0.536, 0.658, 0.222, 0.246, 0.202, 0.244, 0.232, 0.254, 0.176, 0.232, 0.2, 0.194, 0.16, 0.192]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0537, std=0.2718
[DEBUG][MIA] Test Set Loss:   mean=3.3161, std=3.3246
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.9296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0475, std=3.6603
[DEBUG][MIA] Test Set Loss:   mean=3.2636, std=3.8915
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.484928, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=2.4047, std=3.6498
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.25, 'auc': 0.88427734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7769, std=2.9400
[DEBUG][MIA] Test Set Loss:   mean=2.0619, std=3.4319
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10600000000000001, 'auc': 0.511472, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.5663, std=3.1070
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7833333333333333, 'auc': 0.916015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6595, std=2.6983
[DEBUG][MIA] Test Set Loss:   mean=2.0882, std=3.3737
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.094, 'auc': 0.540496, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.8896, std=3.0430
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7166666666666667, 'auc': 0.953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4993, std=2.6787
[DEBUG][MIA] Test Set Loss:   mean=1.9353, std=2.8810
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.15399999999999997, 'auc': 0.5607840000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=1.8377, std=2.1698
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.2833333333333333, 'auc': 0.96484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5369, std=2.6662
[DEBUG][MIA] Test Set Loss:   mean=1.7411, std=2.6366
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.168, 'auc': 0.5445519999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.7139, std=2.8835
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7333333333333333, 'auc': 0.890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6770, std=2.6364
[DEBUG][MIA] Test Set Loss:   mean=1.9926, std=3.0185
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.16199999999999998, 'auc': 0.534504, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9146, std=1.3919
[DEBUG][MIA] Test Set Loss:   mean=4.2698, std=4.5314
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6500000000000001, 'auc': 0.7392578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4519, std=3.8447
[DEBUG][MIA] Test Set Loss:   mean=3.9185, std=4.2656
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11200000000000002, 'auc': 0.5294239999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.2487, std=2.6011
[DEBUG][MIA] Test Set Loss:   mean=6.9062, std=5.8306
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.7333333333333333, 'auc': 0.7314453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.7556, std=4.9691
[DEBUG][MIA] Test Set Loss:   mean=7.0646, std=5.7247
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11800000000000002, 'auc': 0.562144, 'task': 8}
Total correct retain:  1231  Total retain:  2500
Total correct forget:  16666  Total forget:  47500
Total correct test:  238  Total test:  500
Total correct forget test:  3147  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.476, 0.432, 0.62, 0.586, 0.562, 0.562, 0.578, 0.37, 0.232, 0.264, 0.206, 0.252, 0.234, 0.252, 0.174, 0.224, 0.178, 0.194, 0.168, 0.206]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=2.4197, std=3.8911
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7999999999999999, 'auc': 0.9384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7425, std=3.3763
[DEBUG][MIA] Test Set Loss:   mean=2.9318, std=3.4099
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.5247999999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.5170, std=2.9300
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7000000000000001, 'auc': 0.919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0508, std=3.5631
[DEBUG][MIA] Test Set Loss:   mean=2.0756, std=3.2592
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10400000000000001, 'auc': 0.5202399999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=2.2944, std=3.2604
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.33333333333333337, 'auc': 0.8896484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3164, std=2.5001
[DEBUG][MIA] Test Set Loss:   mean=1.8792, std=3.1067
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11200000000000002, 'auc': 0.538656, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=2.9632, std=3.9843
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7666666666666667, 'auc': 0.9111328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3844, std=2.4124
[DEBUG][MIA] Test Set Loss:   mean=2.5310, std=3.7838
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.13199999999999998, 'auc': 0.5917600000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.5354, std=2.5981
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7666666666666667, 'auc': 0.8603515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1950, std=2.3295
[DEBUG][MIA] Test Set Loss:   mean=2.0182, std=2.9567
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.126, 'auc': 0.59824, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3368, std=2.1323
[DEBUG][MIA] Test Set Loss:   mean=7.1623, std=5.8924
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5666666666666667, 'auc': 0.7421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.1704, std=5.8334
[DEBUG][MIA] Test Set Loss:   mean=7.1174, std=5.9599
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.09, 'auc': 0.545024, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5297, std=0.8439
[DEBUG][MIA] Test Set Loss:   mean=3.8737, std=4.2794
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.19999999999999998, 'auc': 0.71533203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8128, std=3.7244
[DEBUG][MIA] Test Set Loss:   mean=2.8267, std=3.3980
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11000000000000001, 'auc': 0.512416, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7872, std=3.2684
[DEBUG][MIA] Test Set Loss:   mean=7.1496, std=5.9623
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.6, 'auc': 0.7451171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.6547, std=5.4700
[DEBUG][MIA] Test Set Loss:   mean=7.1292, std=6.1465
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10200000000000001, 'auc': 0.515296, 'task': 8}
Total correct retain:  1247  Total retain:  2500
Total correct forget:  16190  Total forget:  47500
Total correct test:  244  Total test:  500
Total correct forget test:  3036  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.488, 0.442, 0.63, 0.58, 0.568, 0.542, 0.248, 0.422, 0.22, 0.292, 0.218, 0.232, 0.232, 0.262, 0.194, 0.23, 0.19, 0.204, 0.166, 0.2]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0583, std=0.2677
[DEBUG][MIA] Test Set Loss:   mean=3.0443, std=2.8146
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.8166666666666667, 'auc': 0.93359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8318, std=3.6189
[DEBUG][MIA] Test Set Loss:   mean=3.3573, std=4.1597
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.122, 'auc': 0.528352, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=2.3130, std=3.6368
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7, 'auc': 0.919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1156, std=3.7796
[DEBUG][MIA] Test Set Loss:   mean=2.4732, std=3.9671
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.08399999999999999, 'auc': 0.519968, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0081
[DEBUG][MIA] Test Set Loss:   mean=1.8318, std=2.7859
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.9482421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8676, std=2.9843
[DEBUG][MIA] Test Set Loss:   mean=2.1454, std=3.3663
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.086, 'auc': 0.547864, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8691, std=2.5217
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7333333333333333, 'auc': 0.88623046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7902, std=3.0183
[DEBUG][MIA] Test Set Loss:   mean=2.1944, std=3.1938
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.16199999999999998, 'auc': 0.57232, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5011, std=2.2913
[DEBUG][MIA] Test Set Loss:   mean=7.4142, std=7.4524
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5333333333333333, 'auc': 0.7236328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7403, std=7.3371
[DEBUG][MIA] Test Set Loss:   mean=7.1859, std=7.3246
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.088, 'auc': 0.521728, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.1109, std=2.7778
[DEBUG][MIA] Test Set Loss:   mean=8.6404, std=6.4069
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.5, 'auc': 0.78759765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.2071, std=6.3730
[DEBUG][MIA] Test Set Loss:   mean=8.0643, std=6.5102
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10800000000000001, 'auc': 0.5381760000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.1537, std=1.7290
[DEBUG][MIA] Test Set Loss:   mean=5.7295, std=5.7094
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.5666666666666667, 'auc': 0.76806640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8665, std=4.1706
[DEBUG][MIA] Test Set Loss:   mean=4.0565, std=4.2298
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10400000000000001, 'auc': 0.512264, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.3075, std=3.5992
[DEBUG][MIA] Test Set Loss:   mean=8.3967, std=6.2441
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5666666666666667, 'auc': 0.75048828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.5437, std=5.6800
[DEBUG][MIA] Test Set Loss:   mean=8.1560, std=6.6619
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11399999999999999, 'auc': 0.519224, 'task': 8}
Total correct retain:  1230  Total retain:  2500
Total correct forget:  14759  Total forget:  47500
Total correct test:  243  Total test:  500
Total correct forget test:  2856  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.486, 0.438, 0.596, 0.594, 0.552, 0.288, 0.234, 0.35, 0.21, 0.292, 0.216, 0.232, 0.228, 0.256, 0.198, 0.228, 0.216, 0.214, 0.162, 0.208]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0212
[DEBUG][MIA] Test Set Loss:   mean=2.3010, std=3.2120
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.4833333333333334, 'auc': 0.9208984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8714, std=3.6478
[DEBUG][MIA] Test Set Loss:   mean=2.5816, std=3.5023
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.12, 'auc': 0.486176, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0130
[DEBUG][MIA] Test Set Loss:   mean=2.2019, std=3.4924
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.8837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3514, std=3.8247
[DEBUG][MIA] Test Set Loss:   mean=2.1233, std=3.3302
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11200000000000002, 'auc': 0.489736, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.1950, std=3.4037
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.7833333333333333, 'auc': 0.85546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7896, std=2.8659
[DEBUG][MIA] Test Set Loss:   mean=2.1940, std=3.5197
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.09, 'auc': 0.520848, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5322, std=0.9206
[DEBUG][MIA] Test Set Loss:   mean=5.4991, std=5.8088
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7499999999999999, 'auc': 0.8037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4944, std=4.3223
[DEBUG][MIA] Test Set Loss:   mean=4.5498, std=5.0846
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.126, 'auc': 0.560808, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4209, std=2.0840
[DEBUG][MIA] Test Set Loss:   mean=5.9352, std=6.9405
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.6166666666666666, 'auc': 0.677734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.2912, std=6.5036
[DEBUG][MIA] Test Set Loss:   mean=7.6650, std=7.0189
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.446, 'cv_acc': 0.118, 'auc': 0.450376, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3012, std=2.6292
[DEBUG][MIA] Test Set Loss:   mean=8.2960, std=6.3061
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6166666666666667, 'auc': 0.796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.7971, std=6.1075
[DEBUG][MIA] Test Set Loss:   mean=7.7621, std=6.2047
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.096, 'auc': 0.545144, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6408, std=1.2369
[DEBUG][MIA] Test Set Loss:   mean=4.9770, std=4.5199
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.4666666666666667, 'auc': 0.80078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4434, std=4.1666
[DEBUG][MIA] Test Set Loss:   mean=3.6164, std=4.1990
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.52064, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.0469, std=3.0334
[DEBUG][MIA] Test Set Loss:   mean=8.6338, std=6.6018
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.4666666666666668, 'auc': 0.759765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.4749, std=5.7841
[DEBUG][MIA] Test Set Loss:   mean=7.7702, std=6.1056
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.1, 'auc': 0.5627679999999999, 'task': 8}
Total correct retain:  1265  Total retain:  2500
Total correct forget:  14280  Total forget:  47500
Total correct test:  246  Total test:  500
Total correct forget test:  2745  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.492, 0.444, 0.618, 0.574, 0.334, 0.32, 0.238, 0.354, 0.218, 0.252, 0.212, 0.228, 0.228, 0.232, 0.208, 0.24, 0.2, 0.206, 0.176, 0.208]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0220, std=0.0736
[DEBUG][MIA] Test Set Loss:   mean=4.8539, std=5.7514
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8166666666666667, 'auc': 0.90625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5792, std=4.1635
[DEBUG][MIA] Test Set Loss:   mean=3.3034, std=4.0037
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.098, 'auc': 0.5229839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.7188, std=2.8691
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2833333333333333, 'auc': 0.888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5427, std=2.8338
[DEBUG][MIA] Test Set Loss:   mean=2.0113, std=3.2436
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.096, 'auc': 0.543568, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2678, std=0.5060
[DEBUG][MIA] Test Set Loss:   mean=5.1401, std=5.9288
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7166666666666667, 'auc': 0.791015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0311, std=4.9388
[DEBUG][MIA] Test Set Loss:   mean=4.1180, std=4.6380
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11599999999999999, 'auc': 0.517024, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7846, std=1.0002
[DEBUG][MIA] Test Set Loss:   mean=5.2314, std=5.3653
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6333333333333333, 'auc': 0.73876953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6892, std=5.5807
[DEBUG][MIA] Test Set Loss:   mean=6.0443, std=6.2144
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.096, 'auc': 0.558608, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8516, std=2.5800
[DEBUG][MIA] Test Set Loss:   mean=7.2050, std=7.3504
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4833333333333333, 'auc': 0.716796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0984, std=6.8210
[DEBUG][MIA] Test Set Loss:   mean=7.6540, std=7.3333
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.09, 'auc': 0.562424, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.9681, std=2.6726
[DEBUG][MIA] Test Set Loss:   mean=7.5934, std=6.3548
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5666666666666667, 'auc': 0.693359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.9508, std=6.0111
[DEBUG][MIA] Test Set Loss:   mean=6.7119, std=5.8807
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11600000000000002, 'auc': 0.49276000000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4647, std=0.8683
[DEBUG][MIA] Test Set Loss:   mean=3.0623, std=3.3720
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7666666666666667, 'auc': 0.71142578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.5286, std=3.5224
[DEBUG][MIA] Test Set Loss:   mean=2.8134, std=3.8556
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11000000000000001, 'auc': 0.534464, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9570, std=2.2167
[DEBUG][MIA] Test Set Loss:   mean=6.2496, std=4.9346
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6166666666666667, 'auc': 0.7373046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5653, std=4.7936
[DEBUG][MIA] Test Set Loss:   mean=6.1245, std=5.7778
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.096, 'auc': 0.574312, 'task': 8}
Total correct retain:  1182  Total retain:  2500
Total correct forget:  14100  Total forget:  47500
Total correct test:  230  Total test:  500
Total correct forget test:  2692  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.46, 0.422, 0.622, 0.376, 0.29, 0.316, 0.248, 0.468, 0.246, 0.276, 0.212, 0.236, 0.23, 0.232, 0.178, 0.248, 0.196, 0.218, 0.184, 0.186]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0088
[DEBUG][MIA] Test Set Loss:   mean=2.1952, std=3.3922
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.8701171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.2723, std=4.0786
[DEBUG][MIA] Test Set Loss:   mean=3.0936, std=4.0398
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.47659199999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0572, std=2.1530
[DEBUG][MIA] Test Set Loss:   mean=9.4454, std=8.9153
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.6333333333333334, 'auc': 0.830078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.2126, std=6.8412
[DEBUG][MIA] Test Set Loss:   mean=7.6836, std=7.2301
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.481496, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9474, std=1.5566
[DEBUG][MIA] Test Set Loss:   mean=5.4728, std=5.7660
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6666666666666667, 'auc': 0.7529296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.1418, std=5.6368
[DEBUG][MIA] Test Set Loss:   mean=5.4206, std=5.6710
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.479904, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0285, std=1.5424
[DEBUG][MIA] Test Set Loss:   mean=6.0641, std=5.8245
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6166666666666667, 'auc': 0.78515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2728, std=6.0890
[DEBUG][MIA] Test Set Loss:   mean=5.8663, std=6.2115
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10600000000000001, 'auc': 0.5247040000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7842, std=3.4609
[DEBUG][MIA] Test Set Loss:   mean=7.9561, std=8.8826
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.5666666666666667, 'auc': 0.650390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.5102, std=7.7312
[DEBUG][MIA] Test Set Loss:   mean=8.0810, std=7.5337
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.13999999999999999, 'auc': 0.536624, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9774, std=2.4586
[DEBUG][MIA] Test Set Loss:   mean=5.5742, std=5.2248
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.4833333333333334, 'auc': 0.68359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.0236, std=5.3622
[DEBUG][MIA] Test Set Loss:   mean=6.6075, std=6.1149
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.515712, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0193, std=1.5415
[DEBUG][MIA] Test Set Loss:   mean=2.8636, std=4.9295
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.6666666666666667, 'auc': 0.6025390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.1508, std=4.2179
[DEBUG][MIA] Test Set Loss:   mean=3.1262, std=3.9482
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11000000000000001, 'auc': 0.516736, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.0474, std=3.2335
[DEBUG][MIA] Test Set Loss:   mean=9.0307, std=6.2903
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.4166666666666667, 'auc': 0.783203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7337, std=5.7346
[DEBUG][MIA] Test Set Loss:   mean=7.5621, std=6.5454
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11200000000000002, 'auc': 0.5289280000000001, 'task': 8}
Total correct retain:  1181  Total retain:  2500
Total correct forget:  13010  Total forget:  47500
Total correct test:  236  Total test:  500
Total correct forget test:  2487  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.472, 0.436, 0.298, 0.33, 0.294, 0.31, 0.272, 0.42, 0.228, 0.27, 0.222, 0.236, 0.228, 0.238, 0.162, 0.246, 0.208, 0.212, 0.17, 0.194]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 5, 5, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1043, std=0.1732
[DEBUG][MIA] Test Set Loss:   mean=4.2418, std=4.1004
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.7666666666666668, 'auc': 0.8447265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 7 9 7 7 7 8 7 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 9 8 9 6 8 8 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4667, std=5.5576
[DEBUG][MIA] Test Set Loss:   mean=5.0479, std=5.2643
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10400000000000001, 'auc': 0.48453599999999997, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 10, 14, 14, 14, 14, 11, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3380, std=2.4331
[DEBUG][MIA] Test Set Loss:   mean=5.5618, std=6.1968
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5499999999999999, 'auc': 0.71240234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 11 11 13 11 12 10 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 13 12 10 12 13 10 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.2695, std=6.3087
[DEBUG][MIA] Test Set Loss:   mean=6.3278, std=6.7291
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.096, 'auc': 0.49151999999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([17, 17, 17, 15, 16, 18, 17, 19, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9016, std=1.5120
[DEBUG][MIA] Test Set Loss:   mean=5.0555, std=4.6967
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.6666666666666666, 'auc': 0.7685546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 16 15 17 15 16 17 17 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 18 19 16 16 15 17 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.6086, std=5.2702
[DEBUG][MIA] Test Set Loss:   mean=4.4054, std=4.9389
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.49330399999999996, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 23, 20, 23, 22, 23, 24, 24, 23, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7003, std=1.1038
[DEBUG][MIA] Test Set Loss:   mean=3.2943, std=4.6701
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.6833333333333333, 'auc': 0.7265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 22 23 24 22 23 22 24 23 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 24 22 20 23 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.9503, std=5.0164
[DEBUG][MIA] Test Set Loss:   mean=4.4638, std=5.0807
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10200000000000001, 'auc': 0.542976, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([29, 28, 29, 27, 28, 26, 28, 25, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3516, std=3.3090
[DEBUG][MIA] Test Set Loss:   mean=7.8376, std=8.3893
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.26666666666666666, 'auc': 0.6494140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 27 29 26 27 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 27 27 25 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4606, std=7.3073
[DEBUG][MIA] Test Set Loss:   mean=6.4260, std=7.2472
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.088, 'auc': 0.505784, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 34, 34, 30, 31, 30, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2945, std=2.4319
[DEBUG][MIA] Test Set Loss:   mean=5.6319, std=5.2871
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5333333333333333, 'auc': 0.67236328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 31 31 32 34 33 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 32 33 32 33 33 33 32 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.2015, std=5.8044
[DEBUG][MIA] Test Set Loss:   mean=6.9752, std=6.3241
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.096, 'auc': 0.533504, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 35, 36, 39, 37, 38, 36, 38, 35, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.1065, std=3.4831
[DEBUG][MIA] Test Set Loss:   mean=4.0534, std=4.3212
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.55, 'auc': 0.5673828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 35 36 35 38 38 37 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 35 38 38 37 36 35 35 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.3977, std=4.8235
[DEBUG][MIA] Test Set Loss:   mean=4.9021, std=4.8452
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.09, 'auc': 0.534408, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([40, 44, 42, 44, 44, 40, 40, 44, 44, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.9239, std=3.4999
[DEBUG][MIA] Test Set Loss:   mean=7.2853, std=5.8414
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.6333333333333333, 'auc': 0.61474609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 41 41 40 43 40 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 40 41 44 41 40 44 43 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.5206, std=6.1197
[DEBUG][MIA] Test Set Loss:   mean=8.7098, std=6.8366
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.096, 'auc': 0.4527840000000001, 'task': 8}
Total correct retain:  1263  Total retain:  2500
Total correct forget:  12689  Total forget:  47500
Total correct test:  246  Total test:  500
Total correct forget test:  2426  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.492, 0.282, 0.352, 0.368, 0.394, 0.35, 0.26, 0.306, 0.224, 0.23, 0.206, 0.222, 0.246, 0.23, 0.162, 0.232, 0.224, 0.198, 0.176, 0.19]
Number of constraint violations:  0
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: RL-GEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 14:16:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 46%   61C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['man', 'shrew', 'otter', 'castle', 'tulips', 'lawn-mower', 'porcupine', 'seal', 'willow', 'turtle', 'shark', 'wolf', 'boy', 'kangaroo', 'house', 'cans', 'pine', 'possum', 'motorcycle', 'cups', 'bridge', 'computer keyboard', 'spider', 'skyscraper', 'pickup truck', 'butterfly', 'dinosaur', 'cattle', 'ray', 'forest', 'clock', 'cloud', 'fox', 'bicycle', 'dolphin', 'chimpanzee', 'lizard', 'maple', 'pears', 'aquarium fish', 'flatfish', 'whale', 'skunk', 'snake', 'couch', 'snail', 'sea', 'woman', 'train', 'tiger', 'lion', 'plates', 'tractor', 'squirrel', 'orchids', 'raccoon', 'rocket', 'television', 'worm', 'bee', 'leopard', 'mushrooms', 'camel', 'beetle', 'tank', 'cockroach', 'table', 'sunflowers', 'crocodile', 'crab', 'wardrobe', 'bus', 'palm', 'elephant', 'oak', 'trout', 'caterpillar', 'apples', 'bed', 'sweet peppers', 'bowls', 'bear', 'beaver', 'bottles', 'plain', 'rabbit', 'poppies', 'lobster', 'baby', 'roses', 'oranges', 'girl', 'telephone', 'mouse', 'hamster', 'chair', 'road', 'mountain', 'lamp', 'streetcar']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2075  Total retain:  2500
Total correct forget:  9230  Total forget:  47500
Total correct test:  348  Total test:  500
Total correct forget test:  1904  Total test forget:  9500
After learning task 1
Task accuracies: [0.696, 0.2, 0.198, 0.254, 0.158, 0.178, 0.178, 0.204, 0.136, 0.22, 0.244, 0.176, 0.19, 0.112, 0.218, 0.258, 0.156, 0.186, 0.294, 0.248]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0875, std=0.2357
[DEBUG][MIA] Test Set Loss:   mean=1.6443, std=3.0720
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.21960784313725493, 'auc': 0.72393798828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1569, std=0.5878
[DEBUG][MIA] Test Set Loss:   mean=1.3697, std=2.8457
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.236, 'auc': 0.6634720000000001, 'task': 1}
2 1
Total correct retain:  1839  Total retain:  2500
Total correct forget:  10826  Total forget:  47500
Total correct test:  319  Total test:  500
Total correct forget test:  2025  Total test forget:  9500
After learning task 2
Task accuracies: [0.638, 0.708, 0.216, 0.206, 0.054, 0.172, 0.21, 0.236, 0.224, 0.198, 0.196, 0.254, 0.21, 0.136, 0.152, 0.156, 0.124, 0.14, 0.27, 0.188]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0131
[DEBUG][MIA] Test Set Loss:   mean=1.6627, std=2.5169
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7058823529411764, 'auc': 0.811553955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9022, std=1.9369
[DEBUG][MIA] Test Set Loss:   mean=1.8129, std=2.7717
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.196, 'auc': 0.610888, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0261, std=0.1289
[DEBUG][MIA] Test Set Loss:   mean=1.4823, std=2.8698
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.27450980392156865, 'auc': 0.755279541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0708, std=0.3868
[DEBUG][MIA] Test Set Loss:   mean=1.1692, std=2.3294
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.262, 'auc': 0.73256, 'task': 2}
3 2
Total correct retain:  1780  Total retain:  2500
Total correct forget:  13257  Total forget:  47500
Total correct test:  339  Total test:  500
Total correct forget test:  2435  Total test forget:  9500
After learning task 3
Task accuracies: [0.678, 0.63, 0.73, 0.232, 0.096, 0.172, 0.204, 0.256, 0.246, 0.24, 0.204, 0.282, 0.204, 0.118, 0.158, 0.22, 0.21, 0.184, 0.192, 0.292]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0173
[DEBUG][MIA] Test Set Loss:   mean=1.5893, std=2.8062
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6941176470588235, 'auc': 0.84002685546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9311, std=2.0321
[DEBUG][MIA] Test Set Loss:   mean=1.9393, std=3.2625
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15, 'auc': 0.575512, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.9416, std=3.2629
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7137254901960783, 'auc': 0.795928955078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5814, std=1.4174
[DEBUG][MIA] Test Set Loss:   mean=1.9128, std=3.2774
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.196, 'auc': 0.622208, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0349, std=0.1940
[DEBUG][MIA] Test Set Loss:   mean=1.2771, std=2.5419
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2, 'auc': 0.690643310546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0252, std=0.1232
[DEBUG][MIA] Test Set Loss:   mean=1.0774, std=2.3445
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.23200000000000004, 'auc': 0.693256, 'task': 3}
4 3
Total correct retain:  1720  Total retain:  2500
Total correct forget:  14640  Total forget:  47500
Total correct test:  317  Total test:  500
Total correct forget test:  2683  Total test forget:  9500
After learning task 4
Task accuracies: [0.634, 0.628, 0.65, 0.756, 0.092, 0.164, 0.22, 0.25, 0.266, 0.312, 0.168, 0.212, 0.244, 0.158, 0.16, 0.232, 0.148, 0.206, 0.198, 0.302]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0105
[DEBUG][MIA] Test Set Loss:   mean=2.4930, std=3.5354
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7411764705882353, 'auc': 0.840606689453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4699, std=2.8615
[DEBUG][MIA] Test Set Loss:   mean=2.2912, std=3.4375
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.17200000000000001, 'auc': 0.591544, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0096
[DEBUG][MIA] Test Set Loss:   mean=2.2258, std=3.5194
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.5725490196078431, 'auc': 0.842010498046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0750, std=2.3206
[DEBUG][MIA] Test Set Loss:   mean=2.1133, std=3.2808
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.194, 'auc': 0.607648, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=2.0061, std=3.3112
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.29803921568627445, 'auc': 0.820953369140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3073, std=1.1267
[DEBUG][MIA] Test Set Loss:   mean=1.4936, std=3.0786
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.21400000000000002, 'auc': 0.6606240000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0239, std=0.1399
[DEBUG][MIA] Test Set Loss:   mean=1.2480, std=2.8988
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.25098039215686274, 'auc': 0.718780517578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0198, std=0.1426
[DEBUG][MIA] Test Set Loss:   mean=0.8617, std=2.0909
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.21800000000000003, 'auc': 0.6736, 'task': 4}
5 4
Total correct retain:  1625  Total retain:  2500
Total correct forget:  16155  Total forget:  47500
Total correct test:  295  Total test:  500
Total correct forget test:  2883  Total test forget:  9500
After learning task 5
Task accuracies: [0.59, 0.584, 0.618, 0.686, 0.784, 0.17, 0.206, 0.214, 0.216, 0.252, 0.236, 0.218, 0.196, 0.152, 0.158, 0.21, 0.164, 0.252, 0.204, 0.246]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=2.3840, std=3.6593
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333334, 'auc': 0.810577392578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6739, std=3.0736
[DEBUG][MIA] Test Set Loss:   mean=2.2794, std=3.4713
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.13599999999999998, 'auc': 0.575736, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.4456, std=3.3476
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7254901960784315, 'auc': 0.9029541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1749, std=2.4011
[DEBUG][MIA] Test Set Loss:   mean=2.3377, std=3.5576
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15599999999999997, 'auc': 0.630784, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.4390, std=2.8072
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2901960784313725, 'auc': 0.839752197265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4984, std=1.3132
[DEBUG][MIA] Test Set Loss:   mean=1.9722, std=3.5940
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.13799999999999998, 'auc': 0.61748, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=1.6369, std=3.1974
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24705882352941178, 'auc': 0.7659912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4563, std=1.3235
[DEBUG][MIA] Test Set Loss:   mean=1.4338, std=3.0064
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.186, 'auc': 0.643248, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0775, std=0.5445
[DEBUG][MIA] Test Set Loss:   mean=0.8731, std=1.9481
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2627450980392157, 'auc': 0.73150634765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0412
[DEBUG][MIA] Test Set Loss:   mean=1.1027, std=2.4623
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.264, 'auc': 0.737472, 'task': 5}
6 5
Total correct retain:  1667  Total retain:  2500
Total correct forget:  17846  Total forget:  47500
Total correct test:  311  Total test:  500
Total correct forget test:  3096  Total test forget:  9500
After learning task 6
Task accuracies: [0.622, 0.594, 0.576, 0.676, 0.728, 0.734, 0.198, 0.226, 0.278, 0.266, 0.198, 0.222, 0.212, 0.144, 0.182, 0.182, 0.196, 0.166, 0.17, 0.244]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=2.4366, std=3.7078
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7607843137254902, 'auc': 0.818115234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9232, std=3.5499
[DEBUG][MIA] Test Set Loss:   mean=2.1918, std=3.4005
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.536648, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.2720, std=3.8099
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7254901960784313, 'auc': 0.907501220703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3989, std=2.8919
[DEBUG][MIA] Test Set Loss:   mean=1.8600, std=3.2341
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.16199999999999998, 'auc': 0.586392, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0077
[DEBUG][MIA] Test Set Loss:   mean=2.0475, std=3.8220
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7137254901960784, 'auc': 0.78204345703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0819, std=2.5464
[DEBUG][MIA] Test Set Loss:   mean=2.0328, std=3.5877
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.154, 'auc': 0.611752, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.7102, std=3.1836
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.29411764705882354, 'auc': 0.83447265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7617, std=1.8870
[DEBUG][MIA] Test Set Loss:   mean=1.6638, std=3.3899
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.168, 'auc': 0.5749600000000001, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.1548, std=2.3544
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2705882352941177, 'auc': 0.79681396484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1470, std=0.6314
[DEBUG][MIA] Test Set Loss:   mean=1.2398, std=2.6786
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.20800000000000002, 'auc': 0.6611199999999999, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0107
[DEBUG][MIA] Test Set Loss:   mean=0.6916, std=1.7145
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.19607843137254904, 'auc': 0.714508056640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0140, std=0.1870
[DEBUG][MIA] Test Set Loss:   mean=0.6422, std=1.6466
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.22200000000000003, 'auc': 0.7107760000000001, 'task': 6}
7 6
Total correct retain:  1690  Total retain:  2500
Total correct forget:  19505  Total forget:  47500
Total correct test:  290  Total test:  500
Total correct forget test:  3443  Total test forget:  9500
After learning task 7
Task accuracies: [0.58, 0.6, 0.594, 0.648, 0.706, 0.73, 0.808, 0.216, 0.282, 0.238, 0.162, 0.254, 0.236, 0.146, 0.142, 0.21, 0.226, 0.202, 0.186, 0.3]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=2.0646, std=3.3064
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6627450980392157, 'auc': 0.780670166015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7676, std=3.3582
[DEBUG][MIA] Test Set Loss:   mean=2.1252, std=3.5283
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.5669280000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=2.7101, std=4.0449
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7647058823529411, 'auc': 0.872283935546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0418, std=3.5782
[DEBUG][MIA] Test Set Loss:   mean=2.6422, std=4.3053
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.132, 'auc': 0.554624, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.8742, std=3.7553
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2941176470588235, 'auc': 0.832763671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9343, std=2.4094
[DEBUG][MIA] Test Set Loss:   mean=1.6661, std=3.1428
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.154, 'auc': 0.5763280000000001, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0078
[DEBUG][MIA] Test Set Loss:   mean=2.0094, std=3.7221
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.25098039215686274, 'auc': 0.804779052734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1110, std=2.5076
[DEBUG][MIA] Test Set Loss:   mean=1.7188, std=3.6078
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.16199999999999998, 'auc': 0.5651039999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=1.8651, std=3.1531
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2980392156862745, 'auc': 0.8779296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5452, std=1.5257
[DEBUG][MIA] Test Set Loss:   mean=1.4724, std=2.7820
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.20400000000000001, 'auc': 0.6581680000000001, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.0863, std=2.4873
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2549019607843137, 'auc': 0.756103515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1887, std=1.0496
[DEBUG][MIA] Test Set Loss:   mean=1.0610, std=2.3342
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.21200000000000002, 'auc': 0.664536, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0196, std=0.1269
[DEBUG][MIA] Test Set Loss:   mean=0.6499, std=1.9842
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.21960784313725493, 'auc': 0.551483154296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0303, std=0.3935
[DEBUG][MIA] Test Set Loss:   mean=0.9094, std=2.2921
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.16999999999999998, 'auc': 0.6886000000000001, 'task': 7}
8 7
Total correct retain:  1701  Total retain:  2500
Total correct forget:  21277  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  3759  Total test forget:  9500
After learning task 8
Task accuracies: [0.588, 0.614, 0.58, 0.692, 0.7, 0.67, 0.748, 0.836, 0.254, 0.18, 0.202, 0.232, 0.238, 0.126, 0.196, 0.228, 0.28, 0.194, 0.228, 0.32]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0119
[DEBUG][MIA] Test Set Loss:   mean=1.8420, std=3.4080
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6941176470588235, 'auc': 0.767059326171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0844, std=3.6976
[DEBUG][MIA] Test Set Loss:   mean=2.0712, std=3.6888
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11600000000000002, 'auc': 0.533152, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=2.2499, std=3.8011
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7215686274509804, 'auc': 0.85540771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6634, std=3.1295
[DEBUG][MIA] Test Set Loss:   mean=2.6990, std=4.1775
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.122, 'auc': 0.56664, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=2.0381, std=4.0030
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.7176470588235294, 'auc': 0.82391357421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4432, std=2.9809
[DEBUG][MIA] Test Set Loss:   mean=1.8873, std=3.5543
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.15799999999999997, 'auc': 0.5500160000000001, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=2.1351, std=4.2932
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2901960784313725, 'auc': 0.83160400390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0677, std=2.5239
[DEBUG][MIA] Test Set Loss:   mean=1.8801, std=3.5513
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.14, 'auc': 0.607664, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=1.4247, std=2.8634
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6980392156862745, 'auc': 0.811859130859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0651, std=2.3901
[DEBUG][MIA] Test Set Loss:   mean=2.0592, std=3.4751
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.186, 'auc': 0.617712, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.4904, std=2.6181
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.25098039215686274, 'auc': 0.844207763671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4269, std=1.2250
[DEBUG][MIA] Test Set Loss:   mean=1.2164, std=2.2985
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.174, 'auc': 0.6202160000000001, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.4703, std=2.8058
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.26666666666666666, 'auc': 0.763824462890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4566, std=1.4064
[DEBUG][MIA] Test Set Loss:   mean=1.1628, std=2.4149
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.152, 'auc': 0.617096, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0126, std=0.1154
[DEBUG][MIA] Test Set Loss:   mean=0.7934, std=2.2030
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.21568627450980396, 'auc': 0.714996337890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0206
[DEBUG][MIA] Test Set Loss:   mean=1.1320, std=2.8171
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.22000000000000003, 'auc': 0.710744, 'task': 8}
Total correct retain:  1721  Total retain:  2500
Total correct forget:  22328  Total forget:  47500
Total correct test:  321  Total test:  500
Total correct forget test:  3930  Total test forget:  9500
After learning task 9
Task accuracies: [0.642, 0.614, 0.59, 0.67, 0.662, 0.638, 0.73, 0.748, 0.802, 0.244, 0.206, 0.248, 0.19, 0.132, 0.182, 0.216, 0.238, 0.202, 0.242, 0.306]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0123
[DEBUG][MIA] Test Set Loss:   mean=2.4131, std=3.7737
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7254901960784313, 'auc': 0.810516357421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3481, std=4.1183
[DEBUG][MIA] Test Set Loss:   mean=2.3987, std=4.0289
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.138, 'auc': 0.527952, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.5497, std=3.8337
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7647058823529412, 'auc': 0.90789794921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6189, std=3.3443
[DEBUG][MIA] Test Set Loss:   mean=2.8134, std=4.4622
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.12800000000000003, 'auc': 0.610416, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=1.7393, std=3.6196
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.28627450980392155, 'auc': 0.73992919921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2452, std=2.6514
[DEBUG][MIA] Test Set Loss:   mean=1.5078, std=3.3856
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.184, 'auc': 0.523288, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0086
[DEBUG][MIA] Test Set Loss:   mean=1.8605, std=3.4571
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2705882352941177, 'auc': 0.848541259765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3242, std=2.8998
[DEBUG][MIA] Test Set Loss:   mean=1.6154, std=3.2950
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.15, 'auc': 0.555488, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.7058, std=3.3115
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7294117647058823, 'auc': 0.80853271484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8536, std=2.0695
[DEBUG][MIA] Test Set Loss:   mean=1.7845, std=3.2813
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.16199999999999998, 'auc': 0.565496, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.1820, std=2.4518
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.23529411764705882, 'auc': 0.764434814453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4607, std=1.3783
[DEBUG][MIA] Test Set Loss:   mean=1.1563, std=2.5342
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.188, 'auc': 0.598136, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=0.9039, std=1.8664
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.27450980392156865, 'auc': 0.7725830078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4094, std=1.1958
[DEBUG][MIA] Test Set Loss:   mean=1.1456, std=2.4360
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.15, 'auc': 0.58264, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.0051, std=2.4958
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.25098039215686274, 'auc': 0.71343994140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1078, std=0.4700
[DEBUG][MIA] Test Set Loss:   mean=1.1404, std=2.6657
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.2, 'auc': 0.668936, 'task': 8}
Total correct retain:  1766  Total retain:  2500
Total correct forget:  24074  Total forget:  47500
Total correct test:  329  Total test:  500
Total correct forget test:  4261  Total test forget:  9500
After learning task 10
Task accuracies: [0.658, 0.612, 0.606, 0.66, 0.688, 0.644, 0.768, 0.746, 0.77, 0.8, 0.202, 0.232, 0.214, 0.17, 0.198, 0.224, 0.272, 0.182, 0.228, 0.306]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0324
[DEBUG][MIA] Test Set Loss:   mean=2.4904, std=4.2501
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6862745098039216, 'auc': 0.818511962890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0598, std=3.5851
[DEBUG][MIA] Test Set Loss:   mean=2.6481, std=4.1534
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10800000000000001, 'auc': 0.5600959999999999, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=2.5218, std=3.7248
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7098039215686274, 'auc': 0.84112548828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8183, std=3.0124
[DEBUG][MIA] Test Set Loss:   mean=3.0916, std=4.5114
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11600000000000002, 'auc': 0.573632, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0144
[DEBUG][MIA] Test Set Loss:   mean=1.5547, std=3.5860
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.7176470588235293, 'auc': 0.693328857421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7414, std=3.6145
[DEBUG][MIA] Test Set Loss:   mean=2.2446, std=4.1109
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.12, 'auc': 0.5515439999999999, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0267
[DEBUG][MIA] Test Set Loss:   mean=1.4518, std=2.8346
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2784313725490196, 'auc': 0.727264404296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3612, std=2.9203
[DEBUG][MIA] Test Set Loss:   mean=1.6521, std=3.0615
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11400000000000002, 'auc': 0.5441999999999999, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0277
[DEBUG][MIA] Test Set Loss:   mean=2.0316, std=3.4249
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2784313725490196, 'auc': 0.833526611328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9767, std=2.3204
[DEBUG][MIA] Test Set Loss:   mean=1.8525, std=3.2076
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.10999999999999999, 'auc': 0.597016, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.9329, std=2.1020
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25490196078431376, 'auc': 0.773590087890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6380, std=1.8666
[DEBUG][MIA] Test Set Loss:   mean=0.9295, std=2.1742
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.142, 'auc': 0.591032, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=1.0134, std=2.5290
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2431372549019608, 'auc': 0.74517822265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4417, std=1.1440
[DEBUG][MIA] Test Set Loss:   mean=1.1171, std=2.5631
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.146, 'auc': 0.567424, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0079
[DEBUG][MIA] Test Set Loss:   mean=1.5891, std=2.9959
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24313725490196075, 'auc': 0.804840087890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4590, std=1.4750
[DEBUG][MIA] Test Set Loss:   mean=1.7870, std=3.2887
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.164, 'auc': 0.641344, 'task': 8}
Total correct retain:  1773  Total retain:  2500
Total correct forget:  25303  Total forget:  47500
Total correct test:  335  Total test:  500
Total correct forget test:  4497  Total test forget:  9500
After learning task 11
Task accuracies: [0.67, 0.596, 0.574, 0.67, 0.698, 0.65, 0.76, 0.752, 0.726, 0.764, 0.818, 0.236, 0.168, 0.156, 0.172, 0.224, 0.264, 0.174, 0.3, 0.292]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2139, std=0.9694
[DEBUG][MIA] Test Set Loss:   mean=3.1817, std=4.6492
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.5843137254901961, 'auc': 0.78509521484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8691, std=4.3908
[DEBUG][MIA] Test Set Loss:   mean=2.9567, std=4.4630
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11599999999999999, 'auc': 0.530888, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.2511, std=0.7666
[DEBUG][MIA] Test Set Loss:   mean=3.8202, std=5.3191
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6274509803921569, 'auc': 0.741241455078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5604, std=4.4591
[DEBUG][MIA] Test Set Loss:   mean=3.5013, std=4.8011
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10600000000000001, 'auc': 0.550024, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3764, std=1.2661
[DEBUG][MIA] Test Set Loss:   mean=3.2531, std=5.6634
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2431372549019608, 'auc': 0.688629150390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3002, std=4.1137
[DEBUG][MIA] Test Set Loss:   mean=2.6921, std=4.8252
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.132, 'auc': 0.52, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3155, std=1.1524
[DEBUG][MIA] Test Set Loss:   mean=2.3749, std=4.6335
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.21568627450980396, 'auc': 0.68267822265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0331, std=3.5522
[DEBUG][MIA] Test Set Loss:   mean=2.3856, std=4.2425
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10600000000000001, 'auc': 0.506192, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1523, std=0.6321
[DEBUG][MIA] Test Set Loss:   mean=2.0309, std=3.5823
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.4666666666666667, 'auc': 0.735809326171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9770, std=3.5139
[DEBUG][MIA] Test Set Loss:   mean=2.7697, std=4.5234
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.086, 'auc': 0.430664, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1508, std=0.6756
[DEBUG][MIA] Test Set Loss:   mean=1.4562, std=2.8195
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.2431372549019608, 'auc': 0.634124755859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2790, std=3.2403
[DEBUG][MIA] Test Set Loss:   mean=2.0032, std=3.8009
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10600000000000001, 'auc': 0.5560959999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0844, std=0.4548
[DEBUG][MIA] Test Set Loss:   mean=1.7182, std=3.0079
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2549019607843137, 'auc': 0.760528564453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7081, std=1.9165
[DEBUG][MIA] Test Set Loss:   mean=1.5425, std=2.9759
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.172, 'auc': 0.595752, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3128, std=1.2982
[DEBUG][MIA] Test Set Loss:   mean=2.0613, std=3.8459
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25098039215686274, 'auc': 0.678253173828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7060, std=2.0874
[DEBUG][MIA] Test Set Loss:   mean=2.2207, std=4.3740
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.146, 'auc': 0.6121920000000001, 'task': 8}
Total correct retain:  1661  Total retain:  2500
Total correct forget:  21910  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  3972  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.616, 0.546, 0.478, 0.606, 0.656, 0.588, 0.696, 0.7, 0.686, 0.72, 0.312, 0.21, 0.16, 0.152, 0.188, 0.208, 0.286, 0.172, 0.298, 0.282]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8729, std=2.2691
[DEBUG][MIA] Test Set Loss:   mean=3.8068, std=5.4196
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.40784313725490196, 'auc': 0.729461669921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.3916, std=5.0778
[DEBUG][MIA] Test Set Loss:   mean=3.6613, std=5.0498
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.527272, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3651, std=1.3045
[DEBUG][MIA] Test Set Loss:   mean=4.1451, std=5.5483
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6078431372549019, 'auc': 0.77557373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6597, std=4.4361
[DEBUG][MIA] Test Set Loss:   mean=3.3572, std=4.8705
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10200000000000001, 'auc': 0.556424, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2043, std=3.0722
[DEBUG][MIA] Test Set Loss:   mean=4.1277, std=6.6239
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.25882352941176473, 'auc': 0.635772705078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.7501, std=5.9556
[DEBUG][MIA] Test Set Loss:   mean=4.4722, std=7.2012
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10600000000000001, 'auc': 0.525032, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2074, std=2.7868
[DEBUG][MIA] Test Set Loss:   mean=3.5989, std=5.7314
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.17254901960784313, 'auc': 0.6346435546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8307, std=5.1764
[DEBUG][MIA] Test Set Loss:   mean=3.4676, std=5.6063
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10400000000000001, 'auc': 0.5329680000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5107, std=1.5112
[DEBUG][MIA] Test Set Loss:   mean=3.2857, std=5.2665
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.4588235294117647, 'auc': 0.698455810546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1015, std=3.9079
[DEBUG][MIA] Test Set Loss:   mean=3.1229, std=4.9421
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.124, 'auc': 0.587712, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3162, std=1.3159
[DEBUG][MIA] Test Set Loss:   mean=2.0066, std=3.9052
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2666666666666667, 'auc': 0.67388916015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5965, std=3.7976
[DEBUG][MIA] Test Set Loss:   mean=2.2096, std=4.1163
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.14, 'auc': 0.561632, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2905, std=1.0472
[DEBUG][MIA] Test Set Loss:   mean=2.3571, std=3.9928
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20784313725490194, 'auc': 0.685394287109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0248, std=2.1063
[DEBUG][MIA] Test Set Loss:   mean=2.0806, std=3.6945
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13, 'auc': 0.574432, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2519, std=0.9004
[DEBUG][MIA] Test Set Loss:   mean=1.7459, std=3.5054
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.23137254901960785, 'auc': 0.66058349609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.0318, std=2.3966
[DEBUG][MIA] Test Set Loss:   mean=2.1836, std=4.0152
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.13799999999999998, 'auc': 0.575224, 'task': 8}
Total correct retain:  1564  Total retain:  2500
Total correct forget:  19570  Total forget:  47500
Total correct test:  283  Total test:  500
Total correct forget test:  3600  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.566, 0.516, 0.518, 0.562, 0.62, 0.566, 0.67, 0.642, 0.684, 0.21, 0.292, 0.194, 0.182, 0.172, 0.18, 0.21, 0.298, 0.176, 0.27, 0.238]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3130, std=2.8227
[DEBUG][MIA] Test Set Loss:   mean=4.7124, std=5.9852
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2627450980392157, 'auc': 0.67578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.8699, std=5.5881
[DEBUG][MIA] Test Set Loss:   mean=3.9455, std=5.0091
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.527376, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5064, std=1.4931
[DEBUG][MIA] Test Set Loss:   mean=3.4683, std=4.9039
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.580392156862745, 'auc': 0.74798583984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1338, std=4.8706
[DEBUG][MIA] Test Set Loss:   mean=3.2243, std=4.4402
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.094, 'auc': 0.5350239999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8145, std=2.0217
[DEBUG][MIA] Test Set Loss:   mean=3.4330, std=5.9898
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.2235294117647059, 'auc': 0.658111572265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.6564, std=4.6835
[DEBUG][MIA] Test Set Loss:   mean=3.3891, std=5.6309
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.094, 'auc': 0.531544, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0314, std=2.5683
[DEBUG][MIA] Test Set Loss:   mean=3.9296, std=6.1034
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2, 'auc': 0.6563720703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5181, std=5.7385
[DEBUG][MIA] Test Set Loss:   mean=3.3361, std=5.4436
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.11800000000000002, 'auc': 0.491072, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2505, std=0.7768
[DEBUG][MIA] Test Set Loss:   mean=2.7317, std=4.2685
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2588235294117647, 'auc': 0.71807861328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2483, std=4.3235
[DEBUG][MIA] Test Set Loss:   mean=2.4905, std=4.1225
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.088, 'auc': 0.537216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1780, std=0.6666
[DEBUG][MIA] Test Set Loss:   mean=1.6452, std=3.5026
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2588235294117647, 'auc': 0.681640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7402, std=4.0736
[DEBUG][MIA] Test Set Loss:   mean=1.6764, std=3.3702
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11200000000000002, 'auc': 0.5118320000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3755, std=3.3813
[DEBUG][MIA] Test Set Loss:   mean=2.4622, std=4.0897
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.2549019607843137, 'auc': 0.60552978515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2920, std=4.3314
[DEBUG][MIA] Test Set Loss:   mean=2.6710, std=4.2925
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.5311119999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=29.1421, std=20.1148
[DEBUG][MIA] Test Set Loss:   mean=29.4831, std=21.2834
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11764705882352941, 'auc': 0.504638671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=27.6495, std=21.1926
[DEBUG][MIA] Test Set Loss:   mean=27.4280, std=20.1033
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.49892000000000003, 'task': 8}
Total correct retain:  1571  Total retain:  2500
Total correct forget:  17642  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  3301  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.588, 0.5, 0.528, 0.61, 0.564, 0.556, 0.672, 0.606, 0.208, 0.212, 0.252, 0.208, 0.176, 0.178, 0.176, 0.222, 0.246, 0.186, 0.29, 0.212]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8607, std=3.3519
[DEBUG][MIA] Test Set Loss:   mean=3.6737, std=5.2646
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.2392156862745098, 'auc': 0.621978759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5104, std=5.0739
[DEBUG][MIA] Test Set Loss:   mean=4.0314, std=5.4342
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.539632, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5599, std=3.2660
[DEBUG][MIA] Test Set Loss:   mean=4.9217, std=5.5858
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.18039215686274512, 'auc': 0.691864013671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5842, std=5.2722
[DEBUG][MIA] Test Set Loss:   mean=4.7909, std=5.4949
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.422, 'cv_acc': 0.11200000000000002, 'auc': 0.42444799999999994, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3164, std=4.1794
[DEBUG][MIA] Test Set Loss:   mean=4.2788, std=5.7821
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.2392156862745098, 'auc': 0.58953857421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0365, std=6.1737
[DEBUG][MIA] Test Set Loss:   mean=4.5774, std=6.2802
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.524744, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6065, std=3.9404
[DEBUG][MIA] Test Set Loss:   mean=3.7333, std=5.4289
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.12549019607843137, 'auc': 0.62518310546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2607, std=5.6344
[DEBUG][MIA] Test Set Loss:   mean=3.8247, std=5.2025
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.1, 'auc': 0.530744, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3357, std=2.7216
[DEBUG][MIA] Test Set Loss:   mean=3.8718, std=5.0473
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.21176470588235294, 'auc': 0.677093505859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.1141, std=4.6784
[DEBUG][MIA] Test Set Loss:   mean=3.4194, std=4.6425
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.531304, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8547, std=2.0709
[DEBUG][MIA] Test Set Loss:   mean=2.4172, std=3.6724
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2235294117647059, 'auc': 0.6466064453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7966, std=3.3471
[DEBUG][MIA] Test Set Loss:   mean=2.9083, std=4.6926
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.09, 'auc': 0.5594, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=19.9222, std=27.6670
[DEBUG][MIA] Test Set Loss:   mean=16.5522, std=19.4855
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.500946044921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.3925, std=21.3588
[DEBUG][MIA] Test Set Loss:   mean=18.2472, std=20.4265
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.086, 'auc': 0.468072, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=28.6264, std=20.8983
[DEBUG][MIA] Test Set Loss:   mean=27.1596, std=22.2059
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10196078431372549, 'auc': 0.53009033203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=28.4665, std=22.0660
[DEBUG][MIA] Test Set Loss:   mean=27.6950, std=21.2756
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10200000000000001, 'auc': 0.495432, 'task': 8}
Total correct retain:  1537  Total retain:  2500
Total correct forget:  15350  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  2868  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.588, 0.492, 0.438, 0.484, 0.544, 0.51, 0.612, 0.272, 0.206, 0.204, 0.234, 0.192, 0.138, 0.144, 0.136, 0.206, 0.24, 0.166, 0.32, 0.198]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8737, std=3.4419
[DEBUG][MIA] Test Set Loss:   mean=4.8564, std=6.2490
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.23921568627450984, 'auc': 0.63232421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.5374, std=6.1804
[DEBUG][MIA] Test Set Loss:   mean=4.4528, std=6.2142
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.5126080000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2049, std=2.2294
[DEBUG][MIA] Test Set Loss:   mean=4.7329, std=5.5699
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5215686274509804, 'auc': 0.72882080078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.3745, std=4.2524
[DEBUG][MIA] Test Set Loss:   mean=4.1477, std=5.6359
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11200000000000002, 'auc': 0.513336, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9058, std=3.8766
[DEBUG][MIA] Test Set Loss:   mean=4.3771, std=6.3020
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.21960784313725493, 'auc': 0.621734619140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2909, std=5.5912
[DEBUG][MIA] Test Set Loss:   mean=4.6515, std=6.5094
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11399999999999999, 'auc': 0.547528, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6673, std=3.3010
[DEBUG][MIA] Test Set Loss:   mean=3.9734, std=6.3227
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.13725490196078433, 'auc': 0.622711181640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0778, std=6.1869
[DEBUG][MIA] Test Set Loss:   mean=3.6994, std=5.9712
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10200000000000001, 'auc': 0.47163200000000005, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7423, std=3.1259
[DEBUG][MIA] Test Set Loss:   mean=3.8713, std=5.5706
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.21176470588235294, 'auc': 0.61578369140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.2126, std=6.5520
[DEBUG][MIA] Test Set Loss:   mean=4.3728, std=6.1213
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.520928, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.6644, std=20.5714
[DEBUG][MIA] Test Set Loss:   mean=24.2710, std=20.8486
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09803921568627451, 'auc': 0.520904541015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.2836, std=20.9248
[DEBUG][MIA] Test Set Loss:   mean=26.5045, std=21.8705
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.098, 'auc': 0.4414, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=29.7199, std=36.3278
[DEBUG][MIA] Test Set Loss:   mean=25.8106, std=24.6440
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11764705882352941, 'auc': 0.5194091796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=22.4618, std=26.0173
[DEBUG][MIA] Test Set Loss:   mean=25.0428, std=24.8718
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.08399999999999999, 'auc': 0.540376, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=35.8214, std=26.6758
[DEBUG][MIA] Test Set Loss:   mean=34.1841, std=28.1678
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11764705882352941, 'auc': 0.47711181640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=33.9189, std=27.8846
[DEBUG][MIA] Test Set Loss:   mean=34.2921, std=26.3465
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.4948, 'task': 8}
Total correct retain:  1492  Total retain:  2500
Total correct forget:  13999  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  2640  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.594, 0.48, 0.428, 0.494, 0.544, 0.486, 0.202, 0.216, 0.204, 0.2, 0.204, 0.186, 0.158, 0.166, 0.142, 0.204, 0.292, 0.134, 0.318, 0.222]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6017, std=5.3927
[DEBUG][MIA] Test Set Loss:   mean=5.3273, std=8.0269
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.21960784313725493, 'auc': 0.57867431640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4338, std=8.0209
[DEBUG][MIA] Test Set Loss:   mean=6.2876, std=8.5972
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10200000000000001, 'auc': 0.5179119999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8231, std=6.6639
[DEBUG][MIA] Test Set Loss:   mean=5.6737, std=7.3685
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.2235294117647059, 'auc': 0.61737060546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.9983, std=7.9614
[DEBUG][MIA] Test Set Loss:   mean=7.1854, std=8.7663
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10400000000000001, 'auc': 0.46372800000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2085, std=2.6279
[DEBUG][MIA] Test Set Loss:   mean=4.3790, std=5.5106
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.1411764705882353, 'auc': 0.7225341796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8729, std=5.0247
[DEBUG][MIA] Test Set Loss:   mean=3.2213, std=5.1108
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10800000000000001, 'auc': 0.514952, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0190, std=3.6791
[DEBUG][MIA] Test Set Loss:   mean=3.8175, std=5.7734
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.23137254901960783, 'auc': 0.58892822265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5235, std=5.0014
[DEBUG][MIA] Test Set Loss:   mean=4.4661, std=6.4672
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10800000000000001, 'auc': 0.52112, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=14.6043, std=16.0697
[DEBUG][MIA] Test Set Loss:   mean=17.0369, std=18.9662
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11764705882352941, 'auc': 0.5277099609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=17.2588, std=17.8443
[DEBUG][MIA] Test Set Loss:   mean=16.4656, std=17.2373
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.09, 'auc': 0.48419200000000007, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=23.6161, std=19.8570
[DEBUG][MIA] Test Set Loss:   mean=26.5245, std=19.4819
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09803921568627451, 'auc': 0.545806884765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=24.6473, std=19.5001
[DEBUG][MIA] Test Set Loss:   mean=26.0091, std=20.0872
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11599999999999999, 'auc': 0.48372800000000005, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=21.4505, std=23.9939
[DEBUG][MIA] Test Set Loss:   mean=23.1647, std=20.7914
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.08627450980392157, 'auc': 0.452911376953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=21.6393, std=21.7979
[DEBUG][MIA] Test Set Loss:   mean=20.5490, std=19.1960
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.501368, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=33.6895, std=28.4187
[DEBUG][MIA] Test Set Loss:   mean=35.5152, std=29.3703
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.0784313725490196, 'auc': 0.485107421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=35.4992, std=25.7108
[DEBUG][MIA] Test Set Loss:   mean=33.2429, std=26.2747
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.46932799999999997, 'task': 8}
Total correct retain:  1529  Total retain:  2500
Total correct forget:  13349  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  2591  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.614, 0.494, 0.398, 0.56, 0.5, 0.258, 0.202, 0.226, 0.202, 0.2, 0.212, 0.234, 0.162, 0.18, 0.244, 0.218, 0.222, 0.184, 0.262, 0.224]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1795, std=2.7460
[DEBUG][MIA] Test Set Loss:   mean=3.6703, std=5.8308
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.19215686274509802, 'auc': 0.646514892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.4490, std=5.8272
[DEBUG][MIA] Test Set Loss:   mean=4.1019, std=6.4677
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.1, 'auc': 0.537192, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8788, std=2.0444
[DEBUG][MIA] Test Set Loss:   mean=3.7618, std=4.9343
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.20392156862745098, 'auc': 0.705230712890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1865, std=5.3680
[DEBUG][MIA] Test Set Loss:   mean=3.7099, std=5.2673
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.122, 'auc': 0.5241279999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2083, std=3.0988
[DEBUG][MIA] Test Set Loss:   mean=3.4616, std=6.0577
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.11372549019607843, 'auc': 0.5989990234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.7304, std=7.8924
[DEBUG][MIA] Test Set Loss:   mean=4.6134, std=7.5498
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.12000000000000002, 'auc': 0.49438400000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.1556, std=29.9358
[DEBUG][MIA] Test Set Loss:   mean=22.9540, std=28.1618
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.10980392156862746, 'auc': 0.49371337890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.0938, std=27.2142
[DEBUG][MIA] Test Set Loss:   mean=20.4909, std=22.3755
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10600000000000001, 'auc': 0.5071920000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.6575, std=9.3256
[DEBUG][MIA] Test Set Loss:   mean=8.7961, std=9.8744
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.55560302734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.7388, std=10.8488
[DEBUG][MIA] Test Set Loss:   mean=9.5819, std=11.1193
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.1, 'auc': 0.492848, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=21.6568, std=22.6648
[DEBUG][MIA] Test Set Loss:   mean=21.9814, std=20.5735
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10980392156862746, 'auc': 0.515106201171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.9305, std=19.7009
[DEBUG][MIA] Test Set Loss:   mean=22.9337, std=22.1672
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.521344, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=23.8810, std=32.7138
[DEBUG][MIA] Test Set Loss:   mean=27.8439, std=31.9545
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.1215686274509804, 'auc': 0.421295166015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=28.7079, std=33.8533
[DEBUG][MIA] Test Set Loss:   mean=26.4999, std=32.1473
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.519712, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=40.3275, std=41.5327
[DEBUG][MIA] Test Set Loss:   mean=31.6520, std=31.4474
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10980392156862746, 'auc': 0.45489501953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.9980, std=36.6574
[DEBUG][MIA] Test Set Loss:   mean=39.5702, std=38.0534
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.473792, 'task': 8}
Total correct retain:  1470  Total retain:  2500
Total correct forget:  13558  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  2593  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.576, 0.5, 0.482, 0.536, 0.282, 0.308, 0.208, 0.268, 0.202, 0.206, 0.208, 0.224, 0.214, 0.14, 0.19, 0.224, 0.254, 0.19, 0.314, 0.236]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4302, std=3.3972
[DEBUG][MIA] Test Set Loss:   mean=4.0386, std=5.5968
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2235294117647059, 'auc': 0.639617919921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6426, std=5.1808
[DEBUG][MIA] Test Set Loss:   mean=4.0808, std=5.9109
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11200000000000002, 'auc': 0.52336, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5417, std=3.3386
[DEBUG][MIA] Test Set Loss:   mean=4.5098, std=5.8120
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20392156862745098, 'auc': 0.6861572265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8729, std=5.5718
[DEBUG][MIA] Test Set Loss:   mean=4.3733, std=6.1974
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.126, 'auc': 0.528432, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=39.2639, std=44.9534
[DEBUG][MIA] Test Set Loss:   mean=38.5149, std=36.8969
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.13725490196078433, 'auc': 0.522705078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=37.3567, std=40.0271
[DEBUG][MIA] Test Set Loss:   mean=37.4984, std=39.8700
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.49960000000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=19.5475, std=28.5645
[DEBUG][MIA] Test Set Loss:   mean=16.3268, std=22.2901
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.12549019607843137, 'auc': 0.52813720703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.3207, std=28.4872
[DEBUG][MIA] Test Set Loss:   mean=19.1846, std=25.2926
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.088, 'auc': 0.5325920000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.3277, std=9.5125
[DEBUG][MIA] Test Set Loss:   mean=9.2173, std=10.8028
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.11764705882352941, 'auc': 0.449859619140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.4688, std=11.1861
[DEBUG][MIA] Test Set Loss:   mean=8.4212, std=10.8140
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.094, 'auc': 0.495576, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=21.4333, std=21.5902
[DEBUG][MIA] Test Set Loss:   mean=22.8102, std=21.3010
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10980392156862746, 'auc': 0.53009033203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.1007, std=23.8491
[DEBUG][MIA] Test Set Loss:   mean=23.7538, std=22.6648
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.096, 'auc': 0.5256639999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=19.8959, std=29.6683
[DEBUG][MIA] Test Set Loss:   mean=23.5167, std=26.2627
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.11372549019607843, 'auc': 0.57147216796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=21.9432, std=29.3343
[DEBUG][MIA] Test Set Loss:   mean=20.3809, std=25.4710
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.507336, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=40.4021, std=34.5868
[DEBUG][MIA] Test Set Loss:   mean=37.0366, std=38.0006
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10588235294117647, 'auc': 0.543701171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=37.8473, std=32.5363
[DEBUG][MIA] Test Set Loss:   mean=37.0772, std=34.2430
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.48145600000000005, 'task': 8}
Total correct retain:  1298  Total retain:  2500
Total correct forget:  12836  Total forget:  47500
Total correct test:  267  Total test:  500
Total correct forget test:  2512  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.534, 0.486, 0.452, 0.24, 0.322, 0.378, 0.2, 0.256, 0.202, 0.202, 0.204, 0.218, 0.27, 0.162, 0.168, 0.228, 0.246, 0.216, 0.302, 0.272]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4232, std=9.5139
[DEBUG][MIA] Test Set Loss:   mean=7.9348, std=12.8422
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.14901960784313725, 'auc': 0.582611083984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.5240, std=10.0294
[DEBUG][MIA] Test Set Loss:   mean=6.1811, std=9.5592
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.122, 'auc': 0.5027839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=15.1463, std=17.6120
[DEBUG][MIA] Test Set Loss:   mean=17.6933, std=21.5474
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12941176470588237, 'auc': 0.505340576171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=17.2893, std=19.9431
[DEBUG][MIA] Test Set Loss:   mean=17.8418, std=24.6480
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.08199999999999999, 'auc': 0.508272, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=73.1579, std=92.9359
[DEBUG][MIA] Test Set Loss:   mean=59.5594, std=64.7288
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.11764705882352941, 'auc': 0.4937744140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=76.6123, std=92.7087
[DEBUG][MIA] Test Set Loss:   mean=64.9640, std=76.1296
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.46212, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=34.0133, std=49.6104
[DEBUG][MIA] Test Set Loss:   mean=40.8432, std=64.7322
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10980392156862746, 'auc': 0.4891357421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=38.7229, std=57.6946
[DEBUG][MIA] Test Set Loss:   mean=44.1665, std=66.2581
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.48561600000000005, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=17.0521, std=25.2496
[DEBUG][MIA] Test Set Loss:   mean=16.4581, std=26.9459
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12156862745098038, 'auc': 0.5185546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.7771, std=20.6774
[DEBUG][MIA] Test Set Loss:   mean=18.1173, std=26.5866
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11200000000000002, 'auc': 0.488592, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=31.2044, std=37.8326
[DEBUG][MIA] Test Set Loss:   mean=39.6608, std=41.9934
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.09411764705882353, 'auc': 0.4202880859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=39.1516, std=51.2258
[DEBUG][MIA] Test Set Loss:   mean=37.5746, std=44.8694
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10800000000000001, 'auc': 0.503312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=55.9811, std=79.9543
[DEBUG][MIA] Test Set Loss:   mean=52.3311, std=60.1671
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09411764705882353, 'auc': 0.47509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=64.7904, std=84.2226
[DEBUG][MIA] Test Set Loss:   mean=57.2984, std=71.2708
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.5267519999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=84.4777, std=91.3557
[DEBUG][MIA] Test Set Loss:   mean=73.6332, std=76.3102
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.11372549019607843, 'auc': 0.468994140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=62.8951, std=74.9689
[DEBUG][MIA] Test Set Loss:   mean=57.8303, std=58.9826
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10600000000000001, 'auc': 0.493056, 'task': 8}
Total correct retain:  1051  Total retain:  2500
Total correct forget:  10523  Total forget:  47500
Total correct test:  206  Total test:  500
Total correct forget test:  2117  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.412, 0.394, 0.276, 0.212, 0.268, 0.276, 0.2, 0.22, 0.2, 0.2, 0.202, 0.194, 0.254, 0.118, 0.182, 0.194, 0.252, 0.188, 0.138, 0.266]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 6, 8, 5, 8, 7, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1439.8574, std=1915.1401
[DEBUG][MIA] Test Set Loss:   mean=1633.8185, std=2226.3853
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10196078431372549, 'auc': 0.467010498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 7 9 9 8 6 6 7 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 9 6 5 6 6 9 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1551.1270, std=2335.9790
[DEBUG][MIA] Test Set Loss:   mean=1595.1881, std=2499.2832
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.092, 'auc': 0.48484800000000006, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 10, 11, 10, 14, 11, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=184.2929, std=327.2440
[DEBUG][MIA] Test Set Loss:   mean=238.5732, std=361.3046
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.11764705882352941, 'auc': 0.479949951171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 13 13 11 12 11 12 10 13 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 13 10 12 10 12 12 12 13 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=188.4370, std=320.9885
[DEBUG][MIA] Test Set Loss:   mean=211.3566, std=369.2267
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.094, 'auc': 0.52164, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 19, 19, 18, 15, 19, 18, 19, 15, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=953.1005, std=1438.8536
[DEBUG][MIA] Test Set Loss:   mean=911.5531, std=1317.4988
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.478759765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 16 17 17 17 16 17 17 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 15 19 16 15 17 16 17 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=914.8682, std=1355.0613
[DEBUG][MIA] Test Set Loss:   mean=834.7943, std=1204.4626
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.092, 'auc': 0.52652, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 21, 24, 20, 20, 21, 21, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=646.0850, std=1090.6107
[DEBUG][MIA] Test Set Loss:   mean=558.8840, std=909.5247
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10980392156862746, 'auc': 0.474578857421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 23 22 20 22 22 22 22 21 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 24 23 21 21 24 24 24 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=485.7177, std=882.3162
[DEBUG][MIA] Test Set Loss:   mean=649.5666, std=1063.9540
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.086, 'auc': 0.560272, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 25, 28, 25, 28, 27, 29, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=134.2353, std=219.1377
[DEBUG][MIA] Test Set Loss:   mean=148.9729, std=238.8708
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.499725341796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 25 29 28 26 26 27 27 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 28 27 26 28 29 27 28 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=120.3543, std=199.6124
[DEBUG][MIA] Test Set Loss:   mean=121.8987, std=199.1302
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.4896400000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 30, 31, 34, 30, 30, 30, 34, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=237.3457, std=404.4419
[DEBUG][MIA] Test Set Loss:   mean=302.2068, std=556.4048
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.541015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 34 33 33 30 32 31 32 33 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 33 30 32 30 30 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=289.9335, std=522.4467
[DEBUG][MIA] Test Set Loss:   mean=327.0089, std=568.4130
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.086, 'auc': 0.509648, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 38, 36, 36, 38, 39, 37, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=443.7115, std=687.6878
[DEBUG][MIA] Test Set Loss:   mean=373.9521, std=438.8438
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.11372549019607843, 'auc': 0.5372314453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 37 35 37 37 35 36 35 35 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 38 35 35 37 38 38 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=428.0342, std=606.5383
[DEBUG][MIA] Test Set Loss:   mean=416.4841, std=493.6682
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.094, 'auc': 0.49659999999999993, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 43, 42, 44, 42, 41, 42, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=572.4601, std=785.6785
[DEBUG][MIA] Test Set Loss:   mean=495.2166, std=672.1724
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.483612060546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 43 40 40 42 41 42 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 42 42 43 43 40 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=608.6254, std=797.1364
[DEBUG][MIA] Test Set Loss:   mean=543.2476, std=722.8564
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.09, 'auc': 0.49812, 'task': 8}
Total correct retain:  623  Total retain:  2500
Total correct forget:  10064  Total forget:  47500
Total correct test:  121  Total test:  500
Total correct forget test:  2015  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.242, 0.216, 0.246, 0.222, 0.252, 0.226, 0.2, 0.2, 0.2, 0.2, 0.2, 0.188, 0.23, 0.146, 0.186, 0.208, 0.25, 0.23, 0.164, 0.266]
Number of constraint violations:  64
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: ALT-NEGGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 15:10:55 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 44%   62C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['sea', 'cockroach', 'telephone', 'plain', 'boy', 'pears', 'skunk', 'willow', 'girl', 'leopard', 'bowls', 'spider', 'camel', 'mountain', 'lizard', 'bear', 'lamp', 'table', 'wardrobe', 'forest', 'dinosaur', 'wolf', 'shrew', 'pickup truck', 'television', 'oranges', 'palm', 'butterfly', 'pine', 'bee', 'house', 'turtle', 'sunflowers', 'chimpanzee', 'computer keyboard', 'trout', 'cans', 'beetle', 'elephant', 'orchids', 'poppies', 'clock', 'tulips', 'mouse', 'crocodile', 'tank', 'bridge', 'bus', 'crab', 'porcupine', 'tractor', 'whale', 'oak', 'cloud', 'mushrooms', 'possum', 'train', 'couch', 'tiger', 'castle', 'maple', 'man', 'bed', 'cups', 'apples', 'bicycle', 'fox', 'cattle', 'aquarium fish', 'woman', 'lobster', 'lion', 'beaver', 'skyscraper', 'seal', 'raccoon', 'worm', 'flatfish', 'kangaroo', 'ray', 'shark', 'snake', 'rabbit', 'snail', 'hamster', 'rocket', 'streetcar', 'lawn-mower', 'sweet peppers', 'dolphin', 'baby', 'otter', 'motorcycle', 'caterpillar', 'squirrel', 'bottles', 'roses', 'plates', 'road', 'chair']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2253  Total retain:  2500
Total correct forget:  9638  Total forget:  47500
Total correct test:  390  Total test:  500
Total correct forget test:  1904  Total test forget:  9500
After learning task 1
Task accuracies: [0.78, 0.204, 0.22, 0.164, 0.2, 0.224, 0.198, 0.176, 0.198, 0.25, 0.25, 0.158, 0.2, 0.206, 0.204, 0.158, 0.178, 0.216, 0.204, 0.2]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1645, std=0.8178
[DEBUG][MIA] Test Set Loss:   mean=0.9351, std=2.0749
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.22745098039215686, 'auc': 0.617889404296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0907, std=0.4097
[DEBUG][MIA] Test Set Loss:   mean=0.9714, std=2.2331
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.194, 'auc': 0.60976, 'task': 1}
2 1
Total correct retain:  1992  Total retain:  2500
Total correct forget:  11470  Total forget:  47500
Total correct test:  366  Total test:  500
Total correct forget test:  2209  Total test forget:  9500
After learning task 2
Task accuracies: [0.732, 0.796, 0.242, 0.218, 0.19, 0.248, 0.178, 0.186, 0.318, 0.264, 0.202, 0.108, 0.08, 0.198, 0.236, 0.15, 0.254, 0.194, 0.174, 0.182]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0245, std=0.0694
[DEBUG][MIA] Test Set Loss:   mean=1.2457, std=2.6480
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2784313725490196, 'auc': 0.70245361328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7546, std=1.6289
[DEBUG][MIA] Test Set Loss:   mean=1.3003, std=2.4029
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.158, 'auc': 0.546384, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0218, std=0.1101
[DEBUG][MIA] Test Set Loss:   mean=1.6923, std=3.4777
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.25882352941176473, 'auc': 0.73980712890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0317, std=0.1878
[DEBUG][MIA] Test Set Loss:   mean=1.2087, std=2.4500
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.658, 'cv_acc': 0.254, 'auc': 0.7089840000000001, 'task': 2}
3 2
Total correct retain:  1938  Total retain:  2500
Total correct forget:  13533  Total forget:  47500
Total correct test:  360  Total test:  500
Total correct forget test:  2492  Total test forget:  9500
After learning task 3
Task accuracies: [0.72, 0.674, 0.706, 0.216, 0.148, 0.19, 0.194, 0.226, 0.188, 0.294, 0.318, 0.248, 0.068, 0.188, 0.244, 0.252, 0.258, 0.172, 0.188, 0.212]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.3952, std=2.4344
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7215686274509804, 'auc': 0.88165283203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9602, std=2.1526
[DEBUG][MIA] Test Set Loss:   mean=1.6941, std=3.1627
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.13799999999999998, 'auc': 0.592368, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=1.9117, std=3.4966
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7019607843137254, 'auc': 0.787506103515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6054, std=1.6156
[DEBUG][MIA] Test Set Loss:   mean=1.7701, std=2.9971
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.188, 'auc': 0.62076, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0224, std=0.1366
[DEBUG][MIA] Test Set Loss:   mean=1.2996, std=2.5196
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.25490196078431376, 'auc': 0.7298583984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0173, std=0.2280
[DEBUG][MIA] Test Set Loss:   mean=1.0967, std=2.2951
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.676, 'cv_acc': 0.284, 'auc': 0.7408319999999999, 'task': 3}
4 3
Total correct retain:  1883  Total retain:  2500
Total correct forget:  14376  Total forget:  47500
Total correct test:  355  Total test:  500
Total correct forget test:  2573  Total test forget:  9500
After learning task 4
Task accuracies: [0.71, 0.68, 0.64, 0.736, 0.15, 0.152, 0.148, 0.178, 0.188, 0.3, 0.27, 0.168, 0.078, 0.208, 0.214, 0.26, 0.184, 0.188, 0.188, 0.216]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0129, std=0.1257
[DEBUG][MIA] Test Set Loss:   mean=2.2156, std=3.5209
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2980392156862745, 'auc': 0.8397216796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1854, std=2.4070
[DEBUG][MIA] Test Set Loss:   mean=1.8075, std=3.1357
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.144, 'auc': 0.566936, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.2989, std=3.4510
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.6980392156862745, 'auc': 0.87042236328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7612, std=1.8430
[DEBUG][MIA] Test Set Loss:   mean=1.5501, std=2.7119
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.20800000000000002, 'auc': 0.632536, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0130
[DEBUG][MIA] Test Set Loss:   mean=1.1122, std=2.2275
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.39607843137254906, 'auc': 0.76129150390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3979, std=1.3493
[DEBUG][MIA] Test Set Loss:   mean=1.6879, std=2.8605
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.176, 'auc': 0.673872, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0678, std=0.5166
[DEBUG][MIA] Test Set Loss:   mean=1.3590, std=2.9475
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.24705882352941178, 'auc': 0.698760986328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0240, std=0.1802
[DEBUG][MIA] Test Set Loss:   mean=1.0813, std=2.6701
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.22399999999999998, 'auc': 0.6758559999999999, 'task': 4}
5 4
Total correct retain:  1877  Total retain:  2500
Total correct forget:  16024  Total forget:  47500
Total correct test:  360  Total test:  500
Total correct forget test:  2846  Total test forget:  9500
After learning task 5
Task accuracies: [0.72, 0.618, 0.632, 0.654, 0.786, 0.236, 0.158, 0.178, 0.214, 0.322, 0.216, 0.19, 0.1, 0.202, 0.23, 0.214, 0.236, 0.152, 0.142, 0.212]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.3419, std=2.8242
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.28627450980392155, 'auc': 0.79241943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0577, std=2.3622
[DEBUG][MIA] Test Set Loss:   mean=1.7571, std=3.0834
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.1, 'auc': 0.620264, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.8260, std=3.2880
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7137254901960784, 'auc': 0.799835205078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9935, std=2.1017
[DEBUG][MIA] Test Set Loss:   mean=1.9254, std=3.3365
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.13800000000000004, 'auc': 0.6070639999999999, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.5131, std=2.8689
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6196078431372548, 'auc': 0.848602294921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8954, std=1.9564
[DEBUG][MIA] Test Set Loss:   mean=1.8881, std=3.0983
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.16999999999999998, 'auc': 0.616768, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0087, std=0.0297
[DEBUG][MIA] Test Set Loss:   mean=1.3917, std=2.9273
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2980392156862745, 'auc': 0.7496337890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3713, std=1.1053
[DEBUG][MIA] Test Set Loss:   mean=1.6225, std=2.9688
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.188, 'auc': 0.639608, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0138, std=0.1126
[DEBUG][MIA] Test Set Loss:   mean=0.7051, std=1.9171
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.25882352941176473, 'auc': 0.735260009765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0284
[DEBUG][MIA] Test Set Loss:   mean=0.9064, std=2.1806
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.656, 'cv_acc': 0.246, 'auc': 0.714168, 'task': 5}
6 5
Total correct retain:  1842  Total retain:  2500
Total correct forget:  17533  Total forget:  47500
Total correct test:  339  Total test:  500
Total correct forget test:  3096  Total test forget:  9500
After learning task 6
Task accuracies: [0.678, 0.654, 0.608, 0.644, 0.688, 0.79, 0.192, 0.144, 0.198, 0.246, 0.294, 0.184, 0.094, 0.206, 0.284, 0.204, 0.21, 0.186, 0.176, 0.19]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.2323, std=3.6751
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7450980392156863, 'auc': 0.83026123046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4609, std=2.5745
[DEBUG][MIA] Test Set Loss:   mean=1.6720, std=3.0384
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.15799999999999997, 'auc': 0.5586720000000001, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=2.2820, std=3.8119
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7215686274509804, 'auc': 0.830352783203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4639, std=2.7281
[DEBUG][MIA] Test Set Loss:   mean=1.7364, std=3.0920
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.17800000000000002, 'auc': 0.531912, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=2.0276, std=3.4736
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7411764705882353, 'auc': 0.845428466796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0706, std=2.4588
[DEBUG][MIA] Test Set Loss:   mean=2.1535, std=3.8758
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.15, 'auc': 0.6038239999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0316
[DEBUG][MIA] Test Set Loss:   mean=1.9090, std=3.2810
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2784313725490196, 'auc': 0.74188232421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6203, std=1.9819
[DEBUG][MIA] Test Set Loss:   mean=1.7629, std=3.1056
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.21599999999999997, 'auc': 0.6474880000000001, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.3942, std=2.6344
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2745098039215686, 'auc': 0.81610107421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2372, std=0.9027
[DEBUG][MIA] Test Set Loss:   mean=1.4235, std=2.5517
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.22800000000000004, 'auc': 0.678536, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0197
[DEBUG][MIA] Test Set Loss:   mean=1.0060, std=2.7685
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.203921568627451, 'auc': 0.637451171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0172, std=0.1909
[DEBUG][MIA] Test Set Loss:   mean=0.6920, std=1.9766
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.20800000000000002, 'auc': 0.630336, 'task': 6}
7 6
Total correct retain:  1821  Total retain:  2500
Total correct forget:  18988  Total forget:  47500
Total correct test:  334  Total test:  500
Total correct forget test:  3274  Total test forget:  9500
After learning task 7
Task accuracies: [0.668, 0.658, 0.61, 0.668, 0.674, 0.676, 0.83, 0.152, 0.194, 0.226, 0.266, 0.14, 0.1, 0.212, 0.224, 0.19, 0.212, 0.164, 0.14, 0.212]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.6214, std=3.0744
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2705882352941177, 'auc': 0.806243896484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4023, std=2.8018
[DEBUG][MIA] Test Set Loss:   mean=1.6743, std=3.0287
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.134, 'auc': 0.5587679999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.0264, std=3.8985
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7333333333333334, 'auc': 0.837677001953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5401, std=2.9172
[DEBUG][MIA] Test Set Loss:   mean=1.7728, std=3.2724
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.146, 'auc': 0.532544, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0106
[DEBUG][MIA] Test Set Loss:   mean=2.5211, std=4.2446
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7215686274509804, 'auc': 0.792449951171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4378, std=2.9696
[DEBUG][MIA] Test Set Loss:   mean=2.4449, std=4.0263
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.13399999999999998, 'auc': 0.5890639999999999, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0324
[DEBUG][MIA] Test Set Loss:   mean=1.5207, std=3.1449
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.6666666666666666, 'auc': 0.68682861328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5586, std=1.3745
[DEBUG][MIA] Test Set Loss:   mean=1.8547, std=3.5620
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.176, 'auc': 0.602608, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.6683, std=2.7640
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7058823529411765, 'auc': 0.836212158203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5872, std=1.5473
[DEBUG][MIA] Test Set Loss:   mean=1.4875, std=2.6302
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.192, 'auc': 0.618352, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.0921, std=2.2953
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2431372549019608, 'auc': 0.741485595703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3015, std=0.9239
[DEBUG][MIA] Test Set Loss:   mean=0.8844, std=2.0486
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.192, 'auc': 0.600728, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0167
[DEBUG][MIA] Test Set Loss:   mean=1.2232, std=3.1457
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.21176470588235294, 'auc': 0.652191162109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0322
[DEBUG][MIA] Test Set Loss:   mean=0.6793, std=1.9759
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.21600000000000003, 'auc': 0.69404, 'task': 7}
8 7
Total correct retain:  1909  Total retain:  2500
Total correct forget:  20316  Total forget:  47500
Total correct test:  349  Total test:  500
Total correct forget test:  3531  Total test forget:  9500
After learning task 8
Task accuracies: [0.698, 0.664, 0.64, 0.614, 0.642, 0.652, 0.756, 0.808, 0.164, 0.266, 0.23, 0.168, 0.116, 0.198, 0.22, 0.154, 0.224, 0.174, 0.182, 0.19]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.1498, std=3.6134
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7411764705882353, 'auc': 0.82928466796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5251, std=2.9863
[DEBUG][MIA] Test Set Loss:   mean=1.7532, std=3.2003
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.132, 'auc': 0.554552, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.8510, std=3.5358
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7254901960784315, 'auc': 0.819915771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7299, std=3.4005
[DEBUG][MIA] Test Set Loss:   mean=1.9130, std=3.2569
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.146, 'auc': 0.561936, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=2.2194, std=3.6215
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7137254901960783, 'auc': 0.81768798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4771, std=2.8310
[DEBUG][MIA] Test Set Loss:   mean=2.2532, std=3.5017
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11200000000000002, 'auc': 0.5644, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0412
[DEBUG][MIA] Test Set Loss:   mean=2.2821, std=3.9878
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6588235294117647, 'auc': 0.785400390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0199, std=2.2931
[DEBUG][MIA] Test Set Loss:   mean=2.0085, std=3.5880
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.12200000000000003, 'auc': 0.586664, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=1.6817, std=2.7059
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.30196078431372547, 'auc': 0.8316650390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5694, std=1.3628
[DEBUG][MIA] Test Set Loss:   mean=1.6352, std=2.8207
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.194, 'auc': 0.600176, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.3387, std=2.5054
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.28627450980392155, 'auc': 0.781524658203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5362, std=1.3601
[DEBUG][MIA] Test Set Loss:   mean=1.2284, std=2.4871
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11600000000000002, 'auc': 0.5936079999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=0.9765, std=2.4399
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.26666666666666666, 'auc': 0.7606201171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2713, std=0.9932
[DEBUG][MIA] Test Set Loss:   mean=1.1283, std=2.3409
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.176, 'auc': 0.6244080000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0739, std=0.5014
[DEBUG][MIA] Test Set Loss:   mean=1.1689, std=2.4825
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.22745098039215686, 'auc': 0.747528076171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0160, std=0.1347
[DEBUG][MIA] Test Set Loss:   mean=1.7873, std=3.4523
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.664, 'cv_acc': 0.22599999999999998, 'auc': 0.76868, 'task': 8}
Total correct retain:  1821  Total retain:  2500
Total correct forget:  21528  Total forget:  47500
Total correct test:  332  Total test:  500
Total correct forget test:  3761  Total test forget:  9500
After learning task 9
Task accuracies: [0.664, 0.652, 0.63, 0.594, 0.64, 0.64, 0.71, 0.758, 0.724, 0.25, 0.24, 0.172, 0.16, 0.196, 0.216, 0.172, 0.174, 0.202, 0.182, 0.21]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.6767, std=3.3845
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.7137254901960783, 'auc': 0.881622314453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3156, std=2.6674
[DEBUG][MIA] Test Set Loss:   mean=1.9542, std=3.4196
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11600000000000002, 'auc': 0.5882000000000001, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.0843, std=3.9502
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7333333333333334, 'auc': 0.823822021484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6923, std=3.4745
[DEBUG][MIA] Test Set Loss:   mean=2.3038, std=4.0640
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.16599999999999998, 'auc': 0.583736, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0090, std=0.0780
[DEBUG][MIA] Test Set Loss:   mean=2.2356, std=3.7068
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2980392156862745, 'auc': 0.79803466796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0481, std=3.8577
[DEBUG][MIA] Test Set Loss:   mean=2.4036, std=3.9871
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.12600000000000003, 'auc': 0.527296, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=2.2876, std=4.0576
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.24705882352941178, 'auc': 0.8359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7476, std=2.0004
[DEBUG][MIA] Test Set Loss:   mean=1.4067, std=2.8490
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.134, 'auc': 0.561088, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0123
[DEBUG][MIA] Test Set Loss:   mean=1.8040, std=3.0660
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6470588235294118, 'auc': 0.805877685546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1213, std=2.3914
[DEBUG][MIA] Test Set Loss:   mean=2.1679, std=3.2748
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.13999999999999999, 'auc': 0.591608, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0071
[DEBUG][MIA] Test Set Loss:   mean=1.9413, std=3.5215
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.3098039215686274, 'auc': 0.741607666015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1323, std=2.7066
[DEBUG][MIA] Test Set Loss:   mean=1.2965, std=2.5060
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.13399999999999998, 'auc': 0.540096, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=0.9214, std=1.9512
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2823529411764706, 'auc': 0.783538818359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6149, std=1.5066
[DEBUG][MIA] Test Set Loss:   mean=1.0861, std=2.3385
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.182, 'auc': 0.580856, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0947, std=0.4719
[DEBUG][MIA] Test Set Loss:   mean=2.7952, std=4.0787
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6745098039215686, 'auc': 0.74591064453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7492, std=1.8103
[DEBUG][MIA] Test Set Loss:   mean=2.3107, std=3.8853
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.202, 'auc': 0.603112, 'task': 8}
Total correct retain:  1833  Total retain:  2500
Total correct forget:  22945  Total forget:  47500
Total correct test:  345  Total test:  500
Total correct forget test:  4028  Total test forget:  9500
After learning task 10
Task accuracies: [0.69, 0.616, 0.612, 0.594, 0.704, 0.616, 0.684, 0.726, 0.628, 0.734, 0.274, 0.188, 0.144, 0.214, 0.26, 0.222, 0.178, 0.182, 0.182, 0.298]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0075
[DEBUG][MIA] Test Set Loss:   mean=1.9145, std=2.9218
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2823529411764706, 'auc': 0.86151123046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6747, std=3.6228
[DEBUG][MIA] Test Set Loss:   mean=1.8973, std=3.1755
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11400000000000002, 'auc': 0.585176, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.1463, std=4.0082
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.30196078431372547, 'auc': 0.8525390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2763, std=2.7756
[DEBUG][MIA] Test Set Loss:   mean=2.1115, std=3.8967
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11800000000000002, 'auc': 0.5755999999999999, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0140, std=0.0577
[DEBUG][MIA] Test Set Loss:   mean=2.3190, std=3.6993
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6980392156862745, 'auc': 0.793426513671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1458, std=3.8357
[DEBUG][MIA] Test Set Loss:   mean=2.5446, std=4.0944
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.552232, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.7392, std=3.4937
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.25882352941176473, 'auc': 0.812408447265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9525, std=2.3512
[DEBUG][MIA] Test Set Loss:   mean=1.5514, std=2.9240
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.15, 'auc': 0.584768, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0093, std=0.0386
[DEBUG][MIA] Test Set Loss:   mean=2.2890, std=3.8738
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2941176470588235, 'auc': 0.74713134765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3080, std=2.7171
[DEBUG][MIA] Test Set Loss:   mean=2.2246, std=3.8227
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.11000000000000001, 'auc': 0.571048, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.6567, std=3.3224
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2784313725490196, 'auc': 0.80999755859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0817, std=2.3674
[DEBUG][MIA] Test Set Loss:   mean=1.3296, std=2.6245
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.13600000000000004, 'auc': 0.518024, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0385
[DEBUG][MIA] Test Set Loss:   mean=1.0001, std=2.3433
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2666666666666667, 'auc': 0.782135009765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7676, std=1.7391
[DEBUG][MIA] Test Set Loss:   mean=1.6845, std=3.1214
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12400000000000003, 'auc': 0.552816, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1083, std=0.4497
[DEBUG][MIA] Test Set Loss:   mean=3.0179, std=4.8852
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2980392156862745, 'auc': 0.723968505859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4765, std=3.1084
[DEBUG][MIA] Test Set Loss:   mean=2.3423, std=4.0013
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.22400000000000003, 'auc': 0.557248, 'task': 8}
Total correct retain:  1892  Total retain:  2500
Total correct forget:  24396  Total forget:  47500
Total correct test:  368  Total test:  500
Total correct forget test:  4285  Total test forget:  9500
After learning task 11
Task accuracies: [0.736, 0.63, 0.63, 0.568, 0.72, 0.628, 0.698, 0.724, 0.604, 0.678, 0.878, 0.2, 0.158, 0.2, 0.266, 0.206, 0.14, 0.184, 0.19, 0.268]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2192, std=0.8598
[DEBUG][MIA] Test Set Loss:   mean=2.3498, std=3.6222
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6274509803921569, 'auc': 0.75628662109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4652, std=4.3025
[DEBUG][MIA] Test Set Loss:   mean=2.6342, std=4.3153
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.1, 'auc': 0.47389600000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=2.6054, std=4.5160
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2431372549019608, 'auc': 0.860748291015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7602, std=3.6984
[DEBUG][MIA] Test Set Loss:   mean=2.4120, std=4.2330
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.126, 'auc': 0.561488, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7992, std=2.3995
[DEBUG][MIA] Test Set Loss:   mean=4.1892, std=6.4449
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2784313725490196, 'auc': 0.71038818359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0009, std=5.8301
[DEBUG][MIA] Test Set Loss:   mean=4.4085, std=6.3581
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.096, 'auc': 0.48304800000000003, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0193
[DEBUG][MIA] Test Set Loss:   mean=1.3382, std=2.7851
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2941176470588235, 'auc': 0.73138427734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6835, std=2.0780
[DEBUG][MIA] Test Set Loss:   mean=1.8031, std=3.4407
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.10200000000000001, 'auc': 0.6190559999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2305, std=0.8894
[DEBUG][MIA] Test Set Loss:   mean=3.0013, std=4.5190
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.25882352941176473, 'auc': 0.7467041015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9938, std=4.0516
[DEBUG][MIA] Test Set Loss:   mean=2.7109, std=4.2503
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.128, 'auc': 0.582152, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2421, std=0.9000
[DEBUG][MIA] Test Set Loss:   mean=2.1967, std=4.0846
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2666666666666667, 'auc': 0.6934814453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.0041, std=3.7028
[DEBUG][MIA] Test Set Loss:   mean=1.7271, std=3.6649
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.12000000000000002, 'auc': 0.49273599999999995, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1323, std=0.6864
[DEBUG][MIA] Test Set Loss:   mean=2.2182, std=3.4888
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2627450980392157, 'auc': 0.777587890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2715, std=2.8081
[DEBUG][MIA] Test Set Loss:   mean=2.3882, std=3.8570
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.11600000000000002, 'auc': 0.593096, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7922, std=2.3404
[DEBUG][MIA] Test Set Loss:   mean=3.5481, std=5.5659
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2823529411764706, 'auc': 0.64141845703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8591, std=3.8483
[DEBUG][MIA] Test Set Loss:   mean=3.6851, std=5.4900
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.20200000000000004, 'auc': 0.588072, 'task': 8}
Total correct retain:  1877  Total retain:  2500
Total correct forget:  21817  Total forget:  47500
Total correct test:  361  Total test:  500
Total correct forget test:  3821  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.722, 0.586, 0.618, 0.52, 0.698, 0.576, 0.642, 0.664, 0.54, 0.64, 0.362, 0.162, 0.158, 0.196, 0.294, 0.194, 0.196, 0.156, 0.194, 0.246]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7445, std=2.3069
[DEBUG][MIA] Test Set Loss:   mean=2.5756, std=4.3598
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.20784313725490197, 'auc': 0.678436279296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4198, std=4.4120
[DEBUG][MIA] Test Set Loss:   mean=2.9180, std=4.8609
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11200000000000002, 'auc': 0.5513440000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6854, std=1.8463
[DEBUG][MIA] Test Set Loss:   mean=3.0688, std=4.9819
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.3882352941176471, 'auc': 0.6710205078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2366, std=3.5934
[DEBUG][MIA] Test Set Loss:   mean=2.7728, std=4.2204
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.528952, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0486, std=2.4438
[DEBUG][MIA] Test Set Loss:   mean=3.7427, std=6.1207
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.27450980392156865, 'auc': 0.665771484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2966, std=5.1442
[DEBUG][MIA] Test Set Loss:   mean=4.3264, std=6.3131
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11200000000000002, 'auc': 0.551048, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1084, std=4.2109
[DEBUG][MIA] Test Set Loss:   mean=2.6627, std=4.8354
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.1843137254901961, 'auc': 0.56072998046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1455, std=5.4048
[DEBUG][MIA] Test Set Loss:   mean=3.6633, std=5.9789
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.092, 'auc': 0.5350159999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6207, std=1.5359
[DEBUG][MIA] Test Set Loss:   mean=2.4212, std=4.1557
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.20784313725490197, 'auc': 0.638519287109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1925, std=3.9633
[DEBUG][MIA] Test Set Loss:   mean=2.9740, std=4.5765
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.08399999999999999, 'auc': 0.566232, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8750, std=2.2066
[DEBUG][MIA] Test Set Loss:   mean=1.3233, std=2.5833
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.2274509803921569, 'auc': 0.57501220703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4896, std=4.2621
[DEBUG][MIA] Test Set Loss:   mean=2.5100, std=4.5564
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10400000000000001, 'auc': 0.4858320000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4640, std=3.2704
[DEBUG][MIA] Test Set Loss:   mean=3.0992, std=4.9252
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.19607843137254902, 'auc': 0.66192626953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8286, std=5.3546
[DEBUG][MIA] Test Set Loss:   mean=3.5964, std=5.4762
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.592392, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7134, std=2.0542
[DEBUG][MIA] Test Set Loss:   mean=2.1454, std=3.9714
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.21960784313725493, 'auc': 0.652069091796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8430, std=3.8294
[DEBUG][MIA] Test Set Loss:   mean=2.7792, std=4.5878
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.192, 'auc': 0.562744, 'task': 8}
Total correct retain:  1586  Total retain:  2500
Total correct forget:  18625  Total forget:  47500
Total correct test:  304  Total test:  500
Total correct forget test:  3416  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.608, 0.574, 0.552, 0.46, 0.558, 0.544, 0.612, 0.518, 0.568, 0.294, 0.228, 0.172, 0.18, 0.196, 0.342, 0.168, 0.316, 0.188, 0.184, 0.178]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4321, std=4.0880
[DEBUG][MIA] Test Set Loss:   mean=3.9462, std=5.4278
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.23137254901960785, 'auc': 0.580474853515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.7234, std=5.2071
[DEBUG][MIA] Test Set Loss:   mean=4.1400, std=5.4294
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.533072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2628, std=2.4997
[DEBUG][MIA] Test Set Loss:   mean=3.5523, std=4.2926
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.21960784313725493, 'auc': 0.6722412109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1479, std=4.8551
[DEBUG][MIA] Test Set Loss:   mean=2.9978, std=4.2137
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.13799999999999998, 'auc': 0.503312, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9714, std=2.7237
[DEBUG][MIA] Test Set Loss:   mean=4.4326, std=5.9628
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.23921568627450984, 'auc': 0.71331787109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.8841, std=5.8956
[DEBUG][MIA] Test Set Loss:   mean=3.9051, std=5.5462
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10600000000000001, 'auc': 0.5213760000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3393, std=4.3527
[DEBUG][MIA] Test Set Loss:   mean=4.7657, std=6.4118
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.14901960784313725, 'auc': 0.600799560546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7531, std=5.7291
[DEBUG][MIA] Test Set Loss:   mean=3.7801, std=5.6005
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11800000000000002, 'auc': 0.497056, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5174, std=3.0441
[DEBUG][MIA] Test Set Loss:   mean=2.2704, std=4.3934
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.17647058823529413, 'auc': 0.591888427734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4860, std=3.9790
[DEBUG][MIA] Test Set Loss:   mean=2.8580, std=4.6277
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.128, 'auc': 0.509544, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0213, std=2.0229
[DEBUG][MIA] Test Set Loss:   mean=2.2294, std=3.2368
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.16470588235294117, 'auc': 0.614501953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9485, std=3.1149
[DEBUG][MIA] Test Set Loss:   mean=2.2959, std=3.2937
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.086, 'auc': 0.44501599999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8781, std=3.1565
[DEBUG][MIA] Test Set Loss:   mean=2.7495, std=3.9946
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.2, 'auc': 0.547210693359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.9891, std=4.1239
[DEBUG][MIA] Test Set Loss:   mean=3.0777, std=4.3449
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.496616, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=51.9679, std=56.6244
[DEBUG][MIA] Test Set Loss:   mean=46.5148, std=54.5997
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11372549019607843, 'auc': 0.467315673828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=47.5279, std=54.0512
[DEBUG][MIA] Test Set Loss:   mean=45.7356, std=55.8849
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11800000000000002, 'auc': 0.470312, 'task': 8}
Total correct retain:  1232  Total retain:  2500
Total correct forget:  16123  Total forget:  47500
Total correct test:  240  Total test:  500
Total correct forget test:  3102  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.48, 0.49, 0.484, 0.48, 0.518, 0.532, 0.53, 0.5, 0.284, 0.314, 0.21, 0.166, 0.178, 0.222, 0.31, 0.15, 0.254, 0.202, 0.196, 0.184]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2726, std=2.7462
[DEBUG][MIA] Test Set Loss:   mean=2.4612, std=3.9509
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.2549019607843137, 'auc': 0.639495849609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2655, std=4.3610
[DEBUG][MIA] Test Set Loss:   mean=2.4978, std=3.8643
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.10600000000000001, 'auc': 0.44600799999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6895, std=1.5115
[DEBUG][MIA] Test Set Loss:   mean=2.3831, std=3.7129
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.24313725490196075, 'auc': 0.643096923828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9151, std=3.2352
[DEBUG][MIA] Test Set Loss:   mean=2.2121, std=3.3520
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.539168, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9764, std=2.2070
[DEBUG][MIA] Test Set Loss:   mean=3.6127, std=4.9494
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.27450980392156865, 'auc': 0.6689453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.1184, std=4.4657
[DEBUG][MIA] Test Set Loss:   mean=3.7781, std=4.9149
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.096, 'auc': 0.545168, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9102, std=2.0021
[DEBUG][MIA] Test Set Loss:   mean=3.2397, std=4.7106
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.1607843137254902, 'auc': 0.63641357421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4711, std=3.7953
[DEBUG][MIA] Test Set Loss:   mean=3.0508, std=4.9467
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11400000000000002, 'auc': 0.518, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5716, std=1.4095
[DEBUG][MIA] Test Set Loss:   mean=2.2262, std=4.1657
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.25098039215686274, 'auc': 0.645660400390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5655, std=2.6743
[DEBUG][MIA] Test Set Loss:   mean=2.1480, std=3.3945
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.144, 'auc': 0.5464800000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0504, std=2.3487
[DEBUG][MIA] Test Set Loss:   mean=2.6699, std=4.0393
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.18039215686274512, 'auc': 0.637176513671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.2433, std=4.7542
[DEBUG][MIA] Test Set Loss:   mean=2.9125, std=4.4971
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10600000000000001, 'auc': 0.482312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.4215, std=13.8253
[DEBUG][MIA] Test Set Loss:   mean=14.8875, std=15.4137
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.14509803921568626, 'auc': 0.56597900390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=15.4990, std=17.1357
[DEBUG][MIA] Test Set Loss:   mean=16.0380, std=17.8653
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.5018159999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=43.3550, std=50.4754
[DEBUG][MIA] Test Set Loss:   mean=42.2914, std=48.1545
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.11764705882352941, 'auc': 0.49774169921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=40.2009, std=47.7021
[DEBUG][MIA] Test Set Loss:   mean=45.0562, std=49.5399
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.10400000000000001, 'auc': 0.4796, 'task': 8}
Total correct retain:  1358  Total retain:  2500
Total correct forget:  16237  Total forget:  47500
Total correct test:  264  Total test:  500
Total correct forget test:  3083  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.528, 0.548, 0.564, 0.47, 0.55, 0.56, 0.584, 0.278, 0.29, 0.332, 0.2, 0.17, 0.108, 0.224, 0.33, 0.126, 0.262, 0.182, 0.192, 0.196]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1692, std=0.6816
[DEBUG][MIA] Test Set Loss:   mean=1.9620, std=3.3863
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.40784313725490196, 'auc': 0.734466552734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6482, std=3.1442
[DEBUG][MIA] Test Set Loss:   mean=1.9287, std=3.1353
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.088, 'auc': 0.46733600000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.2840, std=0.9081
[DEBUG][MIA] Test Set Loss:   mean=2.1677, std=3.1925
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.27450980392156865, 'auc': 0.740692138671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7413, std=2.8346
[DEBUG][MIA] Test Set Loss:   mean=2.2343, std=3.3798
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11200000000000002, 'auc': 0.572288, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5762, std=1.3411
[DEBUG][MIA] Test Set Loss:   mean=3.8537, std=5.4959
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.6156862745098038, 'auc': 0.713958740234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8740, std=4.5784
[DEBUG][MIA] Test Set Loss:   mean=3.7275, std=4.9213
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11400000000000002, 'auc': 0.548344, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6265, std=1.7256
[DEBUG][MIA] Test Set Loss:   mean=2.5033, std=3.7574
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.23137254901960783, 'auc': 0.6903076171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0585, std=3.5923
[DEBUG][MIA] Test Set Loss:   mean=2.7042, std=4.3698
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.52452, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4792, std=1.5852
[DEBUG][MIA] Test Set Loss:   mean=1.9505, std=3.2832
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.6352941176470588, 'auc': 0.71563720703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4701, std=2.6732
[DEBUG][MIA] Test Set Loss:   mean=1.7768, std=3.3370
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10800000000000001, 'auc': 0.528968, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.3118, std=8.2751
[DEBUG][MIA] Test Set Loss:   mean=8.6021, std=10.1407
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.11372549019607843, 'auc': 0.576446533203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.5900, std=10.2654
[DEBUG][MIA] Test Set Loss:   mean=8.4866, std=10.6845
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10800000000000001, 'auc': 0.512544, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.2243, std=14.4339
[DEBUG][MIA] Test Set Loss:   mean=15.6549, std=18.5131
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10588235294117647, 'auc': 0.41705322265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.7367, std=14.9690
[DEBUG][MIA] Test Set Loss:   mean=12.2722, std=16.0405
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11399999999999999, 'auc': 0.5110480000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=31.4450, std=40.5946
[DEBUG][MIA] Test Set Loss:   mean=29.4888, std=38.6336
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.08627450980392157, 'auc': 0.486236572265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=33.8292, std=40.8746
[DEBUG][MIA] Test Set Loss:   mean=36.7146, std=46.2209
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.510608, 'task': 8}
Total correct retain:  1446  Total retain:  2500
Total correct forget:  16515  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  3128  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.594, 0.622, 0.582, 0.476, 0.56, 0.608, 0.336, 0.304, 0.292, 0.336, 0.2, 0.176, 0.154, 0.216, 0.36, 0.162, 0.234, 0.244, 0.196, 0.198]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4357, std=1.3343
[DEBUG][MIA] Test Set Loss:   mean=1.6804, std=2.5676
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2705882352941177, 'auc': 0.720062255859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2582, std=2.1734
[DEBUG][MIA] Test Set Loss:   mean=2.0009, std=3.1551
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.08, 'auc': 0.578504, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8622, std=1.8113
[DEBUG][MIA] Test Set Loss:   mean=2.4940, std=3.3996
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.24705882352941178, 'auc': 0.66375732421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1558, std=3.0346
[DEBUG][MIA] Test Set Loss:   mean=2.8675, std=3.6049
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11800000000000002, 'auc': 0.56604, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2190, std=1.8810
[DEBUG][MIA] Test Set Loss:   mean=3.1641, std=5.2333
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.1647058823529412, 'auc': 0.6138916015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5111, std=3.9623
[DEBUG][MIA] Test Set Loss:   mean=2.7636, std=3.8306
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.537656, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.9550, std=4.7598
[DEBUG][MIA] Test Set Loss:   mean=4.1473, std=4.8020
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.1764705882352941, 'auc': 0.6153564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.0969, std=4.5926
[DEBUG][MIA] Test Set Loss:   mean=3.0828, std=4.4052
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.118, 'auc': 0.52196, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=23.4231, std=33.0414
[DEBUG][MIA] Test Set Loss:   mean=22.5533, std=31.5810
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.487762451171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=19.4563, std=26.2630
[DEBUG][MIA] Test Set Loss:   mean=25.8609, std=33.6417
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.12999999999999998, 'auc': 0.458056, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.2310, std=5.3560
[DEBUG][MIA] Test Set Loss:   mean=6.9175, std=7.8179
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.1215686274509804, 'auc': 0.61474609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.8230, std=7.1653
[DEBUG][MIA] Test Set Loss:   mean=6.5421, std=6.9709
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.088, 'auc': 0.48448800000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.8461, std=7.5050
[DEBUG][MIA] Test Set Loss:   mean=6.7781, std=7.2747
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.1215686274509804, 'auc': 0.564117431640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.8020, std=8.7554
[DEBUG][MIA] Test Set Loss:   mean=7.0258, std=8.0883
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11399999999999999, 'auc': 0.516248, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=23.3469, std=40.5800
[DEBUG][MIA] Test Set Loss:   mean=29.6690, std=42.5741
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.08627450980392157, 'auc': 0.55517578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=26.9350, std=42.5113
[DEBUG][MIA] Test Set Loss:   mean=30.6004, std=44.0766
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.1, 'auc': 0.5353680000000001, 'task': 8}
Total correct retain:  1422  Total retain:  2500
Total correct forget:  14409  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2747  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.556, 0.562, 0.468, 0.484, 0.536, 0.322, 0.288, 0.294, 0.258, 0.23, 0.2, 0.254, 0.22, 0.22, 0.274, 0.198, 0.198, 0.178, 0.134, 0.176]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0582, std=2.4297
[DEBUG][MIA] Test Set Loss:   mean=2.5802, std=3.8418
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.26666666666666666, 'auc': 0.6376953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7533, std=3.0575
[DEBUG][MIA] Test Set Loss:   mean=2.6120, std=3.5769
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.09, 'auc': 0.5853119999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9658, std=2.4518
[DEBUG][MIA] Test Set Loss:   mean=3.5239, std=5.1645
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.20392156862745098, 'auc': 0.71099853515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4144, std=3.9365
[DEBUG][MIA] Test Set Loss:   mean=3.5498, std=4.8042
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10400000000000001, 'auc': 0.5982479999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8969, std=6.0913
[DEBUG][MIA] Test Set Loss:   mean=7.9068, std=10.7835
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.21176470588235294, 'auc': 0.687957763671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.7756, std=8.0912
[DEBUG][MIA] Test Set Loss:   mean=4.7964, std=7.6373
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.126, 'auc': 0.506736, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=25.3654, std=31.9682
[DEBUG][MIA] Test Set Loss:   mean=28.1240, std=34.1589
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.51739501953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=28.4837, std=33.8841
[DEBUG][MIA] Test Set Loss:   mean=28.0766, std=32.5651
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.49363199999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=40.6533, std=45.7504
[DEBUG][MIA] Test Set Loss:   mean=48.9593, std=50.7600
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.0784313725490196, 'auc': 0.46087646484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=44.7169, std=49.3475
[DEBUG][MIA] Test Set Loss:   mean=50.1771, std=49.5828
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10400000000000001, 'auc': 0.536816, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.9434, std=16.7849
[DEBUG][MIA] Test Set Loss:   mean=14.0401, std=16.3985
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.08235294117647059, 'auc': 0.50750732421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=16.6436, std=18.7868
[DEBUG][MIA] Test Set Loss:   mean=15.8369, std=17.1632
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08399999999999999, 'auc': 0.49804000000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=21.3066, std=25.7920
[DEBUG][MIA] Test Set Loss:   mean=28.3355, std=30.4807
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10588235294117647, 'auc': 0.54248046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=28.2571, std=29.5147
[DEBUG][MIA] Test Set Loss:   mean=29.4624, std=30.6316
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.49906399999999995, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=74.2316, std=63.7399
[DEBUG][MIA] Test Set Loss:   mean=81.1874, std=70.4677
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11372549019607843, 'auc': 0.47802734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=76.6357, std=70.4609
[DEBUG][MIA] Test Set Loss:   mean=84.0177, std=73.7854
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.5269280000000001, 'task': 8}
Total correct retain:  1526  Total retain:  2500
Total correct forget:  13224  Total forget:  47500
Total correct test:  295  Total test:  500
Total correct forget test:  2567  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.59, 0.538, 0.494, 0.426, 0.286, 0.26, 0.28, 0.24, 0.228, 0.28, 0.2, 0.206, 0.238, 0.178, 0.28, 0.24, 0.236, 0.172, 0.172, 0.18]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6221, std=1.4017
[DEBUG][MIA] Test Set Loss:   mean=2.2171, std=2.7546
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2627450980392157, 'auc': 0.742431640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1162, std=3.1937
[DEBUG][MIA] Test Set Loss:   mean=2.4772, std=3.4081
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.12, 'auc': 0.545288, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2446, std=2.3553
[DEBUG][MIA] Test Set Loss:   mean=2.7778, std=3.8889
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.23529411764705882, 'auc': 0.6275634765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8046, std=4.0696
[DEBUG][MIA] Test Set Loss:   mean=2.8387, std=4.2001
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.142, 'auc': 0.520216, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.9955, std=10.3628
[DEBUG][MIA] Test Set Loss:   mean=9.2666, std=11.7974
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.16470588235294117, 'auc': 0.569427490234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.6905, std=12.1505
[DEBUG][MIA] Test Set Loss:   mean=10.9782, std=14.5256
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.454, 'cv_acc': 0.08399999999999999, 'auc': 0.45120000000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.1065, std=13.7729
[DEBUG][MIA] Test Set Loss:   mean=16.3596, std=15.8152
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.14509803921568626, 'auc': 0.600982666015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=14.8751, std=13.3350
[DEBUG][MIA] Test Set Loss:   mean=14.9068, std=14.9928
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.1, 'auc': 0.493736, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=24.8722, std=39.1282
[DEBUG][MIA] Test Set Loss:   mean=27.8629, std=39.5132
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10980392156862746, 'auc': 0.541046142578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=31.6539, std=43.5471
[DEBUG][MIA] Test Set Loss:   mean=30.3462, std=43.8260
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.12200000000000003, 'auc': 0.503512, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.1785, std=8.6102
[DEBUG][MIA] Test Set Loss:   mean=7.9147, std=8.5465
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.11372549019607843, 'auc': 0.582550048828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.2878, std=8.6275
[DEBUG][MIA] Test Set Loss:   mean=8.9786, std=8.7515
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10600000000000001, 'auc': 0.47508799999999995, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.6704, std=15.6427
[DEBUG][MIA] Test Set Loss:   mean=9.0887, std=14.3325
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.14901960784313725, 'auc': 0.505706787109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.1977, std=16.8860
[DEBUG][MIA] Test Set Loss:   mean=11.6466, std=16.3617
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.501344, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=44.3668, std=53.9251
[DEBUG][MIA] Test Set Loss:   mean=41.1492, std=49.3039
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.14901960784313725, 'auc': 0.49786376953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=42.1337, std=56.8025
[DEBUG][MIA] Test Set Loss:   mean=46.5070, std=54.9665
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.094, 'auc': 0.5383439999999999, 'task': 8}
Total correct retain:  1703  Total retain:  2500
Total correct forget:  12452  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  2381  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.674, 0.478, 0.496, 0.31, 0.258, 0.352, 0.268, 0.264, 0.238, 0.248, 0.2, 0.206, 0.166, 0.166, 0.238, 0.182, 0.232, 0.19, 0.118, 0.152]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7426, std=1.3470
[DEBUG][MIA] Test Set Loss:   mean=2.2618, std=2.8633
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.3764705882352941, 'auc': 0.66900634765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9512, std=2.9754
[DEBUG][MIA] Test Set Loss:   mean=2.1272, std=2.9671
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.52824, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.1102, std=19.0205
[DEBUG][MIA] Test Set Loss:   mean=16.6380, std=20.3365
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.08627450980392157, 'auc': 0.497711181640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=15.0508, std=19.0037
[DEBUG][MIA] Test Set Loss:   mean=16.4573, std=21.7123
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10200000000000001, 'auc': 0.48173599999999994, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.9904, std=11.0122
[DEBUG][MIA] Test Set Loss:   mean=12.5036, std=15.8806
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.13725490196078433, 'auc': 0.518798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=12.0050, std=14.7046
[DEBUG][MIA] Test Set Loss:   mean=12.1858, std=15.4994
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11200000000000002, 'auc': 0.49828, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=16.7203, std=14.4217
[DEBUG][MIA] Test Set Loss:   mean=22.3519, std=18.7516
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.09019607843137255, 'auc': 0.59130859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.5725, std=17.0351
[DEBUG][MIA] Test Set Loss:   mean=19.6836, std=18.2730
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.1, 'auc': 0.4703919999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=39.2725, std=64.1073
[DEBUG][MIA] Test Set Loss:   mean=43.2492, std=63.0169
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.12549019607843137, 'auc': 0.534210205078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=41.8855, std=62.5211
[DEBUG][MIA] Test Set Loss:   mean=44.8876, std=65.6524
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.495872, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.5899, std=11.0172
[DEBUG][MIA] Test Set Loss:   mean=13.4508, std=11.3602
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10196078431372549, 'auc': 0.587127685546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.4590, std=12.3746
[DEBUG][MIA] Test Set Loss:   mean=13.7722, std=11.1987
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.08399999999999999, 'auc': 0.46782399999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.6632, std=11.9797
[DEBUG][MIA] Test Set Loss:   mean=9.8181, std=14.0713
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.11764705882352941, 'auc': 0.579803466796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.3205, std=13.0555
[DEBUG][MIA] Test Set Loss:   mean=10.3116, std=14.1273
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.096, 'auc': 0.5305759999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=51.2922, std=70.3929
[DEBUG][MIA] Test Set Loss:   mean=55.3865, std=67.2575
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.12549019607843137, 'auc': 0.542877197265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=48.0518, std=72.5218
[DEBUG][MIA] Test Set Loss:   mean=54.4534, std=67.7445
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10400000000000001, 'auc': 0.570112, 'task': 8}
Total correct retain:  1375  Total retain:  2500
Total correct forget:  12049  Total forget:  47500
Total correct test:  283  Total test:  500
Total correct forget test:  2345  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.566, 0.504, 0.282, 0.304, 0.226, 0.334, 0.188, 0.254, 0.228, 0.226, 0.2, 0.208, 0.276, 0.198, 0.21, 0.214, 0.29, 0.21, 0.144, 0.194]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 5, 6, 6, 7, 5, 7, 9, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3081, std=6.1714
[DEBUG][MIA] Test Set Loss:   mean=8.2144, std=7.2956
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.14901960784313723, 'auc': 0.61669921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 9 8 8 9 6 9 6 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 6 5 9 6 5 5 8 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.7832, std=8.0641
[DEBUG][MIA] Test Set Loss:   mean=7.6709, std=6.9118
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.5125040000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 11, 11, 10, 12, 10, 13, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=17.4721, std=25.6058
[DEBUG][MIA] Test Set Loss:   mean=20.1130, std=24.5254
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09803921568627451, 'auc': 0.54913330078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 13 12 11 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 13 13 12 10 10 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.4819, std=25.1651
[DEBUG][MIA] Test Set Loss:   mean=16.7420, std=23.8639
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.519504, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 15, 18, 18, 17, 19, 19, 15, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=12.4230, std=15.1279
[DEBUG][MIA] Test Set Loss:   mean=13.4218, std=16.7996
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.1607843137254902, 'auc': 0.5201416015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 18 19 16 18 16 16 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 16 16 18 18 19 16 17 16 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=15.4246, std=17.7479
[DEBUG][MIA] Test Set Loss:   mean=12.5805, std=15.9678
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.13, 'auc': 0.45055200000000006, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 24, 20, 24, 21, 21, 23, 24, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=17.4121, std=13.8189
[DEBUG][MIA] Test Set Loss:   mean=19.3051, std=16.6531
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.21960784313725493, 'auc': 0.5101318359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 22 24 21 24 21 24 20 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 23 23 22 23 23 23 24 20 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.0032, std=19.8555
[DEBUG][MIA] Test Set Loss:   mean=21.7414, std=18.5360
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.122, 'auc': 0.49011200000000005, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 25, 27, 29, 27, 27, 26, 26, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=43.1425, std=65.7718
[DEBUG][MIA] Test Set Loss:   mean=53.0913, std=71.4397
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11372549019607843, 'auc': 0.4493408203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 26 27 29 25 26 28 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 25 26 26 29 29 28 26 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=50.8447, std=75.5771
[DEBUG][MIA] Test Set Loss:   mean=48.4129, std=71.9592
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.489576, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 31, 34, 31, 33, 33, 30, 33, 33, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.5390, std=12.2681
[DEBUG][MIA] Test Set Loss:   mean=14.8480, std=13.2120
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.11372549019607843, 'auc': 0.5596923828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 33 30 31 31 30 32 33 33 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 31 34 32 32 33 33 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.7831, std=13.7332
[DEBUG][MIA] Test Set Loss:   mean=14.9201, std=13.5905
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.09, 'auc': 0.522112, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 39, 36, 35, 35, 35, 36, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.3782, std=15.1607
[DEBUG][MIA] Test Set Loss:   mean=11.2580, std=15.2430
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09803921568627451, 'auc': 0.581390380859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 38 39 37 39 39 37 37 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 38 37 35 38 38 39 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.0789, std=15.3557
[DEBUG][MIA] Test Set Loss:   mean=11.1935, std=14.9659
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.098, 'auc': 0.544192, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 40, 41, 43, 43, 44, 43, 43, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=66.2959, std=80.7961
[DEBUG][MIA] Test Set Loss:   mean=62.6026, std=75.1828
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.18823529411764706, 'auc': 0.489654541015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 42 43 40 44 44 40 40 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 41 42 41 41 43 42 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=53.1573, std=70.3296
[DEBUG][MIA] Test Set Loss:   mean=61.3307, std=74.4390
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10800000000000001, 'auc': 0.545056, 'task': 8}
Total correct retain:  1462  Total retain:  2500
Total correct forget:  11204  Total forget:  47500
Total correct test:  285  Total test:  500
Total correct forget test:  2198  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.57, 0.214, 0.28, 0.29, 0.224, 0.332, 0.182, 0.268, 0.228, 0.224, 0.2, 0.196, 0.284, 0.192, 0.276, 0.222, 0.254, 0.21, 0.132, 0.188]
Number of constraint violations:  0
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: neggrad
alpha: 0.5
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 4
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Mon Apr 28 16:06:04 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA RTX A5000               Off |   00000000:01:00.0 Off |                  Off |
| 46%   63C    P0             N/A /  230W |       1MiB /  24564MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA RTX A5000
Unlearn Batch Size:  4
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['wolf', 'raccoon', 'house', 'bowls', 'cloud', 'rocket', 'kangaroo', 'pine', 'castle', 'couch', 'computer keyboard', 'butterfly', 'crab', 'lobster', 'mushrooms', 'camel', 'snake', 'maple', 'tractor', 'beetle', 'rabbit', 'elephant', 'cockroach', 'man', 'palm', 'flatfish', 'shrew', 'hamster', 'spider', 'train', 'bicycle', 'leopard', 'oak', 'chair', 'bridge', 'whale', 'otter', 'pears', 'seal', 'dolphin', 'aquarium fish', 'streetcar', 'crocodile', 'road', 'table', 'bee', 'cups', 'possum', 'turtle', 'lion', 'television', 'cans', 'pickup truck', 'beaver', 'worm', 'skunk', 'tulips', 'snail', 'orchids', 'fox', 'bottles', 'chimpanzee', 'caterpillar', 'apples', 'girl', 'clock', 'sweet peppers', 'wardrobe', 'bus', 'forest', 'cattle', 'mountain', 'tiger', 'plates', 'boy', 'telephone', 'baby', 'bed', 'squirrel', 'dinosaur', 'roses', 'ray', 'shark', 'porcupine', 'lamp', 'bear', 'motorcycle', 'woman', 'tank', 'plain', 'skyscraper', 'oranges', 'poppies', 'lawn-mower', 'sunflowers', 'sea', 'willow', 'lizard', 'mouse', 'trout']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2086  Total retain:  2500
Total correct forget:  9744  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  1954  Total test forget:  9500
After learning task 1
Task accuracies: [0.6, 0.2, 0.194, 0.236, 0.198, 0.224, 0.202, 0.246, 0.188, 0.25, 0.21, 0.178, 0.164, 0.166, 0.2, 0.27, 0.2, 0.192, 0.22, 0.17]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0091, std=0.0477
[DEBUG][MIA] Test Set Loss:   mean=0.5596, std=1.6980
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.1607843137254902, 'auc': 0.638397216796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0167, std=0.1070
[DEBUG][MIA] Test Set Loss:   mean=0.6855, std=2.1173
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.184, 'auc': 0.596624, 'task': 1}
2 1
Total correct retain:  1767  Total retain:  2500
Total correct forget:  11451  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  2228  Total test forget:  9500
After learning task 2
Task accuracies: [0.594, 0.856, 0.192, 0.224, 0.244, 0.142, 0.198, 0.198, 0.146, 0.234, 0.194, 0.196, 0.126, 0.216, 0.248, 0.25, 0.196, 0.202, 0.226, 0.168]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0470, std=0.1641
[DEBUG][MIA] Test Set Loss:   mean=1.1270, std=2.0327
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2627450980392157, 'auc': 0.731231689453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4250, std=1.2041
[DEBUG][MIA] Test Set Loss:   mean=1.0254, std=1.9983
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.12, 'auc': 0.5666640000000001, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0887, std=0.4608
[DEBUG][MIA] Test Set Loss:   mean=1.2753, std=2.7326
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2941176470588235, 'auc': 0.736572265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0454, std=0.2353
[DEBUG][MIA] Test Set Loss:   mean=1.6375, std=3.0088
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.69, 'cv_acc': 0.264, 'auc': 0.773528, 'task': 2}
3 2
Total correct retain:  1680  Total retain:  2500
Total correct forget:  12778  Total forget:  47500
Total correct test:  286  Total test:  500
Total correct forget test:  2321  Total test forget:  9500
After learning task 3
Task accuracies: [0.572, 0.744, 0.678, 0.188, 0.226, 0.098, 0.198, 0.196, 0.18, 0.25, 0.188, 0.202, 0.082, 0.25, 0.24, 0.154, 0.192, 0.188, 0.222, 0.166]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0224
[DEBUG][MIA] Test Set Loss:   mean=1.3950, std=2.7085
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.30196078431372547, 'auc': 0.75799560546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7207, std=1.9564
[DEBUG][MIA] Test Set Loss:   mean=1.2116, std=2.3429
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.11800000000000002, 'auc': 0.629632, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.8517, std=3.0237
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7137254901960783, 'auc': 0.86492919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4018, std=0.9461
[DEBUG][MIA] Test Set Loss:   mean=1.9965, std=3.0666
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.21800000000000003, 'auc': 0.697192, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0096, std=0.0428
[DEBUG][MIA] Test Set Loss:   mean=1.0910, std=2.3744
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.22745098039215686, 'auc': 0.737762451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0602
[DEBUG][MIA] Test Set Loss:   mean=1.1268, std=2.7088
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.25, 'auc': 0.77668, 'task': 3}
4 3
Total correct retain:  1615  Total retain:  2500
Total correct forget:  14512  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  2612  Total test forget:  9500
After learning task 4
Task accuracies: [0.532, 0.712, 0.61, 0.762, 0.254, 0.098, 0.186, 0.222, 0.164, 0.286, 0.184, 0.194, 0.18, 0.202, 0.284, 0.194, 0.184, 0.206, 0.174, 0.128]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0180, std=0.1393
[DEBUG][MIA] Test Set Loss:   mean=1.5134, std=2.6909
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2549019607843137, 'auc': 0.7635498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0434, std=2.1541
[DEBUG][MIA] Test Set Loss:   mean=1.2319, std=2.4678
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.17200000000000001, 'auc': 0.5319119999999999, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0259
[DEBUG][MIA] Test Set Loss:   mean=1.7416, std=2.6144
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7411764705882353, 'auc': 0.898651123046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8597, std=1.7785
[DEBUG][MIA] Test Set Loss:   mean=1.7578, std=2.8047
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.15199999999999997, 'auc': 0.6120800000000001, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.1094, std=2.3946
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.7254901960784315, 'auc': 0.7734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3091, std=1.0361
[DEBUG][MIA] Test Set Loss:   mean=1.6895, std=3.1390
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.21600000000000003, 'auc': 0.668296, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0192
[DEBUG][MIA] Test Set Loss:   mean=1.0797, std=2.1567
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2549019607843137, 'auc': 0.728546142578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0155, std=0.1215
[DEBUG][MIA] Test Set Loss:   mean=1.0412, std=2.2659
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.668, 'cv_acc': 0.254, 'auc': 0.714648, 'task': 4}
5 4
Total correct retain:  1561  Total retain:  2500
Total correct forget:  15667  Total forget:  47500
Total correct test:  274  Total test:  500
Total correct forget test:  2777  Total test forget:  9500
After learning task 5
Task accuracies: [0.548, 0.696, 0.622, 0.666, 0.736, 0.1, 0.196, 0.168, 0.21, 0.232, 0.188, 0.196, 0.124, 0.184, 0.284, 0.194, 0.2, 0.164, 0.21, 0.184]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0210
[DEBUG][MIA] Test Set Loss:   mean=1.2724, std=2.7778
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2980392156862745, 'auc': 0.722564697265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1810, std=2.5724
[DEBUG][MIA] Test Set Loss:   mean=1.3785, std=2.7336
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.53612, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0301
[DEBUG][MIA] Test Set Loss:   mean=2.2709, std=3.4083
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7686274509803921, 'auc': 0.869598388671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2593, std=2.1958
[DEBUG][MIA] Test Set Loss:   mean=2.3254, std=3.2294
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.194, 'auc': 0.6072559999999999, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.7251, std=3.3321
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30588235294117644, 'auc': 0.8118896484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7080, std=1.8347
[DEBUG][MIA] Test Set Loss:   mean=1.7866, std=3.4966
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.17800000000000002, 'auc': 0.5990719999999999, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0113, std=0.0685
[DEBUG][MIA] Test Set Loss:   mean=2.5181, std=3.5052
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7058823529411765, 'auc': 0.790283203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5157, std=1.3773
[DEBUG][MIA] Test Set Loss:   mean=1.7502, std=2.8234
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.22600000000000003, 'auc': 0.64808, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0133, std=0.0849
[DEBUG][MIA] Test Set Loss:   mean=1.1784, std=2.6339
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2627450980392157, 'auc': 0.734893798828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0431, std=0.3915
[DEBUG][MIA] Test Set Loss:   mean=1.1549, std=2.5729
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.246, 'auc': 0.74736, 'task': 5}
6 5
Total correct retain:  1532  Total retain:  2500
Total correct forget:  17156  Total forget:  47500
Total correct test:  280  Total test:  500
Total correct forget test:  3001  Total test forget:  9500
After learning task 6
Task accuracies: [0.56, 0.692, 0.516, 0.688, 0.616, 0.742, 0.188, 0.166, 0.2, 0.188, 0.18, 0.18, 0.154, 0.192, 0.23, 0.214, 0.204, 0.196, 0.244, 0.212]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.1695, std=2.2164
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2549019607843137, 'auc': 0.759735107421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9128, std=1.9836
[DEBUG][MIA] Test Set Loss:   mean=1.3406, std=2.6708
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.42612800000000006, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0287
[DEBUG][MIA] Test Set Loss:   mean=2.7677, std=4.0222
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7529411764705883, 'auc': 0.85235595703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5358, std=2.7569
[DEBUG][MIA] Test Set Loss:   mean=3.0516, std=4.1492
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.138, 'auc': 0.61388, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.9360, std=4.0489
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2823529411764706, 'auc': 0.741119384765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1520, std=2.4320
[DEBUG][MIA] Test Set Loss:   mean=1.8314, std=3.2074
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.14999999999999997, 'auc': 0.568184, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.7653, std=2.8912
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7294117647058823, 'auc': 0.80010986328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9068, std=2.1158
[DEBUG][MIA] Test Set Loss:   mean=2.0188, std=3.2368
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.196, 'auc': 0.619728, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.6269, std=3.5973
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2666666666666667, 'auc': 0.820404052734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1930, std=0.6998
[DEBUG][MIA] Test Set Loss:   mean=1.5436, std=3.3516
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.194, 'auc': 0.6992160000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0234, std=0.1266
[DEBUG][MIA] Test Set Loss:   mean=0.6316, std=1.8656
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.18823529411764706, 'auc': 0.64117431640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0619
[DEBUG][MIA] Test Set Loss:   mean=0.5738, std=1.7905
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.16599999999999998, 'auc': 0.6495839999999999, 'task': 6}
7 6
Total correct retain:  1558  Total retain:  2500
Total correct forget:  18791  Total forget:  47500
Total correct test:  272  Total test:  500
Total correct forget test:  3333  Total test forget:  9500
After learning task 7
Task accuracies: [0.544, 0.724, 0.524, 0.652, 0.636, 0.71, 0.868, 0.162, 0.204, 0.222, 0.192, 0.198, 0.086, 0.19, 0.25, 0.236, 0.202, 0.2, 0.238, 0.172]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.4102, std=2.6692
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6588235294117647, 'auc': 0.800018310546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2417, std=2.6004
[DEBUG][MIA] Test Set Loss:   mean=1.7865, std=3.2636
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11800000000000002, 'auc': 0.5482720000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0331
[DEBUG][MIA] Test Set Loss:   mean=3.2170, std=4.3249
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7764705882352941, 'auc': 0.9072265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2501, std=3.5612
[DEBUG][MIA] Test Set Loss:   mean=2.8477, std=3.8625
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.15, 'auc': 0.554296, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=2.0600, std=3.9244
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7058823529411764, 'auc': 0.801177978515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0912, std=2.2501
[DEBUG][MIA] Test Set Loss:   mean=1.9967, std=3.5483
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.15199999999999997, 'auc': 0.570664, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.6060, std=2.8961
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7529411764705882, 'auc': 0.826080322265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2055, std=2.2333
[DEBUG][MIA] Test Set Loss:   mean=2.2266, std=3.1959
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.11600000000000002, 'auc': 0.6100800000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0128
[DEBUG][MIA] Test Set Loss:   mean=1.8791, std=3.7808
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7019607843137255, 'auc': 0.808258056640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8099, std=1.8672
[DEBUG][MIA] Test Set Loss:   mean=2.0274, std=3.5965
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.16799999999999998, 'auc': 0.618336, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=0.8535, std=1.8585
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.25098039215686274, 'auc': 0.794097900390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2608, std=0.8099
[DEBUG][MIA] Test Set Loss:   mean=0.9247, std=2.0630
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.15399999999999997, 'auc': 0.6004320000000001, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0271, std=0.2271
[DEBUG][MIA] Test Set Loss:   mean=1.8907, std=3.4413
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2666666666666667, 'auc': 0.76397705078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0174, std=0.0742
[DEBUG][MIA] Test Set Loss:   mean=1.7984, std=3.1144
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.71, 'cv_acc': 0.292, 'auc': 0.7879280000000001, 'task': 7}
8 7
Total correct retain:  1558  Total retain:  2500
Total correct forget:  19862  Total forget:  47500
Total correct test:  272  Total test:  500
Total correct forget test:  3395  Total test forget:  9500
After learning task 8
Task accuracies: [0.544, 0.678, 0.5, 0.654, 0.58, 0.632, 0.786, 0.63, 0.248, 0.254, 0.216, 0.178, 0.108, 0.17, 0.186, 0.18, 0.202, 0.19, 0.22, 0.178]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.6002, std=2.9396
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2784313725490196, 'auc': 0.753875732421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2044, std=2.6767
[DEBUG][MIA] Test Set Loss:   mean=1.2675, std=2.4941
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.122, 'auc': 0.5501919999999999, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=3.1489, std=3.9313
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8203125, 'cv_acc': 0.7490196078431373, 'auc': 0.91546630859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2278, std=3.5549
[DEBUG][MIA] Test Set Loss:   mean=3.0318, std=3.9684
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.12200000000000003, 'auc': 0.586792, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.6320, std=2.9689
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7333333333333334, 'auc': 0.807952880859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1049, std=2.4152
[DEBUG][MIA] Test Set Loss:   mean=2.1713, std=3.7568
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10400000000000001, 'auc': 0.591272, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=2.2062, std=3.3925
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7568627450980392, 'auc': 0.829925537109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2882, std=2.4984
[DEBUG][MIA] Test Set Loss:   mean=2.4675, std=3.7159
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.15799999999999997, 'auc': 0.591424, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.8430, std=3.1419
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2901960784313725, 'auc': 0.8001708984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0037, std=1.8871
[DEBUG][MIA] Test Set Loss:   mean=1.6580, std=2.8818
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.2, 'auc': 0.543288, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=0.8090, std=1.7227
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.26274509803921575, 'auc': 0.755462646484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4205, std=1.1224
[DEBUG][MIA] Test Set Loss:   mean=0.7875, std=1.7557
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.16, 'auc': 0.5616639999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.2949, std=3.0307
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7254901960784313, 'auc': 0.87139892578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2345, std=1.0128
[DEBUG][MIA] Test Set Loss:   mean=2.1122, std=3.0910
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.692, 'cv_acc': 0.396, 'auc': 0.7696959999999999, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0449
[DEBUG][MIA] Test Set Loss:   mean=0.7261, std=2.1258
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.20784313725490194, 'auc': 0.75640869140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0364, std=0.5232
[DEBUG][MIA] Test Set Loss:   mean=0.7719, std=2.1662
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.196, 'auc': 0.6938, 'task': 8}
Total correct retain:  1513  Total retain:  2500
Total correct forget:  21143  Total forget:  47500
Total correct test:  245  Total test:  500
Total correct forget test:  3623  Total test forget:  9500
After learning task 9
Task accuracies: [0.49, 0.708, 0.464, 0.638, 0.568, 0.632, 0.772, 0.584, 0.832, 0.258, 0.216, 0.156, 0.09, 0.164, 0.188, 0.17, 0.22, 0.206, 0.216, 0.164]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0346
[DEBUG][MIA] Test Set Loss:   mean=1.3595, std=3.2184
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.6901960784313725, 'auc': 0.719024658203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4170, std=3.1009
[DEBUG][MIA] Test Set Loss:   mean=1.7102, std=3.4820
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.12200000000000003, 'auc': 0.51412, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=3.1342, std=4.0464
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7843137254901961, 'auc': 0.893035888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5762, std=4.2207
[DEBUG][MIA] Test Set Loss:   mean=3.2585, std=4.1172
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11000000000000001, 'auc': 0.586056, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.9919, std=3.2725
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7294117647058824, 'auc': 0.901702880859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6173, std=3.0215
[DEBUG][MIA] Test Set Loss:   mean=2.1721, std=3.5021
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.16599999999999998, 'auc': 0.581224, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.9354, std=3.1753
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7176470588235294, 'auc': 0.825103759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7255, std=3.3173
[DEBUG][MIA] Test Set Loss:   mean=2.1457, std=3.4209
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.162, 'auc': 0.556408, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=2.0599, std=3.2523
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7137254901960784, 'auc': 0.857086181640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2660, std=2.4881
[DEBUG][MIA] Test Set Loss:   mean=2.0442, std=3.4781
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.176, 'auc': 0.588816, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0068
[DEBUG][MIA] Test Set Loss:   mean=1.0105, std=2.3440
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2705882352941177, 'auc': 0.7420654296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5886, std=1.9538
[DEBUG][MIA] Test Set Loss:   mean=1.2693, std=2.4296
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.096, 'auc': 0.638536, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=2.6655, std=3.4211
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.2980392156862745, 'auc': 0.85614013671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7361, std=1.9066
[DEBUG][MIA] Test Set Loss:   mean=2.3931, std=3.4034
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.20600000000000002, 'auc': 0.6790240000000001, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.2030, std=2.2907
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.28627450980392155, 'auc': 0.767852783203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4061, std=1.1535
[DEBUG][MIA] Test Set Loss:   mean=1.3998, std=2.7440
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.196, 'auc': 0.6301680000000001, 'task': 8}
Total correct retain:  1566  Total retain:  2500
Total correct forget:  22247  Total forget:  47500
Total correct test:  263  Total test:  500
Total correct forget test:  3771  Total test forget:  9500
After learning task 10
Task accuracies: [0.526, 0.674, 0.47, 0.622, 0.602, 0.622, 0.756, 0.548, 0.714, 0.674, 0.232, 0.18, 0.108, 0.19, 0.194, 0.204, 0.202, 0.2, 0.204, 0.146]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.8418, std=3.2874
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2705882352941177, 'auc': 0.781707763671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1863, std=2.4505
[DEBUG][MIA] Test Set Loss:   mean=1.8000, std=3.4727
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.13199999999999998, 'auc': 0.5403519999999999, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0242
[DEBUG][MIA] Test Set Loss:   mean=2.5161, std=3.1929
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7725490196078431, 'auc': 0.902069091796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5446, std=4.1356
[DEBUG][MIA] Test Set Loss:   mean=3.4058, std=4.1423
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.118, 'auc': 0.6066720000000001, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0061
[DEBUG][MIA] Test Set Loss:   mean=2.2910, std=3.7481
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6980392156862745, 'auc': 0.840545654296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5534, std=3.0788
[DEBUG][MIA] Test Set Loss:   mean=2.1596, std=3.7263
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11399999999999999, 'auc': 0.5584960000000001, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=2.1506, std=3.6357
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7058823529411765, 'auc': 0.875274658203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8114, std=3.3404
[DEBUG][MIA] Test Set Loss:   mean=1.8773, std=3.4919
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.534416, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=2.0517, std=3.4351
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7254901960784313, 'auc': 0.84564208984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2899, std=2.4328
[DEBUG][MIA] Test Set Loss:   mean=2.1556, std=3.5899
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.094, 'auc': 0.578008, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=0.9291, std=1.9895
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.25098039215686274, 'auc': 0.76171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7170, std=1.9614
[DEBUG][MIA] Test Set Loss:   mean=0.9883, std=2.1265
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10400000000000001, 'auc': 0.590496, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.5932, std=3.4428
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7960784313725491, 'auc': 0.89715576171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7733, std=1.8160
[DEBUG][MIA] Test Set Loss:   mean=2.5497, std=3.6896
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.23399999999999999, 'auc': 0.684848, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.1477, std=2.5123
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2823529411764706, 'auc': 0.837738037109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7226, std=1.8808
[DEBUG][MIA] Test Set Loss:   mean=1.1645, std=2.7021
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.164, 'auc': 0.5838639999999999, 'task': 8}
Total correct retain:  1509  Total retain:  2500
Total correct forget:  23966  Total forget:  47500
Total correct test:  253  Total test:  500
Total correct forget test:  4044  Total test forget:  9500
After learning task 11
Task accuracies: [0.506, 0.69, 0.466, 0.626, 0.604, 0.614, 0.764, 0.5, 0.744, 0.596, 0.8, 0.174, 0.086, 0.236, 0.184, 0.18, 0.206, 0.226, 0.214, 0.178]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0616, std=0.4749
[DEBUG][MIA] Test Set Loss:   mean=1.4863, std=2.9819
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2980392156862745, 'auc': 0.72320556640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2848, std=3.1150
[DEBUG][MIA] Test Set Loss:   mean=1.7315, std=3.5109
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.1, 'auc': 0.5405760000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0697, std=0.3954
[DEBUG][MIA] Test Set Loss:   mean=3.3856, std=4.9589
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6784313725490195, 'auc': 0.860321044921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0698, std=4.2767
[DEBUG][MIA] Test Set Loss:   mean=3.6535, std=4.6448
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11800000000000002, 'auc': 0.5489120000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0099, std=0.0425
[DEBUG][MIA] Test Set Loss:   mean=2.0681, std=3.4390
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6509803921568628, 'auc': 0.819610595703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5199, std=2.9926
[DEBUG][MIA] Test Set Loss:   mean=2.2231, std=3.7719
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11400000000000002, 'auc': 0.537968, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0781, std=0.3237
[DEBUG][MIA] Test Set Loss:   mean=3.0376, std=4.8694
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6313725490196078, 'auc': 0.72467041015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0172, std=3.9961
[DEBUG][MIA] Test Set Loss:   mean=3.1513, std=4.5307
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.11400000000000002, 'auc': 0.589072, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0334, std=0.1595
[DEBUG][MIA] Test Set Loss:   mean=2.3271, std=3.8388
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.6313725490196078, 'auc': 0.77886962890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6141, std=3.1636
[DEBUG][MIA] Test Set Loss:   mean=2.2051, std=3.7973
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10200000000000001, 'auc': 0.544344, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0828, std=0.3248
[DEBUG][MIA] Test Set Loss:   mean=1.2538, std=2.2480
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25098039215686274, 'auc': 0.722320556640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9396, std=2.6118
[DEBUG][MIA] Test Set Loss:   mean=1.4185, std=2.7908
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.565088, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1990, std=0.7303
[DEBUG][MIA] Test Set Loss:   mean=3.3480, std=4.6187
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333332, 'auc': 0.818389892578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4774, std=3.4327
[DEBUG][MIA] Test Set Loss:   mean=3.5336, std=4.6168
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.652, 'cv_acc': 0.20400000000000001, 'auc': 0.6708239999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0118
[DEBUG][MIA] Test Set Loss:   mean=1.2725, std=2.9354
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.28627450980392155, 'auc': 0.809783935546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7676, std=2.2116
[DEBUG][MIA] Test Set Loss:   mean=1.1691, std=2.4066
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.178, 'auc': 0.5888960000000001, 'task': 8}
Total correct retain:  1463  Total retain:  2500
Total correct forget:  21353  Total forget:  47500
Total correct test:  257  Total test:  500
Total correct forget test:  3730  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.514, 0.664, 0.454, 0.624, 0.576, 0.636, 0.722, 0.438, 0.732, 0.58, 0.282, 0.178, 0.096, 0.228, 0.204, 0.194, 0.206, 0.238, 0.212, 0.196]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2014, std=0.9403
[DEBUG][MIA] Test Set Loss:   mean=2.7954, std=4.7543
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4431372549019607, 'auc': 0.722564697265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8150, std=3.3588
[DEBUG][MIA] Test Set Loss:   mean=2.5613, std=4.5274
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.12600000000000003, 'auc': 0.532864, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0747, std=0.3044
[DEBUG][MIA] Test Set Loss:   mean=3.8466, std=5.4112
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7058823529411764, 'auc': 0.8125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0293, std=4.3365
[DEBUG][MIA] Test Set Loss:   mean=3.8855, std=5.5553
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.546752, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0895, std=0.4439
[DEBUG][MIA] Test Set Loss:   mean=2.5391, std=4.2968
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6823529411764706, 'auc': 0.75518798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9135, std=3.4302
[DEBUG][MIA] Test Set Loss:   mean=2.6599, std=4.2285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11599999999999999, 'auc': 0.5296239999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2333, std=0.7258
[DEBUG][MIA] Test Set Loss:   mean=3.1933, std=4.7105
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.7137254901960786, 'auc': 0.70745849609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4726, std=4.5374
[DEBUG][MIA] Test Set Loss:   mean=3.6399, std=4.9310
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.08399999999999999, 'auc': 0.581368, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2914, std=0.9587
[DEBUG][MIA] Test Set Loss:   mean=3.0217, std=4.2954
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.41568627450980394, 'auc': 0.7633056640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5192, std=4.0054
[DEBUG][MIA] Test Set Loss:   mean=2.8624, std=4.7914
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11800000000000002, 'auc': 0.50956, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3793, std=1.1299
[DEBUG][MIA] Test Set Loss:   mean=2.1258, std=3.3633
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2627450980392157, 'auc': 0.677825927734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3983, std=2.9592
[DEBUG][MIA] Test Set Loss:   mean=2.1140, std=3.4671
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.442, 'cv_acc': 0.11600000000000002, 'auc': 0.41088800000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1088, std=0.3760
[DEBUG][MIA] Test Set Loss:   mean=2.8047, std=4.1093
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7176470588235294, 'auc': 0.7703857421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6121, std=2.9895
[DEBUG][MIA] Test Set Loss:   mean=3.1984, std=4.5310
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.202, 'auc': 0.623, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0398, std=0.1105
[DEBUG][MIA] Test Set Loss:   mean=2.0294, std=3.3318
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.4431372549019608, 'auc': 0.766815185546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6486, std=1.4653
[DEBUG][MIA] Test Set Loss:   mean=1.9571, std=3.1637
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.156, 'auc': 0.6397120000000001, 'task': 8}
Total correct retain:  1437  Total retain:  2500
Total correct forget:  19093  Total forget:  47500
Total correct test:  247  Total test:  500
Total correct forget test:  3408  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.494, 0.63, 0.488, 0.586, 0.534, 0.574, 0.612, 0.49, 0.652, 0.232, 0.322, 0.208, 0.124, 0.212, 0.184, 0.156, 0.2, 0.214, 0.172, 0.226]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3094, std=1.1736
[DEBUG][MIA] Test Set Loss:   mean=2.6487, std=4.2750
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.39215686274509803, 'auc': 0.755706787109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4855, std=4.5795
[DEBUG][MIA] Test Set Loss:   mean=2.7736, std=4.4385
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.122, 'auc': 0.528568, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3388, std=1.0269
[DEBUG][MIA] Test Set Loss:   mean=4.7791, std=5.7908
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.6431372549019608, 'auc': 0.847564697265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8222, std=4.4466
[DEBUG][MIA] Test Set Loss:   mean=4.0809, std=5.4338
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11800000000000002, 'auc': 0.579248, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.1365, std=0.4920
[DEBUG][MIA] Test Set Loss:   mean=3.2550, std=5.0361
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.596078431372549, 'auc': 0.810150146484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.6358, std=4.4000
[DEBUG][MIA] Test Set Loss:   mean=3.0600, std=4.4918
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.13199999999999998, 'auc': 0.55164, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3501, std=1.2232
[DEBUG][MIA] Test Set Loss:   mean=3.7624, std=5.3149
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6784313725490196, 'auc': 0.74127197265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1222, std=3.6081
[DEBUG][MIA] Test Set Loss:   mean=3.1987, std=4.8797
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13800000000000004, 'auc': 0.5531919999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4377, std=1.4357
[DEBUG][MIA] Test Set Loss:   mean=3.0368, std=5.1126
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.24705882352941178, 'auc': 0.724090576171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1155, std=3.7282
[DEBUG][MIA] Test Set Loss:   mean=2.7843, std=4.9577
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.516016, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4710, std=1.3832
[DEBUG][MIA] Test Set Loss:   mean=1.9263, std=3.5952
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.25882352941176473, 'auc': 0.629638671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3256, std=3.6602
[DEBUG][MIA] Test Set Loss:   mean=2.0177, std=3.3549
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.47092, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2768, std=0.7062
[DEBUG][MIA] Test Set Loss:   mean=3.8565, std=4.8195
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.396078431372549, 'auc': 0.788360595703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8194, std=3.4467
[DEBUG][MIA] Test Set Loss:   mean=3.9100, std=4.9319
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.22399999999999998, 'auc': 0.652896, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.4033, std=19.6174
[DEBUG][MIA] Test Set Loss:   mean=17.8363, std=20.8868
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.1764705882352941, 'auc': 0.57318115234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=14.1928, std=20.0649
[DEBUG][MIA] Test Set Loss:   mean=17.5030, std=20.8006
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.1, 'auc': 0.43068800000000007, 'task': 8}
Total correct retain:  1342  Total retain:  2500
Total correct forget:  16988  Total forget:  47500
Total correct test:  224  Total test:  500
Total correct forget test:  3117  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.448, 0.584, 0.48, 0.534, 0.526, 0.556, 0.598, 0.45, 0.302, 0.206, 0.256, 0.23, 0.156, 0.208, 0.178, 0.17, 0.18, 0.212, 0.198, 0.21]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7087, std=1.8609
[DEBUG][MIA] Test Set Loss:   mean=2.6191, std=4.0873
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.26274509803921564, 'auc': 0.6627197265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8262, std=4.2716
[DEBUG][MIA] Test Set Loss:   mean=3.4780, std=5.1835
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.096, 'auc': 0.5211839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7644, std=1.6698
[DEBUG][MIA] Test Set Loss:   mean=4.7793, std=5.1758
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6039215686274509, 'auc': 0.77740478515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.1709, std=5.5594
[DEBUG][MIA] Test Set Loss:   mean=5.1090, std=5.9178
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10200000000000001, 'auc': 0.555744, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6501, std=1.3079
[DEBUG][MIA] Test Set Loss:   mean=2.3990, std=4.0839
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.27450980392156865, 'auc': 0.63458251953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2803, std=5.0021
[DEBUG][MIA] Test Set Loss:   mean=3.1006, std=5.0612
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10800000000000001, 'auc': 0.474576, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3666, std=1.1294
[DEBUG][MIA] Test Set Loss:   mean=3.4857, std=5.4944
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6196078431372548, 'auc': 0.702362060546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2817, std=5.6723
[DEBUG][MIA] Test Set Loss:   mean=2.9598, std=4.7161
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10200000000000001, 'auc': 0.5091600000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4987, std=1.5151
[DEBUG][MIA] Test Set Loss:   mean=3.9810, std=5.5367
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5098039215686274, 'auc': 0.75103759765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.0151, std=5.0371
[DEBUG][MIA] Test Set Loss:   mean=3.8371, std=5.6771
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10800000000000001, 'auc': 0.542312, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3604, std=0.8498
[DEBUG][MIA] Test Set Loss:   mean=2.2909, std=3.6590
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2392156862745098, 'auc': 0.64208984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4962, std=3.9391
[DEBUG][MIA] Test Set Loss:   mean=2.4838, std=3.7497
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.502568, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=178.2659, std=172.7736
[DEBUG][MIA] Test Set Loss:   mean=178.5490, std=160.0311
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.12549019607843137, 'auc': 0.501983642578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=174.0308, std=162.5251
[DEBUG][MIA] Test Set Loss:   mean=181.1340, std=159.4529
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.511776, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=32.5540, std=33.6172
[DEBUG][MIA] Test Set Loss:   mean=33.2933, std=40.0857
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09019607843137255, 'auc': 0.47283935546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=31.5233, std=37.5194
[DEBUG][MIA] Test Set Loss:   mean=32.8440, std=36.1060
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.5207999999999999, 'task': 8}
Total correct retain:  1331  Total retain:  2500
Total correct forget:  14806  Total forget:  47500
Total correct test:  217  Total test:  500
Total correct forget test:  2847  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.434, 0.564, 0.39, 0.564, 0.514, 0.478, 0.588, 0.218, 0.244, 0.202, 0.206, 0.238, 0.132, 0.244, 0.168, 0.19, 0.218, 0.252, 0.082, 0.202]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2616, std=0.6594
[DEBUG][MIA] Test Set Loss:   mean=2.9881, std=4.3428
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.588235294117647, 'auc': 0.702972412109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7684, std=4.3199
[DEBUG][MIA] Test Set Loss:   mean=2.3634, std=3.7061
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.132, 'auc': 0.48282400000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2843, std=2.5651
[DEBUG][MIA] Test Set Loss:   mean=4.2871, std=5.3617
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.5372549019607844, 'auc': 0.70367431640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.6052, std=6.6947
[DEBUG][MIA] Test Set Loss:   mean=5.0061, std=6.3396
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11599999999999999, 'auc': 0.5429599999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2892, std=0.6175
[DEBUG][MIA] Test Set Loss:   mean=2.7982, std=4.8987
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.24705882352941178, 'auc': 0.653411865234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3762, std=3.7985
[DEBUG][MIA] Test Set Loss:   mean=2.5298, std=4.3174
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.096, 'auc': 0.500304, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2168, std=0.6666
[DEBUG][MIA] Test Set Loss:   mean=2.7063, std=4.4672
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.592156862745098, 'auc': 0.697540283203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.9425, std=5.1024
[DEBUG][MIA] Test Set Loss:   mean=2.8460, std=4.4612
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.098, 'auc': 0.531968, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6336, std=1.5301
[DEBUG][MIA] Test Set Loss:   mean=3.2850, std=4.6390
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.607843137254902, 'auc': 0.724639892578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.6083, std=4.0482
[DEBUG][MIA] Test Set Loss:   mean=4.0018, std=6.0420
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.094, 'auc': 0.5438959999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.6049, std=11.1938
[DEBUG][MIA] Test Set Loss:   mean=12.5525, std=13.1624
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.14901960784313725, 'auc': 0.560516357421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.9758, std=13.5963
[DEBUG][MIA] Test Set Loss:   mean=12.5028, std=13.3716
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.094, 'auc': 0.49980800000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=180.0907, std=177.1799
[DEBUG][MIA] Test Set Loss:   mean=178.1942, std=173.4500
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.4951171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=185.7849, std=182.8471
[DEBUG][MIA] Test Set Loss:   mean=175.7747, std=164.9211
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.1, 'auc': 0.49652799999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=28.8985, std=36.9667
[DEBUG][MIA] Test Set Loss:   mean=39.6640, std=41.3331
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.09411764705882353, 'auc': 0.577911376953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=27.9054, std=35.4110
[DEBUG][MIA] Test Set Loss:   mean=32.7355, std=34.7071
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.096, 'auc': 0.554632, 'task': 8}
Total correct retain:  1290  Total retain:  2500
Total correct forget:  14227  Total forget:  47500
Total correct test:  211  Total test:  500
Total correct forget test:  2743  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.422, 0.564, 0.384, 0.578, 0.53, 0.492, 0.268, 0.222, 0.246, 0.202, 0.202, 0.236, 0.128, 0.244, 0.17, 0.216, 0.222, 0.248, 0.12, 0.214]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4298, std=2.9556
[DEBUG][MIA] Test Set Loss:   mean=3.1950, std=5.0282
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.4235294117647059, 'auc': 0.590362548828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.1196, std=6.0410
[DEBUG][MIA] Test Set Loss:   mean=3.8474, std=5.6807
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.48563200000000006, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3690, std=1.0683
[DEBUG][MIA] Test Set Loss:   mean=4.3245, std=5.5108
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.6980392156862745, 'auc': 0.799652099609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.4017, std=5.1550
[DEBUG][MIA] Test Set Loss:   mean=4.1586, std=5.2835
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.154, 'auc': 0.54752, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6544, std=1.4372
[DEBUG][MIA] Test Set Loss:   mean=2.7926, std=4.4559
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.6078431372549019, 'auc': 0.67034912109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.9344, std=4.5704
[DEBUG][MIA] Test Set Loss:   mean=4.0593, std=6.0960
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.098, 'auc': 0.5382399999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5438, std=1.7033
[DEBUG][MIA] Test Set Loss:   mean=3.1133, std=4.3884
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2627450980392157, 'auc': 0.695159912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.7048, std=4.2076
[DEBUG][MIA] Test Set Loss:   mean=3.4975, std=5.1932
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.096, 'auc': 0.554888, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.7811, std=14.1369
[DEBUG][MIA] Test Set Loss:   mean=15.8026, std=19.1947
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.17254901960784313, 'auc': 0.59063720703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=14.7575, std=16.7336
[DEBUG][MIA] Test Set Loss:   mean=15.1649, std=16.6525
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10600000000000001, 'auc': 0.5165679999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.3484, std=10.0806
[DEBUG][MIA] Test Set Loss:   mean=14.7758, std=14.0390
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.08235294117647059, 'auc': 0.58477783203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.4143, std=14.0897
[DEBUG][MIA] Test Set Loss:   mean=14.6653, std=13.9421
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.47363999999999995, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=213.0439, std=200.0083
[DEBUG][MIA] Test Set Loss:   mean=193.2244, std=177.7434
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.13725490196078433, 'auc': 0.47900390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=209.8482, std=184.0800
[DEBUG][MIA] Test Set Loss:   mean=197.5390, std=180.1860
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.092, 'auc': 0.482912, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.9715, std=39.6227
[DEBUG][MIA] Test Set Loss:   mean=38.8928, std=45.9890
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09019607843137255, 'auc': 0.5115966796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.8112, std=41.4984
[DEBUG][MIA] Test Set Loss:   mean=40.0969, std=44.8181
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10800000000000001, 'auc': 0.5212159999999999, 'task': 8}
Total correct retain:  1164  Total retain:  2500
Total correct forget:  13178  Total forget:  47500
Total correct test:  196  Total test:  500
Total correct forget test:  2504  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.392, 0.51, 0.376, 0.514, 0.506, 0.254, 0.26, 0.216, 0.23, 0.2, 0.21, 0.182, 0.11, 0.202, 0.266, 0.178, 0.234, 0.242, 0.112, 0.206]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8219, std=1.9372
[DEBUG][MIA] Test Set Loss:   mean=3.7485, std=5.3181
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.25098039215686274, 'auc': 0.705810546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.1183, std=4.9370
[DEBUG][MIA] Test Set Loss:   mean=3.3720, std=4.6601
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.09, 'auc': 0.530152, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4435, std=1.5394
[DEBUG][MIA] Test Set Loss:   mean=4.2571, std=5.4780
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6392156862745098, 'auc': 0.78497314453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8544, std=5.0229
[DEBUG][MIA] Test Set Loss:   mean=4.4202, std=5.1849
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.12600000000000003, 'auc': 0.538304, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7409, std=1.8299
[DEBUG][MIA] Test Set Loss:   mean=2.9224, std=4.3189
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.403921568627451, 'auc': 0.6966552734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8972, std=4.1511
[DEBUG][MIA] Test Set Loss:   mean=3.2222, std=5.0531
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.5012880000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.5730, std=16.5628
[DEBUG][MIA] Test Set Loss:   mean=11.8270, std=15.5419
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.11372549019607843, 'auc': 0.54156494140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=11.2465, std=15.4440
[DEBUG][MIA] Test Set Loss:   mean=13.7681, std=15.5808
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.096, 'auc': 0.42735199999999995, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.9942, std=10.6449
[DEBUG][MIA] Test Set Loss:   mean=10.7960, std=15.1392
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.16862745098039217, 'auc': 0.558563232421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.4759, std=13.7107
[DEBUG][MIA] Test Set Loss:   mean=10.1902, std=12.9009
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.50176, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.2563, std=11.6418
[DEBUG][MIA] Test Set Loss:   mean=11.7500, std=12.2723
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.20392156862745098, 'auc': 0.54644775390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.4098, std=12.6608
[DEBUG][MIA] Test Set Loss:   mean=11.9749, std=12.8492
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10800000000000001, 'auc': 0.488592, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=147.7464, std=161.4448
[DEBUG][MIA] Test Set Loss:   mean=164.9310, std=167.6570
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4453125, 'cv_acc': 0.10196078431372549, 'auc': 0.464874267578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=156.2265, std=172.1492
[DEBUG][MIA] Test Set Loss:   mean=164.6345, std=161.9898
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.1, 'auc': 0.47605600000000003, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=30.5807, std=41.5018
[DEBUG][MIA] Test Set Loss:   mean=33.1684, std=43.9136
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.11764705882352941, 'auc': 0.51812744140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=29.8013, std=35.9235
[DEBUG][MIA] Test Set Loss:   mean=33.1674, std=40.9798
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.094, 'auc': 0.4883200000000001, 'task': 8}
Total correct retain:  1366  Total retain:  2500
Total correct forget:  12743  Total forget:  47500
Total correct test:  229  Total test:  500
Total correct forget test:  2430  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.458, 0.522, 0.408, 0.53, 0.262, 0.29, 0.296, 0.232, 0.262, 0.2, 0.216, 0.196, 0.142, 0.23, 0.202, 0.172, 0.186, 0.252, 0.092, 0.17]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6857, std=6.6146
[DEBUG][MIA] Test Set Loss:   mean=6.1137, std=8.5557
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.1568627450980392, 'auc': 0.6005859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4595, std=9.4738
[DEBUG][MIA] Test Set Loss:   mean=5.9695, std=8.7948
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10200000000000001, 'auc': 0.5254719999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3531, std=1.1223
[DEBUG][MIA] Test Set Loss:   mean=4.0798, std=6.0223
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.7058823529411764, 'auc': 0.75537109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.4403, std=4.9548
[DEBUG][MIA] Test Set Loss:   mean=4.2934, std=6.3525
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11399999999999999, 'auc': 0.54632, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=19.4758, std=26.2841
[DEBUG][MIA] Test Set Loss:   mean=25.6390, std=33.0913
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.1215686274509804, 'auc': 0.5535888671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=27.1749, std=34.3493
[DEBUG][MIA] Test Set Loss:   mean=29.9030, std=35.0215
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.1, 'auc': 0.531848, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=13.6038, std=15.8056
[DEBUG][MIA] Test Set Loss:   mean=17.6259, std=17.7039
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09411764705882353, 'auc': 0.57354736328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=15.9322, std=17.5841
[DEBUG][MIA] Test Set Loss:   mean=17.1238, std=16.5479
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.096, 'auc': 0.452152, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=18.4431, std=22.4467
[DEBUG][MIA] Test Set Loss:   mean=20.8859, std=24.5400
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09019607843137255, 'auc': 0.5401611328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=20.8717, std=25.0643
[DEBUG][MIA] Test Set Loss:   mean=20.0041, std=23.8905
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.126, 'auc': 0.49806400000000006, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=16.1597, std=16.8697
[DEBUG][MIA] Test Set Loss:   mean=17.8329, std=20.0135
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1254901960784314, 'auc': 0.508544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.6147, std=17.8712
[DEBUG][MIA] Test Set Loss:   mean=18.5874, std=18.9520
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.08399999999999999, 'auc': 0.513552, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=203.3728, std=232.8349
[DEBUG][MIA] Test Set Loss:   mean=226.9020, std=234.0052
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09019607843137255, 'auc': 0.46575927734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=233.8698, std=224.0491
[DEBUG][MIA] Test Set Loss:   mean=221.3626, std=228.0146
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.094, 'auc': 0.482144, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=43.6450, std=52.4716
[DEBUG][MIA] Test Set Loss:   mean=45.9961, std=56.7353
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10196078431372549, 'auc': 0.504791259765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=48.7151, std=56.0289
[DEBUG][MIA] Test Set Loss:   mean=46.8018, std=54.2087
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.086, 'auc': 0.49171999999999993, 'task': 8}
Total correct retain:  1208  Total retain:  2500
Total correct forget:  11465  Total forget:  47500
Total correct test:  199  Total test:  500
Total correct forget test:  2219  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.398, 0.424, 0.452, 0.314, 0.21, 0.232, 0.262, 0.214, 0.238, 0.202, 0.2, 0.188, 0.156, 0.212, 0.226, 0.146, 0.23, 0.236, 0.096, 0.2]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6900, std=6.8313
[DEBUG][MIA] Test Set Loss:   mean=3.6145, std=8.0895
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.13725490196078433, 'auc': 0.5682373046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.7597, std=7.8102
[DEBUG][MIA] Test Set Loss:   mean=3.4482, std=7.5326
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.490648, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.7225, std=26.6546
[DEBUG][MIA] Test Set Loss:   mean=18.1734, std=28.1095
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.09803921568627451, 'auc': 0.562164306640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.5860, std=26.9823
[DEBUG][MIA] Test Set Loss:   mean=17.9157, std=31.2495
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10600000000000001, 'auc': 0.5223439999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=14.1316, std=29.5381
[DEBUG][MIA] Test Set Loss:   mean=17.2076, std=25.2511
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09411764705882353, 'auc': 0.560699462890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=20.0321, std=34.5043
[DEBUG][MIA] Test Set Loss:   mean=19.0827, std=28.6933
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11400000000000002, 'auc': 0.475424, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=21.7628, std=33.9922
[DEBUG][MIA] Test Set Loss:   mean=22.6999, std=28.9324
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.56622314453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.0008, std=28.5805
[DEBUG][MIA] Test Set Loss:   mean=22.0063, std=29.4322
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.5077280000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=12.4676, std=20.5275
[DEBUG][MIA] Test Set Loss:   mean=15.6466, std=24.3578
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10588235294117647, 'auc': 0.570068359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=15.5956, std=22.0414
[DEBUG][MIA] Test Set Loss:   mean=15.5465, std=26.2953
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.48427200000000004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=17.2414, std=23.5887
[DEBUG][MIA] Test Set Loss:   mean=19.6534, std=23.8629
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09019607843137255, 'auc': 0.45599365234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.4191, std=23.1499
[DEBUG][MIA] Test Set Loss:   mean=18.1636, std=21.0152
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.5364559999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=195.0650, std=234.6618
[DEBUG][MIA] Test Set Loss:   mean=201.6235, std=216.3192
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09803921568627451, 'auc': 0.523101806640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=208.4995, std=239.7793
[DEBUG][MIA] Test Set Loss:   mean=243.4271, std=248.3180
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.11000000000000001, 'auc': 0.44758400000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=44.8290, std=60.8464
[DEBUG][MIA] Test Set Loss:   mean=53.4345, std=64.5180
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.08627450980392157, 'auc': 0.534423828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=48.7027, std=60.3056
[DEBUG][MIA] Test Set Loss:   mean=51.1205, std=61.2944
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.09, 'auc': 0.50936, 'task': 8}
Total correct retain:  1251  Total retain:  2500
Total correct forget:  11476  Total forget:  47500
Total correct test:  216  Total test:  500
Total correct forget test:  2248  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.432, 0.532, 0.246, 0.3, 0.282, 0.248, 0.224, 0.204, 0.21, 0.2, 0.2, 0.156, 0.2, 0.252, 0.266, 0.208, 0.18, 0.256, 0.136, 0.196]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 9, 6, 7, 7, 5, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.2840, std=15.6342
[DEBUG][MIA] Test Set Loss:   mean=12.2799, std=14.9930
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.13333333333333333, 'auc': 0.56048583984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 6 7 7 8 6 5 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 8 5 9 5 8 7 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=14.2164, std=20.4698
[DEBUG][MIA] Test Set Loss:   mean=14.6254, std=20.9802
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10600000000000001, 'auc': 0.48594400000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 11, 11, 13, 13, 14, 12, 13, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=14.3323, std=20.1097
[DEBUG][MIA] Test Set Loss:   mean=16.1514, std=21.6030
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10588235294117647, 'auc': 0.569305419921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 11 14 12 14 12 13 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 11 10 12 12 10 12 10 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=14.8266, std=19.1767
[DEBUG][MIA] Test Set Loss:   mean=16.9949, std=20.6104
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.088, 'auc': 0.46124800000000005, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 18, 19, 16, 17, 16, 18, 17, 16, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.7711, std=23.5162
[DEBUG][MIA] Test Set Loss:   mean=12.9120, std=19.5692
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.10196078431372549, 'auc': 0.55010986328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 16 18 16 17 17 15 18 18 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 19 16 18 16 17 17 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.9162, std=21.9136
[DEBUG][MIA] Test Set Loss:   mean=13.5870, std=20.4094
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.483368, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 24, 21, 22, 23, 23, 21, 21, 24, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.6099, std=18.3607
[DEBUG][MIA] Test Set Loss:   mean=11.2864, std=16.2291
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.08235294117647059, 'auc': 0.371368408203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 24 23 23 24 21 23 21 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 22 24 21 20 21 21 24 23 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.4374, std=20.4959
[DEBUG][MIA] Test Set Loss:   mean=12.0676, std=18.7651
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.08199999999999999, 'auc': 0.51624, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 27, 26, 27, 28, 26, 28, 27, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.4319, std=15.5369
[DEBUG][MIA] Test Set Loss:   mean=10.2677, std=11.9539
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.1215686274509804, 'auc': 0.55230712890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 26 29 25 25 25 25 26 25 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 27 29 25 27 25 26 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=11.7267, std=17.2036
[DEBUG][MIA] Test Set Loss:   mean=12.0564, std=16.4556
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.506096, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 31, 31, 32, 31, 30, 34, 31, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.2477, std=15.4375
[DEBUG][MIA] Test Set Loss:   mean=14.0417, std=15.9130
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09803921568627451, 'auc': 0.54266357421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 31 30 33 31 31 33 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 30 33 32 31 33 30 33 32 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.5698, std=17.4120
[DEBUG][MIA] Test Set Loss:   mean=13.6778, std=15.6400
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10400000000000001, 'auc': 0.46599199999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 36, 39, 39, 36, 39, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=120.3258, std=146.6756
[DEBUG][MIA] Test Set Loss:   mean=147.4496, std=154.9915
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09803921568627451, 'auc': 0.451446533203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 38 35 36 35 38 38 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 37 35 37 37 35 35 35 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=138.5449, std=172.9618
[DEBUG][MIA] Test Set Loss:   mean=145.4166, std=164.5054
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10200000000000001, 'auc': 0.525168, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 41, 41, 43, 41, 44, 44, 40, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=30.0085, std=39.2669
[DEBUG][MIA] Test Set Loss:   mean=35.4052, std=45.0259
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.11372549019607843, 'auc': 0.527587890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 42 44 41 44 44 43 42 42 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 40 42 42 43 41 43 40 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=26.0120, std=33.8279
[DEBUG][MIA] Test Set Loss:   mean=30.0041, std=36.7847
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.08399999999999999, 'auc': 0.459064, 'task': 8}
Total correct retain:  1279  Total retain:  2500
Total correct forget:  10335  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  2026  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.444, 0.248, 0.2, 0.222, 0.316, 0.206, 0.206, 0.204, 0.21, 0.2, 0.2, 0.16, 0.17, 0.226, 0.234, 0.246, 0.206, 0.266, 0.086, 0.246]
Number of constraint violations:  0
