Requirement already satisfied: pyyaml in /usr/lib64/python3.12/site-packages (6.0.1)
Requirement already satisfied: setuptools in /usr/lib/python3.12/site-packages (68.2.2)
Requirement already satisfied: matplotlib in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.10.1)
Requirement already satisfied: contourpy>=1.0.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler>=0.10 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy>=1.23 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.2.4)
Requirement already satisfied: packaging>=20.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow>=8 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing>=2.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: quadprog in /dcs/21/u2110391/.local/lib/python3.12/site-packages (0.1.13)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from quadprog) (2.2.4)
Requirement already satisfied: pyparsing in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.2.3)
Requirement already satisfied: pandas in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.3)
Requirement already satisfied: numpy>=1.26.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.4)
Fri Apr 25 22:23:22 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 38%   68C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Command line arguments:
number_of_gpus: 1
algorithm: negagem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 20
unlearn_mem_strength: 0.5
unlearn_batch_size: 10
average_over_n_runs: 3
salun: 0
salun_strength: 0.2
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Fri Apr 25 22:23:28 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 32%   66C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['table', 'sea', 'orchids', 'willow', 'pine', 'mouse', 'sweet peppers', 'bed', 'tiger', 'lizard', 'cloud', 'hamster', 'fox', 'house', 'camel', 'skunk', 'man', 'tank', 'caterpillar', 'bus', 'forest', 'snake', 'leopard', 'maple', 'spider', 'wolf', 'crab', 'bicycle', 'kangaroo', 'butterfly', 'seal', 'palm', 'television', 'tractor', 'lion', 'roses', 'snail', 'clock', 'telephone', 'trout', 'crocodile', 'couch', 'wardrobe', 'cups', 'aquarium fish', 'worm', 'chimpanzee', 'bear', 'road', 'poppies', 'streetcar', 'mushrooms', 'elephant', 'cans', 'otter', 'tulips', 'train', 'oak', 'shark', 'girl', 'cattle', 'computer keyboard', 'oranges', 'sunflowers', 'whale', 'rocket', 'chair', 'bridge', 'plates', 'shrew', 'lamp', 'mountain', 'bottles', 'ray', 'flatfish', 'raccoon', 'beaver', 'possum', 'rabbit', 'cockroach', 'porcupine', 'dinosaur', 'lobster', 'lawn-mower', 'bowls', 'plain', 'castle', 'apples', 'baby', 'bee', 'turtle', 'motorcycle', 'squirrel', 'pickup truck', 'beetle', 'skyscraper', 'woman', 'dolphin', 'pears', 'boy']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2213  Total retain:  2500
Total correct forget:  9438  Total forget:  47500
Total correct test:  376  Total test:  500
Total correct forget test:  1881  Total test forget:  9500
After learning task 1
Task accuracies: [0.752, 0.178, 0.206, 0.128, 0.204, 0.21, 0.232, 0.19, 0.2, 0.202, 0.194, 0.2, 0.186, 0.224, 0.192, 0.182, 0.206, 0.216, 0.21, 0.202]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0692, std=0.3125
[DEBUG][MIA] Test Set Loss:   mean=1.2348, std=2.3802
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.26666666666666666, 'auc': 0.677093505859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0993, std=0.5331
[DEBUG][MIA] Test Set Loss:   mean=1.6442, std=2.6406
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.698, 'cv_acc': 0.23399999999999999, 'auc': 0.799072, 'task': 1}
2 1
Total correct retain:  1944  Total retain:  2500
Total correct forget:  11101  Total forget:  47500
Total correct test:  339  Total test:  500
Total correct forget test:  2066  Total test forget:  9500
After learning task 2
Task accuracies: [0.678, 0.656, 0.192, 0.134, 0.248, 0.206, 0.19, 0.198, 0.214, 0.216, 0.238, 0.184, 0.218, 0.206, 0.182, 0.148, 0.162, 0.144, 0.198, 0.198]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0083, std=0.0223
[DEBUG][MIA] Test Set Loss:   mean=2.0860, std=2.6918
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.6627450980392158, 'auc': 0.825714111328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7981, std=1.5110
[DEBUG][MIA] Test Set Loss:   mean=1.4654, std=2.6608
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.254, 'auc': 0.5771999999999999, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0069, std=0.0270
[DEBUG][MIA] Test Set Loss:   mean=1.0851, std=2.7282
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2627450980392157, 'auc': 0.73516845703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0183, std=0.2269
[DEBUG][MIA] Test Set Loss:   mean=1.0990, std=2.7669
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.22999999999999998, 'auc': 0.738632, 'task': 2}
3 2
Total correct retain:  1922  Total retain:  2500
Total correct forget:  12710  Total forget:  47500
Total correct test:  363  Total test:  500
Total correct forget test:  2376  Total test forget:  9500
After learning task 3
Task accuracies: [0.726, 0.602, 0.796, 0.244, 0.206, 0.196, 0.144, 0.196, 0.176, 0.254, 0.23, 0.186, 0.122, 0.204, 0.158, 0.182, 0.262, 0.15, 0.208, 0.236]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0134, std=0.0684
[DEBUG][MIA] Test Set Loss:   mean=1.9801, std=2.9317
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7568627450980393, 'auc': 0.8233642578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3356, std=2.3955
[DEBUG][MIA] Test Set Loss:   mean=2.0942, std=2.8805
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.186, 'auc': 0.5954, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.0623, std=2.6142
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2627450980392157, 'auc': 0.71331787109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1427, std=0.4459
[DEBUG][MIA] Test Set Loss:   mean=0.8813, std=1.9636
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.176, 'auc': 0.648272, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=0.8557, std=2.2150
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2156862745098039, 'auc': 0.71051025390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0302
[DEBUG][MIA] Test Set Loss:   mean=0.7287, std=1.9255
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.22400000000000003, 'auc': 0.7392, 'task': 3}
4 3
Total correct retain:  1853  Total retain:  2500
Total correct forget:  14637  Total forget:  47500
Total correct test:  334  Total test:  500
Total correct forget test:  2654  Total test forget:  9500
After learning task 4
Task accuracies: [0.668, 0.552, 0.74, 0.808, 0.224, 0.186, 0.192, 0.184, 0.23, 0.3, 0.224, 0.2, 0.214, 0.15, 0.156, 0.188, 0.214, 0.092, 0.196, 0.258]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.8454, std=2.8886
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7568627450980392, 'auc': 0.8189697265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3750, std=2.3926
[DEBUG][MIA] Test Set Loss:   mean=2.0601, std=2.7961
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.11200000000000002, 'auc': 0.5855440000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.4962, std=2.2279
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.6901960784313725, 'auc': 0.793182373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8872, std=1.7314
[DEBUG][MIA] Test Set Loss:   mean=1.5070, std=2.5195
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.176, 'auc': 0.594552, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0262
[DEBUG][MIA] Test Set Loss:   mean=1.4470, std=2.4115
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2705882352941177, 'auc': 0.808563232421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5995, std=1.2918
[DEBUG][MIA] Test Set Loss:   mean=1.2656, std=2.2812
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.20800000000000002, 'auc': 0.601712, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0321
[DEBUG][MIA] Test Set Loss:   mean=1.2364, std=2.3277
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2627450980392157, 'auc': 0.766357421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0126
[DEBUG][MIA] Test Set Loss:   mean=1.3681, std=2.6102
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.722, 'cv_acc': 0.256, 'auc': 0.791472, 'task': 4}
5 4
Total correct retain:  1822  Total retain:  2500
Total correct forget:  15275  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  2698  Total test forget:  9500
After learning task 5
Task accuracies: [0.674, 0.548, 0.61, 0.654, 0.726, 0.192, 0.174, 0.198, 0.194, 0.3, 0.194, 0.19, 0.168, 0.156, 0.13, 0.178, 0.232, 0.154, 0.19, 0.208]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0124, std=0.0734
[DEBUG][MIA] Test Set Loss:   mean=2.1906, std=2.9900
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6470588235294118, 'auc': 0.83837890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7244, std=2.7889
[DEBUG][MIA] Test Set Loss:   mean=2.0294, std=3.2860
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.184, 'auc': 0.545768, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.1052, std=1.9281
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.2549019607843137, 'auc': 0.872833251953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9426, std=2.0572
[DEBUG][MIA] Test Set Loss:   mean=1.2991, std=2.3899
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.16, 'auc': 0.5424, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=0.6666, std=1.3510
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6823529411764706, 'auc': 0.84075927734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9151, std=1.7848
[DEBUG][MIA] Test Set Loss:   mean=1.1949, std=2.2390
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.178, 'auc': 0.537632, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.7419, std=2.7286
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7137254901960783, 'auc': 0.806549072265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3124, std=1.0235
[DEBUG][MIA] Test Set Loss:   mean=1.5133, std=2.7473
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.242, 'auc': 0.6261680000000001, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=1.0483, std=2.3987
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2705882352941177, 'auc': 0.8026123046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0502
[DEBUG][MIA] Test Set Loss:   mean=1.2656, std=2.6695
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.684, 'cv_acc': 0.29799999999999993, 'auc': 0.7847040000000001, 'task': 5}
6 5
Total correct retain:  1802  Total retain:  2500
Total correct forget:  16681  Total forget:  47500
Total correct test:  346  Total test:  500
Total correct forget test:  2905  Total test forget:  9500
After learning task 6
Task accuracies: [0.692, 0.578, 0.668, 0.688, 0.658, 0.716, 0.136, 0.222, 0.146, 0.278, 0.206, 0.162, 0.074, 0.164, 0.148, 0.186, 0.21, 0.176, 0.206, 0.188]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0333
[DEBUG][MIA] Test Set Loss:   mean=1.7703, std=2.8794
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7176470588235294, 'auc': 0.7890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5744, std=2.6995
[DEBUG][MIA] Test Set Loss:   mean=2.1513, std=3.2950
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.5498639999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=1.3422, std=2.3409
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6980392156862746, 'auc': 0.829803466796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9790, std=1.9105
[DEBUG][MIA] Test Set Loss:   mean=1.3697, std=2.2988
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.138, 'auc': 0.5735520000000001, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=1.1776, std=2.3983
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2901960784313725, 'auc': 0.844268798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8971, std=1.9247
[DEBUG][MIA] Test Set Loss:   mean=1.4337, std=2.6037
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.172, 'auc': 0.583528, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=2.1243, std=2.9105
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.81640625, 'cv_acc': 0.7215686274509804, 'auc': 0.93621826171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5328, std=1.5007
[DEBUG][MIA] Test Set Loss:   mean=1.7530, std=2.9108
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.242, 'auc': 0.65876, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.3314, std=2.6367
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7176470588235293, 'auc': 0.86810302734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1727, std=0.6355
[DEBUG][MIA] Test Set Loss:   mean=1.5736, std=2.5614
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.23000000000000004, 'auc': 0.7163120000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0101
[DEBUG][MIA] Test Set Loss:   mean=0.9146, std=2.0378
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2549019607843137, 'auc': 0.717681884765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=0.6943, std=1.7005
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.238, 'auc': 0.73068, 'task': 6}
7 6
Total correct retain:  1753  Total retain:  2500
Total correct forget:  18651  Total forget:  47500
Total correct test:  321  Total test:  500
Total correct forget test:  3269  Total test forget:  9500
After learning task 7
Task accuracies: [0.642, 0.61, 0.678, 0.666, 0.606, 0.66, 0.806, 0.234, 0.196, 0.232, 0.294, 0.182, 0.096, 0.14, 0.156, 0.172, 0.186, 0.196, 0.208, 0.22]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.9433, std=2.8637
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7372549019607842, 'auc': 0.887481689453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4648, std=2.7790
[DEBUG][MIA] Test Set Loss:   mean=1.8114, std=2.9391
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.128, 'auc': 0.566616, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.4930, std=2.6221
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.30980392156862746, 'auc': 0.82281494140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0369, std=2.2444
[DEBUG][MIA] Test Set Loss:   mean=2.0687, std=3.2428
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.146, 'auc': 0.600976, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=1.1327, std=2.0545
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7411764705882353, 'auc': 0.86279296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2037, std=2.4979
[DEBUG][MIA] Test Set Loss:   mean=1.5037, std=2.4120
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.152, 'auc': 0.55724, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=1.5475, std=2.6700
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7294117647058823, 'auc': 0.872100830078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8504, std=1.8689
[DEBUG][MIA] Test Set Loss:   mean=1.5345, std=2.6215
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.19, 'auc': 0.5777439999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.4584, std=2.4869
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7372549019607842, 'auc': 0.863006591796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3489, std=0.9637
[DEBUG][MIA] Test Set Loss:   mean=1.7811, std=2.9631
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.248, 'auc': 0.6909359999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=1.1565, std=2.0329
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.28627450980392155, 'auc': 0.80499267578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1838, std=0.5872
[DEBUG][MIA] Test Set Loss:   mean=1.1857, std=2.1719
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.21000000000000002, 'auc': 0.6592800000000001, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0236, std=0.2378
[DEBUG][MIA] Test Set Loss:   mean=1.1094, std=2.3654
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.21176470588235294, 'auc': 0.726287841796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=1.1957, std=2.4576
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.674, 'cv_acc': 0.22000000000000003, 'auc': 0.7312239999999999, 'task': 7}
8 7
Total correct retain:  1776  Total retain:  2500
Total correct forget:  20338  Total forget:  47500
Total correct test:  327  Total test:  500
Total correct forget test:  3480  Total test forget:  9500
After learning task 8
Task accuracies: [0.654, 0.62, 0.598, 0.632, 0.606, 0.614, 0.716, 0.768, 0.144, 0.238, 0.312, 0.178, 0.118, 0.204, 0.126, 0.166, 0.216, 0.31, 0.202, 0.192]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=2.5042, std=3.2901
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7098039215686274, 'auc': 0.8746337890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4320, std=2.8712
[DEBUG][MIA] Test Set Loss:   mean=2.2355, std=3.0765
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.11600000000000002, 'auc': 0.601728, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.6365, std=2.5258
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7450980392156863, 'auc': 0.871734619140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1843, std=2.4450
[DEBUG][MIA] Test Set Loss:   mean=1.6270, std=2.7693
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12400000000000003, 'auc': 0.551992, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.7332, std=2.6878
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7058823529411764, 'auc': 0.882476806640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0235, std=2.0929
[DEBUG][MIA] Test Set Loss:   mean=1.9245, std=2.8461
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.10600000000000001, 'auc': 0.611944, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=2.1979, std=3.1973
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.6941176470588236, 'auc': 0.88043212890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9966, std=1.8849
[DEBUG][MIA] Test Set Loss:   mean=1.9980, std=3.1552
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.21200000000000002, 'auc': 0.577568, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.8412, std=2.5313
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7686274509803922, 'auc': 0.90631103515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6405, std=1.6421
[DEBUG][MIA] Test Set Loss:   mean=1.8963, std=2.8166
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.236, 'auc': 0.661272, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.2433, std=2.3153
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2941176470588235, 'auc': 0.84423828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4511, std=1.3523
[DEBUG][MIA] Test Set Loss:   mean=1.0134, std=1.9751
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.198, 'auc': 0.6375919999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=0.9131, std=1.9665
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.27450980392156865, 'auc': 0.801116943359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2163, std=0.6790
[DEBUG][MIA] Test Set Loss:   mean=1.1788, std=2.4366
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.23399999999999999, 'auc': 0.6453040000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0097, std=0.0878
[DEBUG][MIA] Test Set Loss:   mean=0.5972, std=1.7604
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.23137254901960785, 'auc': 0.661712646484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0075, std=0.0678
[DEBUG][MIA] Test Set Loss:   mean=0.7405, std=1.9318
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.22800000000000004, 'auc': 0.637304, 'task': 8}
Total correct retain:  1751  Total retain:  2500
Total correct forget:  21539  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  3722  Total test forget:  9500
After learning task 9
Task accuracies: [0.63, 0.574, 0.606, 0.608, 0.574, 0.576, 0.712, 0.71, 0.814, 0.258, 0.3, 0.184, 0.198, 0.156, 0.136, 0.196, 0.244, 0.184, 0.198, 0.216]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.9012, std=3.2231
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7254901960784313, 'auc': 0.851287841796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4257, std=2.5849
[DEBUG][MIA] Test Set Loss:   mean=2.1548, std=3.3465
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.5864959999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.4969, std=2.5958
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7019607843137254, 'auc': 0.833251953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0142, std=2.2820
[DEBUG][MIA] Test Set Loss:   mean=1.4974, std=2.7004
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.122, 'auc': 0.5855520000000001, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0113
[DEBUG][MIA] Test Set Loss:   mean=1.4849, std=2.3887
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7176470588235294, 'auc': 0.8580322265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4351, std=2.6451
[DEBUG][MIA] Test Set Loss:   mean=1.7875, std=2.9459
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.118, 'auc': 0.549872, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.0153, std=2.7567
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7490196078431373, 'auc': 0.84368896484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8702, std=1.8700
[DEBUG][MIA] Test Set Loss:   mean=2.0637, std=3.2104
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.196, 'auc': 0.6109840000000001, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.7257, std=3.0436
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7686274509803922, 'auc': 0.863189697265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7460, std=1.7063
[DEBUG][MIA] Test Set Loss:   mean=1.8102, std=2.8690
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.182, 'auc': 0.653056, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.3971, std=2.2696
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.6352941176470587, 'auc': 0.860870361328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6630, std=1.6308
[DEBUG][MIA] Test Set Loss:   mean=1.3671, std=2.4021
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.172, 'auc': 0.630224, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.2594, std=2.3919
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2549019607843137, 'auc': 0.758697509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3327, std=0.9825
[DEBUG][MIA] Test Set Loss:   mean=1.1713, std=2.4891
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.20600000000000002, 'auc': 0.5988, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=0.9130, std=1.8313
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.29411764705882354, 'auc': 0.748565673828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1764, std=0.5879
[DEBUG][MIA] Test Set Loss:   mean=1.0125, std=1.9610
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.20600000000000002, 'auc': 0.6388079999999999, 'task': 8}
Total correct retain:  1795  Total retain:  2500
Total correct forget:  22884  Total forget:  47500
Total correct test:  328  Total test:  500
Total correct forget test:  3983  Total test forget:  9500
After learning task 10
Task accuracies: [0.656, 0.592, 0.664, 0.634, 0.576, 0.582, 0.682, 0.716, 0.756, 0.86, 0.258, 0.164, 0.172, 0.216, 0.134, 0.218, 0.232, 0.116, 0.214, 0.18]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=2.3587, std=3.6760
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7450980392156863, 'auc': 0.8526611328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7154, std=2.6997
[DEBUG][MIA] Test Set Loss:   mean=2.1865, std=3.3613
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.138, 'auc': 0.543424, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.8159, std=3.0023
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2980392156862745, 'auc': 0.821624755859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9685, std=2.4072
[DEBUG][MIA] Test Set Loss:   mean=1.3738, std=2.4817
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12400000000000003, 'auc': 0.576768, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=2.0176, std=3.6005
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2862745098039216, 'auc': 0.868865966796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4188, std=2.6585
[DEBUG][MIA] Test Set Loss:   mean=1.8855, std=3.2862
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.154, 'auc': 0.559104, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.0487, std=3.3301
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7450980392156863, 'auc': 0.8121337890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3057, std=2.5517
[DEBUG][MIA] Test Set Loss:   mean=2.0222, std=3.2193
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.154, 'auc': 0.567544, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.4383, std=2.3877
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7607843137254902, 'auc': 0.89031982421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8997, std=1.8351
[DEBUG][MIA] Test Set Loss:   mean=1.8758, std=2.8794
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.11200000000000002, 'auc': 0.619584, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.4503, std=2.4569
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2901960784313725, 'auc': 0.86505126953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6416, std=1.5962
[DEBUG][MIA] Test Set Loss:   mean=1.1907, std=2.1867
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.144, 'auc': 0.553944, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.2690, std=2.7306
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.27450980392156865, 'auc': 0.80340576171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4715, std=1.4276
[DEBUG][MIA] Test Set Loss:   mean=1.3160, std=2.6256
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15, 'auc': 0.60484, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.1426, std=2.1110
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2901960784313726, 'auc': 0.7847900390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3078, std=1.0300
[DEBUG][MIA] Test Set Loss:   mean=1.0931, std=2.0151
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.196, 'auc': 0.623064, 'task': 8}
Total correct retain:  1791  Total retain:  2500
Total correct forget:  24292  Total forget:  47500
Total correct test:  332  Total test:  500
Total correct forget test:  4195  Total test forget:  9500
After learning task 11
Task accuracies: [0.664, 0.59, 0.648, 0.646, 0.59, 0.584, 0.702, 0.706, 0.728, 0.796, 0.77, 0.158, 0.148, 0.146, 0.15, 0.21, 0.238, 0.158, 0.206, 0.216]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9982490539550781)
broken out of loop
Accuracy, Confidence: (0.296875, 0.9525488615036011)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.7592, std=7.3659
[DEBUG][MIA] Test Set Loss:   mean=7.5019, std=8.1878
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.2156862745098039, 'auc': 0.57525634765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.6455, std=7.3955
[DEBUG][MIA] Test Set Loss:   mean=6.7396, std=7.3559
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10600000000000001, 'auc': 0.5072479999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.0742, std=4.4356
[DEBUG][MIA] Test Set Loss:   mean=6.1796, std=4.6977
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.15294117647058822, 'auc': 0.646240234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.6953, std=5.0115
[DEBUG][MIA] Test Set Loss:   mean=5.9403, std=5.0844
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11200000000000002, 'auc': 0.51568, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9646, std=6.6002
[DEBUG][MIA] Test Set Loss:   mean=6.1082, std=6.0328
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.16862745098039217, 'auc': 0.578643798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.8348, std=7.7736
[DEBUG][MIA] Test Set Loss:   mean=6.3211, std=6.8423
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.088, 'auc': 0.485152, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.7975, std=4.7950
[DEBUG][MIA] Test Set Loss:   mean=4.1005, std=4.2681
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.16862745098039217, 'auc': 0.65399169921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.3182, std=4.3366
[DEBUG][MIA] Test Set Loss:   mean=3.8831, std=4.2732
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.098, 'auc': 0.555408, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3552, std=3.8083
[DEBUG][MIA] Test Set Loss:   mean=4.6008, std=4.3992
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.18039215686274512, 'auc': 0.690643310546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.8402, std=5.2193
[DEBUG][MIA] Test Set Loss:   mean=4.7277, std=5.3910
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10200000000000001, 'auc': 0.5657439999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5535, std=6.0440
[DEBUG][MIA] Test Set Loss:   mean=5.5009, std=6.1182
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09411764705882353, 'auc': 0.56396484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.9933, std=6.0118
[DEBUG][MIA] Test Set Loss:   mean=6.4750, std=7.0177
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.444, 'cv_acc': 0.092, 'auc': 0.438384, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.0526, std=5.5704
[DEBUG][MIA] Test Set Loss:   mean=3.9599, std=5.4529
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.51580810546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.0229, std=4.7307
[DEBUG][MIA] Test Set Loss:   mean=4.4355, std=5.8021
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.074, 'auc': 0.502176, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6427, std=5.5065
[DEBUG][MIA] Test Set Loss:   mean=5.6133, std=6.9054
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09803921568627451, 'auc': 0.59356689453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.8357, std=6.5807
[DEBUG][MIA] Test Set Loss:   mean=5.2350, std=6.5041
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.463192, 'task': 8}
Total correct retain:  651  Total retain:  2500
Total correct forget:  13175  Total forget:  47500
Total correct test:  130  Total test:  500
Total correct forget test:  2432  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.26, 0.282, 0.206, 0.29, 0.338, 0.31, 0.278, 0.354, 0.384, 0.394, 0.298, 0.188, 0.218, 0.244, 0.14, 0.248, 0.18, 0.13, 0.262, 0.12]
Unlearning task: 10
Accuracy, Confidence: (0.48046875, 0.7909030914306641)
broken out of loop
Accuracy, Confidence: (0.3046875, 0.7891900539398193)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3140, std=5.5321
[DEBUG][MIA] Test Set Loss:   mean=5.9875, std=5.8646
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.13333333333333333, 'auc': 0.6158447265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.9323, std=6.3504
[DEBUG][MIA] Test Set Loss:   mean=6.3613, std=6.1444
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.098, 'auc': 0.520656, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8453, std=4.3515
[DEBUG][MIA] Test Set Loss:   mean=5.5457, std=4.9536
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.13725490196078433, 'auc': 0.61578369140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0477, std=4.4037
[DEBUG][MIA] Test Set Loss:   mean=5.7427, std=4.8481
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10800000000000001, 'auc': 0.537952, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0537, std=5.2233
[DEBUG][MIA] Test Set Loss:   mean=6.5823, std=5.5841
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.1411764705882353, 'auc': 0.660308837890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8020, std=5.9436
[DEBUG][MIA] Test Set Loss:   mean=5.9050, std=5.5361
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.122, 'auc': 0.513696, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8441, std=2.8533
[DEBUG][MIA] Test Set Loss:   mean=3.6875, std=3.8178
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.10588235294117647, 'auc': 0.6844482421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1963, std=3.9507
[DEBUG][MIA] Test Set Loss:   mean=3.6067, std=3.6376
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.124, 'auc': 0.5540160000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4114, std=3.3690
[DEBUG][MIA] Test Set Loss:   mean=4.8004, std=4.4759
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.13725490196078433, 'auc': 0.68914794921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.2555, std=3.7758
[DEBUG][MIA] Test Set Loss:   mean=4.1805, std=4.3315
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.128, 'auc': 0.558336, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.6144, std=4.3493
[DEBUG][MIA] Test Set Loss:   mean=4.9569, std=4.8747
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.1411764705882353, 'auc': 0.6014404296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.0853, std=5.4285
[DEBUG][MIA] Test Set Loss:   mean=4.7520, std=5.1531
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.13799999999999998, 'auc': 0.49404800000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8177, std=5.1490
[DEBUG][MIA] Test Set Loss:   mean=4.8085, std=5.3196
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.10588235294117647, 'auc': 0.57745361328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7961, std=4.7828
[DEBUG][MIA] Test Set Loss:   mean=4.8528, std=5.3280
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.12, 'auc': 0.495568, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7583, std=5.3433
[DEBUG][MIA] Test Set Loss:   mean=4.8797, std=5.2131
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.12549019607843137, 'auc': 0.58197021484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1030, std=5.1186
[DEBUG][MIA] Test Set Loss:   mean=4.5166, std=5.5291
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.521408, 'task': 8}
Total correct retain:  539  Total retain:  2500
Total correct forget:  12476  Total forget:  47500
Total correct test:  130  Total test:  500
Total correct forget test:  2284  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.26, 0.256, 0.206, 0.246, 0.306, 0.302, 0.288, 0.334, 0.362, 0.268, 0.28, 0.186, 0.246, 0.218, 0.152, 0.232, 0.184, 0.148, 0.242, 0.112]
Unlearning task: 9
Accuracy, Confidence: (0.50390625, 0.8797863721847534)
broken out of loop
Accuracy, Confidence: (0.328125, 0.9315502643585205)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6398, std=7.2294
[DEBUG][MIA] Test Set Loss:   mean=7.3339, std=8.2016
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.13333333333333333, 'auc': 0.5751953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.4807, std=7.0204
[DEBUG][MIA] Test Set Loss:   mean=8.1152, std=8.0442
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.092, 'auc': 0.557216, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.9646, std=5.0141
[DEBUG][MIA] Test Set Loss:   mean=7.2492, std=5.7141
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.11764705882352944, 'auc': 0.6171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.7962, std=5.6263
[DEBUG][MIA] Test Set Loss:   mean=6.7292, std=5.4932
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08399999999999999, 'auc': 0.49907200000000007, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.8335, std=5.3475
[DEBUG][MIA] Test Set Loss:   mean=5.8288, std=5.3014
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.1607843137254902, 'auc': 0.57305908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2965, std=6.1408
[DEBUG][MIA] Test Set Loss:   mean=6.2343, std=5.7648
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.092, 'auc': 0.5020640000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4893, std=4.2861
[DEBUG][MIA] Test Set Loss:   mean=4.2510, std=4.1329
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.196078431372549, 'auc': 0.577880859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.8517, std=4.3330
[DEBUG][MIA] Test Set Loss:   mean=4.4323, std=4.4385
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11800000000000002, 'auc': 0.546, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5842, std=3.2670
[DEBUG][MIA] Test Set Loss:   mean=4.3107, std=4.4859
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.15294117647058822, 'auc': 0.643035888671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.6520, std=4.3840
[DEBUG][MIA] Test Set Loss:   mean=4.2335, std=4.4127
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11200000000000002, 'auc': 0.554624, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.1811, std=4.7926
[DEBUG][MIA] Test Set Loss:   mean=5.2916, std=5.9799
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.11372549019607843, 'auc': 0.4678955078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3381, std=6.3308
[DEBUG][MIA] Test Set Loss:   mean=5.7989, std=6.5175
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11000000000000001, 'auc': 0.523008, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.4059, std=5.9833
[DEBUG][MIA] Test Set Loss:   mean=6.5970, std=7.0221
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.14901960784313725, 'auc': 0.435333251953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.3196, std=6.0914
[DEBUG][MIA] Test Set Loss:   mean=6.3869, std=6.1127
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10200000000000001, 'auc': 0.49142399999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9121, std=10.0439
[DEBUG][MIA] Test Set Loss:   mean=9.3765, std=8.4687
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.09019607843137255, 'auc': 0.41900634765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.0643, std=10.0045
[DEBUG][MIA] Test Set Loss:   mean=8.9680, std=9.6345
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.490824, 'task': 8}
Total correct retain:  468  Total retain:  2500
Total correct forget:  11071  Total forget:  47500
Total correct test:  105  Total test:  500
Total correct forget test:  2076  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.21, 0.246, 0.19, 0.214, 0.246, 0.252, 0.244, 0.274, 0.26, 0.214, 0.254, 0.186, 0.25, 0.244, 0.116, 0.254, 0.142, 0.22, 0.222, 0.124]
Unlearning task: 8
Accuracy, Confidence: (0.34765625, 0.8681962490081787)
broken out of loop
Accuracy, Confidence: (0.359375, 0.8641170263290405)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.3744, std=7.4211
[DEBUG][MIA] Test Set Loss:   mean=7.1169, std=8.3075
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.18039215686274507, 'auc': 0.53485107421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.1142, std=7.4760
[DEBUG][MIA] Test Set Loss:   mean=7.4963, std=7.9053
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10800000000000001, 'auc': 0.520256, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.4970, std=4.9825
[DEBUG][MIA] Test Set Loss:   mean=7.0837, std=5.6211
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.11372549019607844, 'auc': 0.64813232421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.5247, std=5.6712
[DEBUG][MIA] Test Set Loss:   mean=6.8232, std=5.3422
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.5255839999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9625, std=5.5939
[DEBUG][MIA] Test Set Loss:   mean=6.5854, std=5.9863
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.10196078431372549, 'auc': 0.595062255859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8225, std=5.4256
[DEBUG][MIA] Test Set Loss:   mean=6.2772, std=5.7436
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10800000000000001, 'auc': 0.520656, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.0056, std=3.9549
[DEBUG][MIA] Test Set Loss:   mean=4.7270, std=4.6051
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.14509803921568626, 'auc': 0.635498046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.8321, std=3.8611
[DEBUG][MIA] Test Set Loss:   mean=4.2910, std=4.1450
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12599999999999997, 'auc': 0.53184, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3534, std=3.2796
[DEBUG][MIA] Test Set Loss:   mean=3.6260, std=3.8286
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.32941176470588235, 'auc': 0.64154052734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.8354, std=4.4791
[DEBUG][MIA] Test Set Loss:   mean=4.2674, std=4.5635
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.547296, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.1488, std=5.9848
[DEBUG][MIA] Test Set Loss:   mean=6.2875, std=7.1080
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.1568627450980392, 'auc': 0.5438232421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3047, std=5.9615
[DEBUG][MIA] Test Set Loss:   mean=6.2069, std=6.7238
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.534656, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.8822, std=5.5551
[DEBUG][MIA] Test Set Loss:   mean=5.6390, std=5.2676
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.09803921568627451, 'auc': 0.43707275390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.5052, std=6.1302
[DEBUG][MIA] Test Set Loss:   mean=5.7473, std=6.1688
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10200000000000001, 'auc': 0.53784, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.0124, std=10.2168
[DEBUG][MIA] Test Set Loss:   mean=8.7725, std=8.7993
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.11764705882352941, 'auc': 0.543670654296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.2105, std=9.5127
[DEBUG][MIA] Test Set Loss:   mean=9.2733, std=9.4137
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10200000000000001, 'auc': 0.44987200000000005, 'task': 8}
Total correct retain:  471  Total retain:  2500
Total correct forget:  11121  Total forget:  47500
Total correct test:  108  Total test:  500
Total correct forget test:  2069  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.216, 0.248, 0.194, 0.22, 0.252, 0.254, 0.24, 0.276, 0.256, 0.216, 0.246, 0.182, 0.244, 0.242, 0.116, 0.258, 0.144, 0.21, 0.22, 0.12]
Unlearning task: 7
Accuracy, Confidence: (0.328125, 0.8368667960166931)
broken out of loop
Accuracy, Confidence: (0.32421875, 0.8380450010299683)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.7538, std=7.5507
[DEBUG][MIA] Test Set Loss:   mean=8.1240, std=7.6837
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.1607843137254902, 'auc': 0.56494140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.4543, std=7.7888
[DEBUG][MIA] Test Set Loss:   mean=7.3432, std=7.8627
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.124, 'auc': 0.49607999999999997, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7404, std=4.9122
[DEBUG][MIA] Test Set Loss:   mean=5.9121, std=5.2675
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.10588235294117647, 'auc': 0.5654296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0858, std=5.3930
[DEBUG][MIA] Test Set Loss:   mean=6.5534, std=5.1167
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11000000000000001, 'auc': 0.53288, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.3072, std=5.3263
[DEBUG][MIA] Test Set Loss:   mean=5.8819, std=5.1134
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.10980392156862746, 'auc': 0.6138916015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2983, std=5.9135
[DEBUG][MIA] Test Set Loss:   mean=6.0894, std=5.3885
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.08199999999999999, 'auc': 0.499552, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1173, std=3.9306
[DEBUG][MIA] Test Set Loss:   mean=4.2142, std=3.9418
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.13333333333333336, 'auc': 0.61956787109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0568, std=4.3237
[DEBUG][MIA] Test Set Loss:   mean=4.4361, std=4.1846
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10400000000000001, 'auc': 0.538576, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.8227, std=3.6120
[DEBUG][MIA] Test Set Loss:   mean=4.2462, std=4.5708
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.24705882352941178, 'auc': 0.60589599609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.9534, std=4.4885
[DEBUG][MIA] Test Set Loss:   mean=4.0330, std=4.2759
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.15799999999999997, 'auc': 0.52176, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.7915, std=5.6109
[DEBUG][MIA] Test Set Loss:   mean=6.1491, std=6.3929
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.12156862745098038, 'auc': 0.56707763671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6944, std=6.0718
[DEBUG][MIA] Test Set Loss:   mean=6.0389, std=6.4248
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.092, 'auc': 0.514352, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3846, std=5.8378
[DEBUG][MIA] Test Set Loss:   mean=5.9317, std=6.3183
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09411764705882353, 'auc': 0.45709228515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9970, std=6.0345
[DEBUG][MIA] Test Set Loss:   mean=5.7940, std=5.8856
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.1, 'auc': 0.503328, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.8854, std=8.7996
[DEBUG][MIA] Test Set Loss:   mean=9.3707, std=8.6630
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.40625, 'cv_acc': 0.09411764705882353, 'auc': 0.391357421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9836, std=9.5131
[DEBUG][MIA] Test Set Loss:   mean=7.5724, std=8.8092
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11599999999999999, 'auc': 0.503536, 'task': 8}
Total correct retain:  469  Total retain:  2500
Total correct forget:  11159  Total forget:  47500
Total correct test:  110  Total test:  500
Total correct forget test:  2077  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.22, 0.254, 0.19, 0.226, 0.244, 0.256, 0.244, 0.274, 0.256, 0.216, 0.244, 0.182, 0.246, 0.244, 0.112, 0.266, 0.148, 0.214, 0.218, 0.12]
Unlearning task: 6
Accuracy, Confidence: (0.44140625, 0.7930707931518555)
broken out of loop
Accuracy, Confidence: (0.44921875, 0.7935375571250916)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3617, std=7.2882
[DEBUG][MIA] Test Set Loss:   mean=7.5614, std=8.4838
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.1607843137254902, 'auc': 0.6043701171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.8566, std=8.0713
[DEBUG][MIA] Test Set Loss:   mean=9.0892, std=8.8226
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.416, 'cv_acc': 0.10800000000000001, 'auc': 0.41028799999999993, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0326, std=5.0386
[DEBUG][MIA] Test Set Loss:   mean=6.6457, std=5.7116
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.1568627450980392, 'auc': 0.57586669921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3610, std=4.9084
[DEBUG][MIA] Test Set Loss:   mean=6.5794, std=5.4708
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.10600000000000001, 'auc': 0.5625600000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9670, std=5.8315
[DEBUG][MIA] Test Set Loss:   mean=5.9111, std=6.1221
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.11764705882352941, 'auc': 0.5614013671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7919, std=5.2152
[DEBUG][MIA] Test Set Loss:   mean=6.4511, std=5.5605
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.098, 'auc': 0.46433599999999997, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6825, std=3.6982
[DEBUG][MIA] Test Set Loss:   mean=4.4570, std=4.0807
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.09803921568627451, 'auc': 0.66534423828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7523, std=4.1668
[DEBUG][MIA] Test Set Loss:   mean=4.4718, std=4.1992
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10800000000000001, 'auc': 0.5625439999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4912, std=3.1594
[DEBUG][MIA] Test Set Loss:   mean=4.1242, std=3.9936
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.2, 'auc': 0.6446533203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.7500, std=4.1398
[DEBUG][MIA] Test Set Loss:   mean=4.2341, std=4.5019
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11600000000000002, 'auc': 0.532624, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.8737, std=5.6483
[DEBUG][MIA] Test Set Loss:   mean=5.6675, std=5.7894
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.14509803921568626, 'auc': 0.55126953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.8540, std=5.2789
[DEBUG][MIA] Test Set Loss:   mean=6.1955, std=6.4737
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11200000000000002, 'auc': 0.55472, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.2662, std=5.8741
[DEBUG][MIA] Test Set Loss:   mean=5.9045, std=5.3903
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09411764705882353, 'auc': 0.42669677734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.1464, std=6.1332
[DEBUG][MIA] Test Set Loss:   mean=5.8253, std=6.0855
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.510528, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.8122, std=9.4855
[DEBUG][MIA] Test Set Loss:   mean=9.4551, std=9.7249
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10588235294117647, 'auc': 0.521148681640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9941, std=9.0883
[DEBUG][MIA] Test Set Loss:   mean=8.8371, std=9.3419
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10200000000000001, 'auc': 0.53192, 'task': 8}
Total correct retain:  470  Total retain:  2500
Total correct forget:  11168  Total forget:  47500
Total correct test:  109  Total test:  500
Total correct forget test:  2084  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.218, 0.254, 0.188, 0.232, 0.252, 0.26, 0.244, 0.278, 0.256, 0.216, 0.248, 0.18, 0.242, 0.244, 0.112, 0.262, 0.146, 0.216, 0.22, 0.118]
Unlearning task: 5
Accuracy, Confidence: (0.4453125, 0.803835391998291)
broken out of loop
Accuracy, Confidence: (0.40625, 0.8162297010421753)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4768, std=7.3790
[DEBUG][MIA] Test Set Loss:   mean=7.4574, std=8.3485
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.13725490196078433, 'auc': 0.59893798828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.2520, std=7.5508
[DEBUG][MIA] Test Set Loss:   mean=8.0486, std=8.1904
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.118, 'auc': 0.521936, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3455, std=5.5430
[DEBUG][MIA] Test Set Loss:   mean=6.1909, std=4.7531
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.23529411764705882, 'auc': 0.5792236328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4699, std=4.5968
[DEBUG][MIA] Test Set Loss:   mean=6.2280, std=5.0555
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11200000000000002, 'auc': 0.539104, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.4536, std=6.5483
[DEBUG][MIA] Test Set Loss:   mean=7.1704, std=6.1296
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.0784313725490196, 'auc': 0.61859130859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.0991, std=7.0039
[DEBUG][MIA] Test Set Loss:   mean=6.5813, std=6.5425
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11200000000000002, 'auc': 0.48081599999999997, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5983, std=4.4931
[DEBUG][MIA] Test Set Loss:   mean=5.1085, std=5.1012
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.10196078431372549, 'auc': 0.61248779296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.9770, std=5.0292
[DEBUG][MIA] Test Set Loss:   mean=5.2960, std=4.8105
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11000000000000001, 'auc': 0.46968, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7044, std=3.2371
[DEBUG][MIA] Test Set Loss:   mean=3.9041, std=4.1206
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.2980392156862745, 'auc': 0.6064453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.8873, std=4.0433
[DEBUG][MIA] Test Set Loss:   mean=3.8309, std=4.0366
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.088, 'auc': 0.502, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.2180, std=4.9793
[DEBUG][MIA] Test Set Loss:   mean=5.9303, std=6.1953
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.08627450980392157, 'auc': 0.59222412109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6032, std=5.8391
[DEBUG][MIA] Test Set Loss:   mean=6.3932, std=6.6125
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.098, 'auc': 0.46796799999999994, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7174, std=6.3033
[DEBUG][MIA] Test Set Loss:   mean=5.2655, std=5.9389
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.08627450980392157, 'auc': 0.49786376953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.1383, std=5.4682
[DEBUG][MIA] Test Set Loss:   mean=5.6622, std=5.2722
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.086, 'auc': 0.454592, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.1773, std=10.2608
[DEBUG][MIA] Test Set Loss:   mean=9.1716, std=9.0884
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10588235294117647, 'auc': 0.5701904296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.6560, std=9.1193
[DEBUG][MIA] Test Set Loss:   mean=8.4159, std=9.0325
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11200000000000002, 'auc': 0.4949680000000001, 'task': 8}
Total correct retain:  418  Total retain:  2500
Total correct forget:  11057  Total forget:  47500
Total correct test:  100  Total test:  500
Total correct forget test:  2052  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.2, 0.228, 0.206, 0.22, 0.252, 0.278, 0.214, 0.27, 0.26, 0.204, 0.252, 0.18, 0.244, 0.236, 0.128, 0.266, 0.152, 0.208, 0.206, 0.1]
Unlearning task: 4
Accuracy, Confidence: (0.30859375, 0.8534317016601562)
broken out of loop
Accuracy, Confidence: (0.30859375, 0.8545452356338501)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.9605, std=7.3237
[DEBUG][MIA] Test Set Loss:   mean=8.4824, std=7.8944
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.09803921568627451, 'auc': 0.60260009765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.7864, std=7.8236
[DEBUG][MIA] Test Set Loss:   mean=7.9846, std=7.9420
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.13999999999999999, 'auc': 0.505952, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.0854, std=4.6175
[DEBUG][MIA] Test Set Loss:   mean=6.5439, std=4.9596
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.10588235294117647, 'auc': 0.65045166015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.9983, std=4.5109
[DEBUG][MIA] Test Set Loss:   mean=5.8039, std=4.8179
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10200000000000001, 'auc': 0.549152, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.3574, std=6.3788
[DEBUG][MIA] Test Set Loss:   mean=7.0645, std=6.5170
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.13333333333333333, 'auc': 0.601104736328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.8209, std=7.1751
[DEBUG][MIA] Test Set Loss:   mean=6.1499, std=5.6916
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.512176, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5394, std=4.9171
[DEBUG][MIA] Test Set Loss:   mean=4.9829, std=4.6064
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.10980392156862746, 'auc': 0.6422119140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.0738, std=4.9642
[DEBUG][MIA] Test Set Loss:   mean=5.0252, std=4.8235
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.092, 'auc': 0.501776, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7455, std=3.4947
[DEBUG][MIA] Test Set Loss:   mean=3.8014, std=4.2073
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.16470588235294117, 'auc': 0.58740234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.4906, std=4.3601
[DEBUG][MIA] Test Set Loss:   mean=3.8933, std=4.1180
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.1, 'auc': 0.551696, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.7539, std=5.6060
[DEBUG][MIA] Test Set Loss:   mean=6.1890, std=6.3452
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.12549019607843137, 'auc': 0.56903076171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.9570, std=6.0315
[DEBUG][MIA] Test Set Loss:   mean=5.9418, std=5.9664
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.088, 'auc': 0.49772799999999995, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3601, std=6.2380
[DEBUG][MIA] Test Set Loss:   mean=5.1522, std=5.7558
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.1176470588235294, 'auc': 0.5274658203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9062, std=6.0583
[DEBUG][MIA] Test Set Loss:   mean=5.2760, std=5.7103
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.47699199999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.0985, std=10.7666
[DEBUG][MIA] Test Set Loss:   mean=7.8071, std=8.6884
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.11372549019607843, 'auc': 0.490936279296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.9559, std=9.2263
[DEBUG][MIA] Test Set Loss:   mean=10.1291, std=10.0219
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10400000000000001, 'auc': 0.46159999999999995, 'task': 8}
Total correct retain:  413  Total retain:  2500
Total correct forget:  11064  Total forget:  47500
Total correct test:  102  Total test:  500
Total correct forget test:  2030  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.204, 0.226, 0.192, 0.222, 0.248, 0.28, 0.204, 0.27, 0.254, 0.202, 0.248, 0.178, 0.24, 0.24, 0.124, 0.268, 0.152, 0.206, 0.21, 0.096]
Unlearning task: 3
Accuracy, Confidence: (0.35546875, 0.8328201770782471)
broken out of loop
Accuracy, Confidence: (0.34765625, 0.8319118022918701)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6455, std=6.7643
[DEBUG][MIA] Test Set Loss:   mean=7.4285, std=7.4138
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.18039215686274507, 'auc': 0.577392578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.7546, std=6.9239
[DEBUG][MIA] Test Set Loss:   mean=7.6876, std=7.9082
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.525488, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7993, std=5.2673
[DEBUG][MIA] Test Set Loss:   mean=5.5859, std=4.9237
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.17254901960784313, 'auc': 0.5728759765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0456, std=4.9774
[DEBUG][MIA] Test Set Loss:   mean=6.5772, std=5.2672
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.526, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1741, std=6.9153
[DEBUG][MIA] Test Set Loss:   mean=7.0993, std=6.8264
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.16862745098039217, 'auc': 0.563018798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1433, std=6.5206
[DEBUG][MIA] Test Set Loss:   mean=6.9112, std=6.2621
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.08399999999999999, 'auc': 0.45624000000000003, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7442, std=4.4690
[DEBUG][MIA] Test Set Loss:   mean=4.6124, std=4.5501
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.12549019607843137, 'auc': 0.58856201171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.2365, std=4.4860
[DEBUG][MIA] Test Set Loss:   mean=4.9049, std=4.6855
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.547392, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4979, std=3.1917
[DEBUG][MIA] Test Set Loss:   mean=3.7055, std=3.7340
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.23137254901960783, 'auc': 0.62127685546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.7633, std=4.3384
[DEBUG][MIA] Test Set Loss:   mean=3.7055, std=3.7812
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.524912, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.7471, std=5.5144
[DEBUG][MIA] Test Set Loss:   mean=5.9671, std=5.5694
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.1215686274509804, 'auc': 0.59027099609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6522, std=6.3145
[DEBUG][MIA] Test Set Loss:   mean=6.1485, std=6.3189
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.092, 'auc': 0.537808, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3371, std=6.2326
[DEBUG][MIA] Test Set Loss:   mean=5.0775, std=5.5030
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10196078431372549, 'auc': 0.520263671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.6136, std=5.7354
[DEBUG][MIA] Test Set Loss:   mean=5.8339, std=5.8837
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08199999999999999, 'auc': 0.514576, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.6403, std=9.2296
[DEBUG][MIA] Test Set Loss:   mean=8.3434, std=9.1058
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.06666666666666667, 'auc': 0.47119140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.4549, std=9.6709
[DEBUG][MIA] Test Set Loss:   mean=8.1356, std=8.9974
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.49703200000000003, 'task': 8}
Total correct retain:  418  Total retain:  2500
Total correct forget:  11067  Total forget:  47500
Total correct test:  105  Total test:  500
Total correct forget test:  2039  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.21, 0.23, 0.188, 0.222, 0.244, 0.282, 0.21, 0.27, 0.256, 0.212, 0.25, 0.174, 0.242, 0.234, 0.126, 0.27, 0.158, 0.208, 0.206, 0.096]
Unlearning task: 2
Accuracy, Confidence: (0.3828125, 0.8515571355819702)
broken out of loop
Accuracy, Confidence: (0.390625, 0.8500160574913025)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 7, 9, 7, 9, 6, 6, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4586, std=6.9865
[DEBUG][MIA] Test Set Loss:   mean=7.7603, std=7.2577
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.10980392156862746, 'auc': 0.62701416015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 6 8 9 9 7 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 6 5 6 6 6 6 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.5557, std=7.3541
[DEBUG][MIA] Test Set Loss:   mean=7.7800, std=7.5553
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.506912, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 13, 13, 14, 13, 12, 14, 10, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.8275, std=4.8148
[DEBUG][MIA] Test Set Loss:   mean=6.1840, std=4.4930
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.13725490196078433, 'auc': 0.60247802734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 14 13 10 14 12 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 12 11 12 10 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.2558, std=4.6203
[DEBUG][MIA] Test Set Loss:   mean=6.0435, std=5.0091
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.542784, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 15, 15, 18, 15, 15, 16, 19, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.1767, std=6.1440
[DEBUG][MIA] Test Set Loss:   mean=6.0784, std=5.3940
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.10980392156862744, 'auc': 0.578369140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 15 18 16 15 16 16 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 15 15 18 19 15 17 16 18 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.5803, std=6.4919
[DEBUG][MIA] Test Set Loss:   mean=6.5064, std=6.1521
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08199999999999999, 'auc': 0.5, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 23, 23, 22, 24, 21, 22, 20, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.9523, std=4.8409
[DEBUG][MIA] Test Set Loss:   mean=5.2560, std=4.8978
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.1411764705882353, 'auc': 0.603759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 21 21 23 23 22 22 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 21 21 23 23 21 24 23 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5576, std=4.9472
[DEBUG][MIA] Test Set Loss:   mean=4.9922, std=4.8281
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.5337440000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 25, 28, 29, 25, 29, 26, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7172, std=3.2743
[DEBUG][MIA] Test Set Loss:   mean=3.6742, std=3.7452
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.3725490196078431, 'auc': 0.6015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 27 25 27 25 29 26 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 25 28 27 27 26 26 26 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.5038, std=4.1135
[DEBUG][MIA] Test Set Loss:   mean=3.5438, std=4.0240
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.148, 'auc': 0.5168159999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 30, 34, 33, 30, 32, 30, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5283, std=6.0502
[DEBUG][MIA] Test Set Loss:   mean=5.4056, std=5.6590
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.13725490196078433, 'auc': 0.577392578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 31 33 32 30 34 33 33 31 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 31 31 34 33 34 34 31 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.7371, std=6.0498
[DEBUG][MIA] Test Set Loss:   mean=6.0729, std=6.4941
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.088, 'auc': 0.5088, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 37, 38, 38, 38, 35, 35, 39, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7116, std=5.9124
[DEBUG][MIA] Test Set Loss:   mean=6.1240, std=5.9836
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09019607843137255, 'auc': 0.5355224609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 35 37 36 35 38 36 38 37 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 35 37 36 39 36 37 37 35]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.1112, std=5.8868
[DEBUG][MIA] Test Set Loss:   mean=4.9302, std=4.6229
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.454, 'cv_acc': 0.132, 'auc': 0.458464, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 42, 41, 42, 41, 42, 40, 44, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.1460, std=9.6028
[DEBUG][MIA] Test Set Loss:   mean=9.5187, std=9.3576
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.08627450980392157, 'auc': 0.44482421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 40 42 41 43 40 40 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 44 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.3735, std=8.4924
[DEBUG][MIA] Test Set Loss:   mean=8.1743, std=8.6646
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.098, 'auc': 0.46078399999999997, 'task': 8}
Total correct retain:  422  Total retain:  2500
Total correct forget:  11069  Total forget:  47500
Total correct test:  105  Total test:  500
Total correct forget test:  2039  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.21, 0.226, 0.18, 0.22, 0.242, 0.286, 0.216, 0.268, 0.262, 0.206, 0.25, 0.176, 0.244, 0.232, 0.13, 0.27, 0.16, 0.206, 0.206, 0.098]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['bowls', 'wardrobe', 'sea', 'road', 'chair', 'hamster', 'cockroach', 'motorcycle', 'couch', 'seal', 'crab', 'sunflowers', 'pears', 'shark', 'beetle', 'dolphin', 'cloud', 'oak', 'bee', 'boy', 'lobster', 'lion', 'skunk', 'mountain', 'tractor', 'apples', 'woman', 'otter', 'whale', 'streetcar', 'flatfish', 'crocodile', 'plain', 'pickup truck', 'raccoon', 'lawn-mower', 'plates', 'trout', 'orchids', 'cattle', 'telephone', 'computer keyboard', 'aquarium fish', 'bus', 'beaver', 'tiger', 'worm', 'forest', 'train', 'squirrel', 'castle', 'girl', 'willow', 'bear', 'shrew', 'bicycle', 'porcupine', 'house', 'wolf', 'clock', 'bottles', 'baby', 'television', 'snake', 'skyscraper', 'pine', 'lizard', 'table', 'leopard', 'mushrooms', 'tank', 'roses', 'rocket', 'cans', 'butterfly', 'man', 'maple', 'poppies', 'elephant', 'palm', 'mouse', 'ray', 'possum', 'sweet peppers', 'chimpanzee', 'caterpillar', 'spider', 'rabbit', 'tulips', 'bed', 'oranges', 'snail', 'lamp', 'dinosaur', 'kangaroo', 'cups', 'bridge', 'fox', 'turtle', 'camel']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2454  Total retain:  2500
Total correct forget:  9828  Total forget:  47500
Total correct test:  453  Total test:  500
Total correct forget test:  1974  Total test forget:  9500
After learning task 1
Task accuracies: [0.906, 0.198, 0.24, 0.198, 0.284, 0.248, 0.118, 0.19, 0.166, 0.176, 0.158, 0.2, 0.128, 0.252, 0.232, 0.236, 0.188, 0.266, 0.246, 0.224]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0193
[DEBUG][MIA] Test Set Loss:   mean=1.2256, std=2.7736
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.22745098039215686, 'auc': 0.736724853515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0083, std=0.0690
[DEBUG][MIA] Test Set Loss:   mean=1.0945, std=2.5462
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.652, 'cv_acc': 0.23400000000000004, 'auc': 0.7142080000000001, 'task': 1}
2 1
Total correct retain:  2163  Total retain:  2500
Total correct forget:  11106  Total forget:  47500
Total correct test:  404  Total test:  500
Total correct forget test:  2099  Total test forget:  9500
After learning task 2
Task accuracies: [0.808, 0.774, 0.194, 0.152, 0.28, 0.232, 0.148, 0.178, 0.17, 0.216, 0.13, 0.208, 0.18, 0.232, 0.252, 0.148, 0.166, 0.138, 0.174, 0.226]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0235, std=0.1010
[DEBUG][MIA] Test Set Loss:   mean=1.3587, std=2.5473
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.4862745098039215, 'auc': 0.75213623046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8959, std=2.1605
[DEBUG][MIA] Test Set Loss:   mean=1.3125, std=2.3007
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.178, 'auc': 0.588568, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0399, std=0.2595
[DEBUG][MIA] Test Set Loss:   mean=1.0253, std=2.1592
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20784313725490197, 'auc': 0.7269287109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0237, std=0.1552
[DEBUG][MIA] Test Set Loss:   mean=0.8806, std=2.0312
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.22400000000000003, 'auc': 0.676784, 'task': 2}
3 2
Total correct retain:  2015  Total retain:  2500
Total correct forget:  12382  Total forget:  47500
Total correct test:  383  Total test:  500
Total correct forget test:  2335  Total test forget:  9500
After learning task 3
Task accuracies: [0.766, 0.664, 0.788, 0.124, 0.28, 0.156, 0.176, 0.196, 0.188, 0.166, 0.136, 0.278, 0.176, 0.232, 0.244, 0.118, 0.206, 0.17, 0.216, 0.156]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.1341, std=2.0103
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6941176470588235, 'auc': 0.780303955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0634, std=2.0660
[DEBUG][MIA] Test Set Loss:   mean=1.6258, std=2.8104
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11600000000000002, 'auc': 0.563288, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0109, std=0.0593
[DEBUG][MIA] Test Set Loss:   mean=1.1075, std=2.7603
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.27450980392156865, 'auc': 0.730743408203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3984, std=1.2851
[DEBUG][MIA] Test Set Loss:   mean=1.3731, std=2.7036
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.186, 'auc': 0.641416, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0099
[DEBUG][MIA] Test Set Loss:   mean=0.7589, std=2.2118
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.18823529411764706, 'auc': 0.6505126953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=0.5131, std=1.6391
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.198, 'auc': 0.662904, 'task': 3}
4 3
Total correct retain:  2032  Total retain:  2500
Total correct forget:  14429  Total forget:  47500
Total correct test:  381  Total test:  500
Total correct forget test:  2687  Total test forget:  9500
After learning task 4
Task accuracies: [0.762, 0.642, 0.72, 0.848, 0.196, 0.228, 0.122, 0.224, 0.182, 0.15, 0.134, 0.234, 0.19, 0.312, 0.254, 0.156, 0.164, 0.228, 0.148, 0.242]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0098
[DEBUG][MIA] Test Set Loss:   mean=1.3413, std=2.8612
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.27450980392156865, 'auc': 0.79248046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7368, std=1.8432
[DEBUG][MIA] Test Set Loss:   mean=1.1479, std=2.3333
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.136, 'auc': 0.574048, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0091, std=0.0671
[DEBUG][MIA] Test Set Loss:   mean=1.3738, std=2.7215
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.28627450980392155, 'auc': 0.782135009765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3948, std=1.3405
[DEBUG][MIA] Test Set Loss:   mean=1.2778, std=2.6029
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.182, 'auc': 0.614152, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.0458, std=2.1876
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.23137254901960783, 'auc': 0.723388671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2066, std=0.7349
[DEBUG][MIA] Test Set Loss:   mean=1.1627, std=2.2432
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.13999999999999999, 'auc': 0.6580079999999999, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0116
[DEBUG][MIA] Test Set Loss:   mean=0.5978, std=1.7953
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.2235294117647059, 'auc': 0.67333984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0169
[DEBUG][MIA] Test Set Loss:   mean=0.8441, std=2.2737
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.21400000000000002, 'auc': 0.693136, 'task': 4}
5 4
Total correct retain:  2011  Total retain:  2500
Total correct forget:  15932  Total forget:  47500
Total correct test:  388  Total test:  500
Total correct forget test:  2919  Total test forget:  9500
After learning task 5
Task accuracies: [0.776, 0.728, 0.712, 0.772, 0.818, 0.194, 0.148, 0.226, 0.186, 0.214, 0.126, 0.246, 0.154, 0.276, 0.21, 0.174, 0.152, 0.204, 0.11, 0.188]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0069, std=0.0191
[DEBUG][MIA] Test Set Loss:   mean=1.6748, std=3.1093
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.26274509803921564, 'auc': 0.771514892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1670, std=2.7388
[DEBUG][MIA] Test Set Loss:   mean=1.4649, std=2.7107
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.086, 'auc': 0.458704, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0436, std=0.2743
[DEBUG][MIA] Test Set Loss:   mean=1.4306, std=2.7972
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.25098039215686274, 'auc': 0.68304443359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6112, std=1.6465
[DEBUG][MIA] Test Set Loss:   mean=1.2070, std=2.3277
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13399999999999998, 'auc': 0.599488, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0088
[DEBUG][MIA] Test Set Loss:   mean=0.9670, std=2.0013
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.28627450980392155, 'auc': 0.726104736328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4959, std=1.2291
[DEBUG][MIA] Test Set Loss:   mean=1.2697, std=2.2963
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.2, 'auc': 0.563392, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0337
[DEBUG][MIA] Test Set Loss:   mean=1.3847, std=2.7020
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.24705882352941178, 'auc': 0.73443603515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3048, std=0.8891
[DEBUG][MIA] Test Set Loss:   mean=1.2328, std=2.5714
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.16799999999999998, 'auc': 0.601552, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0140, std=0.0766
[DEBUG][MIA] Test Set Loss:   mean=0.8669, std=2.1146
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.19607843137254902, 'auc': 0.65283203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0298, std=0.1785
[DEBUG][MIA] Test Set Loss:   mean=0.8889, std=2.2539
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.21399999999999997, 'auc': 0.6491359999999999, 'task': 5}
6 5
Total correct retain:  2033  Total retain:  2500
Total correct forget:  17107  Total forget:  47500
Total correct test:  392  Total test:  500
Total correct forget test:  3148  Total test forget:  9500
After learning task 6
Task accuracies: [0.784, 0.69, 0.718, 0.7, 0.74, 0.812, 0.138, 0.164, 0.228, 0.172, 0.166, 0.23, 0.202, 0.284, 0.184, 0.14, 0.182, 0.182, 0.138, 0.226]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0168
[DEBUG][MIA] Test Set Loss:   mean=1.5809, std=2.6013
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2901960784313726, 'auc': 0.79559326171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1476, std=2.6118
[DEBUG][MIA] Test Set Loss:   mean=1.6927, std=3.0333
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10800000000000001, 'auc': 0.569904, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0121
[DEBUG][MIA] Test Set Loss:   mean=1.4420, std=2.5578
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.30196078431372547, 'auc': 0.795166015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0016, std=2.1607
[DEBUG][MIA] Test Set Loss:   mean=1.6836, std=2.7449
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.14599999999999996, 'auc': 0.611016, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.3349, std=2.4450
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.25882352941176473, 'auc': 0.76483154296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4538, std=1.2251
[DEBUG][MIA] Test Set Loss:   mean=1.2326, std=2.2656
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.158, 'auc': 0.598296, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.3270, std=2.6159
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2392156862745098, 'auc': 0.8277587890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6319, std=1.8921
[DEBUG][MIA] Test Set Loss:   mean=1.2308, std=2.6805
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.17, 'auc': 0.625624, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=0.9557, std=1.8806
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.25882352941176473, 'auc': 0.7459716796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1349, std=0.6885
[DEBUG][MIA] Test Set Loss:   mean=0.8331, std=1.7374
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.20400000000000001, 'auc': 0.660392, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0133, std=0.0997
[DEBUG][MIA] Test Set Loss:   mean=0.3074, std=0.9917
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.19215686274509805, 'auc': 0.6220703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0122, std=0.1219
[DEBUG][MIA] Test Set Loss:   mean=0.5950, std=1.7579
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.182, 'auc': 0.6683599999999998, 'task': 6}
7 6
Total correct retain:  2093  Total retain:  2500
Total correct forget:  18993  Total forget:  47500
Total correct test:  404  Total test:  500
Total correct forget test:  3446  Total test forget:  9500
After learning task 7
Task accuracies: [0.808, 0.672, 0.648, 0.726, 0.746, 0.778, 0.87, 0.182, 0.274, 0.116, 0.124, 0.206, 0.224, 0.284, 0.154, 0.17, 0.138, 0.218, 0.178, 0.184]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.4874, std=2.5069
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7372549019607842, 'auc': 0.82666015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0917, std=2.4335
[DEBUG][MIA] Test Set Loss:   mean=1.7682, std=3.1821
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11399999999999999, 'auc': 0.5929359999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0103
[DEBUG][MIA] Test Set Loss:   mean=1.4858, std=2.5841
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2549019607843137, 'auc': 0.782318115234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0532, std=2.2245
[DEBUG][MIA] Test Set Loss:   mean=1.5884, std=2.8784
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11000000000000001, 'auc': 0.564056, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.5968, std=2.7939
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2392156862745098, 'auc': 0.803924560546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7101, std=1.6830
[DEBUG][MIA] Test Set Loss:   mean=1.3310, std=2.6693
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.13, 'auc': 0.569288, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5542, std=3.0592
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2784313725490196, 'auc': 0.801849365234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5788, std=1.3647
[DEBUG][MIA] Test Set Loss:   mean=1.3523, std=2.6601
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10400000000000001, 'auc': 0.598104, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=0.9610, std=2.0682
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2549019607843137, 'auc': 0.74853515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3044, std=1.0196
[DEBUG][MIA] Test Set Loss:   mean=1.0352, std=2.1415
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.182, 'auc': 0.624784, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=0.8523, std=2.0714
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.21960784313725493, 'auc': 0.68218994140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2545, std=0.8165
[DEBUG][MIA] Test Set Loss:   mean=0.9229, std=2.1268
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.166, 'auc': 0.5947439999999999, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=0.6254, std=1.5520
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.21176470588235294, 'auc': 0.644378662109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0674
[DEBUG][MIA] Test Set Loss:   mean=0.7601, std=1.8067
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.21399999999999997, 'auc': 0.678552, 'task': 7}
8 7
Total correct retain:  2094  Total retain:  2500
Total correct forget:  20668  Total forget:  47500
Total correct test:  406  Total test:  500
Total correct forget test:  3722  Total test forget:  9500
After learning task 8
Task accuracies: [0.812, 0.658, 0.716, 0.716, 0.71, 0.766, 0.778, 0.808, 0.218, 0.168, 0.168, 0.216, 0.248, 0.244, 0.172, 0.108, 0.154, 0.236, 0.172, 0.188]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.4553, std=2.4629
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.2666666666666667, 'auc': 0.80413818359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2716, std=2.7879
[DEBUG][MIA] Test Set Loss:   mean=1.5378, std=2.8945
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.122, 'auc': 0.554056, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0063, std=0.0315
[DEBUG][MIA] Test Set Loss:   mean=1.5114, std=3.0717
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2705882352941177, 'auc': 0.785614013671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1724, std=2.8056
[DEBUG][MIA] Test Set Loss:   mean=1.6215, std=3.1367
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.09, 'auc': 0.543488, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0066
[DEBUG][MIA] Test Set Loss:   mean=1.4532, std=2.7893
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2901960784313726, 'auc': 0.80560302734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7152, std=1.8649
[DEBUG][MIA] Test Set Loss:   mean=1.2098, std=2.3340
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.154, 'auc': 0.6022079999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.8864, std=3.6706
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.2549019607843137, 'auc': 0.801361083984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9087, std=2.0891
[DEBUG][MIA] Test Set Loss:   mean=1.5371, std=3.0880
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.092, 'auc': 0.5893679999999999, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=0.8242, std=2.0565
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.26666666666666666, 'auc': 0.785736083984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3682, std=1.1316
[DEBUG][MIA] Test Set Loss:   mean=0.9234, std=2.0196
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.186, 'auc': 0.587624, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.3116, std=2.8168
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2235294117647059, 'auc': 0.74615478515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3436, std=1.0898
[DEBUG][MIA] Test Set Loss:   mean=0.9831, std=2.4308
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.15999999999999998, 'auc': 0.582152, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.1444, std=2.2291
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2784313725490196, 'auc': 0.803192138671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2593, std=0.9564
[DEBUG][MIA] Test Set Loss:   mean=1.1482, std=2.4767
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.20800000000000002, 'auc': 0.622752, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=0.4497, std=1.2972
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2, 'auc': 0.701385498046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0101
[DEBUG][MIA] Test Set Loss:   mean=0.7244, std=2.0057
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.21800000000000003, 'auc': 0.723848, 'task': 8}
Total correct retain:  2108  Total retain:  2500
Total correct forget:  22290  Total forget:  47500
Total correct test:  418  Total test:  500
Total correct forget test:  4051  Total test forget:  9500
After learning task 9
Task accuracies: [0.836, 0.662, 0.72, 0.712, 0.716, 0.764, 0.802, 0.74, 0.838, 0.176, 0.154, 0.226, 0.266, 0.234, 0.14, 0.152, 0.148, 0.206, 0.218, 0.228]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.1683, std=2.7524
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2823529411764706, 'auc': 0.857208251953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2416, std=2.6432
[DEBUG][MIA] Test Set Loss:   mean=1.6079, std=2.9967
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.096, 'auc': 0.41393599999999997, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0108
[DEBUG][MIA] Test Set Loss:   mean=1.0219, std=2.1027
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.28627450980392155, 'auc': 0.77557373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2776, std=2.5662
[DEBUG][MIA] Test Set Loss:   mean=1.7825, std=3.0832
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.12600000000000003, 'auc': 0.6039439999999999, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.1829, std=2.1611
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2666666666666667, 'auc': 0.78094482421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0042, std=2.1692
[DEBUG][MIA] Test Set Loss:   mean=1.4283, std=2.6157
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.14799999999999996, 'auc': 0.565008, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.7152, std=2.9066
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.25490196078431376, 'auc': 0.83538818359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0854, std=2.3860
[DEBUG][MIA] Test Set Loss:   mean=1.5325, std=2.8220
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10400000000000001, 'auc': 0.5606, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=0.8693, std=2.2238
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2784313725490196, 'auc': 0.69439697265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4697, std=1.5443
[DEBUG][MIA] Test Set Loss:   mean=1.0761, std=2.3663
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.158, 'auc': 0.580256, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.0812, std=2.1569
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.27450980392156865, 'auc': 0.710601806640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6309, std=1.5646
[DEBUG][MIA] Test Set Loss:   mean=1.2532, std=2.4634
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.148, 'auc': 0.544584, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.3609, std=2.3197
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.27450980392156865, 'auc': 0.80023193359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6175, std=1.5531
[DEBUG][MIA] Test Set Loss:   mean=1.3644, std=2.6681
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.16599999999999998, 'auc': 0.5677599999999999, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=0.9640, std=2.4129
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2941176470588235, 'auc': 0.778961181640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3427, std=1.0926
[DEBUG][MIA] Test Set Loss:   mean=1.3650, std=2.8524
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.16199999999999998, 'auc': 0.633896, 'task': 8}
Total correct retain:  2118  Total retain:  2500
Total correct forget:  23374  Total forget:  47500
Total correct test:  410  Total test:  500
Total correct forget test:  4155  Total test forget:  9500
After learning task 10
Task accuracies: [0.82, 0.692, 0.672, 0.698, 0.718, 0.752, 0.738, 0.704, 0.724, 0.708, 0.156, 0.218, 0.236, 0.262, 0.152, 0.112, 0.132, 0.176, 0.224, 0.236]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0136
[DEBUG][MIA] Test Set Loss:   mean=1.1544, std=2.2414
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2901960784313725, 'auc': 0.763641357421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5826, std=3.0579
[DEBUG][MIA] Test Set Loss:   mean=1.3933, std=2.7790
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10400000000000001, 'auc': 0.48088800000000004, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0162
[DEBUG][MIA] Test Set Loss:   mean=1.7879, std=3.0487
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.25882352941176473, 'auc': 0.807525634765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4096, std=2.7079
[DEBUG][MIA] Test Set Loss:   mean=1.7395, std=3.1698
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.1, 'auc': 0.47176799999999997, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.1471, std=2.3688
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2549019607843137, 'auc': 0.796417236328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6911, std=1.8501
[DEBUG][MIA] Test Set Loss:   mean=1.2710, std=2.5611
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.096, 'auc': 0.610304, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.2764, std=2.5419
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2784313725490196, 'auc': 0.79644775390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9146, std=2.1821
[DEBUG][MIA] Test Set Loss:   mean=1.4297, std=2.7618
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12200000000000003, 'auc': 0.55624, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=1.1674, std=2.5534
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.23529411764705882, 'auc': 0.748565673828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7119, std=1.9414
[DEBUG][MIA] Test Set Loss:   mean=1.2544, std=2.8042
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.146, 'auc': 0.546832, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.0493, std=2.2577
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.24705882352941178, 'auc': 0.73980712890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4598, std=1.5239
[DEBUG][MIA] Test Set Loss:   mean=1.0883, std=2.2724
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.15999999999999998, 'auc': 0.6019840000000001, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0237
[DEBUG][MIA] Test Set Loss:   mean=1.4630, std=2.4796
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2823529411764706, 'auc': 0.7867431640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7063, std=1.6658
[DEBUG][MIA] Test Set Loss:   mean=1.3640, std=2.5080
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.172, 'auc': 0.572616, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.2099, std=2.1177
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.28627450980392155, 'auc': 0.855224609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6573, std=1.7030
[DEBUG][MIA] Test Set Loss:   mean=1.2763, std=2.4098
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.152, 'auc': 0.587504, 'task': 8}
Total correct retain:  2109  Total retain:  2500
Total correct forget:  25056  Total forget:  47500
Total correct test:  407  Total test:  500
Total correct forget test:  4399  Total test forget:  9500
After learning task 11
Task accuracies: [0.814, 0.66, 0.686, 0.742, 0.696, 0.734, 0.76, 0.674, 0.706, 0.632, 0.802, 0.242, 0.23, 0.296, 0.114, 0.15, 0.106, 0.192, 0.164, 0.212]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9974600076675415)
broken out of loop
Accuracy, Confidence: (0.2890625, 0.9721857309341431)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6528, std=3.5962
[DEBUG][MIA] Test Set Loss:   mean=3.3164, std=5.6040
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.15294117647058822, 'auc': 0.63330078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6787, std=5.5002
[DEBUG][MIA] Test Set Loss:   mean=3.0925, std=4.6255
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.08399999999999999, 'auc': 0.486432, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8716, std=5.6871
[DEBUG][MIA] Test Set Loss:   mean=5.4794, std=7.0676
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.1215686274509804, 'auc': 0.5767822265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0714, std=6.5219
[DEBUG][MIA] Test Set Loss:   mean=5.6112, std=7.2392
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.5107360000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9080, std=3.2485
[DEBUG][MIA] Test Set Loss:   mean=2.8572, std=4.1441
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.12549019607843137, 'auc': 0.58184814453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0390, std=3.8626
[DEBUG][MIA] Test Set Loss:   mean=3.4567, std=4.1193
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.074, 'auc': 0.46995200000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.5048, std=3.0857
[DEBUG][MIA] Test Set Loss:   mean=3.0273, std=3.5768
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.15294117647058822, 'auc': 0.5565185546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.9131, std=3.2259
[DEBUG][MIA] Test Set Loss:   mean=3.1135, std=3.5880
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11000000000000001, 'auc': 0.498656, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.8530, std=8.7077
[DEBUG][MIA] Test Set Loss:   mean=5.2653, std=8.5340
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.1607843137254902, 'auc': 0.54541015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.1195, std=8.6484
[DEBUG][MIA] Test Set Loss:   mean=5.4650, std=8.0617
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.09, 'auc': 0.468704, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.1064, std=9.7711
[DEBUG][MIA] Test Set Loss:   mean=9.0395, std=10.4490
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09803921568627451, 'auc': 0.5738525390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3451, std=9.7220
[DEBUG][MIA] Test Set Loss:   mean=8.5550, std=9.6906
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11400000000000002, 'auc': 0.501328, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.3315, std=4.6017
[DEBUG][MIA] Test Set Loss:   mean=4.3967, std=4.6841
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.08235294117647059, 'auc': 0.59466552734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1549, std=5.2835
[DEBUG][MIA] Test Set Loss:   mean=4.5698, std=5.2060
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.078, 'auc': 0.537944, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.8142, std=4.1383
[DEBUG][MIA] Test Set Loss:   mean=3.8878, std=4.1979
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.13333333333333336, 'auc': 0.61004638671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1376, std=4.8518
[DEBUG][MIA] Test Set Loss:   mean=4.4615, std=4.7191
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11800000000000002, 'auc': 0.5389120000000001, 'task': 8}
Total correct retain:  944  Total retain:  2500
Total correct forget:  13619  Total forget:  47500
Total correct test:  192  Total test:  500
Total correct forget test:  2570  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.384, 0.418, 0.316, 0.414, 0.392, 0.408, 0.302, 0.308, 0.282, 0.224, 0.326, 0.198, 0.25, 0.186, 0.306, 0.158, 0.13, 0.082, 0.24, 0.2]
Unlearning task: 10
Accuracy, Confidence: (0.35546875, 0.8589693903923035)
broken out of loop
Accuracy, Confidence: (0.35546875, 0.8565683364868164)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7063, std=3.6332
[DEBUG][MIA] Test Set Loss:   mean=3.7408, std=5.6018
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.14901960784313725, 'auc': 0.6751708984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.4457, std=5.1463
[DEBUG][MIA] Test Set Loss:   mean=3.4888, std=5.2398
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.096, 'auc': 0.515072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.5035, std=6.6822
[DEBUG][MIA] Test Set Loss:   mean=5.4598, std=6.5588
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.14901960784313728, 'auc': 0.55682373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8766, std=7.5359
[DEBUG][MIA] Test Set Loss:   mean=5.3365, std=6.6375
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10800000000000001, 'auc': 0.519984, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9538, std=3.5384
[DEBUG][MIA] Test Set Loss:   mean=3.4345, std=3.9680
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.12549019607843137, 'auc': 0.65301513671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2465, std=3.9560
[DEBUG][MIA] Test Set Loss:   mean=3.2096, std=4.0712
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.094, 'auc': 0.48816000000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3132, std=2.9977
[DEBUG][MIA] Test Set Loss:   mean=2.7168, std=3.1168
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1411764705882353, 'auc': 0.5582275390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2731, std=3.4539
[DEBUG][MIA] Test Set Loss:   mean=3.0005, std=3.4460
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.098, 'auc': 0.47568, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.5493, std=7.2290
[DEBUG][MIA] Test Set Loss:   mean=6.1095, std=8.0821
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.1411764705882353, 'auc': 0.544189453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.2990, std=8.2457
[DEBUG][MIA] Test Set Loss:   mean=5.8887, std=8.5988
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.098, 'auc': 0.47904, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3831, std=10.7311
[DEBUG][MIA] Test Set Loss:   mean=8.2724, std=9.7539
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.11372549019607843, 'auc': 0.50958251953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.7959, std=9.8851
[DEBUG][MIA] Test Set Loss:   mean=8.9099, std=10.2109
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10800000000000001, 'auc': 0.49913599999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7652, std=4.6846
[DEBUG][MIA] Test Set Loss:   mean=5.3412, std=5.5425
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.13333333333333333, 'auc': 0.60797119140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1640, std=5.2176
[DEBUG][MIA] Test Set Loss:   mean=5.2820, std=5.4072
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.43, 'cv_acc': 0.10400000000000001, 'auc': 0.42902399999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.8154, std=3.7419
[DEBUG][MIA] Test Set Loss:   mean=4.0543, std=4.5749
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.1764705882352941, 'auc': 0.5909423828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7478, std=4.4785
[DEBUG][MIA] Test Set Loss:   mean=4.6036, std=4.8729
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.10800000000000001, 'auc': 0.44377599999999995, 'task': 8}
Total correct retain:  933  Total retain:  2500
Total correct forget:  13595  Total forget:  47500
Total correct test:  190  Total test:  500
Total correct forget test:  2562  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.38, 0.422, 0.314, 0.408, 0.382, 0.412, 0.298, 0.31, 0.282, 0.222, 0.328, 0.198, 0.252, 0.182, 0.312, 0.15, 0.124, 0.08, 0.242, 0.206]
Unlearning task: 9
Accuracy, Confidence: (0.47265625, 0.7943434715270996)
broken out of loop
Accuracy, Confidence: (0.46875, 0.794448733329773)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0396, std=3.9342
[DEBUG][MIA] Test Set Loss:   mean=3.8733, std=5.4542
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.1607843137254902, 'auc': 0.65631103515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8052, std=4.2011
[DEBUG][MIA] Test Set Loss:   mean=3.8566, std=5.4518
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.446, 'cv_acc': 0.094, 'auc': 0.43216000000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.7291, std=5.1635
[DEBUG][MIA] Test Set Loss:   mean=4.6571, std=6.1160
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.12941176470588237, 'auc': 0.550537109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1935, std=6.7608
[DEBUG][MIA] Test Set Loss:   mean=5.7634, std=6.7971
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.08199999999999999, 'auc': 0.46448, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0172, std=3.5319
[DEBUG][MIA] Test Set Loss:   mean=3.6453, std=4.7126
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.20784313725490197, 'auc': 0.66064453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.6967, std=3.6037
[DEBUG][MIA] Test Set Loss:   mean=3.1535, std=3.9660
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.530752, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3705, std=3.0199
[DEBUG][MIA] Test Set Loss:   mean=3.4575, std=3.7748
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.15686274509803924, 'auc': 0.596923828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1813, std=3.4572
[DEBUG][MIA] Test Set Loss:   mean=3.1977, std=3.2282
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.48740800000000006, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.2647, std=7.4648
[DEBUG][MIA] Test Set Loss:   mean=4.8033, std=8.0657
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.55694580078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.5902, std=8.9295
[DEBUG][MIA] Test Set Loss:   mean=5.2305, std=7.8266
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11200000000000002, 'auc': 0.503136, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6979, std=9.8920
[DEBUG][MIA] Test Set Loss:   mean=9.5597, std=10.0675
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09803921568627451, 'auc': 0.57977294921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8954, std=9.6375
[DEBUG][MIA] Test Set Loss:   mean=8.9447, std=10.3340
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.096, 'auc': 0.527056, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.9154, std=5.2550
[DEBUG][MIA] Test Set Loss:   mean=5.6250, std=5.6506
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.11764705882352941, 'auc': 0.61541748046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7345, std=5.7816
[DEBUG][MIA] Test Set Loss:   mean=4.7284, std=4.9921
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.088, 'auc': 0.539064, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.9493, std=3.9320
[DEBUG][MIA] Test Set Loss:   mean=4.1802, std=4.1620
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.1764705882352941, 'auc': 0.63726806640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7099, std=4.5652
[DEBUG][MIA] Test Set Loss:   mean=4.2827, std=4.7264
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.094, 'auc': 0.550624, 'task': 8}
Total correct retain:  932  Total retain:  2500
Total correct forget:  13594  Total forget:  47500
Total correct test:  191  Total test:  500
Total correct forget test:  2559  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.382, 0.422, 0.316, 0.41, 0.38, 0.41, 0.3, 0.306, 0.276, 0.222, 0.328, 0.198, 0.25, 0.186, 0.312, 0.15, 0.124, 0.084, 0.242, 0.202]
Unlearning task: 8
Accuracy, Confidence: (0.41796875, 0.841546893119812)
broken out of loop
Accuracy, Confidence: (0.3125, 0.8752307891845703)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4831, std=4.4498
[DEBUG][MIA] Test Set Loss:   mean=5.1279, std=6.4619
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.10196078431372549, 'auc': 0.6728515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0068, std=5.5094
[DEBUG][MIA] Test Set Loss:   mean=4.9448, std=7.1396
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.128, 'auc': 0.4696159999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3488, std=6.7138
[DEBUG][MIA] Test Set Loss:   mean=5.6638, std=7.1293
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.13725490196078433, 'auc': 0.5096435546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.1912, std=7.4017
[DEBUG][MIA] Test Set Loss:   mean=6.3637, std=7.7117
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10400000000000001, 'auc': 0.49540799999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2354, std=4.5381
[DEBUG][MIA] Test Set Loss:   mean=3.6192, std=4.4198
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.14901960784313725, 'auc': 0.57696533203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.6978, std=4.6641
[DEBUG][MIA] Test Set Loss:   mean=4.2057, std=4.9189
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.11200000000000002, 'auc': 0.462648, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4340, std=4.2099
[DEBUG][MIA] Test Set Loss:   mean=3.9103, std=4.1720
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10980392156862746, 'auc': 0.54351806640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0323, std=4.4810
[DEBUG][MIA] Test Set Loss:   mean=3.9147, std=4.3903
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11000000000000001, 'auc': 0.49286399999999997, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.5736, std=8.6759
[DEBUG][MIA] Test Set Loss:   mean=7.6594, std=9.8088
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.09803921568627451, 'auc': 0.5938720703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0961, std=8.7737
[DEBUG][MIA] Test Set Loss:   mean=6.4611, std=8.7616
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.1, 'auc': 0.51336, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.3704, std=11.9742
[DEBUG][MIA] Test Set Loss:   mean=10.9304, std=12.6444
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11764705882352941, 'auc': 0.51312255859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.9541, std=11.6010
[DEBUG][MIA] Test Set Loss:   mean=10.4135, std=11.5160
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.5163840000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.2918, std=9.3464
[DEBUG][MIA] Test Set Loss:   mean=8.3589, std=9.7915
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11764705882352941, 'auc': 0.46337890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.4090, std=9.6595
[DEBUG][MIA] Test Set Loss:   mean=8.9702, std=9.1839
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10200000000000001, 'auc': 0.465208, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.0478, std=5.4759
[DEBUG][MIA] Test Set Loss:   mean=5.3915, std=5.4394
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.11372549019607843, 'auc': 0.6107177734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.6069, std=5.2093
[DEBUG][MIA] Test Set Loss:   mean=5.4451, std=5.7165
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.550368, 'task': 8}
Total correct retain:  779  Total retain:  2500
Total correct forget:  12273  Total forget:  47500
Total correct test:  156  Total test:  500
Total correct forget test:  2334  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.312, 0.334, 0.272, 0.368, 0.362, 0.358, 0.27, 0.232, 0.196, 0.174, 0.308, 0.194, 0.26, 0.186, 0.316, 0.15, 0.144, 0.092, 0.244, 0.208]
Unlearning task: 7
Accuracy, Confidence: (0.34765625, 0.8490153551101685)
broken out of loop
Accuracy, Confidence: (0.34765625, 0.8455338478088379)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6121, std=4.7515
[DEBUG][MIA] Test Set Loss:   mean=4.5752, std=6.3191
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.13333333333333336, 'auc': 0.648193359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.2090, std=5.8157
[DEBUG][MIA] Test Set Loss:   mean=4.0698, std=5.8970
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10400000000000001, 'auc': 0.508896, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.2731, std=5.9683
[DEBUG][MIA] Test Set Loss:   mean=5.8869, std=6.4347
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.13333333333333333, 'auc': 0.60638427734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.4017, std=7.4382
[DEBUG][MIA] Test Set Loss:   mean=6.5740, std=7.4526
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11599999999999999, 'auc': 0.50264, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8235, std=4.0719
[DEBUG][MIA] Test Set Loss:   mean=4.1750, std=4.7364
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.16470588235294117, 'auc': 0.61163330078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.6094, std=4.7372
[DEBUG][MIA] Test Set Loss:   mean=4.0261, std=4.6239
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10800000000000001, 'auc': 0.447264, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.3591, std=3.6245
[DEBUG][MIA] Test Set Loss:   mean=3.1475, std=3.2801
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12941176470588237, 'auc': 0.4931640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6342, std=4.2836
[DEBUG][MIA] Test Set Loss:   mean=4.1774, std=4.6048
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.10800000000000001, 'auc': 0.46312, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7699, std=7.7478
[DEBUG][MIA] Test Set Loss:   mean=7.1063, std=8.3190
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10196078431372549, 'auc': 0.61749267578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.5665, std=9.7293
[DEBUG][MIA] Test Set Loss:   mean=6.6437, std=8.9777
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.092, 'auc': 0.481248, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.5331, std=11.5706
[DEBUG][MIA] Test Set Loss:   mean=9.5846, std=11.7227
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11764705882352941, 'auc': 0.5008544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.4251, std=11.0891
[DEBUG][MIA] Test Set Loss:   mean=10.5618, std=11.5948
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.098, 'auc': 0.49404800000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.8352, std=9.8786
[DEBUG][MIA] Test Set Loss:   mean=8.6458, std=8.5374
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10980392156862746, 'auc': 0.56524658203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.1993, std=9.7100
[DEBUG][MIA] Test Set Loss:   mean=8.8718, std=8.9918
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.126, 'auc': 0.45398399999999994, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.2866, std=5.6669
[DEBUG][MIA] Test Set Loss:   mean=6.3655, std=5.7751
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.14509803921568626, 'auc': 0.65380859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5022, std=5.1588
[DEBUG][MIA] Test Set Loss:   mean=5.8380, std=5.8824
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.08199999999999999, 'auc': 0.418432, 'task': 8}
Total correct retain:  787  Total retain:  2500
Total correct forget:  12332  Total forget:  47500
Total correct test:  158  Total test:  500
Total correct forget test:  2342  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.316, 0.336, 0.272, 0.372, 0.362, 0.362, 0.268, 0.232, 0.196, 0.176, 0.31, 0.194, 0.26, 0.19, 0.316, 0.154, 0.144, 0.088, 0.246, 0.206]
Unlearning task: 6
Accuracy, Confidence: (0.4453125, 0.8093909621238708)
broken out of loop
Accuracy, Confidence: (0.328125, 0.8611310124397278)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8537, std=2.7193
[DEBUG][MIA] Test Set Loss:   mean=3.0427, std=3.7091
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.1803921568627451, 'auc': 0.635986328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.2236, std=4.0322
[DEBUG][MIA] Test Set Loss:   mean=3.1593, std=3.8398
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.50312, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8484, std=7.1839
[DEBUG][MIA] Test Set Loss:   mean=5.4773, std=5.0582
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.1176470588235294, 'auc': 0.5235595703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.9687, std=6.9875
[DEBUG][MIA] Test Set Loss:   mean=6.6047, std=7.0714
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.118, 'auc': 0.46348800000000007, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.3778, std=3.6314
[DEBUG][MIA] Test Set Loss:   mean=3.9036, std=4.3801
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.1803921568627451, 'auc': 0.524169921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.3369, std=4.5438
[DEBUG][MIA] Test Set Loss:   mean=4.4502, std=4.7169
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.4936, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5985, std=4.3210
[DEBUG][MIA] Test Set Loss:   mean=5.0881, std=4.6568
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.12941176470588234, 'auc': 0.52935791015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.1862, std=4.8114
[DEBUG][MIA] Test Set Loss:   mean=4.6206, std=4.3566
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.086, 'auc': 0.46748799999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.3977, std=9.3014
[DEBUG][MIA] Test Set Loss:   mean=6.7312, std=8.3233
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.06666666666666667, 'auc': 0.50799560546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.5451, std=10.9134
[DEBUG][MIA] Test Set Loss:   mean=8.2634, std=9.7747
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.092, 'auc': 0.463344, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6484, std=8.5529
[DEBUG][MIA] Test Set Loss:   mean=8.4163, std=8.3831
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10588235294117647, 'auc': 0.542236328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.9267, std=7.8130
[DEBUG][MIA] Test Set Loss:   mean=8.0933, std=8.5088
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.092, 'auc': 0.458256, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3843, std=5.3401
[DEBUG][MIA] Test Set Loss:   mean=5.9886, std=6.0508
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.06666666666666667, 'auc': 0.5301513671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.8706, std=6.4303
[DEBUG][MIA] Test Set Loss:   mean=5.8408, std=5.9894
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.09, 'auc': 0.487824, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8809, std=4.5762
[DEBUG][MIA] Test Set Loss:   mean=4.2853, std=4.2758
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.13333333333333336, 'auc': 0.55096435546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.6555, std=5.0261
[DEBUG][MIA] Test Set Loss:   mean=5.1068, std=5.1141
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.5311520000000001, 'task': 8}
Total correct retain:  914  Total retain:  2500
Total correct forget:  11824  Total forget:  47500
Total correct test:  168  Total test:  500
Total correct forget test:  2290  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.336, 0.35, 0.234, 0.306, 0.246, 0.26, 0.282, 0.298, 0.252, 0.198, 0.256, 0.198, 0.278, 0.194, 0.29, 0.188, 0.222, 0.106, 0.234, 0.188]
Unlearning task: 5
Accuracy, Confidence: (0.31640625, 0.7694734334945679)
broken out of loop
Accuracy, Confidence: (0.32421875, 0.7651189565658569)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1525, std=3.4614
[DEBUG][MIA] Test Set Loss:   mean=3.4442, std=4.5730
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.30196078431372547, 'auc': 0.61285400390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8468, std=3.8470
[DEBUG][MIA] Test Set Loss:   mean=3.1982, std=4.2965
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.092, 'auc': 0.52352, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8641, std=6.5376
[DEBUG][MIA] Test Set Loss:   mean=6.6427, std=7.9555
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.12549019607843137, 'auc': 0.51580810546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0962, std=6.5138
[DEBUG][MIA] Test Set Loss:   mean=5.9845, std=6.2047
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11000000000000001, 'auc': 0.49472, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0182, std=3.3172
[DEBUG][MIA] Test Set Loss:   mean=4.3088, std=4.6001
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10980392156862746, 'auc': 0.5885009765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.4895, std=3.7251
[DEBUG][MIA] Test Set Loss:   mean=4.0078, std=4.5995
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.48316800000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.2051, std=4.0721
[DEBUG][MIA] Test Set Loss:   mean=4.5932, std=4.0551
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12941176470588234, 'auc': 0.5338134765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0653, std=3.9128
[DEBUG][MIA] Test Set Loss:   mean=4.2336, std=4.0731
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.124, 'auc': 0.506512, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.6078, std=8.8035
[DEBUG][MIA] Test Set Loss:   mean=7.8838, std=8.8132
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.11372549019607843, 'auc': 0.555419921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.8702, std=9.6985
[DEBUG][MIA] Test Set Loss:   mean=7.2956, std=9.1097
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.1, 'auc': 0.487776, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.2832, std=8.1885
[DEBUG][MIA] Test Set Loss:   mean=8.1236, std=7.6983
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.55841064453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.9633, std=7.9186
[DEBUG][MIA] Test Set Loss:   mean=7.5831, std=8.0909
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.532544, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.6798, std=6.0388
[DEBUG][MIA] Test Set Loss:   mean=6.0896, std=6.1314
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09019607843137255, 'auc': 0.54425048828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.6107, std=6.0875
[DEBUG][MIA] Test Set Loss:   mean=5.8187, std=5.7004
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.1, 'auc': 0.524184, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.5119, std=4.0130
[DEBUG][MIA] Test Set Loss:   mean=5.2518, std=5.1923
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.11764705882352941, 'auc': 0.591064453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.3216, std=4.4385
[DEBUG][MIA] Test Set Loss:   mean=4.4620, std=4.6147
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11399999999999999, 'auc': 0.50748, 'task': 8}
Total correct retain:  892  Total retain:  2500
Total correct forget:  11908  Total forget:  47500
Total correct test:  164  Total test:  500
Total correct forget test:  2298  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.328, 0.348, 0.244, 0.304, 0.254, 0.268, 0.27, 0.298, 0.246, 0.202, 0.256, 0.198, 0.278, 0.192, 0.304, 0.188, 0.214, 0.104, 0.236, 0.192]
Unlearning task: 4
Accuracy, Confidence: (0.40625, 0.8044602870941162)
broken out of loop
Accuracy, Confidence: (0.41796875, 0.8074462413787842)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7593, std=2.9427
[DEBUG][MIA] Test Set Loss:   mean=3.0309, std=3.9548
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.13725490196078433, 'auc': 0.6480712890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.1439, std=3.6189
[DEBUG][MIA] Test Set Loss:   mean=3.4738, std=4.5381
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11600000000000002, 'auc': 0.49209600000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0815, std=7.1096
[DEBUG][MIA] Test Set Loss:   mean=5.9931, std=6.9431
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.1372549019607843, 'auc': 0.50482177734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.1170, std=7.3403
[DEBUG][MIA] Test Set Loss:   mean=5.8191, std=6.6473
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.08399999999999999, 'auc': 0.500576, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8751, std=3.4558
[DEBUG][MIA] Test Set Loss:   mean=4.0618, std=4.6512
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10980392156862746, 'auc': 0.578857421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0410, std=4.0008
[DEBUG][MIA] Test Set Loss:   mean=4.2505, std=4.6011
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.09, 'auc': 0.49905600000000006, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.9646, std=4.0073
[DEBUG][MIA] Test Set Loss:   mean=3.6761, std=4.2713
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.1764705882352941, 'auc': 0.4813232421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0973, std=3.9561
[DEBUG][MIA] Test Set Loss:   mean=4.2324, std=3.8716
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10400000000000001, 'auc': 0.483456, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.4233, std=9.3165
[DEBUG][MIA] Test Set Loss:   mean=7.5258, std=8.6387
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10980392156862746, 'auc': 0.5181884765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.1670, std=10.3994
[DEBUG][MIA] Test Set Loss:   mean=8.5873, std=10.7910
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.098, 'auc': 0.504496, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.8836, std=8.2835
[DEBUG][MIA] Test Set Loss:   mean=8.0018, std=7.8279
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.1411764705882353, 'auc': 0.55572509765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8621, std=8.3835
[DEBUG][MIA] Test Set Loss:   mean=8.2585, std=8.6404
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.517888, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.4472, std=5.7482
[DEBUG][MIA] Test Set Loss:   mean=5.9441, std=5.6992
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09803921568627451, 'auc': 0.54766845703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.0442, std=6.6050
[DEBUG][MIA] Test Set Loss:   mean=6.1035, std=6.1045
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.096, 'auc': 0.480272, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.4437, std=4.1256
[DEBUG][MIA] Test Set Loss:   mean=4.5061, std=4.7051
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.1215686274509804, 'auc': 0.57098388671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.2714, std=4.4243
[DEBUG][MIA] Test Set Loss:   mean=4.7282, std=4.7672
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10400000000000001, 'auc': 0.523792, 'task': 8}
Total correct retain:  876  Total retain:  2500
Total correct forget:  11983  Total forget:  47500
Total correct test:  160  Total test:  500
Total correct forget test:  2311  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.32, 0.358, 0.25, 0.31, 0.268, 0.266, 0.276, 0.296, 0.244, 0.192, 0.262, 0.194, 0.282, 0.192, 0.306, 0.186, 0.208, 0.104, 0.236, 0.192]
Unlearning task: 3
Accuracy, Confidence: (0.328125, 0.8587890267372131)
broken out of loop
Accuracy, Confidence: (0.33203125, 0.854102611541748)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9532, std=3.6712
[DEBUG][MIA] Test Set Loss:   mean=4.0543, std=5.2691
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.11764705882352941, 'auc': 0.6717529296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0125, std=3.6839
[DEBUG][MIA] Test Set Loss:   mean=3.4913, std=4.6702
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.50904, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1673, std=6.2581
[DEBUG][MIA] Test Set Loss:   mean=5.5801, std=5.1652
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10980392156862746, 'auc': 0.5594482421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.3049, std=7.5729
[DEBUG][MIA] Test Set Loss:   mean=5.6680, std=6.7533
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.478048, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2559, std=3.4900
[DEBUG][MIA] Test Set Loss:   mean=4.3968, std=4.8057
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.13725490196078433, 'auc': 0.56103515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.6686, std=4.0260
[DEBUG][MIA] Test Set Loss:   mean=4.1038, std=4.6099
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10200000000000001, 'auc': 0.48, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6929, std=3.5060
[DEBUG][MIA] Test Set Loss:   mean=5.0227, std=4.3337
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.09019607843137255, 'auc': 0.5841064453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6257, std=4.0099
[DEBUG][MIA] Test Set Loss:   mean=4.0799, std=3.9883
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.094, 'auc': 0.539504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.4931, std=10.1457
[DEBUG][MIA] Test Set Loss:   mean=6.5838, std=9.7751
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.4737548828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7518, std=7.4963
[DEBUG][MIA] Test Set Loss:   mean=7.1610, std=9.3009
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11000000000000001, 'auc': 0.483248, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.9579, std=8.3586
[DEBUG][MIA] Test Set Loss:   mean=6.6449, std=7.3358
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10980392156862744, 'auc': 0.52630615234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7714, std=8.0408
[DEBUG][MIA] Test Set Loss:   mean=7.7762, std=8.4349
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.1, 'auc': 0.49518399999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9401, std=6.2881
[DEBUG][MIA] Test Set Loss:   mean=6.3045, std=5.4400
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.08627450980392157, 'auc': 0.54351806640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.0234, std=6.3213
[DEBUG][MIA] Test Set Loss:   mean=5.6650, std=5.5155
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.506368, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6623, std=4.2751
[DEBUG][MIA] Test Set Loss:   mean=4.5281, std=4.4325
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1803921568627451, 'auc': 0.58319091796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5121, std=4.5475
[DEBUG][MIA] Test Set Loss:   mean=4.9606, std=4.7304
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.5369120000000001, 'task': 8}
Total correct retain:  870  Total retain:  2500
Total correct forget:  12019  Total forget:  47500
Total correct test:  157  Total test:  500
Total correct forget test:  2301  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.314, 0.356, 0.24, 0.316, 0.286, 0.264, 0.272, 0.294, 0.236, 0.188, 0.268, 0.194, 0.286, 0.19, 0.306, 0.184, 0.204, 0.086, 0.234, 0.198]
Unlearning task: 2
Accuracy, Confidence: (0.6015625, 0.7798984050750732)
broken out of loop
Accuracy, Confidence: (0.4140625, 0.8319748640060425)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 8, 8, 6, 5, 7, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2865, std=12.8569
[DEBUG][MIA] Test Set Loss:   mean=10.7052, std=15.8425
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.08627450980392157, 'auc': 0.62957763671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 9 8 7 9 9 7 5 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 5 6 5 8 5 6 6 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.7454, std=15.2068
[DEBUG][MIA] Test Set Loss:   mean=10.4541, std=16.2484
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.094, 'auc': 0.514368, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 12, 14, 13, 10, 10, 10, 14, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.8932, std=11.6830
[DEBUG][MIA] Test Set Loss:   mean=9.3156, std=11.4118
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.13725490196078433, 'auc': 0.53631591796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 10 13 10 11 14 13 12 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 13 12 10 14 11 11 10 12 10]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.0451, std=10.1677
[DEBUG][MIA] Test Set Loss:   mean=8.8201, std=10.3347
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11399999999999999, 'auc': 0.523856, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 17, 15, 18, 17, 16, 16, 16, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.9893, std=6.8842
[DEBUG][MIA] Test Set Loss:   mean=5.6964, std=7.8765
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.11764705882352941, 'auc': 0.601806640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 15 17 19 19 18 16 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 18 17 18 19 19 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.4395, std=8.0519
[DEBUG][MIA] Test Set Loss:   mean=5.8463, std=8.4824
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11600000000000002, 'auc': 0.48152000000000006, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([23, 20, 23, 24, 22, 23, 20, 22, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5047, std=4.0512
[DEBUG][MIA] Test Set Loss:   mean=4.7200, std=4.7548
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.1568627450980392, 'auc': 0.504638671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 21 24 24 22 23 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 23 22 23 22 21 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8836, std=4.9461
[DEBUG][MIA] Test Set Loss:   mean=4.6823, std=4.5238
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.092, 'auc': 0.5000640000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 26, 28, 26, 25, 28, 27, 26, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.8112, std=14.6423
[DEBUG][MIA] Test Set Loss:   mean=11.9085, std=14.5379
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09411764705882353, 'auc': 0.5899658203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 29 26 27 28 27 28 25 29 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 25 28 28 28 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.6289, std=14.3057
[DEBUG][MIA] Test Set Loss:   mean=10.4397, std=14.0803
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.092, 'auc': 0.50112, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 30, 34, 33, 31, 30, 33, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.5463, std=10.5172
[DEBUG][MIA] Test Set Loss:   mean=10.4245, std=11.7643
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09411764705882353, 'auc': 0.433135986328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 30 34 30 30 34 30 31 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 33 33 34 30 30 30 32 33 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.9928, std=10.5970
[DEBUG][MIA] Test Set Loss:   mean=11.1445, std=11.6947
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.442, 'cv_acc': 0.11200000000000002, 'auc': 0.446608, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 37, 39, 39, 39, 36, 35, 38, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.9868, std=11.9645
[DEBUG][MIA] Test Set Loss:   mean=10.1224, std=10.9358
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.0784313725490196, 'auc': 0.46844482421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 39 38 39 36 35 39 38 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 35 35 37 38 39 37 38 37 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.3130, std=10.6453
[DEBUG][MIA] Test Set Loss:   mean=8.9996, std=10.4243
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11599999999999999, 'auc': 0.530648, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 40, 41, 41, 41, 43, 43, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6478, std=5.0190
[DEBUG][MIA] Test Set Loss:   mean=5.3123, std=5.2870
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.11372549019607843, 'auc': 0.62274169921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 40 44 44 44 40 40 43 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 43 41 42 44 41 44 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.0622, std=4.5150
[DEBUG][MIA] Test Set Loss:   mean=4.1600, std=4.6209
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.12000000000000002, 'auc': 0.511968, 'task': 8}
Total correct retain:  704  Total retain:  2500
Total correct forget:  11641  Total forget:  47500
Total correct test:  142  Total test:  500
Total correct forget test:  2249  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.284, 0.298, 0.24, 0.318, 0.308, 0.234, 0.252, 0.236, 0.248, 0.178, 0.302, 0.194, 0.26, 0.24, 0.314, 0.152, 0.168, 0.104, 0.242, 0.21]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['caterpillar', 'spider', 'kangaroo', 'pickup truck', 'apples', 'oak', 'castle', 'mouse', 'streetcar', 'boy', 'camel', 'worm', 'bee', 'shrew', 'skunk', 'motorcycle', 'turtle', 'plain', 'butterfly', 'ray', 'raccoon', 'cockroach', 'tiger', 'television', 'computer keyboard', 'mushrooms', 'tank', 'snake', 'bottles', 'bridge', 'whale', 'aquarium fish', 'rabbit', 'seal', 'chimpanzee', 'porcupine', 'crab', 'baby', 'rocket', 'dinosaur', 'pears', 'bed', 'lobster', 'cups', 'beetle', 'poppies', 'elephant', 'wardrobe', 'trout', 'road', 'girl', 'cans', 'cattle', 'table', 'snail', 'house', 'maple', 'telephone', 'flatfish', 'cloud', 'pine', 'tractor', 'fox', 'palm', 'wolf', 'bowls', 'lion', 'lawn-mower', 'orchids', 'forest', 'beaver', 'chair', 'skyscraper', 'roses', 'shark', 'couch', 'possum', 'clock', 'lamp', 'bus', 'bicycle', 'plates', 'man', 'leopard', 'sweet peppers', 'willow', 'mountain', 'lizard', 'bear', 'tulips', 'hamster', 'otter', 'crocodile', 'train', 'woman', 'squirrel', 'oranges', 'sunflowers', 'dolphin', 'sea']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2153  Total retain:  2500
Total correct forget:  10201  Total forget:  47500
Total correct test:  361  Total test:  500
Total correct forget test:  2083  Total test forget:  9500
After learning task 1
Task accuracies: [0.722, 0.17, 0.262, 0.21, 0.23, 0.234, 0.2, 0.202, 0.228, 0.136, 0.226, 0.2, 0.236, 0.186, 0.192, 0.198, 0.23, 0.36, 0.168, 0.298]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0445, std=0.2770
[DEBUG][MIA] Test Set Loss:   mean=0.9826, std=2.3081
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.20784313725490197, 'auc': 0.644256591796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0461, std=0.2864
[DEBUG][MIA] Test Set Loss:   mean=0.6617, std=1.7810
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.184, 'auc': 0.60964, 'task': 1}
2 1
Total correct retain:  1939  Total retain:  2500
Total correct forget:  12622  Total forget:  47500
Total correct test:  360  Total test:  500
Total correct forget test:  2422  Total test forget:  9500
After learning task 2
Task accuracies: [0.72, 0.834, 0.242, 0.192, 0.238, 0.228, 0.218, 0.194, 0.194, 0.196, 0.198, 0.196, 0.24, 0.194, 0.284, 0.204, 0.182, 0.42, 0.142, 0.248]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0088, std=0.0157
[DEBUG][MIA] Test Set Loss:   mean=1.1926, std=2.4316
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2627450980392157, 'auc': 0.702301025390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4872, std=1.2979
[DEBUG][MIA] Test Set Loss:   mean=1.1188, std=2.1084
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.156, 'auc': 0.57648, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0146, std=0.0670
[DEBUG][MIA] Test Set Loss:   mean=1.3568, std=2.7741
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.21176470588235294, 'auc': 0.707305908203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0072, std=0.0382
[DEBUG][MIA] Test Set Loss:   mean=1.1020, std=2.5035
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.656, 'cv_acc': 0.236, 'auc': 0.7459520000000001, 'task': 2}
3 2
Total correct retain:  1822  Total retain:  2500
Total correct forget:  13933  Total forget:  47500
Total correct test:  330  Total test:  500
Total correct forget test:  2626  Total test forget:  9500
After learning task 3
Task accuracies: [0.66, 0.744, 0.778, 0.228, 0.184, 0.246, 0.174, 0.194, 0.196, 0.222, 0.206, 0.244, 0.248, 0.28, 0.21, 0.244, 0.184, 0.33, 0.14, 0.2]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=0.8540, std=1.8672
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.26666666666666666, 'auc': 0.756317138671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6429, std=1.4983
[DEBUG][MIA] Test Set Loss:   mean=1.0452, std=2.2598
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.15399999999999997, 'auc': 0.547032, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0228
[DEBUG][MIA] Test Set Loss:   mean=1.9706, std=2.9836
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.26666666666666666, 'auc': 0.8265380859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5526, std=1.4791
[DEBUG][MIA] Test Set Loss:   mean=1.6546, std=2.8886
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.20600000000000002, 'auc': 0.621192, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0245, std=0.1467
[DEBUG][MIA] Test Set Loss:   mean=1.3379, std=2.8057
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.23921568627450984, 'auc': 0.686279296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0060, std=0.0330
[DEBUG][MIA] Test Set Loss:   mean=0.6595, std=1.6618
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.632, 'cv_acc': 0.23199999999999998, 'auc': 0.665032, 'task': 3}
4 3
Total correct retain:  1797  Total retain:  2500
Total correct forget:  14971  Total forget:  47500
Total correct test:  332  Total test:  500
Total correct forget test:  2812  Total test forget:  9500
After learning task 4
Task accuracies: [0.664, 0.742, 0.648, 0.8, 0.212, 0.242, 0.244, 0.196, 0.214, 0.142, 0.244, 0.21, 0.224, 0.256, 0.23, 0.196, 0.15, 0.322, 0.174, 0.178]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0312, std=0.1109
[DEBUG][MIA] Test Set Loss:   mean=1.5576, std=2.6657
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.30196078431372547, 'auc': 0.714569091796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0356, std=2.1390
[DEBUG][MIA] Test Set Loss:   mean=1.9785, std=3.1723
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.11800000000000002, 'auc': 0.576856, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0061
[DEBUG][MIA] Test Set Loss:   mean=1.3941, std=2.3816
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7607843137254902, 'auc': 0.84088134765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9316, std=1.8588
[DEBUG][MIA] Test Set Loss:   mean=1.4949, std=2.6926
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.174, 'auc': 0.590048, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0632, std=0.2963
[DEBUG][MIA] Test Set Loss:   mean=1.1654, std=2.4719
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2549019607843137, 'auc': 0.70361328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5529, std=1.3865
[DEBUG][MIA] Test Set Loss:   mean=1.0165, std=2.2895
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.186, 'auc': 0.541976, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0238, std=0.2079
[DEBUG][MIA] Test Set Loss:   mean=1.2059, std=2.5322
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2431372549019608, 'auc': 0.75421142578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0101, std=0.0451
[DEBUG][MIA] Test Set Loss:   mean=1.2139, std=2.6122
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.666, 'cv_acc': 0.272, 'auc': 0.7352, 'task': 4}
5 4
Total correct retain:  1708  Total retain:  2500
Total correct forget:  16151  Total forget:  47500
Total correct test:  299  Total test:  500
Total correct forget test:  2998  Total test forget:  9500
After learning task 5
Task accuracies: [0.598, 0.652, 0.626, 0.728, 0.74, 0.196, 0.218, 0.206, 0.2, 0.208, 0.196, 0.196, 0.25, 0.266, 0.23, 0.238, 0.18, 0.258, 0.17, 0.238]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.7385, std=2.7380
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.6862745098039216, 'auc': 0.782073974609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4428, std=2.5332
[DEBUG][MIA] Test Set Loss:   mean=1.4607, std=2.6600
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.154, 'auc': 0.524312, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=2.7541, std=3.8699
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7254901960784315, 'auc': 0.868316650390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2029, std=2.1510
[DEBUG][MIA] Test Set Loss:   mean=2.2289, std=3.6025
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.15200000000000002, 'auc': 0.57748, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0125, std=0.0640
[DEBUG][MIA] Test Set Loss:   mean=1.3342, std=2.6497
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6862745098039216, 'auc': 0.77703857421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7023, std=1.6089
[DEBUG][MIA] Test Set Loss:   mean=1.2682, std=2.3941
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.154, 'auc': 0.549784, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.5367, std=2.9787
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7215686274509803, 'auc': 0.766876220703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2516, std=0.7747
[DEBUG][MIA] Test Set Loss:   mean=1.4360, std=2.7354
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.23199999999999998, 'auc': 0.6711360000000001, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0079, std=0.0413
[DEBUG][MIA] Test Set Loss:   mean=1.2036, std=2.6172
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2392156862745098, 'auc': 0.757232666015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0265
[DEBUG][MIA] Test Set Loss:   mean=1.2093, std=2.6495
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.21800000000000003, 'auc': 0.7297839999999999, 'task': 5}
6 5
Total correct retain:  1703  Total retain:  2500
Total correct forget:  18061  Total forget:  47500
Total correct test:  319  Total test:  500
Total correct forget test:  3260  Total test forget:  9500
After learning task 6
Task accuracies: [0.638, 0.666, 0.592, 0.72, 0.676, 0.778, 0.186, 0.208, 0.182, 0.208, 0.226, 0.188, 0.256, 0.266, 0.248, 0.226, 0.224, 0.28, 0.168, 0.222]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.4031, std=2.4411
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2823529411764706, 'auc': 0.803955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1889, std=2.2811
[DEBUG][MIA] Test Set Loss:   mean=1.3222, std=2.4066
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.12000000000000002, 'auc': 0.518008, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=2.1638, std=3.3301
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7450980392156863, 'auc': 0.87652587890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3955, std=2.4051
[DEBUG][MIA] Test Set Loss:   mean=2.2837, std=3.1189
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.14, 'auc': 0.608704, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=1.2752, std=2.1813
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2392156862745098, 'auc': 0.809844970703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7021, std=1.5306
[DEBUG][MIA] Test Set Loss:   mean=1.2459, std=2.5250
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.5392319999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0147
[DEBUG][MIA] Test Set Loss:   mean=1.1613, std=2.3412
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7137254901960783, 'auc': 0.80902099609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5371, std=1.3159
[DEBUG][MIA] Test Set Loss:   mean=1.6866, std=3.1368
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.2, 'auc': 0.630936, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.3652, std=2.7265
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2862745098039216, 'auc': 0.861968994140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2487, std=0.8769
[DEBUG][MIA] Test Set Loss:   mean=1.0516, std=2.1886
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.186, 'auc': 0.665616, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0206, std=0.1562
[DEBUG][MIA] Test Set Loss:   mean=1.2222, std=2.9988
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.25098039215686274, 'auc': 0.696929931640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0166, std=0.1213
[DEBUG][MIA] Test Set Loss:   mean=1.3055, std=2.9638
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.23200000000000004, 'auc': 0.6901039999999999, 'task': 6}
7 6
Total correct retain:  1679  Total retain:  2500
Total correct forget:  18553  Total forget:  47500
Total correct test:  311  Total test:  500
Total correct forget test:  3334  Total test forget:  9500
After learning task 7
Task accuracies: [0.622, 0.688, 0.572, 0.714, 0.646, 0.714, 0.77, 0.198, 0.192, 0.116, 0.19, 0.204, 0.252, 0.198, 0.212, 0.222, 0.182, 0.218, 0.168, 0.212]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.4621, std=2.5660
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.28627450980392155, 'auc': 0.852325439453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9709, std=2.2528
[DEBUG][MIA] Test Set Loss:   mean=1.2991, std=2.6477
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.142, 'auc': 0.5320959999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0113
[DEBUG][MIA] Test Set Loss:   mean=2.0314, std=3.0918
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7568627450980392, 'auc': 0.8665771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6056, std=2.6835
[DEBUG][MIA] Test Set Loss:   mean=2.4811, std=3.7569
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12200000000000003, 'auc': 0.5915360000000001, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.2564, std=2.3995
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6823529411764706, 'auc': 0.72808837890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0787, std=2.1905
[DEBUG][MIA] Test Set Loss:   mean=1.5694, std=2.7741
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.098, 'auc': 0.541992, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=1.7184, std=3.0604
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.29803921568627445, 'auc': 0.839599609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7827, std=1.9899
[DEBUG][MIA] Test Set Loss:   mean=1.9476, std=3.1810
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.156, 'auc': 0.6317600000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.0863, std=2.0815
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2823529411764706, 'auc': 0.800323486328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5818, std=1.3700
[DEBUG][MIA] Test Set Loss:   mean=1.3646, std=2.4389
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.182, 'auc': 0.6290880000000001, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0157
[DEBUG][MIA] Test Set Loss:   mean=1.2062, std=2.5289
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.27450980392156865, 'auc': 0.79486083984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2249, std=0.8810
[DEBUG][MIA] Test Set Loss:   mean=1.3752, std=2.7393
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.21000000000000002, 'auc': 0.6617839999999999, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=0.8174, std=2.0286
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.21176470588235294, 'auc': 0.687469482421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0143, std=0.1593
[DEBUG][MIA] Test Set Loss:   mean=0.8550, std=2.1760
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.23199999999999998, 'auc': 0.657256, 'task': 7}
8 7
Total correct retain:  1651  Total retain:  2500
Total correct forget:  20072  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  3621  Total test forget:  9500
After learning task 8
Task accuracies: [0.616, 0.694, 0.576, 0.67, 0.624, 0.692, 0.714, 0.792, 0.216, 0.166, 0.172, 0.19, 0.256, 0.202, 0.198, 0.196, 0.234, 0.252, 0.176, 0.222]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0209
[DEBUG][MIA] Test Set Loss:   mean=1.3320, std=2.6842
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.27450980392156865, 'auc': 0.808929443359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3708, std=2.5534
[DEBUG][MIA] Test Set Loss:   mean=1.3143, std=2.4626
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.124, 'auc': 0.500816, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=2.0052, std=2.9044
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7215686274509805, 'auc': 0.858123779296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2650, std=2.4206
[DEBUG][MIA] Test Set Loss:   mean=1.5278, std=2.6940
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.553992, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=1.5046, std=2.8680
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.6470588235294118, 'auc': 0.73870849609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1054, std=2.1716
[DEBUG][MIA] Test Set Loss:   mean=1.5745, std=2.7947
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.096, 'auc': 0.5401360000000001, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.4978, std=2.7137
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7176470588235293, 'auc': 0.86083984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7925, std=1.6996
[DEBUG][MIA] Test Set Loss:   mean=2.1098, std=3.4349
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.13599999999999998, 'auc': 0.65684, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0066
[DEBUG][MIA] Test Set Loss:   mean=1.1910, std=2.1098
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7372549019607844, 'auc': 0.8466796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7578, std=1.5868
[DEBUG][MIA] Test Set Loss:   mean=1.9646, std=3.2889
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.13199999999999998, 'auc': 0.6364080000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0155, std=0.0457
[DEBUG][MIA] Test Set Loss:   mean=1.4105, std=2.5341
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6666666666666666, 'auc': 0.8048095703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6363, std=1.6519
[DEBUG][MIA] Test Set Loss:   mean=1.5712, std=2.6959
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.17400000000000002, 'auc': 0.6521999999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0076
[DEBUG][MIA] Test Set Loss:   mean=1.1601, std=2.2337
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.29411764705882354, 'auc': 0.76702880859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3106, std=0.8524
[DEBUG][MIA] Test Set Loss:   mean=1.1388, std=2.2767
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.184, 'auc': 0.577208, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0108, std=0.0723
[DEBUG][MIA] Test Set Loss:   mean=1.4498, std=2.7170
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.26666666666666666, 'auc': 0.771820068359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0369
[DEBUG][MIA] Test Set Loss:   mean=1.1825, std=2.4571
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.676, 'cv_acc': 0.27, 'auc': 0.7529760000000001, 'task': 8}
Total correct retain:  1730  Total retain:  2500
Total correct forget:  21519  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  3821  Total test forget:  9500
After learning task 9
Task accuracies: [0.612, 0.67, 0.644, 0.686, 0.596, 0.648, 0.638, 0.714, 0.718, 0.198, 0.19, 0.204, 0.268, 0.242, 0.206, 0.18, 0.232, 0.258, 0.154, 0.196]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.6085, std=2.6542
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7098039215686274, 'auc': 0.8502197265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9745, std=2.1165
[DEBUG][MIA] Test Set Loss:   mean=1.5854, std=2.9531
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.138, 'auc': 0.575728, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.4495, std=2.7245
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7215686274509804, 'auc': 0.855682373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6880, std=3.0675
[DEBUG][MIA] Test Set Loss:   mean=1.7124, std=2.7779
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10400000000000001, 'auc': 0.550504, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0062, std=0.0286
[DEBUG][MIA] Test Set Loss:   mean=1.6154, std=2.9480
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2941176470588235, 'auc': 0.761260986328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8851, std=1.9092
[DEBUG][MIA] Test Set Loss:   mean=1.7399, std=2.8137
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.11000000000000001, 'auc': 0.589792, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0177
[DEBUG][MIA] Test Set Loss:   mean=2.5285, std=3.6815
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.6980392156862745, 'auc': 0.845794677734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1521, std=2.2033
[DEBUG][MIA] Test Set Loss:   mean=2.3413, std=3.4523
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.13200000000000003, 'auc': 0.625744, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0098
[DEBUG][MIA] Test Set Loss:   mean=1.3207, std=2.7871
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2941176470588235, 'auc': 0.817108154296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8521, std=1.7751
[DEBUG][MIA] Test Set Loss:   mean=1.5672, std=2.6415
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.184, 'auc': 0.591112, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0233, std=0.0868
[DEBUG][MIA] Test Set Loss:   mean=1.2851, std=2.4396
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7137254901960784, 'auc': 0.78057861328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7094, std=1.7374
[DEBUG][MIA] Test Set Loss:   mean=1.6751, std=2.9262
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.144, 'auc': 0.6355919999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0075, std=0.0207
[DEBUG][MIA] Test Set Loss:   mean=1.1615, std=2.3922
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.28627450980392155, 'auc': 0.7724609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5959, std=1.4563
[DEBUG][MIA] Test Set Loss:   mean=1.3411, std=2.6515
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.168, 'auc': 0.6040479999999999, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.0948, std=1.9714
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7215686274509804, 'auc': 0.82183837890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1702, std=0.7806
[DEBUG][MIA] Test Set Loss:   mean=1.3337, std=2.4263
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.266, 'auc': 0.7074, 'task': 8}
Total correct retain:  1689  Total retain:  2500
Total correct forget:  23046  Total forget:  47500
Total correct test:  295  Total test:  500
Total correct forget test:  4141  Total test forget:  9500
After learning task 10
Task accuracies: [0.59, 0.65, 0.634, 0.674, 0.552, 0.668, 0.64, 0.68, 0.672, 0.884, 0.186, 0.216, 0.28, 0.224, 0.262, 0.188, 0.214, 0.288, 0.184, 0.186]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.5694, std=2.7625
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.27450980392156865, 'auc': 0.824676513671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1582, std=2.1887
[DEBUG][MIA] Test Set Loss:   mean=1.3663, std=2.6926
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11200000000000002, 'auc': 0.528856, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.5864, std=2.4056
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7215686274509804, 'auc': 0.900726318359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7921, std=3.1881
[DEBUG][MIA] Test Set Loss:   mean=1.8837, std=2.9989
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11599999999999999, 'auc': 0.535952, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0090, std=0.0348
[DEBUG][MIA] Test Set Loss:   mean=1.5873, std=2.8424
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2549019607843137, 'auc': 0.800994873046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0856, std=2.4198
[DEBUG][MIA] Test Set Loss:   mean=1.4520, std=2.6103
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.09, 'auc': 0.56492, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0085
[DEBUG][MIA] Test Set Loss:   mean=2.3340, std=4.2947
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7529411764705882, 'auc': 0.8658447265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4224, std=3.0323
[DEBUG][MIA] Test Set Loss:   mean=2.4376, std=3.9342
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.13400000000000004, 'auc': 0.602232, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.8190, std=3.0773
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7333333333333334, 'auc': 0.831695556640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8877, std=1.9858
[DEBUG][MIA] Test Set Loss:   mean=1.5646, std=2.7322
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.194, 'auc': 0.585896, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.0984
[DEBUG][MIA] Test Set Loss:   mean=1.9479, std=2.8233
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7450980392156863, 'auc': 0.8125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0008, std=2.1208
[DEBUG][MIA] Test Set Loss:   mean=2.0938, std=3.4287
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.148, 'auc': 0.6159439999999999, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0094
[DEBUG][MIA] Test Set Loss:   mean=2.0283, std=3.3570
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.27058823529411763, 'auc': 0.84014892578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8797, std=1.9134
[DEBUG][MIA] Test Set Loss:   mean=1.2761, std=2.4804
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.186, 'auc': 0.57284, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.1533, std=2.4562
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2941176470588235, 'auc': 0.815948486328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4846, std=1.1943
[DEBUG][MIA] Test Set Loss:   mean=1.4525, std=2.5028
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.21800000000000003, 'auc': 0.637424, 'task': 8}
Total correct retain:  1740  Total retain:  2500
Total correct forget:  24445  Total forget:  47500
Total correct test:  325  Total test:  500
Total correct forget test:  4289  Total test forget:  9500
After learning task 11
Task accuracies: [0.65, 0.708, 0.64, 0.682, 0.566, 0.622, 0.586, 0.666, 0.642, 0.838, 0.7, 0.216, 0.286, 0.224, 0.238, 0.176, 0.182, 0.304, 0.12, 0.182]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9966437816619873)
broken out of loop
Accuracy, Confidence: (0.34375, 0.9747949242591858)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2361, std=7.8171
[DEBUG][MIA] Test Set Loss:   mean=6.9190, std=8.0268
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.5509033203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.0755, std=7.5799
[DEBUG][MIA] Test Set Loss:   mean=7.1746, std=8.3502
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.456064, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3645, std=6.1156
[DEBUG][MIA] Test Set Loss:   mean=5.8311, std=5.4208
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.08235294117647059, 'auc': 0.54632568359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.2628, std=6.6539
[DEBUG][MIA] Test Set Loss:   mean=6.2523, std=6.0893
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.092, 'auc': 0.511632, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9162, std=5.3385
[DEBUG][MIA] Test Set Loss:   mean=5.6671, std=6.2117
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.14509803921568626, 'auc': 0.5211181640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9299, std=5.2212
[DEBUG][MIA] Test Set Loss:   mean=5.0740, std=5.4375
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11400000000000002, 'auc': 0.5065759999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.5287, std=7.9973
[DEBUG][MIA] Test Set Loss:   mean=6.8774, std=7.2717
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09803921568627451, 'auc': 0.605255126953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.6589, std=7.2346
[DEBUG][MIA] Test Set Loss:   mean=6.8276, std=7.6545
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10400000000000001, 'auc': 0.5058480000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.4705, std=6.9071
[DEBUG][MIA] Test Set Loss:   mean=5.5156, std=5.7421
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.1568627450980392, 'auc': 0.5318603515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.3545, std=7.9841
[DEBUG][MIA] Test Set Loss:   mean=6.1873, std=6.9621
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.1, 'auc': 0.522456, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5358, std=5.5061
[DEBUG][MIA] Test Set Loss:   mean=5.2979, std=5.6138
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.11372549019607843, 'auc': 0.56195068359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.1327, std=5.7551
[DEBUG][MIA] Test Set Loss:   mean=5.6935, std=5.7488
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.5382319999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4260, std=5.7323
[DEBUG][MIA] Test Set Loss:   mean=4.9881, std=6.3583
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1215686274509804, 'auc': 0.542236328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7020, std=6.5771
[DEBUG][MIA] Test Set Loss:   mean=5.1935, std=6.3395
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10800000000000001, 'auc': 0.5455840000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5449, std=7.8786
[DEBUG][MIA] Test Set Loss:   mean=6.9440, std=6.9207
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09019607843137255, 'auc': 0.55010986328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5303, std=7.4230
[DEBUG][MIA] Test Set Loss:   mean=6.7141, std=7.6010
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.136, 'auc': 0.510648, 'task': 8}
Total correct retain:  645  Total retain:  2500
Total correct forget:  12324  Total forget:  47500
Total correct test:  116  Total test:  500
Total correct forget test:  2327  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.232, 0.246, 0.228, 0.3, 0.308, 0.278, 0.212, 0.334, 0.226, 0.22, 0.338, 0.2, 0.242, 0.19, 0.226, 0.19, 0.134, 0.316, 0.212, 0.254]
Unlearning task: 10
Accuracy, Confidence: (0.29296875, 0.8321269750595093)
broken out of loop
Accuracy, Confidence: (0.296875, 0.8287338614463806)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.1487, std=7.6525
[DEBUG][MIA] Test Set Loss:   mean=7.6812, std=8.9435
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09411764705882353, 'auc': 0.564208984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.3457, std=7.3179
[DEBUG][MIA] Test Set Loss:   mean=6.6193, std=7.1385
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.094, 'auc': 0.5158240000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.5890, std=5.7648
[DEBUG][MIA] Test Set Loss:   mean=6.2221, std=5.7800
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.16862745098039217, 'auc': 0.548828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.2751, std=5.7910
[DEBUG][MIA] Test Set Loss:   mean=5.8681, std=5.4584
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11800000000000002, 'auc': 0.518144, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.1618, std=5.0592
[DEBUG][MIA] Test Set Loss:   mean=5.6372, std=5.8124
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10588235294117647, 'auc': 0.58050537109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.8692, std=4.9738
[DEBUG][MIA] Test Set Loss:   mean=5.7186, std=5.7283
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10200000000000001, 'auc': 0.540608, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.0315, std=7.4886
[DEBUG][MIA] Test Set Loss:   mean=6.1335, std=8.4746
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.14901960784313725, 'auc': 0.50897216796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.2618, std=7.4777
[DEBUG][MIA] Test Set Loss:   mean=7.5520, std=8.2275
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.541952, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.1145, std=6.4024
[DEBUG][MIA] Test Set Loss:   mean=5.9335, std=7.2897
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10980392156862746, 'auc': 0.53118896484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3873, std=6.5722
[DEBUG][MIA] Test Set Loss:   mean=6.0576, std=6.7547
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11200000000000002, 'auc': 0.543544, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.4946, std=4.3853
[DEBUG][MIA] Test Set Loss:   mean=5.7276, std=5.8864
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1607843137254902, 'auc': 0.54742431640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.1869, std=5.5173
[DEBUG][MIA] Test Set Loss:   mean=5.7603, std=5.6054
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.086, 'auc': 0.534816, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5659, std=6.1683
[DEBUG][MIA] Test Set Loss:   mean=5.8935, std=6.6744
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.12941176470588234, 'auc': 0.58074951171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7168, std=6.5536
[DEBUG][MIA] Test Set Loss:   mean=5.3926, std=6.4994
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.096, 'auc': 0.54816, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.4517, std=7.5798
[DEBUG][MIA] Test Set Loss:   mean=8.4663, std=8.1124
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.1411764705882353, 'auc': 0.589202880859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.0330, std=6.1918
[DEBUG][MIA] Test Set Loss:   mean=6.9815, std=7.5216
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.13600000000000004, 'auc': 0.528656, 'task': 8}
Total correct retain:  644  Total retain:  2500
Total correct forget:  12385  Total forget:  47500
Total correct test:  117  Total test:  500
Total correct forget test:  2335  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.234, 0.246, 0.23, 0.302, 0.31, 0.286, 0.21, 0.34, 0.226, 0.222, 0.334, 0.2, 0.236, 0.192, 0.224, 0.194, 0.136, 0.318, 0.212, 0.252]
Unlearning task: 9
Accuracy, Confidence: (0.3125, 0.8678468465805054)
broken out of loop
Accuracy, Confidence: (0.31640625, 0.8667222857475281)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.1534, std=7.7848
[DEBUG][MIA] Test Set Loss:   mean=6.0670, std=7.2697
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11372549019607843, 'auc': 0.531982421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3905, std=6.9027
[DEBUG][MIA] Test Set Loss:   mean=6.0699, std=7.8205
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.088, 'auc': 0.5238960000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4308, std=5.6279
[DEBUG][MIA] Test Set Loss:   mean=5.9625, std=5.4007
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.14509803921568626, 'auc': 0.54608154296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.1979, std=6.4682
[DEBUG][MIA] Test Set Loss:   mean=5.4819, std=5.7367
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11600000000000002, 'auc': 0.47331200000000007, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.8476, std=4.5477
[DEBUG][MIA] Test Set Loss:   mean=5.0371, std=5.0049
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.11764705882352941, 'auc': 0.5758056640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.8963, std=5.1609
[DEBUG][MIA] Test Set Loss:   mean=5.4566, std=5.9118
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.092, 'auc': 0.512384, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.6270, std=7.9852
[DEBUG][MIA] Test Set Loss:   mean=6.5115, std=7.0815
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10588235294117647, 'auc': 0.57391357421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.8302, std=7.5268
[DEBUG][MIA] Test Set Loss:   mean=6.7267, std=8.1548
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.1, 'auc': 0.48188800000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7041, std=6.3965
[DEBUG][MIA] Test Set Loss:   mean=5.7125, std=6.3653
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.14901960784313725, 'auc': 0.5712890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.3825, std=8.0725
[DEBUG][MIA] Test Set Loss:   mean=5.4758, std=6.1484
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.084, 'auc': 0.496136, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0972, std=4.1696
[DEBUG][MIA] Test Set Loss:   mean=5.7985, std=5.5380
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.10588235294117647, 'auc': 0.58929443359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.2672, std=4.5903
[DEBUG][MIA] Test Set Loss:   mean=5.2496, std=5.1646
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.56448, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4866, std=5.6753
[DEBUG][MIA] Test Set Loss:   mean=5.6141, std=6.5872
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10196078431372549, 'auc': 0.6385498046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.8396, std=6.3837
[DEBUG][MIA] Test Set Loss:   mean=5.2953, std=5.8915
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.5496800000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5603, std=7.3860
[DEBUG][MIA] Test Set Loss:   mean=7.6887, std=7.9952
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.08235294117647059, 'auc': 0.54718017578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.0107, std=6.1390
[DEBUG][MIA] Test Set Loss:   mean=7.5272, std=7.9239
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.13, 'auc': 0.549952, 'task': 8}
Total correct retain:  650  Total retain:  2500
Total correct forget:  12386  Total forget:  47500
Total correct test:  119  Total test:  500
Total correct forget test:  2342  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.238, 0.244, 0.232, 0.304, 0.308, 0.292, 0.21, 0.342, 0.236, 0.222, 0.33, 0.2, 0.238, 0.196, 0.224, 0.194, 0.132, 0.32, 0.208, 0.252]
Unlearning task: 8
Accuracy, Confidence: (0.48046875, 0.7893834114074707)
broken out of loop
Accuracy, Confidence: (0.31640625, 0.9115984439849854)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.3689, std=9.2596
[DEBUG][MIA] Test Set Loss:   mean=8.9188, std=9.2533
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.08235294117647059, 'auc': 0.5341796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.1772, std=8.4431
[DEBUG][MIA] Test Set Loss:   mean=8.1821, std=8.5571
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11200000000000002, 'auc': 0.505648, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.0583, std=7.2122
[DEBUG][MIA] Test Set Loss:   mean=7.6165, std=6.8154
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.12549019607843137, 'auc': 0.55126953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.7052, std=7.0136
[DEBUG][MIA] Test Set Loss:   mean=7.0929, std=6.3162
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11000000000000001, 'auc': 0.477864, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.3419, std=7.2430
[DEBUG][MIA] Test Set Loss:   mean=7.2672, std=7.4279
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.08235294117647059, 'auc': 0.56549072265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.0511, std=7.2341
[DEBUG][MIA] Test Set Loss:   mean=7.4368, std=8.2591
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.096, 'auc': 0.49776000000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2839, std=6.6400
[DEBUG][MIA] Test Set Loss:   mean=4.9719, std=6.2278
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.10980392156862746, 'auc': 0.50762939453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.0488, std=5.2705
[DEBUG][MIA] Test Set Loss:   mean=5.4188, std=6.3763
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11600000000000002, 'auc': 0.497736, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7325, std=8.0944
[DEBUG][MIA] Test Set Loss:   mean=7.5976, std=8.4571
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.5477294921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.8065, std=8.7078
[DEBUG][MIA] Test Set Loss:   mean=8.7140, std=9.4405
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.132, 'auc': 0.4721120000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.0708, std=8.1240
[DEBUG][MIA] Test Set Loss:   mean=8.1837, std=9.3218
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.08627450980392157, 'auc': 0.533935546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.0859, std=8.3578
[DEBUG][MIA] Test Set Loss:   mean=9.0471, std=9.1715
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.092, 'auc': 0.474928, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.2445, std=12.4951
[DEBUG][MIA] Test Set Loss:   mean=12.7749, std=14.6885
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.09803921568627451, 'auc': 0.5390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.0687, std=13.7444
[DEBUG][MIA] Test Set Loss:   mean=12.0763, std=12.9946
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.514712, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.4084, std=8.7860
[DEBUG][MIA] Test Set Loss:   mean=9.3037, std=9.5466
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4453125, 'cv_acc': 0.09803921568627451, 'auc': 0.43194580078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0460, std=6.4468
[DEBUG][MIA] Test Set Loss:   mean=9.1184, std=8.9909
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.122, 'auc': 0.558432, 'task': 8}
Total correct retain:  537  Total retain:  2500
Total correct forget:  11028  Total forget:  47500
Total correct test:  100  Total test:  500
Total correct forget test:  2149  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.2, 0.162, 0.202, 0.23, 0.298, 0.214, 0.178, 0.244, 0.194, 0.188, 0.324, 0.214, 0.25, 0.2, 0.202, 0.25, 0.238, 0.314, 0.216, 0.18]
Unlearning task: 7
Accuracy, Confidence: (0.2578125, 0.8333154320716858)
broken out of loop
Accuracy, Confidence: (0.2578125, 0.8307026028633118)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.8224, std=8.3545
[DEBUG][MIA] Test Set Loss:   mean=8.3697, std=8.1673
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09411764705882353, 'auc': 0.465576171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.7153, std=9.0825
[DEBUG][MIA] Test Set Loss:   mean=9.4012, std=9.1806
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.535056, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.7414, std=6.5222
[DEBUG][MIA] Test Set Loss:   mean=6.4658, std=5.4764
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.13725490196078433, 'auc': 0.506988525390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.2383, std=7.1210
[DEBUG][MIA] Test Set Loss:   mean=7.1326, std=6.2310
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.088, 'auc': 0.5096, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.6112, std=7.3673
[DEBUG][MIA] Test Set Loss:   mean=7.3566, std=8.6202
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.13725490196078433, 'auc': 0.5185546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.6830, std=6.4538
[DEBUG][MIA] Test Set Loss:   mean=7.0916, std=7.1370
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.092, 'auc': 0.5121439999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3560, std=6.5684
[DEBUG][MIA] Test Set Loss:   mean=4.7066, std=5.5243
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.10588235294117647, 'auc': 0.511077880859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.0687, std=6.1399
[DEBUG][MIA] Test Set Loss:   mean=5.8634, std=5.9460
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.458, 'cv_acc': 0.1, 'auc': 0.44755999999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7698, std=8.5098
[DEBUG][MIA] Test Set Loss:   mean=7.9448, std=8.8434
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.16470588235294117, 'auc': 0.5650634765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.9357, std=9.1976
[DEBUG][MIA] Test Set Loss:   mean=7.5491, std=8.7459
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11200000000000002, 'auc': 0.497656, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9025, std=8.8053
[DEBUG][MIA] Test Set Loss:   mean=8.6624, std=9.2765
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09019607843137255, 'auc': 0.5411376953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.0062, std=8.9983
[DEBUG][MIA] Test Set Loss:   mean=8.2781, std=8.0887
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10200000000000001, 'auc': 0.49462400000000006, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.0799, std=12.4098
[DEBUG][MIA] Test Set Loss:   mean=11.2599, std=12.8078
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11372549019607843, 'auc': 0.502655029296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.5739, std=12.6416
[DEBUG][MIA] Test Set Loss:   mean=11.6468, std=14.1587
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.092, 'auc': 0.513248, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9927, std=8.5489
[DEBUG][MIA] Test Set Loss:   mean=8.5093, std=7.6141
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.0784313725490196, 'auc': 0.53656005859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7411, std=6.8212
[DEBUG][MIA] Test Set Loss:   mean=7.8925, std=8.2564
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10600000000000001, 'auc': 0.534944, 'task': 8}
Total correct retain:  542  Total retain:  2500
Total correct forget:  10989  Total forget:  47500
Total correct test:  104  Total test:  500
Total correct forget test:  2145  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.208, 0.164, 0.206, 0.236, 0.29, 0.214, 0.178, 0.246, 0.194, 0.192, 0.326, 0.214, 0.248, 0.206, 0.202, 0.242, 0.228, 0.312, 0.21, 0.182]
Unlearning task: 6
Accuracy, Confidence: (0.296875, 0.8533940315246582)
broken out of loop
Accuracy, Confidence: (0.29296875, 0.8524429798126221)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.3102, std=9.5621
[DEBUG][MIA] Test Set Loss:   mean=7.6373, std=7.6189
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.13333333333333336, 'auc': 0.4705810546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.3762, std=8.3599
[DEBUG][MIA] Test Set Loss:   mean=9.3155, std=8.5461
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.537712, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.6296, std=6.6268
[DEBUG][MIA] Test Set Loss:   mean=6.4784, std=5.2332
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09803921568627451, 'auc': 0.51385498046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.8581, std=7.1591
[DEBUG][MIA] Test Set Loss:   mean=7.2433, std=6.9886
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.527424, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.4797, std=7.4337
[DEBUG][MIA] Test Set Loss:   mean=6.7577, std=7.3244
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10196078431372549, 'auc': 0.5262451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.5400, std=6.7110
[DEBUG][MIA] Test Set Loss:   mean=7.2835, std=7.5898
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.51808, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.4112, std=6.3143
[DEBUG][MIA] Test Set Loss:   mean=4.8648, std=5.8258
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10588235294117647, 'auc': 0.4920654296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3084, std=5.4937
[DEBUG][MIA] Test Set Loss:   mean=5.4466, std=6.1737
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.088, 'auc': 0.498864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4080, std=8.4301
[DEBUG][MIA] Test Set Loss:   mean=7.5311, std=8.1491
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.12156862745098038, 'auc': 0.5504150390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.7252, std=9.5626
[DEBUG][MIA] Test Set Loss:   mean=7.1681, std=8.1458
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.096, 'auc': 0.47400000000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7445, std=8.6103
[DEBUG][MIA] Test Set Loss:   mean=8.3573, std=8.6013
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10588235294117647, 'auc': 0.45623779296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.6994, std=8.2903
[DEBUG][MIA] Test Set Loss:   mean=8.2671, std=7.9340
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10800000000000001, 'auc': 0.48855200000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.2867, std=13.2266
[DEBUG][MIA] Test Set Loss:   mean=11.7963, std=12.3451
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10196078431372549, 'auc': 0.536376953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.3451, std=13.5229
[DEBUG][MIA] Test Set Loss:   mean=12.1501, std=14.0523
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12600000000000003, 'auc': 0.539688, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.3893, std=8.8185
[DEBUG][MIA] Test Set Loss:   mean=8.1781, std=7.5910
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10980392156862746, 'auc': 0.56689453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.1304, std=6.7556
[DEBUG][MIA] Test Set Loss:   mean=8.0811, std=8.0059
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.520896, 'task': 8}
Total correct retain:  545  Total retain:  2500
Total correct forget:  11024  Total forget:  47500
Total correct test:  104  Total test:  500
Total correct forget test:  2142  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.208, 0.172, 0.208, 0.238, 0.286, 0.214, 0.184, 0.244, 0.196, 0.188, 0.326, 0.214, 0.252, 0.198, 0.206, 0.236, 0.224, 0.314, 0.208, 0.176]
Unlearning task: 5
Accuracy, Confidence: (0.3671875, 0.8774054050445557)
broken out of loop
Accuracy, Confidence: (0.37109375, 0.87851482629776)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.5256, std=8.0511
[DEBUG][MIA] Test Set Loss:   mean=8.2584, std=8.4111
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.08627450980392157, 'auc': 0.53155517578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.1915, std=7.4395
[DEBUG][MIA] Test Set Loss:   mean=8.4058, std=8.3154
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11200000000000002, 'auc': 0.54056, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.4715, std=5.9874
[DEBUG][MIA] Test Set Loss:   mean=6.7363, std=6.4702
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10196078431372549, 'auc': 0.5135498046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.3932, std=6.6701
[DEBUG][MIA] Test Set Loss:   mean=7.1126, std=6.3567
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10600000000000001, 'auc': 0.4909279999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1686, std=8.0642
[DEBUG][MIA] Test Set Loss:   mean=6.7985, std=8.0013
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.17254901960784313, 'auc': 0.50238037109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.9113, std=7.6768
[DEBUG][MIA] Test Set Loss:   mean=6.8785, std=7.5539
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.1, 'auc': 0.5009920000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.1330, std=6.4887
[DEBUG][MIA] Test Set Loss:   mean=5.2196, std=5.8066
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.13725490196078433, 'auc': 0.533355712890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7096, std=6.1004
[DEBUG][MIA] Test Set Loss:   mean=5.5703, std=5.8650
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.501968, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.9153, std=8.9257
[DEBUG][MIA] Test Set Loss:   mean=6.5532, std=7.5229
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.14509803921568626, 'auc': 0.523529052734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.6123, std=8.3359
[DEBUG][MIA] Test Set Loss:   mean=8.2302, std=8.8946
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.48122399999999993, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6453, std=7.9711
[DEBUG][MIA] Test Set Loss:   mean=7.6006, std=8.0372
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.12941176470588234, 'auc': 0.503662109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.2795, std=8.0301
[DEBUG][MIA] Test Set Loss:   mean=7.4990, std=7.6699
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.086, 'auc': 0.474464, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.5519, std=13.0031
[DEBUG][MIA] Test Set Loss:   mean=10.9985, std=12.6045
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10588235294117647, 'auc': 0.507843017578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.9408, std=13.5684
[DEBUG][MIA] Test Set Loss:   mean=13.7338, std=13.7668
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.5449120000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2168, std=8.2873
[DEBUG][MIA] Test Set Loss:   mean=7.7315, std=8.1232
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09019607843137253, 'auc': 0.52960205078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.8314, std=7.4412
[DEBUG][MIA] Test Set Loss:   mean=8.3620, std=8.4945
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.504384, 'task': 8}
Total correct retain:  548  Total retain:  2500
Total correct forget:  11045  Total forget:  47500
Total correct test:  105  Total test:  500
Total correct forget test:  2137  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.21, 0.17, 0.2, 0.24, 0.274, 0.216, 0.182, 0.246, 0.202, 0.192, 0.328, 0.216, 0.252, 0.198, 0.204, 0.24, 0.218, 0.308, 0.206, 0.182]
Unlearning task: 4
Accuracy, Confidence: (0.3359375, 0.8149496912956238)
broken out of loop
Accuracy, Confidence: (0.328125, 0.8157124519348145)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.9498, std=8.8525
[DEBUG][MIA] Test Set Loss:   mean=7.1578, std=7.6649
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.4951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.5923, std=7.2513
[DEBUG][MIA] Test Set Loss:   mean=8.3174, std=8.4535
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10400000000000001, 'auc': 0.521496, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.4847, std=7.1706
[DEBUG][MIA] Test Set Loss:   mean=7.4987, std=7.0513
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.21960784313725493, 'auc': 0.51556396484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.5984, std=6.2906
[DEBUG][MIA] Test Set Loss:   mean=7.2594, std=6.8185
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.5232800000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.8430, std=7.3526
[DEBUG][MIA] Test Set Loss:   mean=7.1482, std=7.9091
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10196078431372549, 'auc': 0.506591796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.9601, std=7.0614
[DEBUG][MIA] Test Set Loss:   mean=6.6961, std=7.2013
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11400000000000002, 'auc': 0.49108799999999997, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.8271, std=7.2701
[DEBUG][MIA] Test Set Loss:   mean=4.7468, std=5.4334
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.489471435546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2339, std=5.9686
[DEBUG][MIA] Test Set Loss:   mean=5.6858, std=6.2843
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.078, 'auc': 0.48698400000000003, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.6522, std=7.9606
[DEBUG][MIA] Test Set Loss:   mean=7.3562, std=7.4240
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.55523681640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.5189, std=8.3252
[DEBUG][MIA] Test Set Loss:   mean=7.4640, std=7.9935
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10200000000000001, 'auc': 0.48832000000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.5735, std=8.0940
[DEBUG][MIA] Test Set Loss:   mean=7.5139, std=7.1982
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10588235294117647, 'auc': 0.52349853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8014, std=8.0336
[DEBUG][MIA] Test Set Loss:   mean=7.7605, std=7.7926
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10600000000000001, 'auc': 0.50308, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.0237, std=12.5573
[DEBUG][MIA] Test Set Loss:   mean=12.6134, std=14.2900
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10588235294117647, 'auc': 0.53851318359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.8737, std=13.3243
[DEBUG][MIA] Test Set Loss:   mean=12.8124, std=13.3085
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.434, 'cv_acc': 0.10400000000000001, 'auc': 0.448824, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.0668, std=9.2298
[DEBUG][MIA] Test Set Loss:   mean=7.0483, std=8.3792
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.15686274509803919, 'auc': 0.47174072265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.8211, std=7.0370
[DEBUG][MIA] Test Set Loss:   mean=9.1572, std=9.2738
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.444, 'cv_acc': 0.098, 'auc': 0.42953600000000003, 'task': 8}
Total correct retain:  551  Total retain:  2500
Total correct forget:  11066  Total forget:  47500
Total correct test:  107  Total test:  500
Total correct forget test:  2143  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.214, 0.17, 0.202, 0.244, 0.276, 0.218, 0.19, 0.244, 0.206, 0.194, 0.33, 0.216, 0.25, 0.196, 0.208, 0.248, 0.206, 0.306, 0.206, 0.176]
Unlearning task: 3
Accuracy, Confidence: (0.25, 0.9027789831161499)
broken out of loop
Accuracy, Confidence: (0.24609375, 0.8995276689529419)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.8245, std=8.1771
[DEBUG][MIA] Test Set Loss:   mean=8.0629, std=8.0986
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.1411764705882353, 'auc': 0.51995849609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.5479, std=7.7192
[DEBUG][MIA] Test Set Loss:   mean=7.6353, std=6.9091
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.094, 'auc': 0.517232, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.3004, std=6.5793
[DEBUG][MIA] Test Set Loss:   mean=6.5085, std=5.8035
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.08627450980392157, 'auc': 0.53375244140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.8984, std=6.5533
[DEBUG][MIA] Test Set Loss:   mean=7.6418, std=6.8664
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.13, 'auc': 0.47076799999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1349, std=7.1718
[DEBUG][MIA] Test Set Loss:   mean=7.2312, std=7.2599
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.12156862745098038, 'auc': 0.5640869140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.9284, std=6.9019
[DEBUG][MIA] Test Set Loss:   mean=6.8592, std=7.0801
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10400000000000001, 'auc': 0.49128000000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.1651, std=6.7268
[DEBUG][MIA] Test Set Loss:   mean=5.7238, std=5.7152
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09803921568627451, 'auc': 0.56732177734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.6099, std=5.8378
[DEBUG][MIA] Test Set Loss:   mean=5.9864, std=6.2850
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10600000000000001, 'auc': 0.4835759999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.1074, std=8.1017
[DEBUG][MIA] Test Set Loss:   mean=6.5109, std=7.0726
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.11372549019607844, 'auc': 0.55206298828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.8059, std=8.1829
[DEBUG][MIA] Test Set Loss:   mean=7.6706, std=8.2703
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.094, 'auc': 0.5489759999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.5192, std=7.6084
[DEBUG][MIA] Test Set Loss:   mean=7.7023, std=7.6183
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09019607843137255, 'auc': 0.42974853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.4825, std=7.5700
[DEBUG][MIA] Test Set Loss:   mean=8.1433, std=8.1845
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.531536, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.0920, std=13.1506
[DEBUG][MIA] Test Set Loss:   mean=12.2425, std=12.7658
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.12156862745098038, 'auc': 0.541015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.3444, std=12.6908
[DEBUG][MIA] Test Set Loss:   mean=11.9639, std=13.6837
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.5342800000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9980, std=9.1736
[DEBUG][MIA] Test Set Loss:   mean=8.7106, std=9.0774
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.52679443359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.8721, std=7.3015
[DEBUG][MIA] Test Set Loss:   mean=7.9452, std=8.4158
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.118, 'auc': 0.5396240000000001, 'task': 8}
Total correct retain:  554  Total retain:  2500
Total correct forget:  11055  Total forget:  47500
Total correct test:  103  Total test:  500
Total correct forget test:  2138  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.206, 0.172, 0.202, 0.238, 0.272, 0.212, 0.188, 0.24, 0.202, 0.196, 0.324, 0.214, 0.25, 0.198, 0.206, 0.252, 0.208, 0.312, 0.208, 0.182]
Unlearning task: 2
Accuracy, Confidence: (0.23046875, 0.8826597332954407)
broken out of loop
Accuracy, Confidence: (0.234375, 0.8825348615646362)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 6, 8, 8, 7, 9, 9, 5, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.1314, std=7.5614
[DEBUG][MIA] Test Set Loss:   mean=9.9107, std=10.1873
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09411764705882353, 'auc': 0.41876220703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 6 5 6 8 9 9 7 9 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 9 6 5 9 7 6 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.6863, std=7.9517
[DEBUG][MIA] Test Set Loss:   mean=8.3378, std=8.4513
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.086, 'auc': 0.525568, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 10, 14, 10, 14, 13, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8207, std=5.3585
[DEBUG][MIA] Test Set Loss:   mean=6.4170, std=5.1771
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09803921568627451, 'auc': 0.5445556640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 14 10 14 11 11 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 14 14 14 12 10 12 14 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.8540, std=7.0502
[DEBUG][MIA] Test Set Loss:   mean=6.9045, std=6.8022
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.547264, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 15, 16, 15, 18, 15, 18, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.6747, std=6.3249
[DEBUG][MIA] Test Set Loss:   mean=7.3539, std=7.8056
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.41998291015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 16 16 19 15 19 15 18 15 15]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 16 19 19 17 17 16 19 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.7618, std=6.7649
[DEBUG][MIA] Test Set Loss:   mean=7.4065, std=7.6816
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.1, 'auc': 0.489328, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 20, 20, 23, 23, 24, 20, 21, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3292, std=6.3906
[DEBUG][MIA] Test Set Loss:   mean=6.2171, std=6.9198
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10196078431372549, 'auc': 0.55242919921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 23 20 22 23 20 23 20 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 24 21 24 20 21 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7726, std=5.9110
[DEBUG][MIA] Test Set Loss:   mean=4.9939, std=5.7547
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.092, 'auc': 0.548096, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 29, 26, 25, 25, 25, 29, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.1715, std=8.4015
[DEBUG][MIA] Test Set Loss:   mean=7.2016, std=8.6321
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10980392156862744, 'auc': 0.501251220703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 28 25 25 26 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 28 27 27 28 26 25 25 28 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.4590, std=9.5113
[DEBUG][MIA] Test Set Loss:   mean=7.7255, std=8.1695
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.495904, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 32, 34, 30, 34, 33, 34, 34, 32, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.3702, std=8.0261
[DEBUG][MIA] Test Set Loss:   mean=8.3333, std=8.0458
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09411764705882353, 'auc': 0.4571533203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 32 34 33 30 30 32 33 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 32 34 34 30 34 31 30 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.0765, std=8.1228
[DEBUG][MIA] Test Set Loss:   mean=8.4458, std=7.8500
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.094, 'auc': 0.47988, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 36, 36, 38, 38, 39, 35, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.5105, std=11.9077
[DEBUG][MIA] Test Set Loss:   mean=13.4917, std=13.3960
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.10980392156862746, 'auc': 0.58807373046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 38 38 39 39 35 35 36 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 37 38 36 35 36 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.4476, std=12.7685
[DEBUG][MIA] Test Set Loss:   mean=12.3264, std=12.7744
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.094, 'auc': 0.553512, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 40, 44, 43, 43, 41, 43, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7889, std=7.4313
[DEBUG][MIA] Test Set Loss:   mean=8.5526, std=7.9303
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.08235294117647059, 'auc': 0.42913818359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 42 42 43 40 40 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 40 44 43 40 40 42 42 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0269, std=7.6833
[DEBUG][MIA] Test Set Loss:   mean=7.7116, std=8.0465
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.13800000000000004, 'auc': 0.5227839999999999, 'task': 8}
Total correct retain:  554  Total retain:  2500
Total correct forget:  11056  Total forget:  47500
Total correct test:  102  Total test:  500
Total correct forget test:  2137  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.204, 0.17, 0.2, 0.24, 0.276, 0.212, 0.188, 0.24, 0.2, 0.2, 0.326, 0.214, 0.252, 0.2, 0.206, 0.254, 0.204, 0.312, 0.208, 0.172]
Command line arguments:
number_of_gpus: 1
algorithm: RL-GEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 20
unlearn_mem_strength: 0.5
unlearn_batch_size: 10
average_over_n_runs: 3
salun: 0
salun_strength: 0.2
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 01:32:09 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 41%   69C    P0             50W /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['oak', 'spider', 'raccoon', 'turtle', 'mushrooms', 'lion', 'rabbit', 'sea', 'train', 'willow', 'whale', 'dolphin', 'maple', 'baby', 'road', 'snake', 'caterpillar', 'bottles', 'beetle', 'woman', 'boy', 'bear', 'cockroach', 'leopard', 'chimpanzee', 'skyscraper', 'plates', 'bee', 'squirrel', 'castle', 'trout', 'pears', 'snail', 'pine', 'plain', 'telephone', 'porcupine', 'table', 'worm', 'man', 'bowls', 'orchids', 'mountain', 'crocodile', 'skunk', 'tractor', 'aquarium fish', 'lizard', 'dinosaur', 'tank', 'bed', 'couch', 'pickup truck', 'bicycle', 'mouse', 'seal', 'shrew', 'kangaroo', 'ray', 'wolf', 'cloud', 'crab', 'sweet peppers', 'cans', 'possum', 'bridge', 'computer keyboard', 'oranges', 'poppies', 'rocket', 'television', 'roses', 'cattle', 'butterfly', 'shark', 'bus', 'tulips', 'otter', 'elephant', 'apples', 'forest', 'cups', 'tiger', 'lobster', 'streetcar', 'house', 'girl', 'lamp', 'beaver', 'fox', 'wardrobe', 'sunflowers', 'lawn-mower', 'hamster', 'flatfish', 'motorcycle', 'palm', 'clock', 'camel', 'chair']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2265  Total retain:  2500
Total correct forget:  9178  Total forget:  47500
Total correct test:  345  Total test:  500
Total correct forget test:  1798  Total test forget:  9500
After learning task 1
Task accuracies: [0.69, 0.222, 0.138, 0.174, 0.128, 0.208, 0.17, 0.136, 0.196, 0.246, 0.154, 0.198, 0.228, 0.234, 0.07, 0.17, 0.23, 0.242, 0.262, 0.19]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0296
[DEBUG][MIA] Test Set Loss:   mean=0.8795, std=2.4847
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.23137254901960785, 'auc': 0.65948486328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0308, std=0.3982
[DEBUG][MIA] Test Set Loss:   mean=0.7477, std=1.7737
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.21600000000000003, 'auc': 0.661672, 'task': 1}
2 1
Total correct retain:  1860  Total retain:  2500
Total correct forget:  11400  Total forget:  47500
Total correct test:  335  Total test:  500
Total correct forget test:  2190  Total test forget:  9500
After learning task 2
Task accuracies: [0.67, 0.804, 0.144, 0.104, 0.194, 0.214, 0.174, 0.138, 0.214, 0.206, 0.182, 0.158, 0.248, 0.232, 0.16, 0.174, 0.28, 0.228, 0.264, 0.262]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=0.7013, std=1.6605
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.24705882352941172, 'auc': 0.76953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1279, std=0.5099
[DEBUG][MIA] Test Set Loss:   mean=0.8023, std=2.0961
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.202, 'auc': 0.6443360000000001, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0154
[DEBUG][MIA] Test Set Loss:   mean=0.4147, std=1.2234
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.1843137254901961, 'auc': 0.66558837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0046, std=0.0325
[DEBUG][MIA] Test Set Loss:   mean=0.5618, std=1.7380
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.182, 'auc': 0.667544, 'task': 2}
3 2
Total correct retain:  1790  Total retain:  2500
Total correct forget:  13067  Total forget:  47500
Total correct test:  310  Total test:  500
Total correct forget test:  2455  Total test forget:  9500
After learning task 3
Task accuracies: [0.62, 0.79, 0.862, 0.142, 0.236, 0.202, 0.152, 0.128, 0.224, 0.236, 0.196, 0.12, 0.268, 0.13, 0.178, 0.176, 0.214, 0.208, 0.216, 0.232]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0100
[DEBUG][MIA] Test Set Loss:   mean=0.9419, std=1.8328
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2980392156862745, 'auc': 0.696502685546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6568, std=1.4596
[DEBUG][MIA] Test Set Loss:   mean=1.2697, std=2.1965
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.132, 'auc': 0.568136, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0098
[DEBUG][MIA] Test Set Loss:   mean=0.5501, std=1.2530
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.27450980392156865, 'auc': 0.6844482421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4760, std=1.3046
[DEBUG][MIA] Test Set Loss:   mean=0.8946, std=1.8575
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.098, 'auc': 0.590952, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0208, std=0.1475
[DEBUG][MIA] Test Set Loss:   mean=1.2608, std=2.6316
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2784313725490196, 'auc': 0.776092529296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0228
[DEBUG][MIA] Test Set Loss:   mean=1.6003, std=2.8343
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.71, 'cv_acc': 0.274, 'auc': 0.8202639999999999, 'task': 3}
4 3
Total correct retain:  1708  Total retain:  2500
Total correct forget:  14469  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  2595  Total test forget:  9500
After learning task 4
Task accuracies: [0.63, 0.696, 0.796, 0.672, 0.202, 0.22, 0.136, 0.124, 0.21, 0.228, 0.148, 0.184, 0.252, 0.114, 0.186, 0.144, 0.246, 0.22, 0.176, 0.236]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0176, std=0.0569
[DEBUG][MIA] Test Set Loss:   mean=1.3124, std=1.9816
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7176470588235294, 'auc': 0.765716552734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0088, std=2.0032
[DEBUG][MIA] Test Set Loss:   mean=1.3344, std=2.2421
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.12000000000000002, 'auc': 0.5412159999999999, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0229
[DEBUG][MIA] Test Set Loss:   mean=0.5786, std=1.5723
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.23921568627450984, 'auc': 0.70184326171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6137, std=1.6236
[DEBUG][MIA] Test Set Loss:   mean=0.7969, std=1.7516
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.096, 'auc': 0.5614, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=1.6352, std=2.5941
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7058823529411765, 'auc': 0.814422607421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3367, std=1.0405
[DEBUG][MIA] Test Set Loss:   mean=1.5914, std=2.6152
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.632, 'cv_acc': 0.244, 'auc': 0.67648, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0079
[DEBUG][MIA] Test Set Loss:   mean=1.0922, std=2.6183
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2823529411764706, 'auc': 0.667877197265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0530
[DEBUG][MIA] Test Set Loss:   mean=1.0470, std=2.2780
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.664, 'cv_acc': 0.274, 'auc': 0.6943600000000001, 'task': 4}
5 4
Total correct retain:  1646  Total retain:  2500
Total correct forget:  15943  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  2872  Total test forget:  9500
After learning task 5
Task accuracies: [0.6, 0.644, 0.816, 0.612, 0.73, 0.214, 0.198, 0.138, 0.218, 0.246, 0.16, 0.192, 0.242, 0.15, 0.136, 0.172, 0.21, 0.218, 0.194, 0.254]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.4287, std=2.4241
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.2588235294117647, 'auc': 0.853912353515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9325, std=1.9013
[DEBUG][MIA] Test Set Loss:   mean=0.9967, std=2.0847
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.144, 'auc': 0.52032, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=0.9399, std=2.0343
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.23137254901960783, 'auc': 0.79052734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4789, std=1.2344
[DEBUG][MIA] Test Set Loss:   mean=0.8194, std=1.8296
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10200000000000001, 'auc': 0.5494400000000002, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0123
[DEBUG][MIA] Test Set Loss:   mean=2.1851, std=3.1056
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7137254901960784, 'auc': 0.831512451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8778, std=1.9250
[DEBUG][MIA] Test Set Loss:   mean=1.7457, std=2.9653
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.26399999999999996, 'auc': 0.608824, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0062
[DEBUG][MIA] Test Set Loss:   mean=1.4951, std=2.5414
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2705882352941177, 'auc': 0.79681396484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1423, std=0.5215
[DEBUG][MIA] Test Set Loss:   mean=1.5725, std=2.8016
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.258, 'auc': 0.679448, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0075, std=0.0662
[DEBUG][MIA] Test Set Loss:   mean=0.6994, std=1.8975
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.21960784313725493, 'auc': 0.637969970703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0117
[DEBUG][MIA] Test Set Loss:   mean=0.5674, std=1.6066
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.22599999999999998, 'auc': 0.6743840000000001, 'task': 5}
6 5
Total correct retain:  1700  Total retain:  2500
Total correct forget:  17450  Total forget:  47500
Total correct test:  317  Total test:  500
Total correct forget test:  3137  Total test forget:  9500
After learning task 6
Task accuracies: [0.634, 0.706, 0.798, 0.6, 0.66, 0.824, 0.188, 0.148, 0.204, 0.22, 0.15, 0.212, 0.2, 0.226, 0.114, 0.18, 0.222, 0.21, 0.144, 0.268]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.0865, std=2.1681
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.27450980392156865, 'auc': 0.756744384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7123, std=1.4897
[DEBUG][MIA] Test Set Loss:   mean=0.9695, std=1.9611
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.148, 'auc': 0.522248, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=0.9639, std=2.0407
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2235294117647059, 'auc': 0.78460693359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5612, std=1.6057
[DEBUG][MIA] Test Set Loss:   mean=0.8803, std=2.0445
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10400000000000001, 'auc': 0.569296, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0090, std=0.0287
[DEBUG][MIA] Test Set Loss:   mean=2.2589, std=2.9502
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7254901960784313, 'auc': 0.852325439453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8597, std=1.7564
[DEBUG][MIA] Test Set Loss:   mean=1.9254, std=3.0058
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.24, 'auc': 0.6258720000000001, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0070, std=0.0195
[DEBUG][MIA] Test Set Loss:   mean=2.1419, std=3.2953
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6901960784313725, 'auc': 0.808074951171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4812, std=1.1512
[DEBUG][MIA] Test Set Loss:   mean=1.9231, std=3.1501
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.2, 'auc': 0.648496, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=0.7642, std=1.8274
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2431372549019608, 'auc': 0.7310791015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1564, std=0.6602
[DEBUG][MIA] Test Set Loss:   mean=0.6175, std=1.6957
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.22200000000000003, 'auc': 0.582744, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0184
[DEBUG][MIA] Test Set Loss:   mean=0.6252, std=1.6879
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.19607843137254902, 'auc': 0.609100341796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0101, std=0.0696
[DEBUG][MIA] Test Set Loss:   mean=0.7646, std=1.8866
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.64, 'cv_acc': 0.2, 'auc': 0.687064, 'task': 6}
7 6
Total correct retain:  1670  Total retain:  2500
Total correct forget:  19268  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3474  Total test forget:  9500
After learning task 7
Task accuracies: [0.606, 0.704, 0.784, 0.582, 0.646, 0.806, 0.828, 0.126, 0.228, 0.208, 0.15, 0.256, 0.198, 0.2, 0.112, 0.202, 0.216, 0.232, 0.204, 0.266]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0135
[DEBUG][MIA] Test Set Loss:   mean=1.2697, std=2.3002
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.5647058823529412, 'auc': 0.757232666015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9106, std=1.9292
[DEBUG][MIA] Test Set Loss:   mean=1.2145, std=2.2865
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.194, 'auc': 0.514144, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=0.8584, std=2.1955
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2549019607843137, 'auc': 0.767974853515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5927, std=1.5278
[DEBUG][MIA] Test Set Loss:   mean=0.9439, std=2.1910
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11200000000000002, 'auc': 0.53764, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0073
[DEBUG][MIA] Test Set Loss:   mean=1.4848, std=2.4232
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7372549019607844, 'auc': 0.85546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9412, std=2.0435
[DEBUG][MIA] Test Set Loss:   mean=1.5227, std=2.4947
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.20600000000000002, 'auc': 0.609024, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.8145, std=3.1741
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7411764705882353, 'auc': 0.866455078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7079, std=1.4997
[DEBUG][MIA] Test Set Loss:   mean=1.7471, std=2.9068
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.192, 'auc': 0.6399440000000002, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=1.0863, std=2.3170
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2549019607843137, 'auc': 0.78521728515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3936, std=1.1675
[DEBUG][MIA] Test Set Loss:   mean=0.9797, std=2.2733
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.184, 'auc': 0.576416, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=0.7373, std=1.5216
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2823529411764706, 'auc': 0.6724853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3424, std=1.0496
[DEBUG][MIA] Test Set Loss:   mean=0.8319, std=1.7468
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.14, 'auc': 0.5538160000000001, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0116
[DEBUG][MIA] Test Set Loss:   mean=1.2505, std=2.2172
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.25098039215686274, 'auc': 0.7540283203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0100
[DEBUG][MIA] Test Set Loss:   mean=1.1683, std=2.2712
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.708, 'cv_acc': 0.262, 'auc': 0.7761279999999999, 'task': 7}
8 7
Total correct retain:  1709  Total retain:  2500
Total correct forget:  20663  Total forget:  47500
Total correct test:  318  Total test:  500
Total correct forget test:  3676  Total test forget:  9500
After learning task 8
Task accuracies: [0.636, 0.67, 0.788, 0.592, 0.602, 0.766, 0.77, 0.744, 0.228, 0.216, 0.168, 0.226, 0.162, 0.242, 0.16, 0.192, 0.224, 0.198, 0.138, 0.266]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.4827, std=2.8904
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2901960784313725, 'auc': 0.741729736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1845, std=2.4817
[DEBUG][MIA] Test Set Loss:   mean=1.7318, std=3.0530
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.09, 'auc': 0.567712, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=0.9940, std=1.8257
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2156862745098039, 'auc': 0.811798095703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5430, std=1.6674
[DEBUG][MIA] Test Set Loss:   mean=0.7584, std=1.7976
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.098, 'auc': 0.555768, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0177
[DEBUG][MIA] Test Set Loss:   mean=2.3833, std=3.3361
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7490196078431373, 'auc': 0.817657470703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4415, std=2.7133
[DEBUG][MIA] Test Set Loss:   mean=2.0258, std=3.1016
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.192, 'auc': 0.561032, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.9554, std=3.4485
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7490196078431373, 'auc': 0.8314208984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7580, std=1.7542
[DEBUG][MIA] Test Set Loss:   mean=1.7325, std=2.8243
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.184, 'auc': 0.617256, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.8714, std=1.7996
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.27450980392156865, 'auc': 0.813262939453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4777, std=1.2325
[DEBUG][MIA] Test Set Loss:   mean=1.0355, std=2.4072
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.156, 'auc': 0.5740959999999999, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=0.8118, std=1.6622
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.29411764705882354, 'auc': 0.73785400390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3651, std=1.0605
[DEBUG][MIA] Test Set Loss:   mean=1.0793, std=2.2324
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13600000000000004, 'auc': 0.58492, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.0953, std=2.1071
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.3137254901960784, 'auc': 0.824859619140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1037, std=0.4554
[DEBUG][MIA] Test Set Loss:   mean=1.2856, std=2.3215
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.24400000000000005, 'auc': 0.7269840000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0223
[DEBUG][MIA] Test Set Loss:   mean=0.6013, std=1.7997
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.18039215686274507, 'auc': 0.621917724609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0344
[DEBUG][MIA] Test Set Loss:   mean=0.5391, std=1.7154
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.202, 'auc': 0.68272, 'task': 8}
Total correct retain:  1712  Total retain:  2500
Total correct forget:  22376  Total forget:  47500
Total correct test:  311  Total test:  500
Total correct forget test:  3972  Total test forget:  9500
After learning task 9
Task accuracies: [0.622, 0.69, 0.784, 0.572, 0.608, 0.756, 0.762, 0.694, 0.87, 0.21, 0.198, 0.206, 0.192, 0.212, 0.14, 0.136, 0.238, 0.21, 0.152, 0.314]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0054
[DEBUG][MIA] Test Set Loss:   mean=1.4375, std=2.5332
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7176470588235294, 'auc': 0.7548828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2463, std=2.6587
[DEBUG][MIA] Test Set Loss:   mean=1.4218, std=2.4938
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10600000000000001, 'auc': 0.5350079999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=0.8050, std=1.9006
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.23921568627450984, 'auc': 0.77117919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5983, std=1.6040
[DEBUG][MIA] Test Set Loss:   mean=0.9149, std=2.1174
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.092, 'auc': 0.543016, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0095, std=0.0682
[DEBUG][MIA] Test Set Loss:   mean=2.2925, std=3.6024
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7294117647058824, 'auc': 0.842132568359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4140, std=2.6562
[DEBUG][MIA] Test Set Loss:   mean=2.5509, std=3.5304
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.418, 'cv_acc': 0.098, 'auc': 0.414464, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.7454, std=3.1227
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7215686274509803, 'auc': 0.82818603515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8879, std=1.8500
[DEBUG][MIA] Test Set Loss:   mean=1.7927, std=3.0459
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.142, 'auc': 0.5753119999999999, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.1842, std=2.5784
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.25098039215686274, 'auc': 0.7388916015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5653, std=1.5974
[DEBUG][MIA] Test Set Loss:   mean=0.8952, std=2.2455
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.158, 'auc': 0.558736, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.0487, std=2.1898
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.23529411764705882, 'auc': 0.692962646484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6244, std=1.5492
[DEBUG][MIA] Test Set Loss:   mean=1.0146, std=2.0459
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10200000000000001, 'auc': 0.5572720000000001, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.3875, std=2.2669
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2823529411764706, 'auc': 0.80657958984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2648, std=0.9682
[DEBUG][MIA] Test Set Loss:   mean=1.4709, std=2.4005
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.22800000000000004, 'auc': 0.692808, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=0.7565, std=1.6875
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25882352941176473, 'auc': 0.764678955078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0931, std=0.3794
[DEBUG][MIA] Test Set Loss:   mean=0.8701, std=2.1995
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.19, 'auc': 0.621048, 'task': 8}
Total correct retain:  1661  Total retain:  2500
Total correct forget:  23749  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  4225  Total test forget:  9500
After learning task 10
Task accuracies: [0.606, 0.648, 0.792, 0.574, 0.618, 0.778, 0.79, 0.664, 0.808, 0.812, 0.198, 0.204, 0.174, 0.32, 0.13, 0.138, 0.202, 0.218, 0.158, 0.224]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.5257, std=2.8883
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2941176470588235, 'auc': 0.760223388671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1906, std=2.2680
[DEBUG][MIA] Test Set Loss:   mean=1.5470, std=3.0668
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.092, 'auc': 0.5247440000000001, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.2601, std=2.9750
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.23137254901960783, 'auc': 0.763580322265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8207, std=2.0122
[DEBUG][MIA] Test Set Loss:   mean=0.8495, std=2.1140
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11000000000000001, 'auc': 0.5257120000000001, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0066, std=0.0304
[DEBUG][MIA] Test Set Loss:   mean=2.3627, std=3.3222
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7019607843137255, 'auc': 0.85980224609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4223, std=2.7980
[DEBUG][MIA] Test Set Loss:   mean=2.4554, std=3.8061
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.11400000000000002, 'auc': 0.58564, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.7257, std=3.0108
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7529411764705882, 'auc': 0.84417724609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0619, std=1.9353
[DEBUG][MIA] Test Set Loss:   mean=1.7263, std=2.7560
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.192, 'auc': 0.564768, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=0.9761, std=2.0609
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2627450980392157, 'auc': 0.78863525390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6847, std=1.7877
[DEBUG][MIA] Test Set Loss:   mean=1.2076, std=2.3651
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13199999999999998, 'auc': 0.5640080000000001, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=1.1734, std=2.3096
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2627450980392157, 'auc': 0.75067138671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6201, std=1.5040
[DEBUG][MIA] Test Set Loss:   mean=1.0272, std=2.0067
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.10600000000000001, 'auc': 0.599832, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.3559, std=2.1408
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7137254901960784, 'auc': 0.862457275390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5203, std=1.2107
[DEBUG][MIA] Test Set Loss:   mean=1.7122, std=2.6493
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.21800000000000003, 'auc': 0.658184, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.0836, std=2.2781
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2156862745098039, 'auc': 0.8447265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2591, std=1.0027
[DEBUG][MIA] Test Set Loss:   mean=0.9100, std=2.1173
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.176, 'auc': 0.612128, 'task': 8}
Total correct retain:  1643  Total retain:  2500
Total correct forget:  25333  Total forget:  47500
Total correct test:  301  Total test:  500
Total correct forget test:  4457  Total test forget:  9500
After learning task 11
Task accuracies: [0.602, 0.68, 0.792, 0.58, 0.578, 0.732, 0.754, 0.63, 0.768, 0.734, 0.784, 0.24, 0.168, 0.348, 0.138, 0.142, 0.246, 0.21, 0.144, 0.246]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9981306195259094)
broken out of loop
Accuracy, Confidence: (0.20703125, 0.9998347759246826)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=55.4933, std=46.9194
[DEBUG][MIA] Test Set Loss:   mean=58.8160, std=49.2781
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10588235294117647, 'auc': 0.47833251953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=61.2710, std=52.2786
[DEBUG][MIA] Test Set Loss:   mean=58.1351, std=49.1283
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.086, 'auc': 0.512256, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=63.5723, std=43.6004
[DEBUG][MIA] Test Set Loss:   mean=56.7006, std=50.0248
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09803921568627451, 'auc': 0.55364990234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=60.4031, std=43.7989
[DEBUG][MIA] Test Set Loss:   mean=56.5238, std=40.7223
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.525568, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=107.5703, std=106.7647
[DEBUG][MIA] Test Set Loss:   mean=108.6313, std=97.8960
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.0784313725490196, 'auc': 0.513885498046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=102.1370, std=102.4162
[DEBUG][MIA] Test Set Loss:   mean=105.8179, std=102.9711
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.092, 'auc': 0.493104, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=83.1586, std=79.2795
[DEBUG][MIA] Test Set Loss:   mean=69.7778, std=66.5460
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.05490196078431373, 'auc': 0.532196044921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=75.4228, std=72.0044
[DEBUG][MIA] Test Set Loss:   mean=70.8547, std=71.4745
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11200000000000002, 'auc': 0.478456, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=112.4942, std=87.5931
[DEBUG][MIA] Test Set Loss:   mean=113.3274, std=99.9202
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11372549019607843, 'auc': 0.517333984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=119.5479, std=91.6305
[DEBUG][MIA] Test Set Loss:   mean=115.6510, std=87.7046
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11599999999999999, 'auc': 0.485144, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=97.5838, std=86.4778
[DEBUG][MIA] Test Set Loss:   mean=97.6396, std=86.4276
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.08235294117647059, 'auc': 0.50836181640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=103.3840, std=83.0191
[DEBUG][MIA] Test Set Loss:   mean=98.6065, std=82.4248
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.096, 'auc': 0.48375999999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=92.6466, std=76.9692
[DEBUG][MIA] Test Set Loss:   mean=99.0013, std=90.2647
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.5107421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=110.4010, std=77.4413
[DEBUG][MIA] Test Set Loss:   mean=97.8445, std=83.2683
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.454, 'cv_acc': 0.08199999999999999, 'auc': 0.453256, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=66.2348, std=67.5690
[DEBUG][MIA] Test Set Loss:   mean=76.2259, std=85.0008
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.08627450980392157, 'auc': 0.51568603515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=75.8602, std=77.4872
[DEBUG][MIA] Test Set Loss:   mean=75.9478, std=79.3084
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.092, 'auc': 0.49688, 'task': 8}
Total correct retain:  660  Total retain:  2500
Total correct forget:  9941  Total forget:  47500
Total correct test:  121  Total test:  500
Total correct forget test:  1937  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.242, 0.21, 0.2, 0.192, 0.262, 0.214, 0.212, 0.274, 0.266, 0.202, 0.216, 0.206, 0.156, 0.194, 0.16, 0.2, 0.206, 0.164, 0.132, 0.208]
Unlearning task: 10
Accuracy, Confidence: (0.17578125, 0.9905787110328674)
broken out of loop
Accuracy, Confidence: (0.1796875, 0.9806812405586243)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=35.1783, std=30.7084
[DEBUG][MIA] Test Set Loss:   mean=37.5312, std=30.4879
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.1372549019607843, 'auc': 0.52642822265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=39.6218, std=32.8536
[DEBUG][MIA] Test Set Loss:   mean=36.6519, std=33.0306
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.096, 'auc': 0.467024, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=40.0658, std=27.9144
[DEBUG][MIA] Test Set Loss:   mean=36.8422, std=28.3263
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.08627450980392157, 'auc': 0.462677001953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=38.4142, std=30.0055
[DEBUG][MIA] Test Set Loss:   mean=37.7152, std=27.8204
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.092, 'auc': 0.49692, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=73.4625, std=68.7381
[DEBUG][MIA] Test Set Loss:   mean=67.2112, std=70.7529
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.11764705882352941, 'auc': 0.47113037109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=72.5931, std=71.4505
[DEBUG][MIA] Test Set Loss:   mean=70.7131, std=68.0683
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.1, 'auc': 0.49599200000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=53.5628, std=53.9307
[DEBUG][MIA] Test Set Loss:   mean=46.2038, std=47.8103
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.0784313725490196, 'auc': 0.529571533203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=46.0589, std=47.6400
[DEBUG][MIA] Test Set Loss:   mean=49.6527, std=46.7502
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.098, 'auc': 0.47008000000000005, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=76.5777, std=58.1447
[DEBUG][MIA] Test Set Loss:   mean=73.1202, std=63.6709
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09411764705882353, 'auc': 0.466339111328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=72.1538, std=57.6963
[DEBUG][MIA] Test Set Loss:   mean=74.2261, std=57.5903
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10400000000000001, 'auc': 0.508784, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=64.1559, std=58.7868
[DEBUG][MIA] Test Set Loss:   mean=70.5608, std=57.4057
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.11372549019607843, 'auc': 0.54010009765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=61.9746, std=57.6203
[DEBUG][MIA] Test Set Loss:   mean=65.2960, std=54.0125
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.096, 'auc': 0.520616, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=59.9749, std=51.5594
[DEBUG][MIA] Test Set Loss:   mean=66.3526, std=53.5107
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10980392156862744, 'auc': 0.527679443359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=67.0844, std=59.0789
[DEBUG][MIA] Test Set Loss:   mean=64.0043, std=58.9819
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11399999999999999, 'auc': 0.482288, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=39.4532, std=41.1573
[DEBUG][MIA] Test Set Loss:   mean=52.8519, std=56.7280
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.12156862745098038, 'auc': 0.4393310546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=46.6609, std=53.5323
[DEBUG][MIA] Test Set Loss:   mean=49.7184, std=52.3634
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11200000000000002, 'auc': 0.523568, 'task': 8}
Total correct retain:  690  Total retain:  2500
Total correct forget:  10038  Total forget:  47500
Total correct test:  128  Total test:  500
Total correct forget test:  1982  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.256, 0.218, 0.202, 0.208, 0.27, 0.224, 0.216, 0.28, 0.272, 0.2, 0.218, 0.212, 0.152, 0.184, 0.164, 0.204, 0.214, 0.172, 0.138, 0.216]
Unlearning task: 9
Accuracy, Confidence: (0.30078125, 0.9885429739952087)
broken out of loop
Accuracy, Confidence: (0.3046875, 0.9636048674583435)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=22.4679, std=23.4227
[DEBUG][MIA] Test Set Loss:   mean=22.5633, std=19.8351
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.1254901960784314, 'auc': 0.523284912109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=21.9990, std=22.2236
[DEBUG][MIA] Test Set Loss:   mean=24.8593, std=23.9543
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.096, 'auc': 0.465128, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=26.9173, std=18.3831
[DEBUG][MIA] Test Set Loss:   mean=26.9290, std=19.9486
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10196078431372549, 'auc': 0.5101318359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=26.0443, std=21.7366
[DEBUG][MIA] Test Set Loss:   mean=26.0383, std=20.3264
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11200000000000002, 'auc': 0.49583200000000005, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=44.7056, std=48.0883
[DEBUG][MIA] Test Set Loss:   mean=43.8462, std=45.6590
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09019607843137255, 'auc': 0.502593994140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=45.0833, std=49.9307
[DEBUG][MIA] Test Set Loss:   mean=42.6470, std=44.6007
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.490656, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=36.5134, std=37.9118
[DEBUG][MIA] Test Set Loss:   mean=32.2003, std=33.3365
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.10588235294117647, 'auc': 0.47650146484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=35.6113, std=35.5073
[DEBUG][MIA] Test Set Loss:   mean=31.0095, std=32.3038
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11200000000000002, 'auc': 0.530296, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=50.2211, std=41.0200
[DEBUG][MIA] Test Set Loss:   mean=55.7807, std=43.7672
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09411764705882353, 'auc': 0.534881591796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=46.8156, std=38.2795
[DEBUG][MIA] Test Set Loss:   mean=52.1225, std=42.5218
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10200000000000001, 'auc': 0.5223679999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=46.8526, std=39.2625
[DEBUG][MIA] Test Set Loss:   mean=48.8745, std=41.8280
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.12549019607843137, 'auc': 0.50958251953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=45.9635, std=40.8440
[DEBUG][MIA] Test Set Loss:   mean=45.4367, std=42.0830
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11000000000000001, 'auc': 0.493312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=41.9489, std=36.3101
[DEBUG][MIA] Test Set Loss:   mean=44.7155, std=41.7807
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09019607843137255, 'auc': 0.51129150390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=46.1926, std=41.5720
[DEBUG][MIA] Test Set Loss:   mean=47.7879, std=41.5414
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.09, 'auc': 0.493824, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=26.7850, std=31.0509
[DEBUG][MIA] Test Set Loss:   mean=37.3774, std=35.8441
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.40625, 'cv_acc': 0.10196078431372549, 'auc': 0.40692138671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=30.9640, std=34.0045
[DEBUG][MIA] Test Set Loss:   mean=36.1794, std=38.0844
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.078, 'auc': 0.5327360000000001, 'task': 8}
Total correct retain:  717  Total retain:  2500
Total correct forget:  10301  Total forget:  47500
Total correct test:  134  Total test:  500
Total correct forget test:  2036  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.268, 0.23, 0.202, 0.22, 0.272, 0.23, 0.23, 0.28, 0.288, 0.206, 0.228, 0.222, 0.15, 0.172, 0.168, 0.214, 0.214, 0.176, 0.146, 0.224]
Unlearning task: 8
Accuracy, Confidence: (0.2578125, 0.9865289926528931)
broken out of loop
Accuracy, Confidence: (0.18359375, 0.9994022250175476)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=102.5090, std=107.1794
[DEBUG][MIA] Test Set Loss:   mean=98.7425, std=107.0129
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.486358642578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=101.6012, std=113.1552
[DEBUG][MIA] Test Set Loss:   mean=102.1879, std=113.2465
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.5065599999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=161.5908, std=200.9174
[DEBUG][MIA] Test Set Loss:   mean=168.9477, std=182.5433
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.13333333333333333, 'auc': 0.470733642578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=157.2662, std=174.9675
[DEBUG][MIA] Test Set Loss:   mean=177.9079, std=198.0453
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.096, 'auc': 0.480112, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=53.8300, std=62.9715
[DEBUG][MIA] Test Set Loss:   mean=42.9002, std=58.5233
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10588235294117647, 'auc': 0.437347412109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=56.0643, std=62.8799
[DEBUG][MIA] Test Set Loss:   mean=51.7254, std=58.0088
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.086, 'auc': 0.48206399999999994, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=239.2208, std=248.8802
[DEBUG][MIA] Test Set Loss:   mean=210.9354, std=229.2185
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.16470588235294117, 'auc': 0.46954345703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=225.7358, std=233.5773
[DEBUG][MIA] Test Set Loss:   mean=224.7529, std=231.5661
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.09, 'auc': 0.49771200000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=159.2046, std=164.7553
[DEBUG][MIA] Test Set Loss:   mean=170.1719, std=148.3615
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.12549019607843137, 'auc': 0.460174560546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=180.6001, std=161.7579
[DEBUG][MIA] Test Set Loss:   mean=171.0397, std=142.6470
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10600000000000001, 'auc': 0.49440000000000006, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=114.7798, std=130.6325
[DEBUG][MIA] Test Set Loss:   mean=146.9968, std=146.7117
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.08627450980392157, 'auc': 0.561614990234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=128.2774, std=135.6886
[DEBUG][MIA] Test Set Loss:   mean=126.3391, std=138.3025
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.092, 'auc': 0.490128, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=396.0988, std=372.2668
[DEBUG][MIA] Test Set Loss:   mean=435.7405, std=391.6091
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.05490196078431373, 'auc': 0.4647216796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=460.6034, std=378.4977
[DEBUG][MIA] Test Set Loss:   mean=419.1255, std=353.0697
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.485008, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=75.4226, std=75.0058
[DEBUG][MIA] Test Set Loss:   mean=86.0935, std=83.5171
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11372549019607843, 'auc': 0.524749755859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=82.5591, std=92.1847
[DEBUG][MIA] Test Set Loss:   mean=83.2125, std=82.6808
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.088, 'auc': 0.520288, 'task': 8}
Total correct retain:  580  Total retain:  2500
Total correct forget:  9211  Total forget:  47500
Total correct test:  113  Total test:  500
Total correct forget test:  1859  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.226, 0.19, 0.208, 0.172, 0.232, 0.168, 0.218, 0.184, 0.196, 0.208, 0.196, 0.192, 0.202, 0.202, 0.182, 0.202, 0.198, 0.162, 0.2, 0.206]
Unlearning task: 7
Accuracy, Confidence: (0.2734375, 0.9883270263671875)
broken out of loop
Accuracy, Confidence: (0.265625, 0.9829052090644836)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=49.9945, std=67.2455
[DEBUG][MIA] Test Set Loss:   mean=51.6632, std=63.6153
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08627450980392157, 'auc': 0.48333740234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=51.9968, std=66.4315
[DEBUG][MIA] Test Set Loss:   mean=47.6877, std=60.0280
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.13599999999999998, 'auc': 0.47819199999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=98.9412, std=115.1578
[DEBUG][MIA] Test Set Loss:   mean=89.3025, std=107.9152
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.536590576171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=97.4138, std=108.2464
[DEBUG][MIA] Test Set Loss:   mean=110.5974, std=129.3030
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.088, 'auc': 0.519096, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=33.5700, std=36.6582
[DEBUG][MIA] Test Set Loss:   mean=34.3472, std=35.3742
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09411764705882353, 'auc': 0.49114990234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=34.1005, std=38.5823
[DEBUG][MIA] Test Set Loss:   mean=32.5109, std=39.7132
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.088, 'auc': 0.490784, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=131.8852, std=149.0287
[DEBUG][MIA] Test Set Loss:   mean=137.4922, std=154.6253
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12549019607843137, 'auc': 0.50634765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=150.7505, std=166.4342
[DEBUG][MIA] Test Set Loss:   mean=152.0972, std=165.7289
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.494216, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=104.5269, std=103.9026
[DEBUG][MIA] Test Set Loss:   mean=110.7680, std=98.4712
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10980392156862746, 'auc': 0.471282958984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=101.6459, std=97.2678
[DEBUG][MIA] Test Set Loss:   mean=111.2108, std=104.4564
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08199999999999999, 'auc': 0.48298399999999997, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=72.2334, std=81.8593
[DEBUG][MIA] Test Set Loss:   mean=97.7961, std=103.4509
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10980392156862746, 'auc': 0.563232421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=88.1845, std=99.0902
[DEBUG][MIA] Test Set Loss:   mean=94.1471, std=101.6103
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.514848, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=259.4070, std=242.3391
[DEBUG][MIA] Test Set Loss:   mean=294.4501, std=275.2350
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.08627450980392157, 'auc': 0.520660400390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=278.3962, std=243.9202
[DEBUG][MIA] Test Set Loss:   mean=280.7036, std=254.5890
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.5050479999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=42.0131, std=49.5334
[DEBUG][MIA] Test Set Loss:   mean=53.1681, std=60.7419
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.4517822265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=48.9090, std=61.1862
[DEBUG][MIA] Test Set Loss:   mean=50.5288, std=56.3943
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.092, 'auc': 0.473592, 'task': 8}
Total correct retain:  617  Total retain:  2500
Total correct forget:  9329  Total forget:  47500
Total correct test:  121  Total test:  500
Total correct forget test:  1892  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.242, 0.22, 0.226, 0.168, 0.23, 0.17, 0.232, 0.17, 0.206, 0.212, 0.198, 0.198, 0.2, 0.202, 0.172, 0.196, 0.192, 0.178, 0.208, 0.206]
Unlearning task: 6
Accuracy, Confidence: (0.18359375, 0.9874850511550903)
broken out of loop
Accuracy, Confidence: (0.1796875, 0.9847856760025024)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=28.6219, std=45.0152
[DEBUG][MIA] Test Set Loss:   mean=37.6488, std=44.8614
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.42578125, 'cv_acc': 0.1215686274509804, 'auc': 0.42718505859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=36.9342, std=47.4559
[DEBUG][MIA] Test Set Loss:   mean=29.5831, std=38.4562
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.09, 'auc': 0.47983999999999993, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=90.4761, std=98.5122
[DEBUG][MIA] Test Set Loss:   mean=82.1935, std=93.4007
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.13333333333333333, 'auc': 0.471038818359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=55.3764, std=76.8111
[DEBUG][MIA] Test Set Loss:   mean=71.3139, std=91.6572
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11000000000000001, 'auc': 0.5438080000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=24.1896, std=26.6878
[DEBUG][MIA] Test Set Loss:   mean=22.9836, std=26.0947
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09411764705882353, 'auc': 0.488189697265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=26.3889, std=33.2426
[DEBUG][MIA] Test Set Loss:   mean=20.3522, std=23.0267
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.1, 'auc': 0.4807600000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=84.9155, std=101.3869
[DEBUG][MIA] Test Set Loss:   mean=81.1795, std=98.9882
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11372549019607844, 'auc': 0.48895263671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=99.2604, std=109.3570
[DEBUG][MIA] Test Set Loss:   mean=95.1558, std=107.3645
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.509296, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=71.2840, std=72.3993
[DEBUG][MIA] Test Set Loss:   mean=70.0156, std=72.7563
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08627450980392157, 'auc': 0.489166259765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=78.6972, std=81.3177
[DEBUG][MIA] Test Set Loss:   mean=71.8485, std=73.6084
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.094, 'auc': 0.48117600000000005, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=59.0487, std=69.6105
[DEBUG][MIA] Test Set Loss:   mean=57.4853, std=64.8681
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.14901960784313725, 'auc': 0.493865966796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=63.6554, std=71.7581
[DEBUG][MIA] Test Set Loss:   mean=62.3208, std=73.2722
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10200000000000001, 'auc': 0.49081600000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=181.9516, std=176.9789
[DEBUG][MIA] Test Set Loss:   mean=207.3008, std=185.0354
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.09803921568627451, 'auc': 0.5423583984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=202.1157, std=195.2637
[DEBUG][MIA] Test Set Loss:   mean=198.1556, std=196.0673
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.49151999999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=30.2599, std=32.1720
[DEBUG][MIA] Test Set Loss:   mean=28.2180, std=36.3273
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.07058823529411765, 'auc': 0.455413818359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=31.1646, std=37.9179
[DEBUG][MIA] Test Set Loss:   mean=36.1922, std=42.5515
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.47975200000000007, 'task': 8}
Total correct retain:  656  Total retain:  2500
Total correct forget:  9453  Total forget:  47500
Total correct test:  125  Total test:  500
Total correct forget test:  1936  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.25, 0.238, 0.232, 0.17, 0.234, 0.186, 0.24, 0.17, 0.208, 0.228, 0.19, 0.202, 0.2, 0.198, 0.186, 0.194, 0.2, 0.172, 0.21, 0.214]
Unlearning task: 5
Accuracy, Confidence: (0.2578125, 0.9891841411590576)
broken out of loop
Accuracy, Confidence: (0.26171875, 0.9759992361068726)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=19.5847, std=31.5189
[DEBUG][MIA] Test Set Loss:   mean=19.8493, std=31.3084
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11372549019607843, 'auc': 0.50091552734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=19.3251, std=27.6565
[DEBUG][MIA] Test Set Loss:   mean=23.1925, std=31.5023
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11000000000000001, 'auc': 0.47792, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=45.0524, std=59.8344
[DEBUG][MIA] Test Set Loss:   mean=45.1553, std=56.5676
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09411764705882353, 'auc': 0.479400634765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=45.2341, std=55.5600
[DEBUG][MIA] Test Set Loss:   mean=49.0672, std=60.1150
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.512488, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.3444, std=21.1569
[DEBUG][MIA] Test Set Loss:   mean=18.0591, std=23.8120
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10196078431372549, 'auc': 0.47216796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.1438, std=20.4670
[DEBUG][MIA] Test Set Loss:   mean=17.2485, std=20.9580
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11399999999999999, 'auc': 0.51432, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=51.2727, std=65.7915
[DEBUG][MIA] Test Set Loss:   mean=73.2929, std=79.8490
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.1411764705882353, 'auc': 0.584442138671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=76.2705, std=83.0518
[DEBUG][MIA] Test Set Loss:   mean=68.7334, std=79.9264
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.47408000000000006, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=50.8001, std=56.6619
[DEBUG][MIA] Test Set Loss:   mean=45.8248, std=52.6586
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10196078431372549, 'auc': 0.47979736328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=58.8545, std=61.4779
[DEBUG][MIA] Test Set Loss:   mean=51.7017, std=56.0564
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.094, 'auc': 0.472032, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=42.3943, std=49.4211
[DEBUG][MIA] Test Set Loss:   mean=42.2277, std=47.6566
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.2, 'auc': 0.501251220703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=48.8352, std=54.1594
[DEBUG][MIA] Test Set Loss:   mean=47.3100, std=56.3403
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10400000000000001, 'auc': 0.48647199999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=125.4325, std=139.4247
[DEBUG][MIA] Test Set Loss:   mean=145.3741, std=143.3593
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4296875, 'cv_acc': 0.09019607843137255, 'auc': 0.45379638671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=132.3896, std=122.4954
[DEBUG][MIA] Test Set Loss:   mean=148.1779, std=145.2070
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.5168079999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=21.2888, std=24.9420
[DEBUG][MIA] Test Set Loss:   mean=28.1823, std=33.2823
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.536376953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=25.1261, std=31.5895
[DEBUG][MIA] Test Set Loss:   mean=26.9177, std=30.1114
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.5292239999999999, 'task': 8}
Total correct retain:  674  Total retain:  2500
Total correct forget:  9578  Total forget:  47500
Total correct test:  126  Total test:  500
Total correct forget test:  1949  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.252, 0.27, 0.254, 0.162, 0.228, 0.192, 0.238, 0.166, 0.218, 0.236, 0.19, 0.194, 0.21, 0.188, 0.178, 0.18, 0.22, 0.152, 0.208, 0.214]
Unlearning task: 4
Accuracy, Confidence: (0.15625, 0.9093327522277832)
broken out of loop
Accuracy, Confidence: (0.15625, 0.88688063621521)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=16.7837, std=26.3948
[DEBUG][MIA] Test Set Loss:   mean=16.4950, std=23.0299
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.14901960784313725, 'auc': 0.51531982421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=16.4017, std=23.7778
[DEBUG][MIA] Test Set Loss:   mean=14.6835, std=23.3283
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.098, 'auc': 0.521072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=44.1782, std=52.9953
[DEBUG][MIA] Test Set Loss:   mean=37.1760, std=48.3802
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09019607843137253, 'auc': 0.44439697265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=40.8284, std=50.6344
[DEBUG][MIA] Test Set Loss:   mean=37.0633, std=49.2763
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.08199999999999999, 'auc': 0.467712, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=15.3560, std=18.5657
[DEBUG][MIA] Test Set Loss:   mean=13.6881, std=17.1151
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.09019607843137255, 'auc': 0.466064453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.1438, std=15.2129
[DEBUG][MIA] Test Set Loss:   mean=13.0804, std=16.2605
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.096, 'auc': 0.48884000000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=40.4637, std=53.1500
[DEBUG][MIA] Test Set Loss:   mean=59.5655, std=71.1641
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10196078431372549, 'auc': 0.43768310546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=61.4111, std=69.2154
[DEBUG][MIA] Test Set Loss:   mean=50.6888, std=63.3411
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.092, 'auc': 0.5427919999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=40.6071, std=48.0705
[DEBUG][MIA] Test Set Loss:   mean=46.2084, std=45.8454
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.0784313725490196, 'auc': 0.55169677734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=39.1261, std=42.6553
[DEBUG][MIA] Test Set Loss:   mean=39.7306, std=44.2280
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.072, 'auc': 0.501008, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=29.9084, std=38.4476
[DEBUG][MIA] Test Set Loss:   mean=32.8178, std=42.0248
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.11372549019607843, 'auc': 0.508819580078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=30.4311, std=38.9491
[DEBUG][MIA] Test Set Loss:   mean=37.2261, std=42.1191
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.088, 'auc': 0.548696, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=104.0911, std=100.4322
[DEBUG][MIA] Test Set Loss:   mean=122.2321, std=103.5427
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.08235294117647059, 'auc': 0.562286376953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=114.1355, std=105.6845
[DEBUG][MIA] Test Set Loss:   mean=108.9486, std=105.6356
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10600000000000001, 'auc': 0.4802, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=17.0638, std=24.1045
[DEBUG][MIA] Test Set Loss:   mean=16.7200, std=21.9454
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.49346923828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=20.4950, std=25.8680
[DEBUG][MIA] Test Set Loss:   mean=22.0615, std=25.3064
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.09, 'auc': 0.48384, 'task': 8}
Total correct retain:  659  Total retain:  2500
Total correct forget:  9615  Total forget:  47500
Total correct test:  124  Total test:  500
Total correct forget test:  1942  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.248, 0.298, 0.246, 0.156, 0.232, 0.184, 0.218, 0.162, 0.214, 0.238, 0.188, 0.192, 0.226, 0.192, 0.178, 0.17, 0.212, 0.154, 0.214, 0.21]
Unlearning task: 3
Accuracy, Confidence: (0.203125, 0.9621509313583374)
broken out of loop
Accuracy, Confidence: (0.203125, 0.9467828273773193)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.6305, std=19.7087
[DEBUG][MIA] Test Set Loss:   mean=12.8504, std=17.9081
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627451, 'auc': 0.478759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=12.3580, std=17.0308
[DEBUG][MIA] Test Set Loss:   mean=12.3953, std=18.7007
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.098, 'auc': 0.493424, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=31.6342, std=38.4646
[DEBUG][MIA] Test Set Loss:   mean=27.4712, std=36.4097
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.07058823529411765, 'auc': 0.465576171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=27.0887, std=37.2539
[DEBUG][MIA] Test Set Loss:   mean=30.2801, std=40.5369
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11000000000000001, 'auc': 0.511224, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.7372, std=11.7848
[DEBUG][MIA] Test Set Loss:   mean=11.2206, std=13.9409
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.460205078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.9408, std=14.5650
[DEBUG][MIA] Test Set Loss:   mean=10.2723, std=10.8677
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.088, 'auc': 0.5089279999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=36.1244, std=49.2776
[DEBUG][MIA] Test Set Loss:   mean=45.7773, std=56.3427
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09803921568627451, 'auc': 0.4464111328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=45.3193, std=56.2029
[DEBUG][MIA] Test Set Loss:   mean=42.5964, std=52.3647
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.49568, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=30.8829, std=37.7999
[DEBUG][MIA] Test Set Loss:   mean=35.5665, std=39.8129
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.09411764705882353, 'auc': 0.46441650390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=32.3808, std=36.9572
[DEBUG][MIA] Test Set Loss:   mean=33.5894, std=39.2878
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.09, 'auc': 0.502696, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=24.7236, std=31.3830
[DEBUG][MIA] Test Set Loss:   mean=32.1323, std=37.1914
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1215686274509804, 'auc': 0.5513916015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=26.5364, std=33.5282
[DEBUG][MIA] Test Set Loss:   mean=30.2262, std=36.9026
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11599999999999999, 'auc': 0.525632, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=90.4342, std=100.4936
[DEBUG][MIA] Test Set Loss:   mean=95.0819, std=96.7315
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.13725490196078433, 'auc': 0.5350341796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=85.9869, std=88.2037
[DEBUG][MIA] Test Set Loss:   mean=92.3574, std=89.5405
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.519904, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=14.4522, std=18.7931
[DEBUG][MIA] Test Set Loss:   mean=17.2100, std=21.1729
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.10588235294117647, 'auc': 0.4736328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.0496, std=18.8643
[DEBUG][MIA] Test Set Loss:   mean=14.7186, std=18.1310
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.094, 'auc': 0.495408, 'task': 8}
Total correct retain:  671  Total retain:  2500
Total correct forget:  9613  Total forget:  47500
Total correct test:  128  Total test:  500
Total correct forget test:  1960  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.256, 0.304, 0.254, 0.158, 0.23, 0.192, 0.22, 0.154, 0.214, 0.246, 0.188, 0.19, 0.23, 0.194, 0.18, 0.168, 0.214, 0.148, 0.214, 0.222]
Unlearning task: 2
Accuracy, Confidence: (0.3203125, 0.8460038900375366)
broken out of loop
Accuracy, Confidence: (0.19140625, 0.9752465486526489)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 5, 8, 6, 6, 5, 6, 8, 6, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=41.7551, std=35.9408
[DEBUG][MIA] Test Set Loss:   mean=34.6388, std=52.6288
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.09411764705882353, 'auc': 0.60430908203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 9 7 7 6 8 7 5 9 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 5 7 6 5 8 7 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=41.5381, std=44.4776
[DEBUG][MIA] Test Set Loss:   mean=39.4256, std=41.8612
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10400000000000001, 'auc': 0.514192, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 13, 11, 11, 11, 12, 13, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=26.3916, std=28.7095
[DEBUG][MIA] Test Set Loss:   mean=22.9260, std=29.0591
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09411764705882353, 'auc': 0.548614501953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 12 12 12 10 14 10 11 14 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 10 12 10 10 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=19.2509, std=19.2253
[DEBUG][MIA] Test Set Loss:   mean=21.6657, std=27.3028
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.08399999999999999, 'auc': 0.5027119999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 19, 16, 16, 17, 19, 16, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.3481, std=10.8384
[DEBUG][MIA] Test Set Loss:   mean=12.5900, std=10.6716
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.08627450980392157, 'auc': 0.480499267578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 15 17 19 16 16 15 18 19 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 16 17 16 17 16 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.7840, std=9.5322
[DEBUG][MIA] Test Set Loss:   mean=12.7361, std=10.2139
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.516504, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 23, 21, 21, 24, 23, 22, 24, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=14.2123, std=16.6145
[DEBUG][MIA] Test Set Loss:   mean=17.4927, std=17.1778
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09803921568627451, 'auc': 0.57232666015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 23 24 20 22 20 23 23 20 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 20 22 23 20 24 24 24 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=16.7152, std=18.1561
[DEBUG][MIA] Test Set Loss:   mean=16.5346, std=16.7080
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.098, 'auc': 0.49011999999999994, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 26, 26, 26, 28, 28, 28, 28, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=26.2650, std=21.0393
[DEBUG][MIA] Test Set Loss:   mean=28.4005, std=19.9913
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.10196078431372549, 'auc': 0.47332763671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 27 26 25 26 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 29 27 27 25 29 28 27 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=26.6381, std=19.8089
[DEBUG][MIA] Test Set Loss:   mean=27.5512, std=19.9192
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.08399999999999999, 'auc': 0.48554400000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 32, 33, 30, 33, 30, 32, 30, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=16.4583, std=16.1032
[DEBUG][MIA] Test Set Loss:   mean=15.1507, std=17.7607
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11764705882352941, 'auc': 0.528045654296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 33 32 33 32 31 31 34 30 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 32 30 32 31 33 31 30 34 32]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=16.3560, std=17.8832
[DEBUG][MIA] Test Set Loss:   mean=18.1106, std=18.1594
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.092, 'auc': 0.47019199999999994, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 38, 39, 35, 36, 37, 38, 38, 35, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=66.1323, std=56.9863
[DEBUG][MIA] Test Set Loss:   mean=56.5942, std=59.5900
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.421875, 'cv_acc': 0.09019607843137255, 'auc': 0.421051025390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 37 37 39 39 38 37 39 36 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 39 38 36 38 37 35 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=57.6372, std=55.2926
[DEBUG][MIA] Test Set Loss:   mean=57.5646, std=61.6824
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.513304, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 44, 43, 41, 41, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.2315, std=10.4183
[DEBUG][MIA] Test Set Loss:   mean=9.5786, std=10.7080
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10588235294117647, 'auc': 0.51397705078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 44 42 44 43 41 43 42 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 44 42 44 42 44 40 41 44 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.1827, std=10.5189
[DEBUG][MIA] Test Set Loss:   mean=8.5148, std=9.2159
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11200000000000002, 'auc': 0.49007200000000006, 'task': 8}
Total correct retain:  605  Total retain:  2500
Total correct forget:  10050  Total forget:  47500
Total correct test:  117  Total test:  500
Total correct forget test:  2025  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.234, 0.246, 0.228, 0.176, 0.246, 0.208, 0.224, 0.222, 0.27, 0.244, 0.246, 0.238, 0.206, 0.318, 0.196, 0.112, 0.16, 0.148, 0.14, 0.222]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['cattle', 'leopard', 'boy', 'girl', 'lobster', 'fox', 'wardrobe', 'porcupine', 'snail', 'television', 'aquarium fish', 'ray', 'palm', 'oranges', 'forest', 'man', 'dolphin', 'lion', 'skyscraper', 'chimpanzee', 'bed', 'bicycle', 'sweet peppers', 'bee', 'tulips', 'road', 'bridge', 'pears', 'mouse', 'otter', 'train', 'chair', 'sunflowers', 'mountain', 'orchids', 'skunk', 'tractor', 'woman', 'beetle', 'wolf', 'streetcar', 'motorcycle', 'hamster', 'turtle', 'maple', 'roses', 'bus', 'lamp', 'bear', 'possum', 'pine', 'plain', 'cups', 'butterfly', 'shrew', 'willow', 'crab', 'seal', 'computer keyboard', 'mushrooms', 'poppies', 'raccoon', 'table', 'crocodile', 'tank', 'oak', 'apples', 'cloud', 'house', 'bottles', 'lizard', 'telephone', 'bowls', 'elephant', 'cans', 'camel', 'castle', 'dinosaur', 'kangaroo', 'sea', 'cockroach', 'worm', 'trout', 'whale', 'flatfish', 'baby', 'beaver', 'pickup truck', 'plates', 'caterpillar', 'spider', 'shark', 'snake', 'rocket', 'tiger', 'clock', 'squirrel', 'couch', 'rabbit', 'lawn-mower']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  1904  Total retain:  2500
Total correct forget:  9577  Total forget:  47500
Total correct test:  277  Total test:  500
Total correct forget test:  1874  Total test forget:  9500
After learning task 1
Task accuracies: [0.554, 0.192, 0.198, 0.156, 0.206, 0.186, 0.17, 0.22, 0.202, 0.218, 0.192, 0.182, 0.174, 0.276, 0.194, 0.154, 0.234, 0.15, 0.25, 0.194]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0570, std=0.3256
[DEBUG][MIA] Test Set Loss:   mean=1.4090, std=3.0981
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.25098039215686274, 'auc': 0.665008544921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0558, std=0.2785
[DEBUG][MIA] Test Set Loss:   mean=1.2562, std=2.7561
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.22599999999999998, 'auc': 0.690072, 'task': 1}
2 1
Total correct retain:  1694  Total retain:  2500
Total correct forget:  10847  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  2097  Total test forget:  9500
After learning task 2
Task accuracies: [0.564, 0.758, 0.22, 0.232, 0.178, 0.198, 0.19, 0.252, 0.194, 0.198, 0.178, 0.21, 0.192, 0.152, 0.186, 0.214, 0.162, 0.148, 0.14, 0.192]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0211
[DEBUG][MIA] Test Set Loss:   mean=1.3642, std=2.3809
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.5882352941176471, 'auc': 0.78338623046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4126, std=1.0538
[DEBUG][MIA] Test Set Loss:   mean=1.2413, std=2.2839
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.166, 'auc': 0.5988719999999998, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0268, std=0.2887
[DEBUG][MIA] Test Set Loss:   mean=0.4977, std=1.7266
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.15294117647058822, 'auc': 0.589569091796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0081, std=0.0658
[DEBUG][MIA] Test Set Loss:   mean=0.4340, std=1.3144
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.198, 'auc': 0.656128, 'task': 2}
3 2
Total correct retain:  1586  Total retain:  2500
Total correct forget:  12516  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2355  Total test forget:  9500
After learning task 3
Task accuracies: [0.556, 0.664, 0.862, 0.196, 0.188, 0.176, 0.338, 0.198, 0.182, 0.222, 0.112, 0.216, 0.144, 0.1, 0.2, 0.192, 0.18, 0.14, 0.214, 0.186]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=1.2377, std=2.2336
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7411764705882352, 'auc': 0.813873291015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7864, std=1.8155
[DEBUG][MIA] Test Set Loss:   mean=1.5213, std=2.3622
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.11200000000000002, 'auc': 0.6257520000000001, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0073
[DEBUG][MIA] Test Set Loss:   mean=1.1826, std=2.6394
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.24705882352941178, 'auc': 0.773345947265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4784, std=1.3011
[DEBUG][MIA] Test Set Loss:   mean=1.0116, std=2.5131
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.142, 'auc': 0.569952, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0111, std=0.0527
[DEBUG][MIA] Test Set Loss:   mean=1.1270, std=2.5042
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.1843137254901961, 'auc': 0.680084228515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0657
[DEBUG][MIA] Test Set Loss:   mean=1.0147, std=2.4931
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.23399999999999999, 'auc': 0.6806559999999999, 'task': 3}
4 3
Total correct retain:  1603  Total retain:  2500
Total correct forget:  14067  Total forget:  47500
Total correct test:  277  Total test:  500
Total correct forget test:  2616  Total test forget:  9500
After learning task 4
Task accuracies: [0.554, 0.676, 0.776, 0.78, 0.178, 0.2, 0.368, 0.25, 0.2, 0.216, 0.094, 0.202, 0.11, 0.058, 0.206, 0.152, 0.134, 0.206, 0.206, 0.22]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.7413, std=2.6170
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7098039215686275, 'auc': 0.8087158203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8314, std=1.7386
[DEBUG][MIA] Test Set Loss:   mean=1.5425, std=2.4738
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.182, 'auc': 0.584368, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0223
[DEBUG][MIA] Test Set Loss:   mean=1.4297, std=2.8110
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.27450980392156865, 'auc': 0.765106201171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8093, std=1.8692
[DEBUG][MIA] Test Set Loss:   mean=1.0835, std=2.4753
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.13399999999999998, 'auc': 0.5300159999999999, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0154, std=0.0968
[DEBUG][MIA] Test Set Loss:   mean=1.7690, std=2.8849
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.5686274509803921, 'auc': 0.7886962890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4809, std=1.2460
[DEBUG][MIA] Test Set Loss:   mean=1.3411, std=2.4891
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.21600000000000003, 'auc': 0.590232, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0148, std=0.0788
[DEBUG][MIA] Test Set Loss:   mean=0.9890, std=2.5695
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.20784313725490197, 'auc': 0.720550537109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0251, std=0.2217
[DEBUG][MIA] Test Set Loss:   mean=1.1074, std=2.9865
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.22199999999999998, 'auc': 0.731192, 'task': 4}
5 4
Total correct retain:  1472  Total retain:  2500
Total correct forget:  15437  Total forget:  47500
Total correct test:  260  Total test:  500
Total correct forget test:  2790  Total test forget:  9500
After learning task 5
Task accuracies: [0.52, 0.602, 0.732, 0.652, 0.796, 0.182, 0.264, 0.26, 0.202, 0.238, 0.12, 0.2, 0.148, 0.072, 0.244, 0.124, 0.19, 0.2, 0.146, 0.208]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.6971, std=2.6067
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7607843137254902, 'auc': 0.87298583984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1057, std=2.0607
[DEBUG][MIA] Test Set Loss:   mean=1.7466, std=2.6102
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.14600000000000002, 'auc': 0.582696, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0718
[DEBUG][MIA] Test Set Loss:   mean=1.1044, std=2.4996
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2666666666666667, 'auc': 0.7392578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5495, std=1.4702
[DEBUG][MIA] Test Set Loss:   mean=1.3655, std=2.5994
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.146, 'auc': 0.58136, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0175
[DEBUG][MIA] Test Set Loss:   mean=1.3452, std=2.2925
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2901960784313725, 'auc': 0.809906005859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7414, std=1.6593
[DEBUG][MIA] Test Set Loss:   mean=1.4004, std=2.2476
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.176, 'auc': 0.609032, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0916, std=0.3515
[DEBUG][MIA] Test Set Loss:   mean=1.4771, std=2.6457
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.21960784313725493, 'auc': 0.79278564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7548, std=1.6289
[DEBUG][MIA] Test Set Loss:   mean=1.4293, std=2.5313
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.194, 'auc': 0.606336, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0744, std=0.5721
[DEBUG][MIA] Test Set Loss:   mean=1.1005, std=2.5808
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2705882352941177, 'auc': 0.736785888671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0290, std=0.1851
[DEBUG][MIA] Test Set Loss:   mean=1.1519, std=2.6311
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.22199999999999998, 'auc': 0.71528, 'task': 5}
6 5
Total correct retain:  1421  Total retain:  2500
Total correct forget:  16908  Total forget:  47500
Total correct test:  257  Total test:  500
Total correct forget test:  3002  Total test forget:  9500
After learning task 6
Task accuracies: [0.514, 0.608, 0.73, 0.632, 0.684, 0.78, 0.274, 0.222, 0.212, 0.212, 0.144, 0.156, 0.13, 0.11, 0.234, 0.114, 0.152, 0.216, 0.204, 0.19]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0063
[DEBUG][MIA] Test Set Loss:   mean=1.9912, std=2.7613
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7333333333333334, 'auc': 0.819732666015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2702, std=2.6275
[DEBUG][MIA] Test Set Loss:   mean=1.6805, std=2.5562
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11600000000000002, 'auc': 0.5790000000000001, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=1.5134, std=3.0842
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.25098039215686274, 'auc': 0.758636474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8674, std=1.9363
[DEBUG][MIA] Test Set Loss:   mean=1.1603, std=2.3810
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.15599999999999997, 'auc': 0.562088, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0094, std=0.0512
[DEBUG][MIA] Test Set Loss:   mean=1.6525, std=2.5957
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6901960784313725, 'auc': 0.81195068359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8458, std=1.9953
[DEBUG][MIA] Test Set Loss:   mean=1.5556, std=2.9538
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12600000000000003, 'auc': 0.59364, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0285, std=0.1116
[DEBUG][MIA] Test Set Loss:   mean=1.7118, std=3.0225
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6823529411764706, 'auc': 0.763092041015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8357, std=1.8932
[DEBUG][MIA] Test Set Loss:   mean=1.6761, std=2.8202
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.13000000000000003, 'auc': 0.594584, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0117, std=0.0857
[DEBUG][MIA] Test Set Loss:   mean=1.1764, std=2.5579
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2784313725490196, 'auc': 0.764862060546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1963, std=0.6169
[DEBUG][MIA] Test Set Loss:   mean=1.2683, std=2.6017
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.2, 'auc': 0.690448, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0613
[DEBUG][MIA] Test Set Loss:   mean=0.5645, std=2.0818
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.17254901960784313, 'auc': 0.612518310546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0111, std=0.0710
[DEBUG][MIA] Test Set Loss:   mean=0.4714, std=1.7660
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.164, 'auc': 0.604648, 'task': 6}
7 6
Total correct retain:  1369  Total retain:  2500
Total correct forget:  18274  Total forget:  47500
Total correct test:  261  Total test:  500
Total correct forget test:  3249  Total test forget:  9500
After learning task 7
Task accuracies: [0.522, 0.602, 0.708, 0.648, 0.64, 0.738, 0.906, 0.234, 0.212, 0.218, 0.114, 0.176, 0.15, 0.078, 0.214, 0.134, 0.124, 0.24, 0.18, 0.182]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=1.5426, std=2.6701
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7411764705882353, 'auc': 0.80743408203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2422, std=2.7448
[DEBUG][MIA] Test Set Loss:   mean=1.7751, std=2.9035
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11600000000000002, 'auc': 0.582008, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=1.2672, std=2.6039
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2823529411764706, 'auc': 0.75390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9724, std=2.1028
[DEBUG][MIA] Test Set Loss:   mean=1.3353, std=2.4418
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11200000000000002, 'auc': 0.544192, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.8290, std=2.6216
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.2784313725490196, 'auc': 0.864166259765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8385, std=1.9305
[DEBUG][MIA] Test Set Loss:   mean=1.5512, std=2.6916
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.15, 'auc': 0.607512, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0514, std=0.3666
[DEBUG][MIA] Test Set Loss:   mean=1.4283, std=2.3922
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6588235294117648, 'auc': 0.75653076171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9532, std=2.0849
[DEBUG][MIA] Test Set Loss:   mean=1.9342, std=2.7722
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.182, 'auc': 0.6217199999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0182, std=0.0976
[DEBUG][MIA] Test Set Loss:   mean=1.3542, std=2.6370
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.30588235294117644, 'auc': 0.744232177734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6580, std=1.7123
[DEBUG][MIA] Test Set Loss:   mean=1.7560, std=2.9148
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.168, 'auc': 0.6404719999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0075
[DEBUG][MIA] Test Set Loss:   mean=0.4757, std=1.4913
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2, 'auc': 0.714324951171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1519, std=0.7071
[DEBUG][MIA] Test Set Loss:   mean=0.5761, std=1.6979
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.148, 'auc': 0.633376, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0149
[DEBUG][MIA] Test Set Loss:   mean=0.8245, std=1.9325
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2235294117647059, 'auc': 0.70330810546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0097
[DEBUG][MIA] Test Set Loss:   mean=0.7536, std=2.0147
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.244, 'auc': 0.709992, 'task': 7}
8 7
Total correct retain:  1506  Total retain:  2500
Total correct forget:  19241  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  3423  Total test forget:  9500
After learning task 8
Task accuracies: [0.578, 0.642, 0.708, 0.636, 0.598, 0.658, 0.842, 0.802, 0.178, 0.206, 0.13, 0.192, 0.118, 0.068, 0.222, 0.158, 0.126, 0.22, 0.168, 0.174]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0226
[DEBUG][MIA] Test Set Loss:   mean=1.3269, std=2.3324
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7176470588235293, 'auc': 0.829254150390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9429, std=1.9722
[DEBUG][MIA] Test Set Loss:   mean=1.6487, std=2.7576
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.088, 'auc': 0.5936319999999999, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0067
[DEBUG][MIA] Test Set Loss:   mean=1.5557, std=2.8756
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.27058823529411763, 'auc': 0.80133056640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8989, std=1.9100
[DEBUG][MIA] Test Set Loss:   mean=1.4808, std=2.9470
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.13400000000000004, 'auc': 0.5188, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.7168, std=2.9865
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7176470588235294, 'auc': 0.859344482421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9166, std=1.7023
[DEBUG][MIA] Test Set Loss:   mean=1.6906, std=2.9022
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.144, 'auc': 0.58252, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0498, std=0.2080
[DEBUG][MIA] Test Set Loss:   mean=1.9117, std=3.0744
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6784313725490196, 'auc': 0.826446533203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2802, std=2.3703
[DEBUG][MIA] Test Set Loss:   mean=1.7367, std=2.9085
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.152, 'auc': 0.554112, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=1.1027, std=1.9616
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6941176470588235, 'auc': 0.8680419921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6410, std=1.5884
[DEBUG][MIA] Test Set Loss:   mean=1.4065, std=2.4251
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.168, 'auc': 0.6271439999999999, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=0.9197, std=2.2833
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.21960784313725493, 'auc': 0.7650146484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4800, std=1.3704
[DEBUG][MIA] Test Set Loss:   mean=0.7365, std=1.7988
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.13999999999999999, 'auc': 0.545992, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0062
[DEBUG][MIA] Test Set Loss:   mean=1.2222, std=2.3054
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6313725490196079, 'auc': 0.815673828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3520, std=0.8979
[DEBUG][MIA] Test Set Loss:   mean=1.0557, std=2.0984
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.21200000000000002, 'auc': 0.620792, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0169
[DEBUG][MIA] Test Set Loss:   mean=0.8279, std=2.3635
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2392156862745098, 'auc': 0.715728759765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0193
[DEBUG][MIA] Test Set Loss:   mean=0.8871, std=2.0588
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.666, 'cv_acc': 0.23199999999999998, 'auc': 0.7288399999999999, 'task': 8}
Total correct retain:  1401  Total retain:  2500
Total correct forget:  20753  Total forget:  47500
Total correct test:  240  Total test:  500
Total correct forget test:  3650  Total test forget:  9500
After learning task 9
Task accuracies: [0.48, 0.628, 0.68, 0.654, 0.6, 0.672, 0.828, 0.698, 0.8, 0.226, 0.162, 0.21, 0.086, 0.116, 0.218, 0.074, 0.116, 0.176, 0.168, 0.188]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0302
[DEBUG][MIA] Test Set Loss:   mean=1.8292, std=2.8954
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.5882352941176471, 'auc': 0.8177490234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2148, std=2.4735
[DEBUG][MIA] Test Set Loss:   mean=1.6136, std=2.9342
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10800000000000001, 'auc': 0.548392, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.6859, std=3.0063
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2705882352941177, 'auc': 0.824493408203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2141, std=2.3318
[DEBUG][MIA] Test Set Loss:   mean=1.7542, std=3.1130
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.5291600000000001, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0164
[DEBUG][MIA] Test Set Loss:   mean=1.8871, std=3.3165
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7137254901960784, 'auc': 0.855987548828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0853, std=2.2047
[DEBUG][MIA] Test Set Loss:   mean=1.8238, std=3.1208
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.13799999999999998, 'auc': 0.5876399999999999, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0854, std=0.4114
[DEBUG][MIA] Test Set Loss:   mean=1.9502, std=3.2918
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.7137254901960784, 'auc': 0.785125732421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2303, std=2.2658
[DEBUG][MIA] Test Set Loss:   mean=1.9669, std=3.2523
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.142, 'auc': 0.554656, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0620
[DEBUG][MIA] Test Set Loss:   mean=1.7389, std=2.7797
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.25882352941176473, 'auc': 0.857635498046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7511, std=1.9510
[DEBUG][MIA] Test Set Loss:   mean=1.6716, std=2.7670
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.20600000000000002, 'auc': 0.623104, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=0.9217, std=2.2607
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2235294117647059, 'auc': 0.73193359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4453, std=1.4501
[DEBUG][MIA] Test Set Loss:   mean=0.9505, std=2.3497
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11600000000000002, 'auc': 0.57116, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=0.8618, std=1.7150
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.7294117647058824, 'auc': 0.840576171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5440, std=1.4440
[DEBUG][MIA] Test Set Loss:   mean=1.3268, std=2.4436
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.176, 'auc': 0.60476, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0074, std=0.0408
[DEBUG][MIA] Test Set Loss:   mean=0.9802, std=2.0074
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2627450980392157, 'auc': 0.775787353515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3059, std=1.0214
[DEBUG][MIA] Test Set Loss:   mean=1.0848, std=2.3117
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.20800000000000002, 'auc': 0.643624, 'task': 8}
Total correct retain:  1509  Total retain:  2500
Total correct forget:  22298  Total forget:  47500
Total correct test:  255  Total test:  500
Total correct forget test:  3918  Total test forget:  9500
After learning task 10
Task accuracies: [0.51, 0.624, 0.7, 0.636, 0.598, 0.67, 0.808, 0.708, 0.72, 0.81, 0.176, 0.176, 0.074, 0.086, 0.2, 0.112, 0.19, 0.2, 0.166, 0.182]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0081, std=0.0281
[DEBUG][MIA] Test Set Loss:   mean=1.9798, std=2.9400
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6901960784313725, 'auc': 0.848388671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3381, std=2.3959
[DEBUG][MIA] Test Set Loss:   mean=1.8976, std=2.9226
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.098, 'auc': 0.5571280000000001, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0053
[DEBUG][MIA] Test Set Loss:   mean=0.9662, std=2.1260
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.28627450980392155, 'auc': 0.775115966796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0299, std=2.2730
[DEBUG][MIA] Test Set Loss:   mean=1.5561, std=2.9283
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.082, 'auc': 0.553208, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.5082, std=2.5868
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7176470588235294, 'auc': 0.8365478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7982, std=1.9850
[DEBUG][MIA] Test Set Loss:   mean=1.5707, std=2.5979
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.15599999999999997, 'auc': 0.597456, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1613, std=0.5814
[DEBUG][MIA] Test Set Loss:   mean=2.1147, std=3.4736
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.6509803921568628, 'auc': 0.81488037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5716, std=2.9138
[DEBUG][MIA] Test Set Loss:   mean=2.0992, std=3.2672
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.55884, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.5917, std=2.7752
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.28627450980392155, 'auc': 0.8372802734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7036, std=1.7063
[DEBUG][MIA] Test Set Loss:   mean=1.3810, std=2.6860
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.172, 'auc': 0.601472, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=0.7776, std=2.1250
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.23529411764705882, 'auc': 0.769134521484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4564, std=1.3473
[DEBUG][MIA] Test Set Loss:   mean=1.0619, std=2.5806
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.13400000000000004, 'auc': 0.57712, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.2315, std=2.2221
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2627450980392157, 'auc': 0.893951416015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6766, std=1.5355
[DEBUG][MIA] Test Set Loss:   mean=1.0728, std=2.1091
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.20600000000000002, 'auc': 0.547736, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0063
[DEBUG][MIA] Test Set Loss:   mean=0.6393, std=1.2904
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.28627450980392155, 'auc': 0.79840087890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3515, std=1.1151
[DEBUG][MIA] Test Set Loss:   mean=0.8617, std=1.9289
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.202, 'auc': 0.61972, 'task': 8}
Total correct retain:  1425  Total retain:  2500
Total correct forget:  24396  Total forget:  47500
Total correct test:  253  Total test:  500
Total correct forget test:  4262  Total test forget:  9500
After learning task 11
Task accuracies: [0.506, 0.598, 0.716, 0.642, 0.58, 0.688, 0.804, 0.694, 0.724, 0.74, 0.798, 0.18, 0.088, 0.172, 0.216, 0.124, 0.178, 0.196, 0.19, 0.196]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.997174859046936)
broken out of loop
Accuracy, Confidence: (0.23828125, 0.9985636472702026)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=31.4114, std=30.1449
[DEBUG][MIA] Test Set Loss:   mean=30.7041, std=30.3485
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.10588235294117647, 'auc': 0.5118408203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=30.9582, std=31.1464
[DEBUG][MIA] Test Set Loss:   mean=31.6973, std=33.1373
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.49888, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=34.6840, std=49.4790
[DEBUG][MIA] Test Set Loss:   mean=30.5130, std=44.2883
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10588235294117647, 'auc': 0.46954345703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=32.2885, std=49.7318
[DEBUG][MIA] Test Set Loss:   mean=38.3271, std=57.7626
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.47903999999999997, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=55.6701, std=63.1028
[DEBUG][MIA] Test Set Loss:   mean=58.4848, std=73.0089
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10196078431372549, 'auc': 0.509063720703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=62.8516, std=74.0652
[DEBUG][MIA] Test Set Loss:   mean=61.6836, std=68.0250
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.09, 'auc': 0.514424, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=78.9855, std=69.9006
[DEBUG][MIA] Test Set Loss:   mean=76.9409, std=63.6712
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09411764705882353, 'auc': 0.50189208984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=80.6584, std=67.3032
[DEBUG][MIA] Test Set Loss:   mean=86.8907, std=69.6029
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.08399999999999999, 'auc': 0.473936, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=36.0156, std=39.6110
[DEBUG][MIA] Test Set Loss:   mean=46.1061, std=52.3577
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.12941176470588234, 'auc': 0.453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=38.4281, std=44.6291
[DEBUG][MIA] Test Set Loss:   mean=40.8051, std=47.0043
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10400000000000001, 'auc': 0.5221439999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=46.6619, std=59.5877
[DEBUG][MIA] Test Set Loss:   mean=46.9098, std=58.1530
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09411764705882353, 'auc': 0.460205078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=47.7351, std=59.0257
[DEBUG][MIA] Test Set Loss:   mean=48.9083, std=57.4276
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10600000000000001, 'auc': 0.48997599999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=22.7831, std=21.8866
[DEBUG][MIA] Test Set Loss:   mean=20.7435, std=19.8735
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11764705882352941, 'auc': 0.4735107421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=20.8784, std=20.1189
[DEBUG][MIA] Test Set Loss:   mean=20.6181, std=20.3677
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.1, 'auc': 0.504712, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=37.2444, std=31.4042
[DEBUG][MIA] Test Set Loss:   mean=44.4265, std=34.7716
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.11372549019607844, 'auc': 0.44305419921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=39.5189, std=33.3282
[DEBUG][MIA] Test Set Loss:   mean=41.9197, std=34.5127
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.096, 'auc': 0.485392, 'task': 8}
Total correct retain:  502  Total retain:  2500
Total correct forget:  10548  Total forget:  47500
Total correct test:  101  Total test:  500
Total correct forget test:  2122  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.202, 0.24, 0.282, 0.208, 0.204, 0.234, 0.348, 0.236, 0.214, 0.208, 0.236, 0.194, 0.182, 0.248, 0.204, 0.212, 0.194, 0.168, 0.232, 0.2]
Unlearning task: 10
Accuracy, Confidence: (0.23828125, 0.9882753491401672)
broken out of loop
Accuracy, Confidence: (0.23828125, 0.986825704574585)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=17.3210, std=20.0137
[DEBUG][MIA] Test Set Loss:   mean=19.0172, std=21.2978
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.48687744140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=15.0090, std=17.2280
[DEBUG][MIA] Test Set Loss:   mean=16.3095, std=18.7520
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.507976, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=19.4745, std=38.6285
[DEBUG][MIA] Test Set Loss:   mean=26.1165, std=35.5782
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.12156862745098038, 'auc': 0.58233642578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=22.9158, std=29.1527
[DEBUG][MIA] Test Set Loss:   mean=27.3877, std=37.1479
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.078, 'auc': 0.5121600000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=16.9921, std=20.3407
[DEBUG][MIA] Test Set Loss:   mean=17.7886, std=19.2770
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09411764705882353, 'auc': 0.5408935546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=16.0248, std=17.9062
[DEBUG][MIA] Test Set Loss:   mean=17.2852, std=20.5216
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.098, 'auc': 0.494, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=34.5887, std=40.5951
[DEBUG][MIA] Test Set Loss:   mean=33.9672, std=41.7290
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.4913330078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=32.8562, std=46.0585
[DEBUG][MIA] Test Set Loss:   mean=34.5671, std=45.7002
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.1, 'auc': 0.5287759999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=21.9581, std=26.3009
[DEBUG][MIA] Test Set Loss:   mean=20.8485, std=31.0606
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10980392156862744, 'auc': 0.499114990234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=17.9257, std=22.3053
[DEBUG][MIA] Test Set Loss:   mean=26.6255, std=38.9184
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.098, 'auc': 0.44592, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=30.3178, std=47.7712
[DEBUG][MIA] Test Set Loss:   mean=35.2644, std=48.6586
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.07450980392156863, 'auc': 0.45574951171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=33.4245, std=45.7991
[DEBUG][MIA] Test Set Loss:   mean=35.2321, std=49.4923
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.5052719999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=20.7991, std=22.5453
[DEBUG][MIA] Test Set Loss:   mean=26.3228, std=24.7167
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10196078431372549, 'auc': 0.56475830078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=25.2248, std=24.7721
[DEBUG][MIA] Test Set Loss:   mean=27.3266, std=25.7779
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.473472, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=14.9608, std=17.8656
[DEBUG][MIA] Test Set Loss:   mean=18.2238, std=21.6459
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.11372549019607844, 'auc': 0.54296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=16.0985, std=19.6635
[DEBUG][MIA] Test Set Loss:   mean=17.9962, std=21.1914
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.096, 'auc': 0.530192, 'task': 8}
Total correct retain:  390  Total retain:  2500
Total correct forget:  10597  Total forget:  47500
Total correct test:  80  Total test:  500
Total correct forget test:  2055  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.16, 0.172, 0.326, 0.236, 0.282, 0.248, 0.34, 0.236, 0.228, 0.22, 0.278, 0.196, 0.168, 0.092, 0.246, 0.18, 0.118, 0.202, 0.142, 0.2]
Unlearning task: 9
Accuracy, Confidence: (0.2734375, 0.9403760433197021)
broken out of loop
Accuracy, Confidence: (0.25, 0.9728278517723083)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.6337, std=14.6982
[DEBUG][MIA] Test Set Loss:   mean=14.7655, std=13.1824
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10196078431372549, 'auc': 0.54132080078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=12.6876, std=14.9699
[DEBUG][MIA] Test Set Loss:   mean=13.3794, std=15.1692
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.5145120000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.7370, std=10.2296
[DEBUG][MIA] Test Set Loss:   mean=9.8272, std=10.1072
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09803921568627451, 'auc': 0.538848876953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.8606, std=14.9133
[DEBUG][MIA] Test Set Loss:   mean=9.9060, std=10.7010
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.092, 'auc': 0.501264, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.2718, std=15.3760
[DEBUG][MIA] Test Set Loss:   mean=13.5818, std=13.4647
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10196078431372549, 'auc': 0.522491455078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.6262, std=14.3890
[DEBUG][MIA] Test Set Loss:   mean=14.0593, std=13.9727
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.08, 'auc': 0.481672, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=58.4479, std=75.6654
[DEBUG][MIA] Test Set Loss:   mean=52.2544, std=62.7504
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.0784313725490196, 'auc': 0.50823974609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=52.3640, std=65.7262
[DEBUG][MIA] Test Set Loss:   mean=56.8112, std=66.6201
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.512184, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=18.5028, std=25.0449
[DEBUG][MIA] Test Set Loss:   mean=17.8518, std=24.0307
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10588235294117647, 'auc': 0.5140380859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=19.5850, std=25.9629
[DEBUG][MIA] Test Set Loss:   mean=16.6992, std=24.1583
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.11200000000000002, 'auc': 0.459024, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=23.5153, std=26.3400
[DEBUG][MIA] Test Set Loss:   mean=27.8708, std=31.1124
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09019607843137255, 'auc': 0.5430908203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=24.0170, std=27.9188
[DEBUG][MIA] Test Set Loss:   mean=26.3365, std=30.3425
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.47289600000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=27.9071, std=30.6696
[DEBUG][MIA] Test Set Loss:   mean=25.8742, std=30.9707
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09411764705882353, 'auc': 0.480743408203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=24.0917, std=28.7632
[DEBUG][MIA] Test Set Loss:   mean=25.5315, std=31.5775
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.09, 'auc': 0.49753600000000003, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=53.0544, std=72.4309
[DEBUG][MIA] Test Set Loss:   mean=54.3859, std=87.9536
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.48223876953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=56.6418, std=83.6772
[DEBUG][MIA] Test Set Loss:   mean=57.5893, std=91.8951
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10800000000000001, 'auc': 0.532384, 'task': 8}
Total correct retain:  428  Total retain:  2500
Total correct forget:  11156  Total forget:  47500
Total correct test:  93  Total test:  500
Total correct forget test:  2192  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.186, 0.232, 0.274, 0.288, 0.264, 0.288, 0.33, 0.21, 0.294, 0.152, 0.336, 0.198, 0.19, 0.166, 0.208, 0.318, 0.106, 0.176, 0.16, 0.194]
Unlearning task: 8
Accuracy, Confidence: (0.19921875, 0.9520655870437622)
broken out of loop
Accuracy, Confidence: (0.2109375, 0.9304109215736389)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.2934, std=11.2466
[DEBUG][MIA] Test Set Loss:   mean=9.4795, std=9.7011
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12549019607843137, 'auc': 0.511505126953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.8904, std=10.9326
[DEBUG][MIA] Test Set Loss:   mean=10.7531, std=11.4189
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10200000000000001, 'auc': 0.481544, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.0201, std=8.2929
[DEBUG][MIA] Test Set Loss:   mean=6.5929, std=7.3149
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09019607843137255, 'auc': 0.5015869140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.9156, std=9.5795
[DEBUG][MIA] Test Set Loss:   mean=8.1161, std=10.1711
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.118, 'auc': 0.48681599999999997, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.5104, std=9.5228
[DEBUG][MIA] Test Set Loss:   mean=10.0762, std=10.5240
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10196078431372549, 'auc': 0.49127197265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.9691, std=10.1958
[DEBUG][MIA] Test Set Loss:   mean=9.6120, std=10.1424
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.094, 'auc': 0.5125280000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=33.7991, std=47.8126
[DEBUG][MIA] Test Set Loss:   mean=32.7319, std=41.1094
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.12549019607843137, 'auc': 0.4703369140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=36.0773, std=48.0268
[DEBUG][MIA] Test Set Loss:   mean=36.2755, std=44.9731
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11400000000000002, 'auc': 0.500536, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=14.0355, std=17.7143
[DEBUG][MIA] Test Set Loss:   mean=15.0249, std=21.0755
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10196078431372549, 'auc': 0.49200439453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=13.4245, std=18.4187
[DEBUG][MIA] Test Set Loss:   mean=14.4661, std=21.6230
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.126, 'auc': 0.48828000000000005, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.6336, std=15.2692
[DEBUG][MIA] Test Set Loss:   mean=14.8465, std=17.5905
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09803921568627451, 'auc': 0.533599853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=14.1337, std=16.9682
[DEBUG][MIA] Test Set Loss:   mean=13.4886, std=16.9253
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.12, 'auc': 0.487168, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=18.4840, std=21.9841
[DEBUG][MIA] Test Set Loss:   mean=17.7354, std=23.6350
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10588235294117647, 'auc': 0.47601318359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=19.8654, std=23.8717
[DEBUG][MIA] Test Set Loss:   mean=19.4016, std=22.0816
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.50676, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=38.2459, std=57.6026
[DEBUG][MIA] Test Set Loss:   mean=37.9735, std=55.6869
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09411764705882353, 'auc': 0.507232666015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.8666, std=55.3968
[DEBUG][MIA] Test Set Loss:   mean=39.2653, std=67.9212
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10600000000000001, 'auc': 0.49832, 'task': 8}
Total correct retain:  417  Total retain:  2500
Total correct forget:  11334  Total forget:  47500
Total correct test:  83  Total test:  500
Total correct forget test:  2267  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.166, 0.24, 0.318, 0.294, 0.264, 0.312, 0.37, 0.228, 0.276, 0.148, 0.338, 0.198, 0.188, 0.168, 0.222, 0.332, 0.126, 0.168, 0.146, 0.198]
Unlearning task: 7
Accuracy, Confidence: (0.375, 0.9536488652229309)
broken out of loop
Accuracy, Confidence: (0.3671875, 0.9478299617767334)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.8756, std=5.4537
[DEBUG][MIA] Test Set Loss:   mean=4.9061, std=5.5029
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4375, 'cv_acc': 0.12156862745098038, 'auc': 0.4197998046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.0364, std=6.4932
[DEBUG][MIA] Test Set Loss:   mean=4.5420, std=5.8116
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.09, 'auc': 0.5109440000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.7774, std=9.0243
[DEBUG][MIA] Test Set Loss:   mean=6.1527, std=7.0843
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.443389892578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.9697, std=9.2592
[DEBUG][MIA] Test Set Loss:   mean=6.9363, std=8.6587
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.5112800000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.1642, std=10.1152
[DEBUG][MIA] Test Set Loss:   mean=7.9837, std=9.3027
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.50958251953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.7208, std=8.7797
[DEBUG][MIA] Test Set Loss:   mean=7.7704, std=9.3799
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.118, 'auc': 0.47923200000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.9046, std=23.1054
[DEBUG][MIA] Test Set Loss:   mean=11.3503, std=20.8682
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09411764705882353, 'auc': 0.4677734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.1477, std=18.6479
[DEBUG][MIA] Test Set Loss:   mean=8.5044, std=15.2069
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11800000000000002, 'auc': 0.519856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3545, std=6.4093
[DEBUG][MIA] Test Set Loss:   mean=5.5214, std=8.4467
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627451, 'auc': 0.485198974609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.2106, std=9.2053
[DEBUG][MIA] Test Set Loss:   mean=6.0423, std=10.5420
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.08199999999999999, 'auc': 0.49717599999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.9682, std=17.3730
[DEBUG][MIA] Test Set Loss:   mean=14.3977, std=16.9107
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.0784313725490196, 'auc': 0.480560302734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.4460, std=19.1695
[DEBUG][MIA] Test Set Loss:   mean=14.7558, std=17.9662
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.092, 'auc': 0.4942079999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8654, std=4.2521
[DEBUG][MIA] Test Set Loss:   mean=4.3552, std=6.4458
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.505706787109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7552, std=4.0271
[DEBUG][MIA] Test Set Loss:   mean=4.9660, std=7.4376
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10600000000000001, 'auc': 0.480464, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=22.5663, std=23.7924
[DEBUG][MIA] Test Set Loss:   mean=23.5371, std=30.0987
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11764705882352941, 'auc': 0.495025634765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=21.3430, std=24.6636
[DEBUG][MIA] Test Set Loss:   mean=21.4797, std=27.5943
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10600000000000001, 'auc': 0.49195199999999994, 'task': 8}
Total correct retain:  475  Total retain:  2500
Total correct forget:  11797  Total forget:  47500
Total correct test:  106  Total test:  500
Total correct forget test:  2345  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.212, 0.34, 0.342, 0.282, 0.294, 0.362, 0.342, 0.254, 0.208, 0.35, 0.278, 0.19, 0.226, 0.16, 0.216, 0.242, 0.194, 0.168, 0.094, 0.148]
Unlearning task: 6
Accuracy, Confidence: (0.36328125, 0.9097188711166382)
broken out of loop
Accuracy, Confidence: (0.1953125, 1.0)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=55.7477, std=45.7414
[DEBUG][MIA] Test Set Loss:   mean=61.6023, std=42.7566
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.11372549019607843, 'auc': 0.53485107421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=55.4079, std=43.4471
[DEBUG][MIA] Test Set Loss:   mean=58.7929, std=45.2511
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.094, 'auc': 0.5191840000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=113.0951, std=81.9039
[DEBUG][MIA] Test Set Loss:   mean=105.6345, std=83.4198
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.532135009765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=119.6033, std=96.9816
[DEBUG][MIA] Test Set Loss:   mean=123.9245, std=93.5468
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10400000000000001, 'auc': 0.48388, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=83.0881, std=66.7697
[DEBUG][MIA] Test Set Loss:   mean=84.7043, std=63.6082
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.12156862745098038, 'auc': 0.501556396484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=82.1114, std=62.3932
[DEBUG][MIA] Test Set Loss:   mean=84.3544, std=65.1312
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11399999999999999, 'auc': 0.515456, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=73.7934, std=75.8698
[DEBUG][MIA] Test Set Loss:   mean=82.3681, std=88.8783
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10196078431372549, 'auc': 0.511322021484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=86.0523, std=80.8406
[DEBUG][MIA] Test Set Loss:   mean=86.4924, std=83.3206
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10400000000000001, 'auc': 0.49855200000000005, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=702.8987, std=430.7456
[DEBUG][MIA] Test Set Loss:   mean=674.9766, std=375.5943
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09019607843137255, 'auc': 0.496673583984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=667.7394, std=392.7729
[DEBUG][MIA] Test Set Loss:   mean=666.9562, std=398.9073
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10200000000000001, 'auc': 0.49723199999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=43.3073, std=46.7684
[DEBUG][MIA] Test Set Loss:   mean=47.2727, std=50.0522
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11372549019607843, 'auc': 0.5194091796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=41.6903, std=45.2777
[DEBUG][MIA] Test Set Loss:   mean=41.8455, std=45.6760
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.094, 'auc': 0.48707200000000006, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=68.1508, std=53.9129
[DEBUG][MIA] Test Set Loss:   mean=70.7884, std=57.2033
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.51153564453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=71.0816, std=57.5343
[DEBUG][MIA] Test Set Loss:   mean=70.0006, std=54.1260
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.086, 'auc': 0.49888000000000005, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=132.9887, std=101.1878
[DEBUG][MIA] Test Set Loss:   mean=117.2985, std=97.6742
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10588235294117647, 'auc': 0.466644287109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=136.2369, std=99.8654
[DEBUG][MIA] Test Set Loss:   mean=133.5503, std=106.0707
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.478608, 'task': 8}
Total correct retain:  410  Total retain:  2500
Total correct forget:  9381  Total forget:  47500
Total correct test:  79  Total test:  500
Total correct forget test:  1878  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.158, 0.2, 0.2, 0.2, 0.2, 0.2, 0.15, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.206, 0.2]
Unlearning task: 5
Accuracy, Confidence: (0.21484375, 0.9994598031044006)
broken out of loop
Accuracy, Confidence: (0.22265625, 0.9882035851478577)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=34.8046, std=26.8699
[DEBUG][MIA] Test Set Loss:   mean=38.1046, std=30.4109
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.08235294117647059, 'auc': 0.473419189453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=33.5145, std=27.8420
[DEBUG][MIA] Test Set Loss:   mean=39.8149, std=33.3873
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11200000000000002, 'auc': 0.44928, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=77.4130, std=59.0293
[DEBUG][MIA] Test Set Loss:   mean=81.2906, std=71.1385
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.08627450980392157, 'auc': 0.504425048828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=69.3219, std=58.3461
[DEBUG][MIA] Test Set Loss:   mean=78.8174, std=65.1653
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.11200000000000002, 'auc': 0.46255999999999997, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=52.9608, std=40.3715
[DEBUG][MIA] Test Set Loss:   mean=53.5158, std=40.3516
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09019607843137255, 'auc': 0.511383056640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=48.9778, std=42.2126
[DEBUG][MIA] Test Set Loss:   mean=56.2380, std=42.3375
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.5435840000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=54.3837, std=59.8124
[DEBUG][MIA] Test Set Loss:   mean=57.7506, std=63.1716
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09411764705882353, 'auc': 0.519866943359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=48.0315, std=49.8833
[DEBUG][MIA] Test Set Loss:   mean=53.5203, std=58.6581
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.47613599999999995, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=415.5257, std=246.8765
[DEBUG][MIA] Test Set Loss:   mean=450.2427, std=295.6982
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.470672607421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=418.4485, std=278.1671
[DEBUG][MIA] Test Set Loss:   mean=428.4130, std=310.2150
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.092, 'auc': 0.49894400000000005, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=25.8187, std=29.9630
[DEBUG][MIA] Test Set Loss:   mean=28.6679, std=31.0445
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.534423828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=27.9555, std=28.5525
[DEBUG][MIA] Test Set Loss:   mean=26.6036, std=31.0895
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.08, 'auc': 0.47512, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=45.4116, std=36.2377
[DEBUG][MIA] Test Set Loss:   mean=45.7024, std=42.0986
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10980392156862746, 'auc': 0.48541259765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=43.5279, std=38.9309
[DEBUG][MIA] Test Set Loss:   mean=42.9885, std=38.1186
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.49761599999999995, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=87.4066, std=62.5177
[DEBUG][MIA] Test Set Loss:   mean=79.9342, std=68.8672
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.13725490196078433, 'auc': 0.4534912109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=86.2233, std=77.6474
[DEBUG][MIA] Test Set Loss:   mean=88.7365, std=74.8238
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.08199999999999999, 'auc': 0.5149919999999999, 'task': 8}
Total correct retain:  382  Total retain:  2500
Total correct forget:  9399  Total forget:  47500
Total correct test:  77  Total test:  500
Total correct forget test:  1882  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.154, 0.192, 0.2, 0.196, 0.2, 0.202, 0.152, 0.2, 0.198, 0.2, 0.2, 0.202, 0.196, 0.202, 0.202, 0.202, 0.2, 0.204, 0.216, 0.2]
Unlearning task: 4
Accuracy, Confidence: (0.21875, 0.9978165626525879)
broken out of loop
Accuracy, Confidence: (0.2109375, 0.9967950582504272)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=25.7714, std=20.7384
[DEBUG][MIA] Test Set Loss:   mean=30.3870, std=26.2387
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.539764404296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=27.8372, std=22.6574
[DEBUG][MIA] Test Set Loss:   mean=29.4995, std=24.8509
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.094, 'auc': 0.488888, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=65.4860, std=53.7489
[DEBUG][MIA] Test Set Loss:   mean=60.3865, std=49.6317
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.47674560546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=67.3022, std=68.2974
[DEBUG][MIA] Test Set Loss:   mean=56.1402, std=47.8945
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.098, 'auc': 0.44943999999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=37.4617, std=31.6862
[DEBUG][MIA] Test Set Loss:   mean=38.8782, std=36.0192
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.06274509803921569, 'auc': 0.49798583984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=36.9855, std=31.9724
[DEBUG][MIA] Test Set Loss:   mean=39.2614, std=31.7792
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.08199999999999999, 'auc': 0.480136, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=37.0519, std=50.7021
[DEBUG][MIA] Test Set Loss:   mean=35.1436, std=47.7725
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.1215686274509804, 'auc': 0.495086669921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=37.1219, std=45.6134
[DEBUG][MIA] Test Set Loss:   mean=36.7317, std=47.1610
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.092, 'auc': 0.497112, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=281.4932, std=195.2443
[DEBUG][MIA] Test Set Loss:   mean=329.6899, std=180.9558
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4296875, 'cv_acc': 0.09411764705882353, 'auc': 0.42572021484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=291.7207, std=243.9493
[DEBUG][MIA] Test Set Loss:   mean=301.8879, std=219.6678
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.092, 'auc': 0.5221439999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.2199, std=22.4236
[DEBUG][MIA] Test Set Loss:   mean=21.0693, std=28.4821
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.08627450980392157, 'auc': 0.5113525390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.0180, std=21.2414
[DEBUG][MIA] Test Set Loss:   mean=21.5948, std=26.3563
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.14200000000000002, 'auc': 0.48123200000000005, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=29.4525, std=27.1095
[DEBUG][MIA] Test Set Loss:   mean=34.0171, std=32.1971
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08235294117647059, 'auc': 0.47430419921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=32.5249, std=30.0611
[DEBUG][MIA] Test Set Loss:   mean=35.2768, std=31.7133
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.4761679999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=62.7920, std=46.2347
[DEBUG][MIA] Test Set Loss:   mean=64.6611, std=56.0379
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10588235294117647, 'auc': 0.49249267578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=66.6730, std=52.6680
[DEBUG][MIA] Test Set Loss:   mean=64.6868, std=56.0952
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.1, 'auc': 0.472712, 'task': 8}
Total correct retain:  345  Total retain:  2500
Total correct forget:  9431  Total forget:  47500
Total correct test:  73  Total test:  500
Total correct forget test:  1900  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.146, 0.174, 0.19, 0.19, 0.204, 0.204, 0.17, 0.2, 0.198, 0.214, 0.2, 0.206, 0.2, 0.198, 0.202, 0.214, 0.202, 0.208, 0.226, 0.2]
Unlearning task: 3
Accuracy, Confidence: (0.1640625, 0.9990980625152588)
broken out of loop
Accuracy, Confidence: (0.203125, 1.0)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=33.1198, std=41.0950
[DEBUG][MIA] Test Set Loss:   mean=35.8042, std=44.6623
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.08235294117647059, 'auc': 0.50079345703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=32.3974, std=42.2240
[DEBUG][MIA] Test Set Loss:   mean=41.2649, std=46.4397
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.442, 'cv_acc': 0.11200000000000002, 'auc': 0.44721599999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=884.7550, std=686.5090
[DEBUG][MIA] Test Set Loss:   mean=872.1777, std=748.3137
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11372549019607843, 'auc': 0.509185791015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1006.2999, std=722.9901
[DEBUG][MIA] Test Set Loss:   mean=955.5565, std=724.2971
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.086, 'auc': 0.49175199999999997, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=135.9657, std=118.5796
[DEBUG][MIA] Test Set Loss:   mean=142.3908, std=104.0770
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.09803921568627451, 'auc': 0.5360107421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=137.9863, std=117.7403
[DEBUG][MIA] Test Set Loss:   mean=137.3164, std=109.6466
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.504544, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=75.8930, std=80.7959
[DEBUG][MIA] Test Set Loss:   mean=76.0414, std=79.5304
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.13333333333333336, 'auc': 0.48931884765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=75.9035, std=82.8715
[DEBUG][MIA] Test Set Loss:   mean=82.5380, std=84.5605
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11400000000000002, 'auc': 0.517616, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1058.4270, std=707.0930
[DEBUG][MIA] Test Set Loss:   mean=1023.8234, std=662.3248
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09411764705882353, 'auc': 0.50250244140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1031.1538, std=720.3221
[DEBUG][MIA] Test Set Loss:   mean=989.7675, std=702.2380
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11399999999999999, 'auc': 0.48496799999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=397.7836, std=295.4316
[DEBUG][MIA] Test Set Loss:   mean=356.6906, std=243.7566
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.48345947265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=363.0346, std=256.9831
[DEBUG][MIA] Test Set Loss:   mean=355.2554, std=249.8231
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.098, 'auc': 0.48788, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=70.2648, std=75.0780
[DEBUG][MIA] Test Set Loss:   mean=81.4709, std=76.8595
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09019607843137255, 'auc': 0.45941162109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=85.8845, std=79.1936
[DEBUG][MIA] Test Set Loss:   mean=80.9574, std=77.3678
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.48280800000000007, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=226.7467, std=191.0377
[DEBUG][MIA] Test Set Loss:   mean=216.8500, std=171.2952
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11764705882352941, 'auc': 0.510467529296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=225.0426, std=190.1205
[DEBUG][MIA] Test Set Loss:   mean=228.0129, std=195.6074
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08399999999999999, 'auc': 0.49874399999999997, 'task': 8}
Total correct retain:  516  Total retain:  2500
Total correct forget:  9440  Total forget:  47500
Total correct test:  105  Total test:  500
Total correct forget test:  1871  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.21, 0.198, 0.224, 0.204, 0.232, 0.202, 0.206, 0.206, 0.2, 0.206, 0.2, 0.202, 0.13, 0.132, 0.196, 0.2, 0.2, 0.2, 0.2, 0.204]
Unlearning task: 2
Accuracy, Confidence: (0.19140625, 0.8980734348297119)
broken out of loop
Accuracy, Confidence: (0.22265625, 0.8770085573196411)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 8, 5, 7, 5, 5, 7, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=27.3532, std=36.6334
[DEBUG][MIA] Test Set Loss:   mean=29.9945, std=37.1556
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09803921568627451, 'auc': 0.52154541015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 5 8 5 6 9 9 5 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 5 7 8 5 8 9 6 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=30.9440, std=40.0074
[DEBUG][MIA] Test Set Loss:   mean=28.7308, std=35.6068
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.49307199999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 14, 13, 10, 11, 12, 10, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=737.4099, std=565.2334
[DEBUG][MIA] Test Set Loss:   mean=711.6485, std=607.9196
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11372549019607843, 'auc': 0.51885986328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 13 12 14 13 11 13 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 12 11 11 12 10 11 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=806.0156, std=611.1151
[DEBUG][MIA] Test Set Loss:   mean=763.6886, std=609.6823
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.500384, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 17, 15, 18, 16, 16, 17, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=103.7702, std=95.6272
[DEBUG][MIA] Test Set Loss:   mean=108.8921, std=91.2718
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10588235294117647, 'auc': 0.523956298828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 19 18 17 15 15 15 18 15 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 17 19 19 17 18 17 19 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=98.9436, std=95.7116
[DEBUG][MIA] Test Set Loss:   mean=105.7867, std=87.7715
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.09, 'auc': 0.465264, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 21, 24, 20, 23, 24, 23, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=54.1542, std=63.7813
[DEBUG][MIA] Test Set Loss:   mean=78.2135, std=75.4417
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.42578125, 'cv_acc': 0.10588235294117647, 'auc': 0.405609130859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 21 23 22 24 22 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 21 21 23 24 23 22 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=67.6376, std=67.7875
[DEBUG][MIA] Test Set Loss:   mean=64.9736, std=67.8529
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.09, 'auc': 0.488336, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 29, 27, 29, 25, 27, 28, 25, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=881.2306, std=589.2503
[DEBUG][MIA] Test Set Loss:   mean=792.0800, std=564.9043
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.486114501953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 28 29 25 26 25 25 27 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 27 28 26 25 26 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=830.9885, std=555.6277
[DEBUG][MIA] Test Set Loss:   mean=880.1183, std=551.1744
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.096, 'auc': 0.519016, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 34, 34, 32, 34, 30, 31, 32, 33, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=310.5762, std=216.3257
[DEBUG][MIA] Test Set Loss:   mean=265.2804, std=218.9377
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.08627450980392157, 'auc': 0.55426025390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 30 31 33 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 33 31 33 32 30 32 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=283.2087, std=245.7485
[DEBUG][MIA] Test Set Loss:   mean=288.2475, std=223.3777
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.5105440000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 36, 39, 39, 38, 37, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=67.7452, std=65.4928
[DEBUG][MIA] Test Set Loss:   mean=65.5104, std=67.2297
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12549019607843137, 'auc': 0.47607421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 39 36 37 36 36 35 35 39 38]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 39 35 35 38 36 35 37 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=61.6652, std=65.3623
[DEBUG][MIA] Test Set Loss:   mean=63.6366, std=64.8741
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10600000000000001, 'auc': 0.520456, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 42, 41, 43, 41, 44, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=172.7093, std=153.0105
[DEBUG][MIA] Test Set Loss:   mean=175.7381, std=149.0902
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.12156862745098038, 'auc': 0.4910888671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 40 44 44 43 43 41 40 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 43 42 42 44 42 44 42 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=187.7070, std=162.7349
[DEBUG][MIA] Test Set Loss:   mean=192.0078, std=168.7614
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.098, 'auc': 0.499152, 'task': 8}
Total correct retain:  518  Total retain:  2500
Total correct forget:  9485  Total forget:  47500
Total correct test:  102  Total test:  500
Total correct forget test:  1890  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.204, 0.228, 0.226, 0.208, 0.238, 0.208, 0.208, 0.206, 0.194, 0.202, 0.202, 0.202, 0.124, 0.118, 0.198, 0.198, 0.2, 0.2, 0.202, 0.218]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['boy', 'camel', 'caterpillar', 'shrew', 'lizard', 'mouse', 'tank', 'turtle', 'bed', 'beaver', 'television', 'computer keyboard', 'cloud', 'hamster', 'cups', 'baby', 'road', 'lamp', 'oak', 'clock', 'tiger', 'skyscraper', 'train', 'wolf', 'forest', 'tulips', 'table', 'telephone', 'aquarium fish', 'castle', 'plates', 'tractor', 'couch', 'otter', 'poppies', 'bear', 'pickup truck', 'bicycle', 'orchids', 'skunk', 'spider', 'lawn-mower', 'snail', 'mountain', 'elephant', 'bottles', 'seal', 'plain', 'sea', 'dolphin', 'bowls', 'oranges', 'snake', 'worm', 'chair', 'kangaroo', 'possum', 'whale', 'leopard', 'fox', 'pears', 'man', 'lobster', 'rocket', 'chimpanzee', 'flatfish', 'beetle', 'bridge', 'palm', 'girl', 'rabbit', 'wardrobe', 'cans', 'willow', 'crab', 'trout', 'sweet peppers', 'streetcar', 'roses', 'apples', 'raccoon', 'bus', 'porcupine', 'motorcycle', 'cattle', 'pine', 'squirrel', 'crocodile', 'bee', 'lion', 'ray', 'butterfly', 'woman', 'mushrooms', 'sunflowers', 'shark', 'dinosaur', 'maple', 'house', 'cockroach']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  1851  Total retain:  2500
Total correct forget:  9286  Total forget:  47500
Total correct test:  287  Total test:  500
Total correct forget test:  1839  Total test forget:  9500
After learning task 1
Task accuracies: [0.574, 0.194, 0.126, 0.098, 0.286, 0.3, 0.176, 0.286, 0.168, 0.204, 0.166, 0.178, 0.208, 0.184, 0.174, 0.26, 0.158, 0.174, 0.204, 0.134]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1122, std=0.4417
[DEBUG][MIA] Test Set Loss:   mean=1.8890, std=3.4345
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.28627450980392155, 'auc': 0.688720703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0764, std=0.3345
[DEBUG][MIA] Test Set Loss:   mean=1.6980, std=3.1077
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.656, 'cv_acc': 0.42000000000000004, 'auc': 0.719472, 'task': 1}
2 1
Total correct retain:  1528  Total retain:  2500
Total correct forget:  10816  Total forget:  47500
Total correct test:  263  Total test:  500
Total correct forget test:  2036  Total test forget:  9500
After learning task 2
Task accuracies: [0.526, 0.614, 0.172, 0.104, 0.272, 0.218, 0.13, 0.284, 0.154, 0.212, 0.162, 0.24, 0.168, 0.318, 0.16, 0.186, 0.13, 0.162, 0.168, 0.218]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.8430, std=2.9141
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7647058823529411, 'auc': 0.8316650390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5842, std=1.4566
[DEBUG][MIA] Test Set Loss:   mean=1.9505, std=2.8498
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.22000000000000003, 'auc': 0.666864, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0046, std=0.0296
[DEBUG][MIA] Test Set Loss:   mean=1.0464, std=2.5888
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.25098039215686274, 'auc': 0.656768798828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0260
[DEBUG][MIA] Test Set Loss:   mean=1.2294, std=2.5403
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.22599999999999998, 'auc': 0.675848, 'task': 2}
3 2
Total correct retain:  1419  Total retain:  2500
Total correct forget:  12327  Total forget:  47500
Total correct test:  252  Total test:  500
Total correct forget test:  2237  Total test forget:  9500
After learning task 3
Task accuracies: [0.504, 0.58, 0.766, 0.074, 0.192, 0.234, 0.18, 0.286, 0.15, 0.24, 0.19, 0.204, 0.142, 0.306, 0.13, 0.188, 0.156, 0.156, 0.176, 0.124]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.9604, std=2.7981
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7490196078431373, 'auc': 0.87103271484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0523, std=1.8405
[DEBUG][MIA] Test Set Loss:   mean=1.8296, std=2.6444
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.21800000000000003, 'auc': 0.605952, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=1.7552, std=3.1614
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24313725490196075, 'auc': 0.790679931640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.2606, std=0.8540
[DEBUG][MIA] Test Set Loss:   mean=1.2944, std=2.5763
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.202, 'auc': 0.688464, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0266
[DEBUG][MIA] Test Set Loss:   mean=0.9756, std=2.4177
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2, 'auc': 0.640838623046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0181, std=0.2359
[DEBUG][MIA] Test Set Loss:   mean=0.9634, std=2.4125
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.20400000000000001, 'auc': 0.658392, 'task': 3}
4 3
Total correct retain:  1377  Total retain:  2500
Total correct forget:  14391  Total forget:  47500
Total correct test:  246  Total test:  500
Total correct forget test:  2565  Total test forget:  9500
After learning task 4
Task accuracies: [0.492, 0.546, 0.712, 0.818, 0.198, 0.2, 0.232, 0.266, 0.188, 0.242, 0.204, 0.19, 0.112, 0.312, 0.154, 0.19, 0.186, 0.112, 0.158, 0.11]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.7445, std=2.6560
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7803921568627452, 'auc': 0.88360595703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2784, std=2.2905
[DEBUG][MIA] Test Set Loss:   mean=2.2810, std=3.0612
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.158, 'auc': 0.6080880000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0155
[DEBUG][MIA] Test Set Loss:   mean=1.1034, std=2.0203
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.7058823529411764, 'auc': 0.7822265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7939, std=1.9767
[DEBUG][MIA] Test Set Loss:   mean=1.4362, std=2.7213
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.16799999999999998, 'auc': 0.5563999999999999, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0299
[DEBUG][MIA] Test Set Loss:   mean=1.4756, std=2.9314
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.30588235294117644, 'auc': 0.75653076171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6934, std=1.7347
[DEBUG][MIA] Test Set Loss:   mean=1.1218, std=2.3889
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.16399999999999998, 'auc': 0.550736, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0093
[DEBUG][MIA] Test Set Loss:   mean=1.1225, std=2.5306
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2431372549019608, 'auc': 0.740509033203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0304
[DEBUG][MIA] Test Set Loss:   mean=0.9872, std=2.2370
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.252, 'auc': 0.6641279999999999, 'task': 4}
5 4
Total correct retain:  1353  Total retain:  2500
Total correct forget:  15542  Total forget:  47500
Total correct test:  234  Total test:  500
Total correct forget test:  2738  Total test forget:  9500
After learning task 5
Task accuracies: [0.468, 0.55, 0.642, 0.718, 0.764, 0.184, 0.22, 0.3, 0.206, 0.202, 0.23, 0.144, 0.124, 0.302, 0.136, 0.168, 0.212, 0.124, 0.16, 0.09]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.8992, std=2.6858
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7607843137254902, 'auc': 0.848358154296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3787, std=2.4195
[DEBUG][MIA] Test Set Loss:   mean=2.3503, std=3.3917
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.12000000000000002, 'auc': 0.5986799999999999, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0335
[DEBUG][MIA] Test Set Loss:   mean=2.5769, std=3.7611
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7254901960784315, 'auc': 0.79150390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0866, std=2.3235
[DEBUG][MIA] Test Set Loss:   mean=1.9173, std=3.0637
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.16799999999999998, 'auc': 0.58648, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=0.8780, std=2.1747
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2901960784313725, 'auc': 0.732330322265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5318, std=1.4853
[DEBUG][MIA] Test Set Loss:   mean=1.2818, std=2.4971
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.17200000000000001, 'auc': 0.5966560000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.4981, std=2.6410
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7058823529411765, 'auc': 0.772735595703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2522, std=1.0114
[DEBUG][MIA] Test Set Loss:   mean=1.5337, std=2.6490
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.22800000000000004, 'auc': 0.691064, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0359
[DEBUG][MIA] Test Set Loss:   mean=1.1157, std=2.6143
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.19215686274509808, 'auc': 0.69561767578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0668
[DEBUG][MIA] Test Set Loss:   mean=0.8589, std=2.3142
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.22199999999999998, 'auc': 0.641456, 'task': 5}
6 5
Total correct retain:  1415  Total retain:  2500
Total correct forget:  16744  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  2892  Total test forget:  9500
After learning task 6
Task accuracies: [0.516, 0.54, 0.588, 0.714, 0.648, 0.812, 0.258, 0.298, 0.156, 0.22, 0.214, 0.132, 0.134, 0.258, 0.152, 0.088, 0.168, 0.122, 0.168, 0.114]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.7001, std=2.7229
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7725490196078431, 'auc': 0.846527099609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4057, std=2.5102
[DEBUG][MIA] Test Set Loss:   mean=1.9053, std=2.8782
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10400000000000001, 'auc': 0.563768, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0299, std=0.3015
[DEBUG][MIA] Test Set Loss:   mean=1.6716, std=2.7385
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.28627450980392155, 'auc': 0.792144775390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2233, std=2.4926
[DEBUG][MIA] Test Set Loss:   mean=2.1694, std=3.4362
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.118, 'auc': 0.5612079999999999, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0115
[DEBUG][MIA] Test Set Loss:   mean=1.2577, std=2.6695
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25882352941176473, 'auc': 0.75543212890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0275, std=2.0696
[DEBUG][MIA] Test Set Loss:   mean=1.2528, std=2.4496
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.15799999999999997, 'auc': 0.531584, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=1.3445, std=2.4848
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7176470588235294, 'auc': 0.796142578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6957, std=1.4866
[DEBUG][MIA] Test Set Loss:   mean=1.6977, std=2.6958
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.188, 'auc': 0.6011120000000001, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.3627, std=2.8649
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.22745098039215686, 'auc': 0.793975830078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3214, std=1.1232
[DEBUG][MIA] Test Set Loss:   mean=1.1673, std=2.6493
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.164, 'auc': 0.603424, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.1009, std=2.3008
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.23529411764705882, 'auc': 0.682037353515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0196, std=0.1748
[DEBUG][MIA] Test Set Loss:   mean=1.2418, std=2.5495
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.23600000000000004, 'auc': 0.7383680000000001, 'task': 6}
7 6
Total correct retain:  1379  Total retain:  2500
Total correct forget:  18319  Total forget:  47500
Total correct test:  243  Total test:  500
Total correct forget test:  3270  Total test forget:  9500
After learning task 7
Task accuracies: [0.486, 0.596, 0.64, 0.702, 0.624, 0.784, 0.75, 0.344, 0.18, 0.216, 0.218, 0.176, 0.106, 0.314, 0.12, 0.072, 0.2, 0.168, 0.198, 0.132]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.1680, std=3.4919
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7372549019607842, 'auc': 0.854400634765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5788, std=2.9450
[DEBUG][MIA] Test Set Loss:   mean=2.2354, std=3.4159
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.126, 'auc': 0.585808, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0375
[DEBUG][MIA] Test Set Loss:   mean=2.0317, std=3.3720
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2941176470588235, 'auc': 0.810211181640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3058, std=2.4164
[DEBUG][MIA] Test Set Loss:   mean=1.8185, std=3.0052
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.156, 'auc': 0.550416, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.4097, std=2.5426
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2901960784313725, 'auc': 0.74884033203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9411, std=2.1795
[DEBUG][MIA] Test Set Loss:   mean=1.1034, std=2.2017
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.172, 'auc': 0.517912, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=1.9892, std=3.2270
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6862745098039216, 'auc': 0.842193603515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9032, std=1.8085
[DEBUG][MIA] Test Set Loss:   mean=1.6413, std=2.8172
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.21799999999999997, 'auc': 0.5833280000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.4191, std=2.6256
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.26666666666666666, 'auc': 0.819854736328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4774, std=1.3100
[DEBUG][MIA] Test Set Loss:   mean=1.1540, std=2.4699
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.156, 'auc': 0.563776, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.2505, std=2.5100
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25098039215686274, 'auc': 0.706451416015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3037, std=0.9857
[DEBUG][MIA] Test Set Loss:   mean=1.3109, std=2.5021
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.20800000000000002, 'auc': 0.60668, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0132, std=0.1277
[DEBUG][MIA] Test Set Loss:   mean=0.6668, std=1.7227
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.21176470588235294, 'auc': 0.753570556640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0121
[DEBUG][MIA] Test Set Loss:   mean=0.7302, std=2.0641
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.64, 'cv_acc': 0.22199999999999998, 'auc': 0.705344, 'task': 7}
8 7
Total correct retain:  1380  Total retain:  2500
Total correct forget:  19803  Total forget:  47500
Total correct test:  271  Total test:  500
Total correct forget test:  3508  Total test forget:  9500
After learning task 8
Task accuracies: [0.542, 0.6, 0.638, 0.698, 0.612, 0.724, 0.718, 0.824, 0.198, 0.202, 0.23, 0.16, 0.126, 0.28, 0.178, 0.092, 0.194, 0.18, 0.216, 0.146]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=2.5591, std=3.4515
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7843137254901961, 'auc': 0.876068115234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0755, std=3.3313
[DEBUG][MIA] Test Set Loss:   mean=2.4666, std=3.8633
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.524368, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0175
[DEBUG][MIA] Test Set Loss:   mean=1.9915, std=3.2938
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6901960784313725, 'auc': 0.846160888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2904, std=2.5817
[DEBUG][MIA] Test Set Loss:   mean=2.0428, std=3.2235
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.13399999999999998, 'auc': 0.5714319999999999, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.0094, std=1.9574
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2705882352941177, 'auc': 0.84716796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7470, std=1.6756
[DEBUG][MIA] Test Set Loss:   mean=1.2530, std=2.2383
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.13599999999999998, 'auc': 0.574984, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.9570, std=3.0938
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7490196078431373, 'auc': 0.80914306640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7721, std=1.5531
[DEBUG][MIA] Test Set Loss:   mean=1.8878, std=3.0866
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.176, 'auc': 0.603016, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.4392, std=2.5167
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2549019607843137, 'auc': 0.831146240234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5417, std=1.3036
[DEBUG][MIA] Test Set Loss:   mean=1.1175, std=2.3283
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.178, 'auc': 0.572112, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0103
[DEBUG][MIA] Test Set Loss:   mean=1.2251, std=2.3497
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7137254901960786, 'auc': 0.76513671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5540, std=1.4421
[DEBUG][MIA] Test Set Loss:   mean=1.4343, std=2.4355
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.20800000000000002, 'auc': 0.626624, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0046, std=0.0200
[DEBUG][MIA] Test Set Loss:   mean=0.9142, std=1.9927
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.29411764705882354, 'auc': 0.79150390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3477, std=1.0839
[DEBUG][MIA] Test Set Loss:   mean=1.2947, std=2.4484
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.194, 'auc': 0.6703040000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0093, std=0.0612
[DEBUG][MIA] Test Set Loss:   mean=0.9138, std=1.9247
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.20392156862745098, 'auc': 0.762542724609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0371
[DEBUG][MIA] Test Set Loss:   mean=0.8453, std=2.0800
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.252, 'auc': 0.726664, 'task': 8}
Total correct retain:  1337  Total retain:  2500
Total correct forget:  20905  Total forget:  47500
Total correct test:  251  Total test:  500
Total correct forget test:  3648  Total test forget:  9500
After learning task 9
Task accuracies: [0.502, 0.554, 0.604, 0.692, 0.6, 0.722, 0.684, 0.736, 0.792, 0.226, 0.198, 0.14, 0.112, 0.24, 0.17, 0.144, 0.162, 0.146, 0.222, 0.152]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0072
[DEBUG][MIA] Test Set Loss:   mean=2.6130, std=3.6220
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7607843137254902, 'auc': 0.86993408203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8983, std=3.3668
[DEBUG][MIA] Test Set Loss:   mean=2.7629, std=3.8375
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.126, 'auc': 0.589456, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0162
[DEBUG][MIA] Test Set Loss:   mean=1.9424, std=3.1566
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7490196078431371, 'auc': 0.803009033203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1890, std=2.1923
[DEBUG][MIA] Test Set Loss:   mean=1.8023, std=3.2145
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.188, 'auc': 0.524896, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.4869, std=2.8500
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.28627450980392155, 'auc': 0.810638427734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8609, std=1.9215
[DEBUG][MIA] Test Set Loss:   mean=1.2707, std=2.5884
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.142, 'auc': 0.542584, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0078
[DEBUG][MIA] Test Set Loss:   mean=2.0180, std=2.9584
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.807843137254902, 'auc': 0.88671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9668, std=2.1072
[DEBUG][MIA] Test Set Loss:   mean=2.0202, std=3.0625
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.17200000000000001, 'auc': 0.658496, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0240
[DEBUG][MIA] Test Set Loss:   mean=1.1856, std=2.6362
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2705882352941177, 'auc': 0.77520751953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6895, std=1.5661
[DEBUG][MIA] Test Set Loss:   mean=1.2152, std=2.6480
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.146, 'auc': 0.546408, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0053, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=1.7107, std=2.9323
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.28627450980392155, 'auc': 0.7529296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7260, std=1.8109
[DEBUG][MIA] Test Set Loss:   mean=1.5524, std=2.7529
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.196, 'auc': 0.5869920000000001, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0162
[DEBUG][MIA] Test Set Loss:   mean=1.5568, std=2.6674
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.30980392156862746, 'auc': 0.814361572265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7085, std=1.6702
[DEBUG][MIA] Test Set Loss:   mean=1.3689, std=2.4178
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.20999999999999996, 'auc': 0.6263920000000001, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.2825, std=2.4332
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2901960784313725, 'auc': 0.86627197265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1842, std=0.7334
[DEBUG][MIA] Test Set Loss:   mean=1.1975, std=2.1846
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.236, 'auc': 0.675288, 'task': 8}
Total correct retain:  1384  Total retain:  2500
Total correct forget:  21885  Total forget:  47500
Total correct test:  264  Total test:  500
Total correct forget test:  3784  Total test forget:  9500
After learning task 10
Task accuracies: [0.528, 0.556, 0.62, 0.686, 0.592, 0.71, 0.642, 0.66, 0.678, 0.798, 0.206, 0.138, 0.098, 0.22, 0.13, 0.132, 0.19, 0.162, 0.206, 0.144]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0100
[DEBUG][MIA] Test Set Loss:   mean=3.0718, std=4.0901
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7647058823529411, 'auc': 0.868377685546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2702, std=3.5457
[DEBUG][MIA] Test Set Loss:   mean=3.1434, std=4.4021
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.124, 'auc': 0.575032, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0248
[DEBUG][MIA] Test Set Loss:   mean=2.2388, std=3.3266
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7411764705882353, 'auc': 0.818695068359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7695, std=3.0503
[DEBUG][MIA] Test Set Loss:   mean=2.5120, std=3.8601
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10800000000000001, 'auc': 0.554416, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0067
[DEBUG][MIA] Test Set Loss:   mean=1.8115, std=3.1499
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6980392156862745, 'auc': 0.755096435546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3050, std=2.6140
[DEBUG][MIA] Test Set Loss:   mean=1.4677, std=2.9066
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.17400000000000002, 'auc': 0.516848, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0053, std=0.0165
[DEBUG][MIA] Test Set Loss:   mean=2.3567, std=3.4417
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7411764705882353, 'auc': 0.876678466796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2249, std=2.1338
[DEBUG][MIA] Test Set Loss:   mean=2.0924, std=3.3032
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.184, 'auc': 0.5870960000000001, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.6619, std=2.9688
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7137254901960784, 'auc': 0.830810546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7639, std=2.0105
[DEBUG][MIA] Test Set Loss:   mean=1.9752, std=3.0388
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.12800000000000003, 'auc': 0.628704, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.3352, std=2.5766
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2980392156862745, 'auc': 0.78631591796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8811, std=2.1718
[DEBUG][MIA] Test Set Loss:   mean=1.5633, std=2.7331
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.144, 'auc': 0.5984, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0073, std=0.0419
[DEBUG][MIA] Test Set Loss:   mean=1.5412, std=2.3416
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.6784313725490195, 'auc': 0.84454345703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0332, std=2.1643
[DEBUG][MIA] Test Set Loss:   mean=1.4848, std=2.6235
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.16199999999999998, 'auc': 0.598064, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.4014, std=2.5068
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7568627450980392, 'auc': 0.822845458984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4494, std=1.1186
[DEBUG][MIA] Test Set Loss:   mean=1.4234, std=2.2959
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.21600000000000003, 'auc': 0.6832560000000001, 'task': 8}
Total correct retain:  1249  Total retain:  2500
Total correct forget:  22959  Total forget:  47500
Total correct test:  238  Total test:  500
Total correct forget test:  3928  Total test forget:  9500
After learning task 11
Task accuracies: [0.476, 0.524, 0.588, 0.662, 0.56, 0.65, 0.682, 0.622, 0.612, 0.744, 0.752, 0.172, 0.118, 0.234, 0.092, 0.104, 0.2, 0.178, 0.186, 0.176]
Unlearning task: 11
Accuracy, Confidence: (0.99609375, 0.9876097440719604)
broken out of loop
Accuracy, Confidence: (0.21875, 0.9949148297309875)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=45.2897, std=77.9861
[DEBUG][MIA] Test Set Loss:   mean=47.4994, std=75.3312
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10980392156862746, 'auc': 0.4583740234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=56.8841, std=114.3992
[DEBUG][MIA] Test Set Loss:   mean=50.9047, std=81.7687
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10200000000000001, 'auc': 0.52784, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=51.9050, std=108.8528
[DEBUG][MIA] Test Set Loss:   mean=58.9548, std=99.7078
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.506683349609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=57.9848, std=118.3436
[DEBUG][MIA] Test Set Loss:   mean=59.1582, std=107.6403
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11400000000000002, 'auc': 0.517184, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=60.5114, std=100.7349
[DEBUG][MIA] Test Set Loss:   mean=66.1124, std=123.1949
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11372549019607843, 'auc': 0.4649658203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=56.4335, std=92.9837
[DEBUG][MIA] Test Set Loss:   mean=67.2613, std=128.5021
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.08399999999999999, 'auc': 0.504848, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=34.6273, std=53.2097
[DEBUG][MIA] Test Set Loss:   mean=44.4936, std=70.5625
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.08627450980392157, 'auc': 0.5277099609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=34.2263, std=54.1583
[DEBUG][MIA] Test Set Loss:   mean=44.5526, std=79.3494
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.496312, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=44.5711, std=68.9111
[DEBUG][MIA] Test Set Loss:   mean=32.1985, std=58.9898
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.14509803921568626, 'auc': 0.458740234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=46.9860, std=76.1789
[DEBUG][MIA] Test Set Loss:   mean=35.9023, std=57.9707
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.086, 'auc': 0.518656, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=56.7487, std=108.5396
[DEBUG][MIA] Test Set Loss:   mean=77.6950, std=163.9765
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.10196078431372549, 'auc': 0.55499267578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=70.0267, std=114.2117
[DEBUG][MIA] Test Set Loss:   mean=70.0162, std=137.0324
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.5370879999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=29.4999, std=44.2029
[DEBUG][MIA] Test Set Loss:   mean=32.8917, std=57.8288
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.08235294117647059, 'auc': 0.502044677734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=37.2431, std=53.2997
[DEBUG][MIA] Test Set Loss:   mean=33.7884, std=48.7783
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11000000000000001, 'auc': 0.48342399999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=26.4476, std=53.9234
[DEBUG][MIA] Test Set Loss:   mean=28.1357, std=50.6871
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09803921568627451, 'auc': 0.501953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=32.2933, std=81.1757
[DEBUG][MIA] Test Set Loss:   mean=25.2890, std=46.9259
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.098, 'auc': 0.5458160000000001, 'task': 8}
Total correct retain:  450  Total retain:  2500
Total correct forget:  10027  Total forget:  47500
Total correct test:  107  Total test:  500
Total correct forget test:  2012  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.214, 0.23, 0.202, 0.218, 0.154, 0.252, 0.136, 0.274, 0.3, 0.206, 0.212, 0.24, 0.222, 0.22, 0.16, 0.192, 0.202, 0.156, 0.198, 0.25]
Unlearning task: 10
Accuracy, Confidence: (0.2265625, 0.8949771523475647)
broken out of loop
Accuracy, Confidence: (0.21484375, 0.8863248229026794)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=25.9233, std=48.6781
[DEBUG][MIA] Test Set Loss:   mean=26.8370, std=50.1300
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10980392156862746, 'auc': 0.505828857421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=31.5052, std=62.4627
[DEBUG][MIA] Test Set Loss:   mean=25.7376, std=54.3883
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.1, 'auc': 0.486632, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=46.3248, std=93.5664
[DEBUG][MIA] Test Set Loss:   mean=40.3346, std=74.8739
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.11372549019607843, 'auc': 0.428466796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=36.1906, std=73.0293
[DEBUG][MIA] Test Set Loss:   mean=41.4748, std=70.1808
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.09, 'auc': 0.5311520000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=31.7416, std=54.1881
[DEBUG][MIA] Test Set Loss:   mean=39.7066, std=70.8136
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.49639892578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=32.7084, std=64.6903
[DEBUG][MIA] Test Set Loss:   mean=37.9751, std=66.1342
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10600000000000001, 'auc': 0.509392, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=17.7067, std=27.7492
[DEBUG][MIA] Test Set Loss:   mean=18.5437, std=33.4246
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.52313232421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=19.0918, std=33.5281
[DEBUG][MIA] Test Set Loss:   mean=24.7899, std=43.6364
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.09, 'auc': 0.505504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.5845, std=25.4057
[DEBUG][MIA] Test Set Loss:   mean=22.1694, std=31.8971
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.09803921568627451, 'auc': 0.4644775390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=20.9255, std=36.7725
[DEBUG][MIA] Test Set Loss:   mean=20.3250, std=39.4753
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.098, 'auc': 0.5009520000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=35.0496, std=52.7535
[DEBUG][MIA] Test Set Loss:   mean=59.9325, std=119.2700
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.10196078431372549, 'auc': 0.43853759765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=43.5383, std=65.2253
[DEBUG][MIA] Test Set Loss:   mean=49.2321, std=85.9527
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10400000000000001, 'auc': 0.48751200000000006, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.2610, std=23.0927
[DEBUG][MIA] Test Set Loss:   mean=18.1223, std=24.6465
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10980392156862746, 'auc': 0.533599853515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=20.5596, std=33.2491
[DEBUG][MIA] Test Set Loss:   mean=17.6471, std=29.3953
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.094, 'auc': 0.533856, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.6853, std=22.6907
[DEBUG][MIA] Test Set Loss:   mean=17.5651, std=30.9295
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09803921568627451, 'auc': 0.499664306640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=19.5015, std=33.2777
[DEBUG][MIA] Test Set Loss:   mean=17.8542, std=30.2616
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.132, 'auc': 0.482256, 'task': 8}
Total correct retain:  466  Total retain:  2500
Total correct forget:  10238  Total forget:  47500
Total correct test:  103  Total test:  500
Total correct forget test:  2053  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.206, 0.248, 0.204, 0.218, 0.168, 0.252, 0.126, 0.32, 0.29, 0.206, 0.23, 0.254, 0.258, 0.216, 0.17, 0.192, 0.168, 0.138, 0.194, 0.254]
Unlearning task: 9
Accuracy, Confidence: (0.265625, 0.9542486667633057)
broken out of loop
Accuracy, Confidence: (0.265625, 0.9417836666107178)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=16.4016, std=29.4204
[DEBUG][MIA] Test Set Loss:   mean=15.9785, std=31.3556
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.12549019607843137, 'auc': 0.495635986328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=18.8459, std=42.5751
[DEBUG][MIA] Test Set Loss:   mean=18.0788, std=37.9259
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.094, 'auc': 0.528232, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=25.0204, std=41.6709
[DEBUG][MIA] Test Set Loss:   mean=26.0975, std=40.7932
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10588235294117647, 'auc': 0.494720458984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=24.4027, std=50.9693
[DEBUG][MIA] Test Set Loss:   mean=22.8840, std=42.2463
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10400000000000001, 'auc': 0.505104, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=21.7895, std=37.5368
[DEBUG][MIA] Test Set Loss:   mean=31.8067, std=60.9378
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10588235294117647, 'auc': 0.529205322265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=23.4702, std=40.2052
[DEBUG][MIA] Test Set Loss:   mean=24.7155, std=43.1789
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.096, 'auc': 0.503944, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=16.7666, std=26.7292
[DEBUG][MIA] Test Set Loss:   mean=17.1538, std=31.2763
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.13333333333333333, 'auc': 0.4654541015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.1023, std=23.0017
[DEBUG][MIA] Test Set Loss:   mean=15.4680, std=26.7273
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.537472, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.4792, std=15.2273
[DEBUG][MIA] Test Set Loss:   mean=14.9558, std=21.5445
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.09803921568627451, 'auc': 0.459716796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=12.8484, std=24.8479
[DEBUG][MIA] Test Set Loss:   mean=15.2821, std=24.6462
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.098, 'auc': 0.5475599999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=30.7941, std=47.8337
[DEBUG][MIA] Test Set Loss:   mean=34.9504, std=70.9212
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.1215686274509804, 'auc': 0.52764892578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=32.4118, std=52.6377
[DEBUG][MIA] Test Set Loss:   mean=29.8483, std=56.1969
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.094, 'auc': 0.44397600000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.8275, std=11.4950
[DEBUG][MIA] Test Set Loss:   mean=10.2461, std=13.1797
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.07058823529411765, 'auc': 0.5257568359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.6956, std=18.0825
[DEBUG][MIA] Test Set Loss:   mean=11.6705, std=17.4817
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.086, 'auc': 0.504224, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.0865, std=24.7010
[DEBUG][MIA] Test Set Loss:   mean=13.3846, std=22.3906
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.08627450980392157, 'auc': 0.48028564453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.8829, std=19.2423
[DEBUG][MIA] Test Set Loss:   mean=13.3149, std=20.6603
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.11000000000000001, 'auc': 0.45572, 'task': 8}
Total correct retain:  485  Total retain:  2500
Total correct forget:  10417  Total forget:  47500
Total correct test:  106  Total test:  500
Total correct forget test:  2073  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.212, 0.234, 0.202, 0.228, 0.17, 0.258, 0.136, 0.326, 0.294, 0.208, 0.232, 0.266, 0.262, 0.234, 0.158, 0.198, 0.176, 0.138, 0.18, 0.246]
Unlearning task: 8
Accuracy, Confidence: (0.30078125, 0.8548073768615723)
broken out of loop
Accuracy, Confidence: (0.3515625, 0.8117377758026123)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.3466, std=24.8831
[DEBUG][MIA] Test Set Loss:   mean=12.5229, std=21.2043
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.561187744140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.5257, std=23.3523
[DEBUG][MIA] Test Set Loss:   mean=12.7788, std=27.3664
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.442, 'cv_acc': 0.12, 'auc': 0.462872, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=23.7407, std=55.1537
[DEBUG][MIA] Test Set Loss:   mean=20.8000, std=33.7481
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.530029296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.2035, std=28.9444
[DEBUG][MIA] Test Set Loss:   mean=19.3111, std=32.7810
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.08199999999999999, 'auc': 0.521408, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.5420, std=23.1803
[DEBUG][MIA] Test Set Loss:   mean=19.1703, std=32.7110
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10196078431372549, 'auc': 0.53741455078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.2902, std=20.5984
[DEBUG][MIA] Test Set Loss:   mean=17.8826, std=35.8648
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10400000000000001, 'auc': 0.51088, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.1613, std=11.5654
[DEBUG][MIA] Test Set Loss:   mean=12.0984, std=19.1587
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.11764705882352941, 'auc': 0.48046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.1772, std=12.6676
[DEBUG][MIA] Test Set Loss:   mean=11.0214, std=18.0312
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.128, 'auc': 0.519856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.2100, std=13.4787
[DEBUG][MIA] Test Set Loss:   mean=7.7219, std=11.8226
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10980392156862746, 'auc': 0.479248046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=13.0835, std=21.0023
[DEBUG][MIA] Test Set Loss:   mean=8.6855, std=13.4735
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.096, 'auc': 0.46104799999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.5920, std=29.6182
[DEBUG][MIA] Test Set Loss:   mean=21.8009, std=35.8874
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09803921568627451, 'auc': 0.5433349609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=21.7913, std=26.0436
[DEBUG][MIA] Test Set Loss:   mean=24.2085, std=45.7041
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10600000000000001, 'auc': 0.472032, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9911, std=9.8630
[DEBUG][MIA] Test Set Loss:   mean=6.6070, std=9.7398
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.1411764705882353, 'auc': 0.534210205078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.7180, std=14.6894
[DEBUG][MIA] Test Set Loss:   mean=7.9488, std=12.2309
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10400000000000001, 'auc': 0.46903999999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.7321, std=18.1502
[DEBUG][MIA] Test Set Loss:   mean=12.1600, std=17.3918
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11764705882352941, 'auc': 0.49749755859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.3456, std=30.7101
[DEBUG][MIA] Test Set Loss:   mean=9.8710, std=12.9213
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.13599999999999998, 'auc': 0.47584000000000004, 'task': 8}
Total correct retain:  535  Total retain:  2500
Total correct forget:  10576  Total forget:  47500
Total correct test:  112  Total test:  500
Total correct forget test:  2146  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.224, 0.226, 0.178, 0.254, 0.188, 0.27, 0.148, 0.35, 0.3, 0.232, 0.238, 0.278, 0.246, 0.234, 0.164, 0.202, 0.196, 0.15, 0.186, 0.252]
Unlearning task: 7
Accuracy, Confidence: (0.15234375, 0.9618398547172546)
broken out of loop
Accuracy, Confidence: (0.15234375, 0.9430354237556458)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.7786, std=21.2559
[DEBUG][MIA] Test Set Loss:   mean=10.0758, std=19.8150
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.476715087890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.6389, std=20.1985
[DEBUG][MIA] Test Set Loss:   mean=8.7357, std=17.6186
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.481456, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=14.8544, std=33.4436
[DEBUG][MIA] Test Set Loss:   mean=12.6647, std=19.4367
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.08627450980392157, 'auc': 0.509002685546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=12.4887, std=24.1938
[DEBUG][MIA] Test Set Loss:   mean=14.4652, std=22.1813
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.1, 'auc': 0.5527120000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.5494, std=14.2142
[DEBUG][MIA] Test Set Loss:   mean=10.9437, std=20.7637
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09019607843137255, 'auc': 0.486724853515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.2675, std=19.5281
[DEBUG][MIA] Test Set Loss:   mean=13.9565, std=26.0715
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.124, 'auc': 0.5061359999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.4124, std=10.6748
[DEBUG][MIA] Test Set Loss:   mean=7.5876, std=10.4217
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.15686274509803919, 'auc': 0.543701171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3017, std=5.9535
[DEBUG][MIA] Test Set Loss:   mean=7.6411, std=11.8671
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.48209599999999997, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.5459, std=9.0902
[DEBUG][MIA] Test Set Loss:   mean=8.4810, std=13.0575
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10196078431372549, 'auc': 0.547515869140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.9470, std=12.3398
[DEBUG][MIA] Test Set Loss:   mean=7.0611, std=11.3426
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.096, 'auc': 0.536456, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=16.5515, std=24.3789
[DEBUG][MIA] Test Set Loss:   mean=23.0625, std=41.0558
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09019607843137255, 'auc': 0.4759521484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.3303, std=26.3850
[DEBUG][MIA] Test Set Loss:   mean=20.0011, std=37.9287
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.088, 'auc': 0.471456, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4778, std=5.9694
[DEBUG][MIA] Test Set Loss:   mean=6.1197, std=10.0420
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10980392156862744, 'auc': 0.5341796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3679, std=6.9398
[DEBUG][MIA] Test Set Loss:   mean=5.6191, std=8.3770
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.50844, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9847, std=11.8170
[DEBUG][MIA] Test Set Loss:   mean=9.6876, std=12.3344
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10980392156862746, 'auc': 0.430328369140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.8345, std=10.4870
[DEBUG][MIA] Test Set Loss:   mean=8.7346, std=12.3531
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11200000000000002, 'auc': 0.4956399999999999, 'task': 8}
Total correct retain:  590  Total retain:  2500
Total correct forget:  10640  Total forget:  47500
Total correct test:  115  Total test:  500
Total correct forget test:  2108  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.23, 0.226, 0.162, 0.244, 0.204, 0.27, 0.154, 0.322, 0.282, 0.244, 0.228, 0.286, 0.264, 0.238, 0.15, 0.214, 0.158, 0.15, 0.172, 0.248]
Unlearning task: 6
Accuracy, Confidence: (0.265625, 0.8832542896270752)
broken out of loop
Accuracy, Confidence: (0.27734375, 0.8695142269134521)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.6212, std=10.5841
[DEBUG][MIA] Test Set Loss:   mean=7.3405, std=11.8808
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10980392156862746, 'auc': 0.474365234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.2603, std=15.8987
[DEBUG][MIA] Test Set Loss:   mean=6.9350, std=13.3863
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.078, 'auc': 0.5009759999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=14.2248, std=27.8860
[DEBUG][MIA] Test Set Loss:   mean=10.5904, std=16.3300
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.08627450980392157, 'auc': 0.474212646484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.5491, std=19.0656
[DEBUG][MIA] Test Set Loss:   mean=11.5369, std=16.3250
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.09, 'auc': 0.545832, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8814, std=9.1074
[DEBUG][MIA] Test Set Loss:   mean=11.0439, std=19.1906
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.10196078431372549, 'auc': 0.582275390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.3441, std=11.8441
[DEBUG][MIA] Test Set Loss:   mean=10.4951, std=18.7549
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.088, 'auc': 0.5135200000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.6761, std=6.6341
[DEBUG][MIA] Test Set Loss:   mean=6.5512, std=8.2286
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.509033203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.1063, std=7.0484
[DEBUG][MIA] Test Set Loss:   mean=5.4443, std=7.4439
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.10800000000000001, 'auc': 0.444464, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.7840, std=7.0455
[DEBUG][MIA] Test Set Loss:   mean=6.4910, std=9.9349
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11764705882352941, 'auc': 0.5047607421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.7822, std=7.8926
[DEBUG][MIA] Test Set Loss:   mean=5.8925, std=8.4690
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.1, 'auc': 0.49027200000000004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.1832, std=18.9944
[DEBUG][MIA] Test Set Loss:   mean=16.7719, std=25.7640
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.49859619140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.9700, std=18.7155
[DEBUG][MIA] Test Set Loss:   mean=14.0430, std=18.8036
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10200000000000001, 'auc': 0.507904, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.9639, std=4.2411
[DEBUG][MIA] Test Set Loss:   mean=3.8790, std=5.1126
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09803921568627451, 'auc': 0.42303466796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.4324, std=7.0647
[DEBUG][MIA] Test Set Loss:   mean=4.4636, std=6.3050
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.08199999999999999, 'auc': 0.5302479999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9032, std=9.9354
[DEBUG][MIA] Test Set Loss:   mean=8.1772, std=11.6176
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.12156862745098038, 'auc': 0.49737548828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9299, std=9.8565
[DEBUG][MIA] Test Set Loss:   mean=7.6092, std=8.1013
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.49992800000000004, 'task': 8}
Total correct retain:  621  Total retain:  2500
Total correct forget:  10691  Total forget:  47500
Total correct test:  125  Total test:  500
Total correct forget test:  2097  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.25, 0.24, 0.156, 0.262, 0.204, 0.256, 0.142, 0.314, 0.26, 0.268, 0.234, 0.296, 0.262, 0.246, 0.134, 0.216, 0.148, 0.15, 0.164, 0.242]
Unlearning task: 5
Accuracy, Confidence: (0.19140625, 0.706413745880127)
broken out of loop
Accuracy, Confidence: (0.20703125, 0.6920973062515259)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.1172, std=14.7655
[DEBUG][MIA] Test Set Loss:   mean=6.6675, std=10.9095
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10588235294117647, 'auc': 0.45050048828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.9195, std=15.0268
[DEBUG][MIA] Test Set Loss:   mean=6.2447, std=11.3372
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.1, 'auc': 0.53016, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.3922, std=19.1239
[DEBUG][MIA] Test Set Loss:   mean=11.0377, std=15.8554
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11372549019607843, 'auc': 0.46466064453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.8439, std=13.7519
[DEBUG][MIA] Test Set Loss:   mean=9.5028, std=13.7312
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.076, 'auc': 0.53576, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2291, std=7.9554
[DEBUG][MIA] Test Set Loss:   mean=7.3452, std=14.3335
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.13725490196078433, 'auc': 0.515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.8742, std=13.7841
[DEBUG][MIA] Test Set Loss:   mean=8.9163, std=15.1642
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11200000000000002, 'auc': 0.495032, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2400, std=5.9279
[DEBUG][MIA] Test Set Loss:   mean=5.3080, std=5.9618
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.51312255859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.0640, std=5.5884
[DEBUG][MIA] Test Set Loss:   mean=5.1585, std=6.1794
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.48984, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.0217, std=6.4494
[DEBUG][MIA] Test Set Loss:   mean=6.2669, std=9.3167
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.09411764705882353, 'auc': 0.5467529296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7236, std=5.8140
[DEBUG][MIA] Test Set Loss:   mean=5.4791, std=6.9745
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12000000000000002, 'auc': 0.5457919999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.6604, std=13.6278
[DEBUG][MIA] Test Set Loss:   mean=12.4544, std=14.1685
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.0784313725490196, 'auc': 0.51312255859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.5986, std=16.8532
[DEBUG][MIA] Test Set Loss:   mean=14.4089, std=23.1372
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.49869600000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4063, std=3.6844
[DEBUG][MIA] Test Set Loss:   mean=3.9323, std=6.0329
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11764705882352944, 'auc': 0.5054931640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.3124, std=6.1086
[DEBUG][MIA] Test Set Loss:   mean=4.3599, std=6.0648
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.1, 'auc': 0.500144, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.4387, std=8.1248
[DEBUG][MIA] Test Set Loss:   mean=7.7263, std=8.3544
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.1450980392156863, 'auc': 0.4951171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5623, std=6.9597
[DEBUG][MIA] Test Set Loss:   mean=7.4417, std=9.8660
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.5234639999999999, 'task': 8}
Total correct retain:  644  Total retain:  2500
Total correct forget:  10780  Total forget:  47500
Total correct test:  127  Total test:  500
Total correct forget test:  2096  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.254, 0.244, 0.164, 0.28, 0.2, 0.254, 0.148, 0.31, 0.254, 0.264, 0.23, 0.304, 0.258, 0.256, 0.12, 0.212, 0.148, 0.156, 0.158, 0.232]
Unlearning task: 4
Accuracy, Confidence: (0.2734375, 0.8356858491897583)
broken out of loop
Accuracy, Confidence: (0.30078125, 0.834348201751709)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.1282, std=9.3157
[DEBUG][MIA] Test Set Loss:   mean=6.9768, std=12.7976
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10196078431372549, 'auc': 0.51898193359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.2635, std=14.7481
[DEBUG][MIA] Test Set Loss:   mean=6.5367, std=11.2607
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.5145439999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.6608, std=21.0960
[DEBUG][MIA] Test Set Loss:   mean=8.9280, std=11.8446
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10196078431372549, 'auc': 0.530487060546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.3035, std=10.6811
[DEBUG][MIA] Test Set Loss:   mean=9.1350, std=13.3766
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.08399999999999999, 'auc': 0.5025999999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.6206, std=10.0683
[DEBUG][MIA] Test Set Loss:   mean=8.3900, std=12.5600
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.13725490196078433, 'auc': 0.53656005859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9826, std=10.9496
[DEBUG][MIA] Test Set Loss:   mean=7.8473, std=13.4488
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.126, 'auc': 0.548096, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.4481, std=4.8927
[DEBUG][MIA] Test Set Loss:   mean=4.9970, std=5.7894
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09803921568627451, 'auc': 0.529052734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.2984, std=3.7982
[DEBUG][MIA] Test Set Loss:   mean=5.1223, std=6.0235
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.096, 'auc': 0.491648, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.9061, std=4.6857
[DEBUG][MIA] Test Set Loss:   mean=5.1454, std=5.8109
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.12156862745098038, 'auc': 0.4390869140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.6547, std=8.0914
[DEBUG][MIA] Test Set Loss:   mean=5.2554, std=7.4462
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10200000000000001, 'auc': 0.48361600000000005, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.6434, std=13.5731
[DEBUG][MIA] Test Set Loss:   mean=12.2509, std=23.9556
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10980392156862746, 'auc': 0.4761962890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.0943, std=17.0855
[DEBUG][MIA] Test Set Loss:   mean=13.1017, std=23.9030
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.098, 'auc': 0.46311199999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0674, std=3.3969
[DEBUG][MIA] Test Set Loss:   mean=4.0504, std=4.0143
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.13725490196078433, 'auc': 0.57177734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5553, std=6.1593
[DEBUG][MIA] Test Set Loss:   mean=3.6144, std=4.7252
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.1, 'auc': 0.458128, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.7930, std=7.3926
[DEBUG][MIA] Test Set Loss:   mean=6.2389, std=6.5510
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.08235294117647059, 'auc': 0.42340087890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2662, std=7.1178
[DEBUG][MIA] Test Set Loss:   mean=6.4579, std=6.2914
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.46516799999999997, 'task': 8}
Total correct retain:  695  Total retain:  2500
Total correct forget:  10797  Total forget:  47500
Total correct test:  137  Total test:  500
Total correct forget test:  2111  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.274, 0.248, 0.164, 0.286, 0.194, 0.252, 0.16, 0.306, 0.252, 0.268, 0.238, 0.308, 0.262, 0.264, 0.11, 0.206, 0.144, 0.162, 0.16, 0.238]
Unlearning task: 3
Accuracy, Confidence: (0.1875, 0.8450340032577515)
broken out of loop
Accuracy, Confidence: (0.1875, 0.8300524353981018)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4999, std=10.2800
[DEBUG][MIA] Test Set Loss:   mean=6.0812, std=9.5532
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.11372549019607844, 'auc': 0.48541259765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.5694, std=9.6606
[DEBUG][MIA] Test Set Loss:   mean=5.7364, std=9.8757
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.09, 'auc': 0.48974399999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.0503, std=14.7440
[DEBUG][MIA] Test Set Loss:   mean=8.9912, std=12.4977
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10196078431372549, 'auc': 0.48443603515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.9582, std=10.8469
[DEBUG][MIA] Test Set Loss:   mean=8.6801, std=12.0458
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.1, 'auc': 0.511504, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.9575, std=7.1061
[DEBUG][MIA] Test Set Loss:   mean=6.1110, std=10.8787
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.08235294117647059, 'auc': 0.51922607421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.0603, std=10.6220
[DEBUG][MIA] Test Set Loss:   mean=6.7390, std=10.5000
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.08199999999999999, 'auc': 0.523952, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.3238, std=4.2055
[DEBUG][MIA] Test Set Loss:   mean=4.2277, std=4.1863
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.49029541015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.2402, std=4.1817
[DEBUG][MIA] Test Set Loss:   mean=4.4644, std=4.8772
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.096, 'auc': 0.490576, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.9244, std=4.1160
[DEBUG][MIA] Test Set Loss:   mean=5.0634, std=5.5112
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.11764705882352941, 'auc': 0.4306640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1326, std=5.7837
[DEBUG][MIA] Test Set Loss:   mean=4.5591, std=5.2563
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.094, 'auc': 0.540216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.6808, std=12.0893
[DEBUG][MIA] Test Set Loss:   mean=12.7698, std=15.2156
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09411764705882353, 'auc': 0.5474853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.3134, std=12.1491
[DEBUG][MIA] Test Set Loss:   mean=11.2384, std=14.7234
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11200000000000002, 'auc': 0.513248, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0791, std=3.4336
[DEBUG][MIA] Test Set Loss:   mean=3.6299, std=5.6371
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.1450980392156863, 'auc': 0.517333984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.2889, std=3.6275
[DEBUG][MIA] Test Set Loss:   mean=3.4100, std=3.8048
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10800000000000001, 'auc': 0.515856, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5112, std=6.8334
[DEBUG][MIA] Test Set Loss:   mean=7.2443, std=10.8768
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10980392156862744, 'auc': 0.48760986328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.4445, std=6.3894
[DEBUG][MIA] Test Set Loss:   mean=6.8281, std=10.1669
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.098, 'auc': 0.514288, 'task': 8}
Total correct retain:  725  Total retain:  2500
Total correct forget:  10888  Total forget:  47500
Total correct test:  137  Total test:  500
Total correct forget test:  2103  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.274, 0.252, 0.18, 0.288, 0.19, 0.246, 0.17, 0.298, 0.244, 0.274, 0.244, 0.306, 0.25, 0.258, 0.102, 0.206, 0.14, 0.152, 0.168, 0.238]
Unlearning task: 2
Accuracy, Confidence: (0.26171875, 0.8189011216163635)
broken out of loop
Accuracy, Confidence: (0.265625, 0.802718997001648)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 7, 8, 6, 6, 5, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6846, std=9.8709
[DEBUG][MIA] Test Set Loss:   mean=5.3901, std=7.4664
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09019607843137255, 'auc': 0.51953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 9 7 9 9 6 8 5 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 5 6 5 9 9 9 7 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.8032, std=9.4113
[DEBUG][MIA] Test Set Loss:   mean=4.9997, std=8.4144
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.096, 'auc': 0.523216, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([14, 11, 12, 12, 11, 12, 14, 14, 12, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.6080, std=15.1555
[DEBUG][MIA] Test Set Loss:   mean=6.3059, std=7.0645
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11372549019607843, 'auc': 0.48577880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 12 10 10 12 10 10 14 13 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 13 14 13 11 12 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.8905, std=10.4417
[DEBUG][MIA] Test Set Loss:   mean=6.4180, std=6.8455
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10400000000000001, 'auc': 0.550624, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 16, 17, 16, 16, 17, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.7774, std=6.0161
[DEBUG][MIA] Test Set Loss:   mean=6.8273, std=9.2588
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.08235294117647059, 'auc': 0.5667724609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 19 16 18 17 16 15 16 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 15 18 19 19 18 18 17 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.4454, std=8.0150
[DEBUG][MIA] Test Set Loss:   mean=6.1871, std=9.5350
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11000000000000001, 'auc': 0.501376, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 23, 24, 24, 24, 20, 22, 21, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.9890, std=3.5479
[DEBUG][MIA] Test Set Loss:   mean=4.1475, std=4.0767
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.08627450980392157, 'auc': 0.49700927734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 23 23 21 22 23 24 20 21 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 21 22 23 21 21 24 23 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6022, std=2.9590
[DEBUG][MIA] Test Set Loss:   mean=4.0941, std=4.2335
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.515776, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 25, 25, 29, 25, 28, 27, 26, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.0104, std=4.1827
[DEBUG][MIA] Test Set Loss:   mean=4.2515, std=5.0831
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.12941176470588237, 'auc': 0.517333984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 29 26 29 26 25 26 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 25 29 25 28 28 26 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.4244, std=5.2948
[DEBUG][MIA] Test Set Loss:   mean=4.7939, std=5.9943
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11000000000000001, 'auc': 0.49040799999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 32, 32, 30, 30, 31, 34, 34, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.8707, std=12.2937
[DEBUG][MIA] Test Set Loss:   mean=10.6024, std=19.7695
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.15294117647058822, 'auc': 0.45611572265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 33 31 31 33 30 34 32 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 32 31 31 33 34 34 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.6211, std=11.3439
[DEBUG][MIA] Test Set Loss:   mean=10.2895, std=12.7586
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.086, 'auc': 0.520544, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 38, 37, 39, 36, 38, 35, 36, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0090, std=3.0302
[DEBUG][MIA] Test Set Loss:   mean=3.7703, std=5.4609
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10588235294117647, 'auc': 0.5098876953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 39 37 38 37 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 39 37 37 36 36 39 38 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4733, std=4.3575
[DEBUG][MIA] Test Set Loss:   mean=3.4886, std=4.2458
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10200000000000001, 'auc': 0.504032, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 40, 42, 42, 43, 43, 43, 40, 43, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.2723, std=7.2346
[DEBUG][MIA] Test Set Loss:   mean=5.2502, std=5.4617
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.53790283203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 43 44 40 44 44 40 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 43 41 43 41 44 42 44 44 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.7152, std=6.1257
[DEBUG][MIA] Test Set Loss:   mean=6.0444, std=5.8974
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11599999999999999, 'auc': 0.515744, 'task': 8}
Total correct retain:  743  Total retain:  2500
Total correct forget:  10864  Total forget:  47500
Total correct test:  142  Total test:  500
Total correct forget test:  2107  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.284, 0.252, 0.18, 0.294, 0.188, 0.25, 0.172, 0.292, 0.25, 0.268, 0.248, 0.304, 0.246, 0.26, 0.102, 0.21, 0.138, 0.156, 0.162, 0.242]
Command line arguments:
number_of_gpus: 1
algorithm: RL-AGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 20
unlearn_mem_strength: 0.5
unlearn_batch_size: 10
average_over_n_runs: 3
salun: 0
salun_strength: 0.2
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 04:41:32 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 43%   70C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['snake', 'sunflowers', 'fox', 'oranges', 'leopard', 'bed', 'woman', 'cans', 'willow', 'ray', 'crab', 'chimpanzee', 'kangaroo', 'apples', 'shrew', 'roses', 'rabbit', 'butterfly', 'wolf', 'bee', 'whale', 'pickup truck', 'baby', 'plates', 'mountain', 'lamp', 'table', 'skyscraper', 'bottles', 'computer keyboard', 'rocket', 'cockroach', 'spider', 'shark', 'cups', 'trout', 'skunk', 'clock', 'castle', 'caterpillar', 'worm', 'pine', 'tractor', 'possum', 'dolphin', 'lobster', 'sea', 'forest', 'plain', 'camel', 'streetcar', 'bridge', 'girl', 'couch', 'motorcycle', 'raccoon', 'tiger', 'hamster', 'tank', 'poppies', 'crocodile', 'train', 'snail', 'lion', 'orchids', 'squirrel', 'lawn-mower', 'mushrooms', 'wardrobe', 'road', 'palm', 'flatfish', 'otter', 'cloud', 'beaver', 'bowls', 'boy', 'lizard', 'seal', 'dinosaur', 'maple', 'porcupine', 'man', 'aquarium fish', 'bus', 'telephone', 'mouse', 'sweet peppers', 'tulips', 'house', 'beetle', 'cattle', 'elephant', 'turtle', 'bicycle', 'bear', 'oak', 'chair', 'television', 'pears']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  1879  Total retain:  2500
Total correct forget:  9279  Total forget:  47500
Total correct test:  339  Total test:  500
Total correct forget test:  1808  Total test forget:  9500
After learning task 1
Task accuracies: [0.678, 0.226, 0.194, 0.266, 0.178, 0.186, 0.194, 0.142, 0.224, 0.276, 0.176, 0.292, 0.212, 0.1, 0.136, 0.212, 0.158, 0.108, 0.264, 0.072]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0483, std=0.2208
[DEBUG][MIA] Test Set Loss:   mean=0.6972, std=1.8386
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.19607843137254904, 'auc': 0.65667724609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0816, std=0.3458
[DEBUG][MIA] Test Set Loss:   mean=0.7895, std=1.8559
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.21200000000000002, 'auc': 0.666592, 'task': 1}
2 1
Total correct retain:  1578  Total retain:  2500
Total correct forget:  11797  Total forget:  47500
Total correct test:  272  Total test:  500
Total correct forget test:  2289  Total test forget:  9500
After learning task 2
Task accuracies: [0.544, 0.792, 0.202, 0.244, 0.256, 0.182, 0.174, 0.144, 0.192, 0.276, 0.198, 0.172, 0.236, 0.184, 0.222, 0.188, 0.278, 0.182, 0.218, 0.238]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0088
[DEBUG][MIA] Test Set Loss:   mean=1.2676, std=2.2056
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.27450980392156865, 'auc': 0.80535888671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4875, std=1.4403
[DEBUG][MIA] Test Set Loss:   mean=1.0446, std=2.0408
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.19, 'auc': 0.628152, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0486
[DEBUG][MIA] Test Set Loss:   mean=1.4438, std=3.0464
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.21960784313725493, 'auc': 0.7479248046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0137, std=0.0959
[DEBUG][MIA] Test Set Loss:   mean=1.0995, std=2.5094
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.656, 'cv_acc': 0.20600000000000002, 'auc': 0.692632, 'task': 2}
3 2
Total correct retain:  1747  Total retain:  2500
Total correct forget:  13218  Total forget:  47500
Total correct test:  313  Total test:  500
Total correct forget test:  2471  Total test forget:  9500
After learning task 3
Task accuracies: [0.626, 0.71, 0.8, 0.252, 0.274, 0.158, 0.178, 0.176, 0.168, 0.198, 0.198, 0.198, 0.252, 0.186, 0.166, 0.176, 0.26, 0.162, 0.2, 0.23]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0395, std=0.1275
[DEBUG][MIA] Test Set Loss:   mean=1.2619, std=2.0250
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6627450980392158, 'auc': 0.81805419921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0093, std=1.7908
[DEBUG][MIA] Test Set Loss:   mean=1.4481, std=2.3274
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.13999999999999999, 'auc': 0.5738239999999999, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0053, std=0.0161
[DEBUG][MIA] Test Set Loss:   mean=1.4913, std=2.7234
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2666666666666667, 'auc': 0.73992919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5362, std=1.5407
[DEBUG][MIA] Test Set Loss:   mean=1.3390, std=2.6531
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.18, 'auc': 0.586152, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0379, std=0.2141
[DEBUG][MIA] Test Set Loss:   mean=1.5699, std=2.5784
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.24705882352941178, 'auc': 0.73040771484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0069, std=0.0369
[DEBUG][MIA] Test Set Loss:   mean=1.4511, std=2.5699
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.71, 'cv_acc': 0.27, 'auc': 0.755504, 'task': 3}
4 3
Total correct retain:  1682  Total retain:  2500
Total correct forget:  14910  Total forget:  47500
Total correct test:  309  Total test:  500
Total correct forget test:  2712  Total test forget:  9500
After learning task 4
Task accuracies: [0.618, 0.662, 0.714, 0.686, 0.298, 0.176, 0.17, 0.188, 0.198, 0.3, 0.176, 0.194, 0.262, 0.182, 0.176, 0.216, 0.212, 0.186, 0.202, 0.226]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.5371, std=2.7080
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2980392156862745, 'auc': 0.830047607421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8448, std=1.8704
[DEBUG][MIA] Test Set Loss:   mean=1.2497, std=2.3486
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.134, 'auc': 0.5922160000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.3192, std=2.2100
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6941176470588235, 'auc': 0.82232666015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6102, std=1.4530
[DEBUG][MIA] Test Set Loss:   mean=1.3345, std=2.4629
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.172, 'auc': 0.5812959999999999, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0122
[DEBUG][MIA] Test Set Loss:   mean=1.9868, std=2.8472
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6627450980392158, 'auc': 0.795562744140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3097, std=1.0383
[DEBUG][MIA] Test Set Loss:   mean=1.9114, std=3.0775
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.64, 'cv_acc': 0.246, 'auc': 0.6598080000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0155, std=0.1103
[DEBUG][MIA] Test Set Loss:   mean=0.6508, std=2.2061
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.1843137254901961, 'auc': 0.65179443359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0112, std=0.0896
[DEBUG][MIA] Test Set Loss:   mean=0.7781, std=1.9444
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.178, 'auc': 0.642288, 'task': 4}
5 4
Total correct retain:  1590  Total retain:  2500
Total correct forget:  16766  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  3020  Total test forget:  9500
After learning task 5
Task accuracies: [0.592, 0.68, 0.674, 0.63, 0.832, 0.178, 0.19, 0.198, 0.21, 0.324, 0.17, 0.192, 0.278, 0.176, 0.194, 0.21, 0.232, 0.182, 0.216, 0.274]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.4842, std=2.5144
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.27450980392156865, 'auc': 0.806396484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6576, std=1.6602
[DEBUG][MIA] Test Set Loss:   mean=1.4265, std=2.6486
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.118, 'auc': 0.596824, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=2.2256, std=3.2517
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7294117647058823, 'auc': 0.86175537109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8447, std=1.8002
[DEBUG][MIA] Test Set Loss:   mean=2.0526, std=2.9976
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.11800000000000002, 'auc': 0.6329040000000001, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0231
[DEBUG][MIA] Test Set Loss:   mean=2.1949, std=3.0225
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.6901960784313725, 'auc': 0.87640380859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7719, std=1.6923
[DEBUG][MIA] Test Set Loss:   mean=1.9832, std=2.9196
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.22400000000000003, 'auc': 0.6299440000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0552, std=0.2523
[DEBUG][MIA] Test Set Loss:   mean=0.9002, std=2.0073
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.27450980392156865, 'auc': 0.658233642578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3754, std=1.0393
[DEBUG][MIA] Test Set Loss:   mean=0.9709, std=1.9788
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.178, 'auc': 0.601232, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0224
[DEBUG][MIA] Test Set Loss:   mean=1.6901, std=3.2183
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2823529411764706, 'auc': 0.783966064453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0148, std=0.0919
[DEBUG][MIA] Test Set Loss:   mean=1.7488, std=3.1230
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.704, 'cv_acc': 0.298, 'auc': 0.7471760000000001, 'task': 5}
6 5
Total correct retain:  1595  Total retain:  2500
Total correct forget:  17690  Total forget:  47500
Total correct test:  291  Total test:  500
Total correct forget test:  3110  Total test forget:  9500
After learning task 6
Task accuracies: [0.582, 0.694, 0.592, 0.554, 0.732, 0.676, 0.216, 0.17, 0.206, 0.334, 0.174, 0.146, 0.26, 0.202, 0.196, 0.182, 0.232, 0.186, 0.194, 0.274]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.3562, std=2.6795
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6901960784313725, 'auc': 0.810760498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8380, std=2.0397
[DEBUG][MIA] Test Set Loss:   mean=1.4961, std=2.7642
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.13199999999999998, 'auc': 0.598336, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=2.5718, std=3.6699
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7215686274509804, 'auc': 0.8883056640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2245, std=2.3098
[DEBUG][MIA] Test Set Loss:   mean=2.1172, std=3.3820
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.146, 'auc': 0.594608, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0093, std=0.0419
[DEBUG][MIA] Test Set Loss:   mean=2.1229, std=2.8839
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7254901960784315, 'auc': 0.819915771484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1472, std=2.3170
[DEBUG][MIA] Test Set Loss:   mean=1.7818, std=2.6220
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.17200000000000001, 'auc': 0.595224, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0445, std=0.2572
[DEBUG][MIA] Test Set Loss:   mean=1.4110, std=2.5443
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2705882352941177, 'auc': 0.76318359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7937, std=1.6786
[DEBUG][MIA] Test Set Loss:   mean=1.1631, std=2.0772
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.144, 'auc': 0.572048, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.7806, std=2.9239
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7411764705882353, 'auc': 0.806365966796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2418, std=0.8720
[DEBUG][MIA] Test Set Loss:   mean=1.8104, std=3.1043
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.658, 'cv_acc': 0.27199999999999996, 'auc': 0.665016, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0186, std=0.0968
[DEBUG][MIA] Test Set Loss:   mean=0.9871, std=2.3030
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2588235294117647, 'auc': 0.6802978515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0137, std=0.0737
[DEBUG][MIA] Test Set Loss:   mean=1.1624, std=2.1552
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.676, 'cv_acc': 0.21800000000000003, 'auc': 0.719472, 'task': 6}
7 6
Total correct retain:  1533  Total retain:  2500
Total correct forget:  19068  Total forget:  47500
Total correct test:  280  Total test:  500
Total correct forget test:  3328  Total test forget:  9500
After learning task 7
Task accuracies: [0.56, 0.674, 0.582, 0.558, 0.724, 0.624, 0.744, 0.168, 0.198, 0.342, 0.176, 0.174, 0.276, 0.186, 0.214, 0.214, 0.204, 0.148, 0.198, 0.252]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.5961, std=2.6602
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2823529411764706, 'auc': 0.850555419921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0017, std=2.2144
[DEBUG][MIA] Test Set Loss:   mean=1.3474, std=2.4646
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.146, 'auc': 0.5774159999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.9759, std=3.2565
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7568627450980392, 'auc': 0.834259033203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0354, std=2.0446
[DEBUG][MIA] Test Set Loss:   mean=2.0498, std=3.1639
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15199999999999997, 'auc': 0.600392, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0158, std=0.0607
[DEBUG][MIA] Test Set Loss:   mean=2.0966, std=2.6988
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7294117647058823, 'auc': 0.816009521484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9486, std=1.9558
[DEBUG][MIA] Test Set Loss:   mean=2.1248, std=3.0950
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.18, 'auc': 0.620224, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0136, std=0.0665
[DEBUG][MIA] Test Set Loss:   mean=0.7920, std=1.6727
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2588235294117647, 'auc': 0.689422607421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6219, std=1.6081
[DEBUG][MIA] Test Set Loss:   mean=1.0380, std=1.9983
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10400000000000001, 'auc': 0.5665120000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=1.9561, std=2.9418
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7372549019607844, 'auc': 0.8143310546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4991, std=1.2945
[DEBUG][MIA] Test Set Loss:   mean=1.5674, std=2.8112
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.242, 'auc': 0.609328, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0135
[DEBUG][MIA] Test Set Loss:   mean=1.2282, std=2.1500
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2980392156862745, 'auc': 0.7723388671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2546, std=0.9017
[DEBUG][MIA] Test Set Loss:   mean=1.3330, std=2.5215
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.21799999999999997, 'auc': 0.646936, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0095
[DEBUG][MIA] Test Set Loss:   mean=1.1330, std=2.3230
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.20392156862745098, 'auc': 0.693023681640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0889
[DEBUG][MIA] Test Set Loss:   mean=0.8217, std=1.9253
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.20600000000000002, 'auc': 0.7130879999999999, 'task': 7}
8 7
Total correct retain:  1481  Total retain:  2500
Total correct forget:  20596  Total forget:  47500
Total correct test:  275  Total test:  500
Total correct forget test:  3598  Total test forget:  9500
After learning task 8
Task accuracies: [0.55, 0.672, 0.584, 0.556, 0.736, 0.634, 0.694, 0.82, 0.156, 0.354, 0.186, 0.186, 0.244, 0.154, 0.204, 0.198, 0.22, 0.126, 0.188, 0.284]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.7291, std=2.8172
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2980392156862745, 'auc': 0.8536376953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9359, std=2.0856
[DEBUG][MIA] Test Set Loss:   mean=1.4667, std=2.6633
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.094, 'auc': 0.5618000000000001, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.0356, std=3.0175
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7647058823529411, 'auc': 0.859619140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0400, std=1.8871
[DEBUG][MIA] Test Set Loss:   mean=1.9527, std=2.9660
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.15, 'auc': 0.609008, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0193, std=0.0768
[DEBUG][MIA] Test Set Loss:   mean=2.3405, std=3.3271
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7450980392156863, 'auc': 0.85150146484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7198, std=3.2025
[DEBUG][MIA] Test Set Loss:   mean=2.3187, std=3.4042
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.16399999999999998, 'auc': 0.579016, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0085, std=0.0245
[DEBUG][MIA] Test Set Loss:   mean=1.0357, std=1.9752
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25882352941176473, 'auc': 0.73052978515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6793, std=1.6096
[DEBUG][MIA] Test Set Loss:   mean=0.9961, std=2.0008
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.132, 'auc': 0.525712, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=2.1046, std=3.2101
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7254901960784313, 'auc': 0.86529541015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6933, std=1.7678
[DEBUG][MIA] Test Set Loss:   mean=1.8400, std=3.0683
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.22000000000000003, 'auc': 0.634408, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0074, std=0.0246
[DEBUG][MIA] Test Set Loss:   mean=1.3408, std=2.4361
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.29411764705882354, 'auc': 0.794097900390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5843, std=1.3262
[DEBUG][MIA] Test Set Loss:   mean=1.4776, std=2.4410
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.158, 'auc': 0.648736, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.8696, std=1.8611
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2980392156862745, 'auc': 0.777496337890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1664, std=0.6206
[DEBUG][MIA] Test Set Loss:   mean=1.0139, std=1.9285
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.23399999999999999, 'auc': 0.66768, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0129
[DEBUG][MIA] Test Set Loss:   mean=1.1688, std=2.1018
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25882352941176473, 'auc': 0.726165771484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0303, std=0.2254
[DEBUG][MIA] Test Set Loss:   mean=1.0742, std=2.1404
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.264, 'auc': 0.726016, 'task': 8}
Total correct retain:  1476  Total retain:  2500
Total correct forget:  22288  Total forget:  47500
Total correct test:  262  Total test:  500
Total correct forget test:  3830  Total test forget:  9500
After learning task 9
Task accuracies: [0.524, 0.652, 0.608, 0.526, 0.734, 0.598, 0.67, 0.726, 0.732, 0.306, 0.188, 0.164, 0.236, 0.154, 0.194, 0.25, 0.23, 0.224, 0.202, 0.266]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.8905, std=2.9905
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7450980392156863, 'auc': 0.83856201171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2219, std=2.6273
[DEBUG][MIA] Test Set Loss:   mean=1.6629, std=2.7153
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.13400000000000004, 'auc': 0.574816, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.1258, std=3.2488
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7333333333333334, 'auc': 0.87481689453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5774, std=3.0469
[DEBUG][MIA] Test Set Loss:   mean=1.9892, std=2.9894
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.144, 'auc': 0.573064, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0097, std=0.0368
[DEBUG][MIA] Test Set Loss:   mean=2.4387, std=3.1085
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7843137254901961, 'auc': 0.882293701171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4929, std=2.5848
[DEBUG][MIA] Test Set Loss:   mean=2.2817, std=3.1529
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.16199999999999998, 'auc': 0.58424, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0163, std=0.0788
[DEBUG][MIA] Test Set Loss:   mean=1.4484, std=2.7405
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2627450980392157, 'auc': 0.7877197265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9650, std=1.9977
[DEBUG][MIA] Test Set Loss:   mean=1.2545, std=2.4721
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.186, 'auc': 0.514184, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=2.3969, std=3.6227
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7098039215686274, 'auc': 0.870819091796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8550, std=1.8146
[DEBUG][MIA] Test Set Loss:   mean=1.8726, std=2.8294
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.198, 'auc': 0.58932, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0111, std=0.0375
[DEBUG][MIA] Test Set Loss:   mean=1.5318, std=2.7159
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7176470588235293, 'auc': 0.8131103515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0204, std=1.9698
[DEBUG][MIA] Test Set Loss:   mean=1.6759, std=2.8178
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.2, 'auc': 0.582168, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.5439, std=2.8280
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7294117647058823, 'auc': 0.855438232421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5164, std=1.3599
[DEBUG][MIA] Test Set Loss:   mean=1.4639, std=2.5690
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.188, 'auc': 0.62388, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0108
[DEBUG][MIA] Test Set Loss:   mean=1.7903, std=2.5252
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.7490196078431373, 'auc': 0.8701171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5827, std=1.4926
[DEBUG][MIA] Test Set Loss:   mean=1.5771, std=2.5042
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.21000000000000002, 'auc': 0.6395439999999999, 'task': 8}
Total correct retain:  1508  Total retain:  2500
Total correct forget:  22862  Total forget:  47500
Total correct test:  264  Total test:  500
Total correct forget test:  3919  Total test forget:  9500
After learning task 10
Task accuracies: [0.528, 0.626, 0.586, 0.508, 0.68, 0.612, 0.628, 0.672, 0.622, 0.76, 0.188, 0.168, 0.248, 0.192, 0.274, 0.22, 0.18, 0.192, 0.214, 0.268]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5791, std=2.8878
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7254901960784313, 'auc': 0.802154541015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5760, std=3.2377
[DEBUG][MIA] Test Set Loss:   mean=1.6536, std=2.8619
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11600000000000002, 'auc': 0.549592, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=2.2802, std=3.4632
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7450980392156862, 'auc': 0.90203857421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1704, std=2.1811
[DEBUG][MIA] Test Set Loss:   mean=2.1048, std=3.2033
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.15199999999999997, 'auc': 0.606976, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0399, std=0.3240
[DEBUG][MIA] Test Set Loss:   mean=2.4760, std=3.0304
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.82421875, 'cv_acc': 0.7647058823529412, 'auc': 0.89288330078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7749, std=3.0313
[DEBUG][MIA] Test Set Loss:   mean=2.6806, std=3.4849
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.152, 'auc': 0.6045119999999999, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0307
[DEBUG][MIA] Test Set Loss:   mean=1.4854, std=3.1048
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26666666666666666, 'auc': 0.783538818359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0700, std=2.2883
[DEBUG][MIA] Test Set Loss:   mean=1.1196, std=2.2050
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.158, 'auc': 0.513944, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.1510, std=3.3715
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.7098039215686274, 'auc': 0.874176025390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0145, std=2.0191
[DEBUG][MIA] Test Set Loss:   mean=2.3463, std=3.6701
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.15799999999999997, 'auc': 0.6083280000000001, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=1.7751, std=2.8172
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7137254901960784, 'auc': 0.874481201171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3353, std=2.4625
[DEBUG][MIA] Test Set Loss:   mean=2.0461, std=3.0789
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.144, 'auc': 0.5752719999999999, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.0764, std=1.9023
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.7215686274509804, 'auc': 0.7681884765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7219, std=1.8338
[DEBUG][MIA] Test Set Loss:   mean=1.3757, std=2.5744
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.202, 'auc': 0.578504, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.5713, std=2.5370
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7019607843137255, 'auc': 0.888031005859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7487, std=1.6072
[DEBUG][MIA] Test Set Loss:   mean=1.5977, std=2.5231
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.22000000000000003, 'auc': 0.6277360000000001, 'task': 8}
Total correct retain:  1498  Total retain:  2500
Total correct forget:  24246  Total forget:  47500
Total correct test:  281  Total test:  500
Total correct forget test:  4132  Total test forget:  9500
After learning task 11
Task accuracies: [0.562, 0.656, 0.586, 0.468, 0.7, 0.592, 0.592, 0.688, 0.606, 0.712, 0.75, 0.174, 0.28, 0.17, 0.208, 0.19, 0.232, 0.188, 0.202, 0.27]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9979146122932434)
broken out of loop
Accuracy, Confidence: (0.2734375, 0.998348593711853)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6626, std=9.2215
[DEBUG][MIA] Test Set Loss:   mean=5.8063, std=8.7218
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1372549019607843, 'auc': 0.53985595703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.7127, std=7.0305
[DEBUG][MIA] Test Set Loss:   mean=5.2561, std=7.8727
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.496784, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4263, std=9.0613
[DEBUG][MIA] Test Set Loss:   mean=7.4282, std=10.6543
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10196078431372549, 'auc': 0.560394287109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.7635, std=8.1601
[DEBUG][MIA] Test Set Loss:   mean=6.8026, std=8.9455
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.535384, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.2358, std=10.2604
[DEBUG][MIA] Test Set Loss:   mean=8.2103, std=10.9153
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10980392156862744, 'auc': 0.53851318359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.3455, std=12.7350
[DEBUG][MIA] Test Set Loss:   mean=9.6784, std=13.6239
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.5364319999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.4229, std=6.8670
[DEBUG][MIA] Test Set Loss:   mean=6.8700, std=11.0220
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.1215686274509804, 'auc': 0.556243896484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.4924, std=8.0320
[DEBUG][MIA] Test Set Loss:   mean=6.8766, std=10.8881
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.524672, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.6635, std=7.3994
[DEBUG][MIA] Test Set Loss:   mean=3.5201, std=5.8179
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.13333333333333333, 'auc': 0.57855224609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.8783, std=6.6008
[DEBUG][MIA] Test Set Loss:   mean=3.7310, std=5.4925
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10800000000000001, 'auc': 0.5413279999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.9631, std=3.9028
[DEBUG][MIA] Test Set Loss:   mean=3.3925, std=4.9554
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.52093505859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.5161, std=4.6441
[DEBUG][MIA] Test Set Loss:   mean=3.1515, std=3.6861
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.092, 'auc': 0.490944, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.9940, std=7.7476
[DEBUG][MIA] Test Set Loss:   mean=4.1305, std=6.1575
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.09411764705882353, 'auc': 0.572021484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4159, std=5.9939
[DEBUG][MIA] Test Set Loss:   mean=3.4812, std=6.9281
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10400000000000001, 'auc': 0.49251200000000006, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7228, std=6.1515
[DEBUG][MIA] Test Set Loss:   mean=4.8692, std=6.2112
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.13333333333333333, 'auc': 0.5709228515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.6245, std=6.9680
[DEBUG][MIA] Test Set Loss:   mean=4.5845, std=6.8771
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10400000000000001, 'auc': 0.5058400000000001, 'task': 8}
Total correct retain:  702  Total retain:  2500
Total correct forget:  14400  Total forget:  47500
Total correct test:  140  Total test:  500
Total correct forget test:  2753  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.28, 0.394, 0.298, 0.25, 0.422, 0.406, 0.346, 0.484, 0.354, 0.472, 0.258, 0.278, 0.218, 0.2, 0.14, 0.298, 0.238, 0.124, 0.202, 0.124]
Unlearning task: 10
Accuracy, Confidence: (0.546875, 0.9341132640838623)
broken out of loop
Accuracy, Confidence: (0.37890625, 0.9897873401641846)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2043, std=3.5896
[DEBUG][MIA] Test Set Loss:   mean=3.0768, std=3.7575
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.12941176470588237, 'auc': 0.57366943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.9379, std=4.4657
[DEBUG][MIA] Test Set Loss:   mean=3.1167, std=5.0774
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.1, 'auc': 0.518464, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5153, std=2.6097
[DEBUG][MIA] Test Set Loss:   mean=3.4395, std=3.2903
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4375, 'cv_acc': 0.08235294117647059, 'auc': 0.4134521484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5891, std=3.6790
[DEBUG][MIA] Test Set Loss:   mean=3.3759, std=3.0396
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.497408, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.8763, std=5.1752
[DEBUG][MIA] Test Set Loss:   mean=5.3650, std=6.7834
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1411764705882353, 'auc': 0.55987548828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.0816, std=6.6757
[DEBUG][MIA] Test Set Loss:   mean=5.1199, std=6.8992
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.086, 'auc': 0.507456, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.8535, std=5.3702
[DEBUG][MIA] Test Set Loss:   mean=3.9873, std=6.1710
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.11764705882352941, 'auc': 0.476959228515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7937, std=5.7254
[DEBUG][MIA] Test Set Loss:   mean=4.4454, std=6.6028
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10200000000000001, 'auc': 0.494872, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.8127, std=3.4943
[DEBUG][MIA] Test Set Loss:   mean=3.1909, std=3.4042
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.14901960784313723, 'auc': 0.57208251953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.9267, std=3.1836
[DEBUG][MIA] Test Set Loss:   mean=3.6250, std=3.5866
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.092, 'auc': 0.43571200000000004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.7285, std=3.0939
[DEBUG][MIA] Test Set Loss:   mean=2.8267, std=3.5366
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1803921568627451, 'auc': 0.5020751953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3372, std=2.8435
[DEBUG][MIA] Test Set Loss:   mean=2.7055, std=3.1678
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11200000000000002, 'auc': 0.5416479999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.3082, std=3.1102
[DEBUG][MIA] Test Set Loss:   mean=3.1812, std=3.9285
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10196078431372549, 'auc': 0.561309814453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.6522, std=3.7218
[DEBUG][MIA] Test Set Loss:   mean=2.9631, std=4.0485
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10400000000000001, 'auc': 0.516696, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.9002, std=4.9753
[DEBUG][MIA] Test Set Loss:   mean=4.4492, std=5.2264
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.12549019607843137, 'auc': 0.5301513671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1159, std=5.8155
[DEBUG][MIA] Test Set Loss:   mean=4.4822, std=5.4348
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10800000000000001, 'auc': 0.534584, 'task': 8}
Total correct retain:  647  Total retain:  2500
Total correct forget:  13866  Total forget:  47500
Total correct test:  129  Total test:  500
Total correct forget test:  2627  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.258, 0.41, 0.282, 0.232, 0.486, 0.322, 0.328, 0.424, 0.344, 0.33, 0.282, 0.214, 0.292, 0.13, 0.14, 0.294, 0.222, 0.128, 0.246, 0.148]
Unlearning task: 9
Accuracy, Confidence: (0.40625, 0.8710889220237732)
broken out of loop
Accuracy, Confidence: (0.40234375, 0.8678095936775208)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2180, std=3.9800
[DEBUG][MIA] Test Set Loss:   mean=2.9013, std=5.0638
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10588235294117647, 'auc': 0.53582763671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4938, std=3.5780
[DEBUG][MIA] Test Set Loss:   mean=2.9242, std=4.9942
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11200000000000002, 'auc': 0.5403200000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0610, std=3.5059
[DEBUG][MIA] Test Set Loss:   mean=3.5756, std=3.1410
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.12549019607843137, 'auc': 0.57354736328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.4201, std=3.4867
[DEBUG][MIA] Test Set Loss:   mean=3.3389, std=3.1529
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11399999999999999, 'auc': 0.5043040000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0161, std=5.4626
[DEBUG][MIA] Test Set Loss:   mean=5.6394, std=6.7180
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.11372549019607843, 'auc': 0.59228515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.8079, std=6.1227
[DEBUG][MIA] Test Set Loss:   mean=5.2943, std=6.8798
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10200000000000001, 'auc': 0.4873760000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4257, std=5.3753
[DEBUG][MIA] Test Set Loss:   mean=5.0237, std=7.0454
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.1450980392156863, 'auc': 0.549346923828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.7098, std=5.1580
[DEBUG][MIA] Test Set Loss:   mean=3.9235, std=5.9839
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11000000000000001, 'auc': 0.4797199999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7068, std=3.4219
[DEBUG][MIA] Test Set Loss:   mean=3.7903, std=3.7219
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.09803921568627451, 'auc': 0.6219482421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.8201, std=3.2046
[DEBUG][MIA] Test Set Loss:   mean=3.2341, std=3.2689
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11400000000000002, 'auc': 0.54464, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2839, std=2.6078
[DEBUG][MIA] Test Set Loss:   mean=2.4507, std=2.6623
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.14509803921568626, 'auc': 0.52239990234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.5040, std=2.8562
[DEBUG][MIA] Test Set Loss:   mean=2.5565, std=2.8014
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10800000000000001, 'auc': 0.511856, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.6790, std=3.5517
[DEBUG][MIA] Test Set Loss:   mean=2.9695, std=4.1520
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10980392156862746, 'auc': 0.52252197265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.4196, std=3.3084
[DEBUG][MIA] Test Set Loss:   mean=2.9245, std=3.9463
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.092, 'auc': 0.543216, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.4460, std=5.9631
[DEBUG][MIA] Test Set Loss:   mean=4.6353, std=5.6281
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.13725490196078433, 'auc': 0.5360107421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8340, std=5.1014
[DEBUG][MIA] Test Set Loss:   mean=4.1941, std=4.6822
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11600000000000002, 'auc': 0.531368, 'task': 8}
Total correct retain:  639  Total retain:  2500
Total correct forget:  13885  Total forget:  47500
Total correct test:  128  Total test:  500
Total correct forget test:  2643  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.256, 0.402, 0.292, 0.242, 0.488, 0.318, 0.328, 0.43, 0.344, 0.334, 0.284, 0.214, 0.296, 0.132, 0.144, 0.294, 0.226, 0.128, 0.246, 0.144]
Unlearning task: 8
Accuracy, Confidence: (0.4921875, 0.8766676783561707)
broken out of loop
Accuracy, Confidence: (0.328125, 0.9645382165908813)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0070, std=5.3283
[DEBUG][MIA] Test Set Loss:   mean=5.3825, std=5.6570
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.1019607843137255, 'auc': 0.57415771484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.4536, std=6.2803
[DEBUG][MIA] Test Set Loss:   mean=4.3401, std=5.1695
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.126, 'auc': 0.5230159999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5196, std=4.9424
[DEBUG][MIA] Test Set Loss:   mean=4.2271, std=5.0058
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.11372549019607843, 'auc': 0.42095947265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.9958, std=4.7733
[DEBUG][MIA] Test Set Loss:   mean=4.1350, std=4.9348
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10400000000000001, 'auc': 0.474368, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.4943, std=5.4023
[DEBUG][MIA] Test Set Loss:   mean=6.1071, std=5.9025
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.09019607843137255, 'auc': 0.59832763671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.6766, std=6.6153
[DEBUG][MIA] Test Set Loss:   mean=6.5559, std=6.3339
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.096, 'auc': 0.5003839999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.6845, std=8.2989
[DEBUG][MIA] Test Set Loss:   mean=8.7503, std=8.9372
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09019607843137255, 'auc': 0.540863037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.9530, std=7.2810
[DEBUG][MIA] Test Set Loss:   mean=8.5020, std=8.2060
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10200000000000001, 'auc': 0.513048, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.6657, std=5.5969
[DEBUG][MIA] Test Set Loss:   mean=4.5099, std=4.3164
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.13725490196078433, 'auc': 0.52227783203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.9388, std=4.8829
[DEBUG][MIA] Test Set Loss:   mean=5.1589, std=5.3191
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.096, 'auc': 0.509296, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0264, std=5.0690
[DEBUG][MIA] Test Set Loss:   mean=3.2823, std=4.1973
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.12156862745098038, 'auc': 0.45367431640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0423, std=4.7623
[DEBUG][MIA] Test Set Loss:   mean=4.7133, std=5.1908
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.086, 'auc': 0.5333920000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.6083, std=14.9341
[DEBUG][MIA] Test Set Loss:   mean=17.2507, std=16.8318
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10588235294117647, 'auc': 0.463348388671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.8106, std=16.5396
[DEBUG][MIA] Test Set Loss:   mean=15.2703, std=15.8462
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.128, 'auc': 0.46789600000000003, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.9292, std=3.2634
[DEBUG][MIA] Test Set Loss:   mean=3.4571, std=3.3258
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10196078431372549, 'auc': 0.5703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.2258, std=3.2881
[DEBUG][MIA] Test Set Loss:   mean=3.8123, std=3.6857
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.11200000000000002, 'auc': 0.45953600000000006, 'task': 8}
Total correct retain:  842  Total retain:  2500
Total correct forget:  12091  Total forget:  47500
Total correct test:  161  Total test:  500
Total correct forget test:  2380  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.322, 0.366, 0.368, 0.266, 0.298, 0.254, 0.27, 0.304, 0.296, 0.34, 0.286, 0.302, 0.208, 0.098, 0.184, 0.152, 0.286, 0.116, 0.208, 0.158]
Unlearning task: 7
Accuracy, Confidence: (0.3203125, 0.8464219570159912)
broken out of loop
Accuracy, Confidence: (0.28515625, 0.9678277373313904)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.8073, std=5.5063
[DEBUG][MIA] Test Set Loss:   mean=4.7342, std=5.9298
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10196078431372549, 'auc': 0.5491943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6485, std=7.3837
[DEBUG][MIA] Test Set Loss:   mean=5.0508, std=6.9598
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.475464, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0380, std=6.3592
[DEBUG][MIA] Test Set Loss:   mean=5.0966, std=6.4985
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09803921568627452, 'auc': 0.523193359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0100, std=6.3639
[DEBUG][MIA] Test Set Loss:   mean=5.1832, std=6.6186
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.094, 'auc': 0.48332800000000004, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.0902, std=9.9099
[DEBUG][MIA] Test Set Loss:   mean=8.7620, std=9.9225
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.09411764705882353, 'auc': 0.6182861328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.8325, std=9.6916
[DEBUG][MIA] Test Set Loss:   mean=8.1396, std=9.8965
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.094, 'auc': 0.5096959999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7992, std=7.5140
[DEBUG][MIA] Test Set Loss:   mean=7.9313, std=8.2366
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.10980392156862746, 'auc': 0.5955810546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.0269, std=8.2098
[DEBUG][MIA] Test Set Loss:   mean=7.4506, std=8.0669
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.1, 'auc': 0.529608, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.4963, std=6.0633
[DEBUG][MIA] Test Set Loss:   mean=7.1823, std=6.6216
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09019607843137255, 'auc': 0.41827392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.4623, std=7.0968
[DEBUG][MIA] Test Set Loss:   mean=7.2038, std=6.3435
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11399999999999999, 'auc': 0.502112, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.9252, std=11.0244
[DEBUG][MIA] Test Set Loss:   mean=12.6862, std=11.4441
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09019607843137255, 'auc': 0.52130126953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.1694, std=10.8397
[DEBUG][MIA] Test Set Loss:   mean=12.3305, std=11.3956
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10400000000000001, 'auc': 0.5016079999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.1131, std=12.6636
[DEBUG][MIA] Test Set Loss:   mean=12.7633, std=13.3749
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.08235294117647059, 'auc': 0.519622802734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.7675, std=13.3885
[DEBUG][MIA] Test Set Loss:   mean=12.8118, std=13.4157
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.5432159999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8214, std=4.7409
[DEBUG][MIA] Test Set Loss:   mean=4.7273, std=5.0971
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09803921568627451, 'auc': 0.549224853515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5532, std=5.4857
[DEBUG][MIA] Test Set Loss:   mean=4.6727, std=5.1874
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10800000000000001, 'auc': 0.479632, 'task': 8}
Total correct retain:  851  Total retain:  2500
Total correct forget:  12853  Total forget:  47500
Total correct test:  169  Total test:  500
Total correct forget test:  2509  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.338, 0.388, 0.334, 0.284, 0.348, 0.226, 0.268, 0.296, 0.346, 0.362, 0.29, 0.242, 0.276, 0.172, 0.176, 0.212, 0.202, 0.13, 0.282, 0.184]
Unlearning task: 6
Accuracy, Confidence: (0.25, 0.8913689851760864)
broken out of loop
Accuracy, Confidence: (0.2578125, 0.88526451587677)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5783, std=5.2955
[DEBUG][MIA] Test Set Loss:   mean=5.3456, std=7.6008
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.09019607843137255, 'auc': 0.560821533203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3386, std=6.5326
[DEBUG][MIA] Test Set Loss:   mean=5.1716, std=6.8464
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.086, 'auc': 0.526992, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.3577, std=4.7603
[DEBUG][MIA] Test Set Loss:   mean=5.3833, std=6.9478
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.463623046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.6312, std=7.7291
[DEBUG][MIA] Test Set Loss:   mean=5.1934, std=6.2151
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10800000000000001, 'auc': 0.504512, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7538, std=8.5152
[DEBUG][MIA] Test Set Loss:   mean=8.3420, std=9.9628
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.10196078431372549, 'auc': 0.5889892578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.6556, std=10.8447
[DEBUG][MIA] Test Set Loss:   mean=7.3848, std=9.2965
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.092, 'auc': 0.47052799999999995, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.8861, std=7.5070
[DEBUG][MIA] Test Set Loss:   mean=7.1921, std=7.6417
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10588235294117647, 'auc': 0.57525634765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.6387, std=7.6490
[DEBUG][MIA] Test Set Loss:   mean=6.6869, std=7.9161
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.1, 'auc': 0.49129600000000007, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.5334, std=6.0171
[DEBUG][MIA] Test Set Loss:   mean=7.2538, std=6.5542
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.09019607843137255, 'auc': 0.41827392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.6885, std=5.6953
[DEBUG][MIA] Test Set Loss:   mean=6.8884, std=6.3047
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.12, 'auc': 0.555456, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.2928, std=10.6831
[DEBUG][MIA] Test Set Loss:   mean=12.4907, std=10.8735
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.533416748046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.5918, std=10.9341
[DEBUG][MIA] Test Set Loss:   mean=11.5063, std=10.6876
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08399999999999999, 'auc': 0.500808, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.0808, std=11.3675
[DEBUG][MIA] Test Set Loss:   mean=13.0474, std=13.3003
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.09411764705882353, 'auc': 0.437255859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=13.7010, std=13.9598
[DEBUG][MIA] Test Set Loss:   mean=12.8895, std=13.3172
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.12, 'auc': 0.481136, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.3199, std=4.3375
[DEBUG][MIA] Test Set Loss:   mean=4.0980, std=4.7452
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.08627450980392157, 'auc': 0.552032470703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.0050, std=4.4618
[DEBUG][MIA] Test Set Loss:   mean=4.5120, std=5.0442
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.08199999999999999, 'auc': 0.517792, 'task': 8}
Total correct retain:  899  Total retain:  2500
Total correct forget:  12921  Total forget:  47500
Total correct test:  172  Total test:  500
Total correct forget test:  2531  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.344, 0.394, 0.346, 0.298, 0.36, 0.226, 0.264, 0.312, 0.344, 0.35, 0.292, 0.246, 0.28, 0.172, 0.176, 0.21, 0.2, 0.128, 0.286, 0.178]
Unlearning task: 5
Accuracy, Confidence: (0.41015625, 0.9240212440490723)
broken out of loop
Accuracy, Confidence: (0.30859375, 0.9729064702987671)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.1632, std=6.2590
[DEBUG][MIA] Test Set Loss:   mean=5.5911, std=7.2276
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10588235294117647, 'auc': 0.529693603515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.7168, std=6.1348
[DEBUG][MIA] Test Set Loss:   mean=5.6333, std=7.1906
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.086, 'auc': 0.46243199999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1138, std=3.9966
[DEBUG][MIA] Test Set Loss:   mean=3.6518, std=4.1707
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.1607843137254902, 'auc': 0.5447998046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5636, std=4.2251
[DEBUG][MIA] Test Set Loss:   mean=3.9930, std=4.5563
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10400000000000001, 'auc': 0.528512, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.8433, std=6.2609
[DEBUG][MIA] Test Set Loss:   mean=5.8728, std=6.9883
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.14901960784313723, 'auc': 0.547760009765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2628, std=7.3119
[DEBUG][MIA] Test Set Loss:   mean=6.2000, std=7.4507
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10800000000000001, 'auc': 0.506608, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.6546, std=10.8258
[DEBUG][MIA] Test Set Loss:   mean=13.3744, std=11.6019
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10588235294117647, 'auc': 0.5662841796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=11.2433, std=11.4396
[DEBUG][MIA] Test Set Loss:   mean=11.5804, std=10.6387
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.518032, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.1380, std=10.2646
[DEBUG][MIA] Test Set Loss:   mean=10.8666, std=9.6688
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.07450980392156863, 'auc': 0.4691162109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.7962, std=9.9936
[DEBUG][MIA] Test Set Loss:   mean=10.7162, std=9.7521
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.1, 'auc': 0.5021200000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.1441, std=8.9491
[DEBUG][MIA] Test Set Loss:   mean=10.5459, std=9.5630
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.058823529411764705, 'auc': 0.5443115234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.0388, std=8.6978
[DEBUG][MIA] Test Set Loss:   mean=10.0479, std=9.2890
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.465608, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.8006, std=12.5089
[DEBUG][MIA] Test Set Loss:   mean=15.0464, std=14.1885
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10196078431372549, 'auc': 0.4898681640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.8806, std=13.5386
[DEBUG][MIA] Test Set Loss:   mean=15.1553, std=13.4788
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.086, 'auc': 0.496424, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9704, std=7.2808
[DEBUG][MIA] Test Set Loss:   mean=9.5972, std=9.3625
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09803921568627451, 'auc': 0.41961669921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.5661, std=8.3653
[DEBUG][MIA] Test Set Loss:   mean=8.6559, std=8.8310
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.126, 'auc': 0.501088, 'task': 8}
Total correct retain:  1276  Total retain:  2500
Total correct forget:  11742  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  2328  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.516, 0.33, 0.368, 0.336, 0.254, 0.154, 0.274, 0.242, 0.248, 0.282, 0.296, 0.266, 0.312, 0.15, 0.164, 0.23, 0.2, 0.14, 0.236, 0.174]
Unlearning task: 4
Accuracy, Confidence: (0.41015625, 0.9007301330566406)
broken out of loop
Accuracy, Confidence: (0.421875, 0.8956394791603088)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.2029, std=6.9081
[DEBUG][MIA] Test Set Loss:   mean=4.8193, std=6.0580
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.12941176470588237, 'auc': 0.498504638671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.7580, std=6.2713
[DEBUG][MIA] Test Set Loss:   mean=5.2785, std=6.6101
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.088, 'auc': 0.526376, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.7673, std=3.3429
[DEBUG][MIA] Test Set Loss:   mean=4.0639, std=4.9151
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.13333333333333336, 'auc': 0.564849853515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.3659, std=3.9752
[DEBUG][MIA] Test Set Loss:   mean=3.6727, std=4.7133
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.12, 'auc': 0.504776, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.7510, std=5.4565
[DEBUG][MIA] Test Set Loss:   mean=5.2165, std=6.8840
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.07450980392156863, 'auc': 0.51092529296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1420, std=7.4900
[DEBUG][MIA] Test Set Loss:   mean=5.9738, std=7.3200
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.13199999999999998, 'auc': 0.494144, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.6137, std=9.6789
[DEBUG][MIA] Test Set Loss:   mean=10.5973, std=8.9677
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.06666666666666667, 'auc': 0.543853759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=11.9954, std=11.5290
[DEBUG][MIA] Test Set Loss:   mean=11.5058, std=11.0561
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.132, 'auc': 0.486576, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.5104, std=9.8507
[DEBUG][MIA] Test Set Loss:   mean=11.2183, std=9.4245
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.15294117647058825, 'auc': 0.53314208984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.6990, std=9.2456
[DEBUG][MIA] Test Set Loss:   mean=9.9630, std=9.0940
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.5115040000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.5526, std=9.3482
[DEBUG][MIA] Test Set Loss:   mean=8.9104, std=9.6088
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.50506591796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.0515, std=8.9482
[DEBUG][MIA] Test Set Loss:   mean=9.2207, std=8.8375
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10800000000000001, 'auc': 0.476672, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=13.7801, std=12.8070
[DEBUG][MIA] Test Set Loss:   mean=14.4396, std=13.4654
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10980392156862746, 'auc': 0.5137939453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=15.1687, std=13.6378
[DEBUG][MIA] Test Set Loss:   mean=13.2254, std=12.9855
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10400000000000001, 'auc': 0.45798399999999995, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0977, std=7.6635
[DEBUG][MIA] Test Set Loss:   mean=7.6214, std=8.3624
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08627450980392157, 'auc': 0.5146484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.1302, std=7.8421
[DEBUG][MIA] Test Set Loss:   mean=7.7488, std=7.9913
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.51264, 'task': 8}
Total correct retain:  1276  Total retain:  2500
Total correct forget:  11891  Total forget:  47500
Total correct test:  256  Total test:  500
Total correct forget test:  2317  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.512, 0.33, 0.362, 0.326, 0.256, 0.162, 0.274, 0.25, 0.248, 0.296, 0.298, 0.272, 0.314, 0.142, 0.152, 0.212, 0.2, 0.138, 0.236, 0.166]
Unlearning task: 3
Accuracy, Confidence: (0.44140625, 0.8609975576400757)
broken out of loop
Accuracy, Confidence: (0.35546875, 0.9641822576522827)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.1729, std=4.6330
[DEBUG][MIA] Test Set Loss:   mean=4.2604, std=6.1304
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.11764705882352941, 'auc': 0.586181640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0071, std=4.7494
[DEBUG][MIA] Test Set Loss:   mean=4.1261, std=5.5972
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.098, 'auc': 0.497224, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.8336, std=10.1966
[DEBUG][MIA] Test Set Loss:   mean=9.6044, std=9.4357
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.07450980392156863, 'auc': 0.500244140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.2942, std=10.9013
[DEBUG][MIA] Test Set Loss:   mean=9.9086, std=10.5975
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.478296, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.1388, std=5.8039
[DEBUG][MIA] Test Set Loss:   mean=4.9595, std=7.5465
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1215686274509804, 'auc': 0.508453369140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.4529, std=9.4221
[DEBUG][MIA] Test Set Loss:   mean=5.7186, std=8.9732
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.096, 'auc': 0.4624, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.4291, std=9.3232
[DEBUG][MIA] Test Set Loss:   mean=10.4945, std=9.3457
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09019607843137255, 'auc': 0.504669189453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.9062, std=9.6446
[DEBUG][MIA] Test Set Loss:   mean=10.4672, std=8.8562
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10600000000000001, 'auc': 0.49656, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.1685, std=8.5188
[DEBUG][MIA] Test Set Loss:   mean=8.2253, std=7.5353
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12941176470588237, 'auc': 0.56689453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.3273, std=8.5148
[DEBUG][MIA] Test Set Loss:   mean=8.2598, std=7.3191
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.096, 'auc': 0.5130640000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3772, std=8.2726
[DEBUG][MIA] Test Set Loss:   mean=9.6048, std=8.1794
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.09803921568627451, 'auc': 0.448089599609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3499, std=8.2874
[DEBUG][MIA] Test Set Loss:   mean=8.8585, std=8.4559
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.5094799999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.3525, std=13.8145
[DEBUG][MIA] Test Set Loss:   mean=14.8114, std=15.5564
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09411764705882353, 'auc': 0.500732421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=18.6581, std=14.4507
[DEBUG][MIA] Test Set Loss:   mean=16.8952, std=15.3815
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.092, 'auc': 0.5425840000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6884, std=3.2845
[DEBUG][MIA] Test Set Loss:   mean=4.4126, std=3.6822
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.09411764705882353, 'auc': 0.5579833984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.0631, std=3.8241
[DEBUG][MIA] Test Set Loss:   mean=4.1862, std=3.7925
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.5090399999999999, 'task': 8}
Total correct retain:  1181  Total retain:  2500
Total correct forget:  12203  Total forget:  47500
Total correct test:  228  Total test:  500
Total correct forget test:  2435  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.456, 0.356, 0.392, 0.352, 0.272, 0.238, 0.302, 0.276, 0.236, 0.276, 0.276, 0.33, 0.32, 0.096, 0.172, 0.208, 0.21, 0.148, 0.23, 0.18]
Unlearning task: 2
Accuracy, Confidence: (0.44140625, 0.879785418510437)
broken out of loop
Accuracy, Confidence: (0.0859375, 0.9967526793479919)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 5, 9, 9, 6, 9, 8, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=54.5556, std=31.6164
[DEBUG][MIA] Test Set Loss:   mean=51.0284, std=35.3634
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.47021484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 6 9 8 6 9 8 9 5 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 9 9 7 6 6 9 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=49.5426, std=33.2578
[DEBUG][MIA] Test Set Loss:   mean=55.7130, std=32.7950
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.094, 'auc': 0.448408, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 10, 11, 10, 13, 14, 10, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=20.3786, std=14.7623
[DEBUG][MIA] Test Set Loss:   mean=18.7645, std=15.0291
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.08627450980392157, 'auc': 0.54156494140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 12 14 11 10 12 12 14 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 11 12 10 10 11 11 10 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=20.3167, std=15.1611
[DEBUG][MIA] Test Set Loss:   mean=19.1532, std=14.4935
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.096, 'auc': 0.482032, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 18, 18, 18, 18, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=10.9377, std=13.2029
[DEBUG][MIA] Test Set Loss:   mean=11.8299, std=12.8430
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.07450980392156863, 'auc': 0.49017333984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 15 16 18 17 19 18 15 16 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 15 15 15 19 16 19 15 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.8971, std=12.4553
[DEBUG][MIA] Test Set Loss:   mean=11.7667, std=12.9897
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.5183679999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 23, 21, 24, 24, 20, 24, 20, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=23.9490, std=22.5069
[DEBUG][MIA] Test Set Loss:   mean=26.8487, std=22.1331
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.0784313725490196, 'auc': 0.463653564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 20 23 20 23 22 24 24 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 23 21 24 21 22 20 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=24.0528, std=21.2646
[DEBUG][MIA] Test Set Loss:   mean=27.0046, std=21.6553
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.11000000000000001, 'auc': 0.47364799999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 28, 25, 25, 28, 25, 26, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=19.8546, std=14.9918
[DEBUG][MIA] Test Set Loss:   mean=20.3943, std=17.2471
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.11764705882352941, 'auc': 0.50213623046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 27 28 26 27 25 28 25 29]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 29 28 27 29 28 29 28 25 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=20.1714, std=15.8715
[DEBUG][MIA] Test Set Loss:   mean=19.6802, std=16.6586
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.092, 'auc': 0.488448, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 34, 30, 33, 30, 32, 32, 31, 31, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.9849, std=14.5242
[DEBUG][MIA] Test Set Loss:   mean=14.8173, std=13.0537
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.10196078431372549, 'auc': 0.50933837890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 31 33 30 33 30 34 32 32 32]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 33 31 33 30 34 30 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.3729, std=13.7904
[DEBUG][MIA] Test Set Loss:   mean=15.5797, std=13.2303
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.086, 'auc': 0.514784, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 39, 37, 39, 37, 35, 37, 36, 38, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=21.9648, std=18.6188
[DEBUG][MIA] Test Set Loss:   mean=22.6499, std=17.4872
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10196078431372549, 'auc': 0.493621826171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 38 37 39 36 39 36 37 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 38 35 37 37 39 36]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=20.7476, std=18.7193
[DEBUG][MIA] Test Set Loss:   mean=23.3130, std=17.6596
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.08199999999999999, 'auc': 0.54396, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 42, 41, 44, 41, 41, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=23.8459, std=18.2005
[DEBUG][MIA] Test Set Loss:   mean=24.7481, std=19.6161
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.50823974609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 41 41 43 43 42 42 42 43 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 43 41 40 43 44 41 42 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=22.1546, std=19.0417
[DEBUG][MIA] Test Set Loss:   mean=22.8073, std=18.9966
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.096, 'auc': 0.491872, 'task': 8}
Total correct retain:  522  Total retain:  2500
Total correct forget:  8773  Total forget:  47500
Total correct test:  107  Total test:  500
Total correct forget test:  1723  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.214, 0.116, 0.212, 0.286, 0.262, 0.142, 0.166, 0.186, 0.154, 0.182, 0.12, 0.198, 0.22, 0.148, 0.208, 0.218, 0.198, 0.218, 0.154, 0.058]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['beetle', 'lobster', 'tank', 'pears', 'turtle', 'streetcar', 'sunflowers', 'porcupine', 'bowls', 'bus', 'tulips', 'table', 'cloud', 'snail', 'flatfish', 'otter', 'palm', 'roses', 'cups', 'house', 'train', 'raccoon', 'sea', 'snake', 'shrew', 'woman', 'pickup truck', 'oak', 'shark', 'crab', 'worm', 'cans', 'boy', 'forest', 'plates', 'chair', 'fox', 'apples', 'bear', 'possum', 'couch', 'man', 'computer keyboard', 'mushrooms', 'caterpillar', 'bicycle', 'castle', 'telephone', 'lizard', 'camel', 'seal', 'cattle', 'dinosaur', 'tractor', 'road', 'wardrobe', 'television', 'rocket', 'bee', 'kangaroo', 'willow', 'dolphin', 'butterfly', 'bridge', 'maple', 'mountain', 'tiger', 'sweet peppers', 'lamp', 'bottles', 'orchids', 'oranges', 'spider', 'bed', 'trout', 'motorcycle', 'mouse', 'elephant', 'ray', 'skunk', 'poppies', 'girl', 'leopard', 'aquarium fish', 'clock', 'beaver', 'rabbit', 'crocodile', 'baby', 'lawn-mower', 'squirrel', 'whale', 'pine', 'wolf', 'plain', 'chimpanzee', 'skyscraper', 'lion', 'hamster', 'cockroach']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  1956  Total retain:  2500
Total correct forget:  9544  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  1917  Total test forget:  9500
After learning task 1
Task accuracies: [0.614, 0.196, 0.2, 0.18, 0.312, 0.192, 0.222, 0.286, 0.19, 0.12, 0.206, 0.226, 0.218, 0.17, 0.17, 0.212, 0.178, 0.198, 0.22, 0.138]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0486, std=0.1945
[DEBUG][MIA] Test Set Loss:   mean=1.3087, std=2.5174
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.26666666666666666, 'auc': 0.67596435546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0609, std=0.2478
[DEBUG][MIA] Test Set Loss:   mean=1.3167, std=2.6513
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.238, 'auc': 0.68264, 'task': 1}
2 1
Total correct retain:  1756  Total retain:  2500
Total correct forget:  11279  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  2187  Total test forget:  9500
After learning task 2
Task accuracies: [0.588, 0.736, 0.2, 0.198, 0.254, 0.216, 0.204, 0.276, 0.252, 0.148, 0.194, 0.204, 0.23, 0.26, 0.118, 0.224, 0.114, 0.206, 0.204, 0.136]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.1052, std=2.0841
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2980392156862745, 'auc': 0.782470703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3459, std=0.9518
[DEBUG][MIA] Test Set Loss:   mean=1.5007, std=2.4826
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.182, 'auc': 0.6509199999999999, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0144, std=0.0813
[DEBUG][MIA] Test Set Loss:   mean=0.8841, std=2.3102
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.2235294117647059, 'auc': 0.725494384765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0204, std=0.1450
[DEBUG][MIA] Test Set Loss:   mean=0.8893, std=2.0743
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.22600000000000003, 'auc': 0.69492, 'task': 2}
3 2
Total correct retain:  1661  Total retain:  2500
Total correct forget:  13422  Total forget:  47500
Total correct test:  291  Total test:  500
Total correct forget test:  2489  Total test forget:  9500
After learning task 3
Task accuracies: [0.582, 0.708, 0.792, 0.19, 0.3, 0.206, 0.194, 0.242, 0.234, 0.154, 0.208, 0.202, 0.246, 0.264, 0.112, 0.2, 0.066, 0.24, 0.232, 0.188]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.7194, std=2.7097
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7176470588235293, 'auc': 0.828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6613, std=1.5234
[DEBUG][MIA] Test Set Loss:   mean=1.4793, std=2.4193
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.192, 'auc': 0.5936159999999999, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.0849, std=2.5019
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2705882352941177, 'auc': 0.71502685546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3991, std=1.2182
[DEBUG][MIA] Test Set Loss:   mean=1.1830, std=2.3919
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.182, 'auc': 0.6357999999999999, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0464
[DEBUG][MIA] Test Set Loss:   mean=1.0103, std=1.9883
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2392156862745098, 'auc': 0.759857177734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0203
[DEBUG][MIA] Test Set Loss:   mean=1.2283, std=2.4186
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.68, 'cv_acc': 0.26, 'auc': 0.7294320000000001, 'task': 3}
4 3
Total correct retain:  1658  Total retain:  2500
Total correct forget:  14628  Total forget:  47500
Total correct test:  279  Total test:  500
Total correct forget test:  2615  Total test forget:  9500
After learning task 4
Task accuracies: [0.558, 0.62, 0.736, 0.73, 0.316, 0.186, 0.208, 0.236, 0.204, 0.144, 0.188, 0.196, 0.218, 0.266, 0.15, 0.208, 0.058, 0.222, 0.192, 0.152]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.7736, std=2.7952
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.6862745098039216, 'auc': 0.83660888671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9852, std=2.1589
[DEBUG][MIA] Test Set Loss:   mean=1.7535, std=2.8772
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.148, 'auc': 0.5824640000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0131
[DEBUG][MIA] Test Set Loss:   mean=1.1744, std=2.3272
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2823529411764706, 'auc': 0.73309326171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7550, std=1.8179
[DEBUG][MIA] Test Set Loss:   mean=0.9892, std=1.8697
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.096, 'auc': 0.572032, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0122
[DEBUG][MIA] Test Set Loss:   mean=1.5547, std=2.4289
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.5490196078431373, 'auc': 0.78851318359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3622, std=1.0053
[DEBUG][MIA] Test Set Loss:   mean=1.2928, std=2.1398
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.21399999999999997, 'auc': 0.64184, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0093, std=0.0503
[DEBUG][MIA] Test Set Loss:   mean=1.2136, std=2.9517
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.26666666666666666, 'auc': 0.7152099609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0098, std=0.0524
[DEBUG][MIA] Test Set Loss:   mean=1.2437, std=2.4089
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.272, 'auc': 0.7183120000000001, 'task': 4}
5 4
Total correct retain:  1576  Total retain:  2500
Total correct forget:  15829  Total forget:  47500
Total correct test:  263  Total test:  500
Total correct forget test:  2793  Total test forget:  9500
After learning task 5
Task accuracies: [0.526, 0.604, 0.714, 0.64, 0.712, 0.206, 0.214, 0.256, 0.21, 0.18, 0.174, 0.2, 0.198, 0.284, 0.12, 0.17, 0.078, 0.238, 0.226, 0.162]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=1.5295, std=2.4872
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7098039215686274, 'auc': 0.7711181640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8407, std=2.0632
[DEBUG][MIA] Test Set Loss:   mean=1.8071, std=2.9248
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.10600000000000001, 'auc': 0.608744, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0172
[DEBUG][MIA] Test Set Loss:   mean=1.3316, std=2.5418
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2666666666666667, 'auc': 0.725341796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9028, std=2.2498
[DEBUG][MIA] Test Set Loss:   mean=1.3752, std=2.5041
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10800000000000001, 'auc': 0.548248, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0073, std=0.0320
[DEBUG][MIA] Test Set Loss:   mean=1.5187, std=2.7465
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.28627450980392155, 'auc': 0.762115478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6795, std=2.0595
[DEBUG][MIA] Test Set Loss:   mean=1.5644, std=2.7245
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.186, 'auc': 0.608992, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0088
[DEBUG][MIA] Test Set Loss:   mean=1.4242, std=2.8195
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2901960784313725, 'auc': 0.803985595703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1524, std=0.5565
[DEBUG][MIA] Test Set Loss:   mean=1.3510, std=2.3348
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.252, 'auc': 0.6882720000000001, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0160, std=0.1285
[DEBUG][MIA] Test Set Loss:   mean=1.0327, std=2.4884
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.20392156862745098, 'auc': 0.687744140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0452
[DEBUG][MIA] Test Set Loss:   mean=0.6876, std=2.0093
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.22000000000000003, 'auc': 0.663744, 'task': 5}
6 5
Total correct retain:  1582  Total retain:  2500
Total correct forget:  17858  Total forget:  47500
Total correct test:  268  Total test:  500
Total correct forget test:  3155  Total test forget:  9500
After learning task 6
Task accuracies: [0.536, 0.644, 0.716, 0.656, 0.67, 0.832, 0.19, 0.246, 0.19, 0.174, 0.174, 0.182, 0.256, 0.276, 0.14, 0.228, 0.086, 0.232, 0.228, 0.19]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.5339, std=2.4564
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7137254901960783, 'auc': 0.856109619140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6117, std=3.2393
[DEBUG][MIA] Test Set Loss:   mean=1.8654, std=3.1931
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.184, 'auc': 0.54016, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=1.2740, std=2.2814
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.3019607843137254, 'auc': 0.802703857421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8793, std=1.9676
[DEBUG][MIA] Test Set Loss:   mean=1.2734, std=2.4430
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10800000000000001, 'auc': 0.5605359999999999, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.6267, std=2.6162
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7215686274509804, 'auc': 0.814544677734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7446, std=1.6148
[DEBUG][MIA] Test Set Loss:   mean=1.6034, std=2.5340
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.19, 'auc': 0.6004400000000001, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0168
[DEBUG][MIA] Test Set Loss:   mean=1.4577, std=2.7287
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.7490196078431373, 'auc': 0.77178955078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5392, std=1.6330
[DEBUG][MIA] Test Set Loss:   mean=1.6234, std=2.6674
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.23399999999999999, 'auc': 0.6596240000000001, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0136, std=0.0870
[DEBUG][MIA] Test Set Loss:   mean=1.1831, std=2.0874
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.24705882352941178, 'auc': 0.676849365234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2956, std=0.9366
[DEBUG][MIA] Test Set Loss:   mean=1.3782, std=2.4697
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.186, 'auc': 0.6206, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0216
[DEBUG][MIA] Test Set Loss:   mean=1.1800, std=2.3456
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2705882352941177, 'auc': 0.788726806640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0067, std=0.0302
[DEBUG][MIA] Test Set Loss:   mean=1.1134, std=2.4621
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.686, 'cv_acc': 0.278, 'auc': 0.7915679999999999, 'task': 6}
7 6
Total correct retain:  1500  Total retain:  2500
Total correct forget:  18908  Total forget:  47500
Total correct test:  277  Total test:  500
Total correct forget test:  3303  Total test forget:  9500
After learning task 7
Task accuracies: [0.554, 0.6, 0.71, 0.632, 0.636, 0.718, 0.728, 0.222, 0.218, 0.184, 0.198, 0.182, 0.2, 0.25, 0.132, 0.224, 0.128, 0.244, 0.24, 0.16]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=2.0300, std=3.3108
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7333333333333334, 'auc': 0.850128173828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3687, std=2.8444
[DEBUG][MIA] Test Set Loss:   mean=1.8429, std=3.0183
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11400000000000002, 'auc': 0.569032, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0084
[DEBUG][MIA] Test Set Loss:   mean=1.7280, std=2.6503
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.26274509803921564, 'auc': 0.851593017578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8525, std=2.0082
[DEBUG][MIA] Test Set Loss:   mean=1.5219, std=2.6520
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.09, 'auc': 0.567872, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.5882, std=2.6237
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7294117647058824, 'auc': 0.87200927734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8599, std=1.9253
[DEBUG][MIA] Test Set Loss:   mean=1.6804, std=2.7762
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.13400000000000004, 'auc': 0.592144, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0126, std=0.0351
[DEBUG][MIA] Test Set Loss:   mean=2.0301, std=2.9820
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7176470588235293, 'auc': 0.77935791015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8121, std=1.9554
[DEBUG][MIA] Test Set Loss:   mean=1.9543, std=2.7634
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.16999999999999998, 'auc': 0.647872, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0827, std=0.4481
[DEBUG][MIA] Test Set Loss:   mean=1.6197, std=2.9918
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.28627450980392155, 'auc': 0.693603515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5775, std=1.5025
[DEBUG][MIA] Test Set Loss:   mean=1.3226, std=2.5705
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.166, 'auc': 0.5598719999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0061
[DEBUG][MIA] Test Set Loss:   mean=1.6646, std=2.8073
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2823529411764706, 'auc': 0.81231689453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2483, std=0.6939
[DEBUG][MIA] Test Set Loss:   mean=1.4028, std=2.5030
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.256, 'auc': 0.635632, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0134
[DEBUG][MIA] Test Set Loss:   mean=0.7643, std=1.8432
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.25490196078431376, 'auc': 0.68951416015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0117, std=0.1230
[DEBUG][MIA] Test Set Loss:   mean=0.9262, std=2.0828
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.21999999999999997, 'auc': 0.714696, 'task': 7}
8 7
Total correct retain:  1582  Total retain:  2500
Total correct forget:  20178  Total forget:  47500
Total correct test:  283  Total test:  500
Total correct forget test:  3517  Total test forget:  9500
After learning task 8
Task accuracies: [0.566, 0.632, 0.702, 0.652, 0.586, 0.714, 0.662, 0.792, 0.22, 0.164, 0.2, 0.208, 0.214, 0.21, 0.112, 0.228, 0.146, 0.232, 0.248, 0.112]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.8933, std=2.7468
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7372549019607842, 'auc': 0.83660888671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3627, std=2.7276
[DEBUG][MIA] Test Set Loss:   mean=2.0138, std=3.0413
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.13, 'auc': 0.58176, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=1.0955, std=1.9175
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6901960784313725, 'auc': 0.77227783203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2355, std=2.6609
[DEBUG][MIA] Test Set Loss:   mean=1.2423, std=2.4784
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.09, 'auc': 0.550248, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.5659, std=2.6762
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7411764705882353, 'auc': 0.822662353515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1321, std=2.1533
[DEBUG][MIA] Test Set Loss:   mean=1.9888, std=3.0852
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12400000000000003, 'auc': 0.5829679999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0174
[DEBUG][MIA] Test Set Loss:   mean=1.9631, std=2.9044
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7411764705882353, 'auc': 0.8453369140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9135, std=1.8488
[DEBUG][MIA] Test Set Loss:   mean=2.0200, std=2.9311
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.182, 'auc': 0.622832, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0302, std=0.0925
[DEBUG][MIA] Test Set Loss:   mean=1.8214, std=2.7695
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25882352941176473, 'auc': 0.74664306640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5412, std=1.3563
[DEBUG][MIA] Test Set Loss:   mean=1.4227, std=2.5845
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.184, 'auc': 0.5581119999999999, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0251
[DEBUG][MIA] Test Set Loss:   mean=2.1035, std=3.3019
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7411764705882353, 'auc': 0.834381103515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7634, std=1.6739
[DEBUG][MIA] Test Set Loss:   mean=1.8874, std=2.8555
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.20800000000000002, 'auc': 0.6222479999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0069
[DEBUG][MIA] Test Set Loss:   mean=1.3678, std=2.4162
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2705882352941177, 'auc': 0.740966796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2974, std=0.9482
[DEBUG][MIA] Test Set Loss:   mean=1.3942, std=2.5960
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.192, 'auc': 0.6068720000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0124, std=0.1065
[DEBUG][MIA] Test Set Loss:   mean=1.1696, std=2.8097
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.23137254901960783, 'auc': 0.73284912109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0438
[DEBUG][MIA] Test Set Loss:   mean=1.4372, std=3.0608
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.256, 'auc': 0.787544, 'task': 8}
Total correct retain:  1556  Total retain:  2500
Total correct forget:  21245  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  3656  Total test forget:  9500
After learning task 9
Task accuracies: [0.578, 0.57, 0.672, 0.62, 0.57, 0.718, 0.604, 0.712, 0.736, 0.144, 0.216, 0.186, 0.226, 0.238, 0.116, 0.202, 0.126, 0.234, 0.254, 0.168]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.5758, std=2.5920
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7098039215686274, 'auc': 0.841827392578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5300, std=3.0179
[DEBUG][MIA] Test Set Loss:   mean=2.0938, std=3.2475
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.08399999999999999, 'auc': 0.573992, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.4775, std=2.8756
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.27450980392156865, 'auc': 0.742218017578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9939, std=1.9254
[DEBUG][MIA] Test Set Loss:   mean=1.2024, std=2.2938
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11000000000000001, 'auc': 0.520872, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=2.0368, std=3.0086
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2823529411764706, 'auc': 0.879486083984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1931, std=2.1883
[DEBUG][MIA] Test Set Loss:   mean=1.9306, std=3.1225
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11800000000000002, 'auc': 0.564056, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0112
[DEBUG][MIA] Test Set Loss:   mean=1.8213, std=2.9583
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7450980392156863, 'auc': 0.8428955078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3251, std=2.8273
[DEBUG][MIA] Test Set Loss:   mean=1.9496, std=3.0587
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.152, 'auc': 0.591376, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0344
[DEBUG][MIA] Test Set Loss:   mean=1.2931, std=2.5309
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.24705882352941178, 'auc': 0.796142578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6190, std=1.6503
[DEBUG][MIA] Test Set Loss:   mean=1.2840, std=2.4763
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12400000000000003, 'auc': 0.575552, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.8353, std=2.9280
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6941176470588235, 'auc': 0.860443115234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6474, std=1.4690
[DEBUG][MIA] Test Set Loss:   mean=1.9927, std=3.0912
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.188, 'auc': 0.661064, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0119
[DEBUG][MIA] Test Set Loss:   mean=1.1920, std=2.6588
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.28627450980392155, 'auc': 0.7403564453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6735, std=1.4361
[DEBUG][MIA] Test Set Loss:   mean=1.5520, std=2.8202
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.188, 'auc': 0.578456, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.3447, std=2.8564
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2941176470588235, 'auc': 0.8426513671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1495, std=0.5110
[DEBUG][MIA] Test Set Loss:   mean=1.5260, std=2.6877
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.666, 'cv_acc': 0.244, 'auc': 0.733024, 'task': 8}
Total correct retain:  1536  Total retain:  2500
Total correct forget:  22910  Total forget:  47500
Total correct test:  265  Total test:  500
Total correct forget test:  3982  Total test forget:  9500
After learning task 10
Task accuracies: [0.53, 0.61, 0.67, 0.6, 0.582, 0.746, 0.63, 0.692, 0.666, 0.758, 0.2, 0.196, 0.246, 0.202, 0.142, 0.234, 0.15, 0.226, 0.266, 0.148]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.2570, std=3.4046
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7411764705882353, 'auc': 0.907623291015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4707, std=2.7881
[DEBUG][MIA] Test Set Loss:   mean=1.6654, std=2.7780
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11400000000000002, 'auc': 0.56916, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0063
[DEBUG][MIA] Test Set Loss:   mean=1.0590, std=2.1304
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.24705882352941178, 'auc': 0.75, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2276, std=2.4298
[DEBUG][MIA] Test Set Loss:   mean=1.2485, std=2.2268
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.12999999999999998, 'auc': 0.540336, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0062
[DEBUG][MIA] Test Set Loss:   mean=1.7238, std=2.6498
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7176470588235294, 'auc': 0.83221435546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4804, std=2.6650
[DEBUG][MIA] Test Set Loss:   mean=1.9351, std=2.7717
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.122, 'auc': 0.5608319999999999, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.9279, std=3.1193
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7372549019607844, 'auc': 0.83270263671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1205, std=2.2368
[DEBUG][MIA] Test Set Loss:   mean=1.6581, std=2.6610
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.144, 'auc': 0.5806, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0106
[DEBUG][MIA] Test Set Loss:   mean=1.2976, std=2.6475
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.28627450980392155, 'auc': 0.7904052734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6203, std=1.6007
[DEBUG][MIA] Test Set Loss:   mean=1.1165, std=2.4495
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.126, 'auc': 0.597968, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0130, std=0.0489
[DEBUG][MIA] Test Set Loss:   mean=1.9161, std=3.1988
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7568627450980393, 'auc': 0.81842041015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0688, std=2.1217
[DEBUG][MIA] Test Set Loss:   mean=1.9744, std=3.1098
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.17600000000000002, 'auc': 0.5932480000000001, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0219, std=0.0695
[DEBUG][MIA] Test Set Loss:   mean=1.2729, std=2.3291
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2549019607843137, 'auc': 0.734222412109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7647, std=1.6898
[DEBUG][MIA] Test Set Loss:   mean=1.3610, std=2.5651
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.164, 'auc': 0.562528, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0046, std=0.0190
[DEBUG][MIA] Test Set Loss:   mean=1.4047, std=2.3709
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7254901960784313, 'auc': 0.855712890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3883, std=1.0977
[DEBUG][MIA] Test Set Loss:   mean=1.4283, std=2.5050
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.22999999999999998, 'auc': 0.6293759999999999, 'task': 8}
Total correct retain:  1531  Total retain:  2500
Total correct forget:  24120  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  4163  Total test forget:  9500
After learning task 11
Task accuracies: [0.532, 0.598, 0.69, 0.596, 0.588, 0.756, 0.6, 0.648, 0.636, 0.69, 0.776, 0.21, 0.214, 0.158, 0.146, 0.234, 0.1, 0.204, 0.258, 0.224]
Unlearning task: 11
Accuracy, Confidence: (0.98046875, 0.9785822033882141)
broken out of loop
Accuracy, Confidence: (0.23046875, 1.0)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=70.9140, std=63.2155
[DEBUG][MIA] Test Set Loss:   mean=63.1960, std=50.3066
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11372549019607843, 'auc': 0.51104736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=70.0733, std=57.9777
[DEBUG][MIA] Test Set Loss:   mean=71.5739, std=61.5319
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08, 'auc': 0.502304, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=115.7395, std=140.1885
[DEBUG][MIA] Test Set Loss:   mean=152.0048, std=162.5403
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4375, 'cv_acc': 0.11372549019607843, 'auc': 0.422393798828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=136.4362, std=145.2711
[DEBUG][MIA] Test Set Loss:   mean=149.4045, std=163.4033
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11399999999999999, 'auc': 0.490264, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=132.8187, std=128.8460
[DEBUG][MIA] Test Set Loss:   mean=133.4807, std=112.4380
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09803921568627451, 'auc': 0.519805908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=140.1157, std=118.8520
[DEBUG][MIA] Test Set Loss:   mean=138.2676, std=118.3822
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.506624, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=168.0182, std=187.0874
[DEBUG][MIA] Test Set Loss:   mean=156.5915, std=161.6989
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10196078431372549, 'auc': 0.50323486328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=176.4460, std=200.3853
[DEBUG][MIA] Test Set Loss:   mean=179.7880, std=187.5049
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10800000000000001, 'auc': 0.5176160000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=124.9862, std=141.3674
[DEBUG][MIA] Test Set Loss:   mean=129.3886, std=140.3700
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10588235294117647, 'auc': 0.5189208984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=137.2265, std=147.8213
[DEBUG][MIA] Test Set Loss:   mean=122.9488, std=135.8403
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.483056, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=80.6010, std=70.2456
[DEBUG][MIA] Test Set Loss:   mean=86.4767, std=72.3534
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1215686274509804, 'auc': 0.479248046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=78.8313, std=73.0192
[DEBUG][MIA] Test Set Loss:   mean=87.1582, std=80.9848
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10200000000000001, 'auc': 0.478016, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=90.1833, std=70.1352
[DEBUG][MIA] Test Set Loss:   mean=99.8362, std=75.7386
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.08235294117647059, 'auc': 0.46197509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=90.7691, std=76.3888
[DEBUG][MIA] Test Set Loss:   mean=94.5851, std=76.8274
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.08399999999999999, 'auc': 0.47892, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=133.3562, std=137.2642
[DEBUG][MIA] Test Set Loss:   mean=117.6178, std=110.1741
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.06666666666666667, 'auc': 0.501068115234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=116.3143, std=113.6896
[DEBUG][MIA] Test Set Loss:   mean=114.2636, std=112.3770
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10200000000000001, 'auc': 0.499656, 'task': 8}
Total correct retain:  489  Total retain:  2500
Total correct forget:  9438  Total forget:  47500
Total correct test:  98  Total test:  500
Total correct forget test:  1887  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.196, 0.17, 0.196, 0.196, 0.192, 0.202, 0.202, 0.2, 0.196, 0.198, 0.196, 0.206, 0.198, 0.178, 0.222, 0.204, 0.218, 0.2, 0.202, 0.198]
Unlearning task: 10
Accuracy, Confidence: (0.2421875, 0.9997529983520508)
broken out of loop
Accuracy, Confidence: (0.25, 0.9972459077835083)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=44.8810, std=40.9642
[DEBUG][MIA] Test Set Loss:   mean=41.9145, std=36.5169
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09411764705882353, 'auc': 0.50701904296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=40.4951, std=36.8513
[DEBUG][MIA] Test Set Loss:   mean=43.3424, std=40.0279
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10600000000000001, 'auc': 0.482056, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=89.9585, std=109.0008
[DEBUG][MIA] Test Set Loss:   mean=79.3010, std=99.3451
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09411764705882353, 'auc': 0.485595703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=87.9474, std=106.8213
[DEBUG][MIA] Test Set Loss:   mean=88.1077, std=108.6355
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.088, 'auc': 0.5087280000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=85.2643, std=84.9823
[DEBUG][MIA] Test Set Loss:   mean=83.9225, std=74.3789
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.08627450980392157, 'auc': 0.48638916015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=76.9298, std=78.1966
[DEBUG][MIA] Test Set Loss:   mean=92.9000, std=86.9192
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.12799999999999997, 'auc': 0.4522, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=124.6617, std=141.2378
[DEBUG][MIA] Test Set Loss:   mean=120.3186, std=128.6638
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09411764705882353, 'auc': 0.509918212890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=113.0816, std=139.0845
[DEBUG][MIA] Test Set Loss:   mean=126.9767, std=134.2752
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.076, 'auc': 0.44764000000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=62.3429, std=70.8394
[DEBUG][MIA] Test Set Loss:   mean=81.6246, std=92.6173
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11372549019607843, 'auc': 0.454620361328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=85.4370, std=105.6907
[DEBUG][MIA] Test Set Loss:   mean=77.6236, std=91.9607
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10400000000000001, 'auc': 0.48632, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=52.4162, std=47.7282
[DEBUG][MIA] Test Set Loss:   mean=54.2612, std=54.6412
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10980392156862746, 'auc': 0.5079345703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=49.9127, std=49.1085
[DEBUG][MIA] Test Set Loss:   mean=54.3427, std=53.7397
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.5169039999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=54.1148, std=48.1055
[DEBUG][MIA] Test Set Loss:   mean=56.8535, std=46.0821
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.527679443359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=56.2616, std=51.4551
[DEBUG][MIA] Test Set Loss:   mean=56.0413, std=48.1597
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.086, 'auc': 0.51288, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=84.0206, std=83.9593
[DEBUG][MIA] Test Set Loss:   mean=80.7771, std=83.6940
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.51226806640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=78.5522, std=80.6895
[DEBUG][MIA] Test Set Loss:   mean=69.3814, std=71.7104
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10600000000000001, 'auc': 0.528896, 'task': 8}
Total correct retain:  484  Total retain:  2500
Total correct forget:  9375  Total forget:  47500
Total correct test:  96  Total test:  500
Total correct forget test:  1882  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.192, 0.148, 0.192, 0.194, 0.19, 0.204, 0.206, 0.202, 0.206, 0.198, 0.196, 0.198, 0.196, 0.166, 0.244, 0.202, 0.234, 0.202, 0.2, 0.186]
Unlearning task: 9
Accuracy, Confidence: (0.1875, 0.9947333335876465)
broken out of loop
Accuracy, Confidence: (0.20703125, 0.9920738935470581)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=32.3743, std=29.5488
[DEBUG][MIA] Test Set Loss:   mean=30.7585, std=30.4866
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.512054443359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=31.1837, std=26.8472
[DEBUG][MIA] Test Set Loss:   mean=28.2738, std=28.2659
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11000000000000001, 'auc': 0.45371199999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=66.9148, std=80.3333
[DEBUG][MIA] Test Set Loss:   mean=58.8043, std=78.8104
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.482666015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=67.0735, std=80.0177
[DEBUG][MIA] Test Set Loss:   mean=60.9601, std=81.1362
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.533744, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=56.9401, std=63.3529
[DEBUG][MIA] Test Set Loss:   mean=62.9280, std=62.2096
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.11372549019607843, 'auc': 0.46142578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=71.0684, std=64.2006
[DEBUG][MIA] Test Set Loss:   mean=58.9235, std=57.5280
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.088, 'auc': 0.44744, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=85.9561, std=107.4824
[DEBUG][MIA] Test Set Loss:   mean=72.6901, std=85.4500
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.49822998046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=82.2820, std=96.8466
[DEBUG][MIA] Test Set Loss:   mean=90.1978, std=98.6420
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10200000000000001, 'auc': 0.47944000000000003, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=52.7869, std=66.7382
[DEBUG][MIA] Test Set Loss:   mean=64.0871, std=77.6386
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.07450980392156863, 'auc': 0.52130126953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=48.7443, std=63.3375
[DEBUG][MIA] Test Set Loss:   mean=56.6190, std=70.7092
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.535104, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=35.8627, std=40.0050
[DEBUG][MIA] Test Set Loss:   mean=38.3488, std=36.1706
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.08627450980392157, 'auc': 0.54022216796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=44.2815, std=44.4841
[DEBUG][MIA] Test Set Loss:   mean=38.7162, std=41.7611
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.54008, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=39.9701, std=38.2504
[DEBUG][MIA] Test Set Loss:   mean=34.6205, std=31.9910
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09019607843137255, 'auc': 0.480072021484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=45.5713, std=35.9785
[DEBUG][MIA] Test Set Loss:   mean=40.1834, std=35.4732
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.122, 'auc': 0.44816800000000007, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=50.3601, std=58.9110
[DEBUG][MIA] Test Set Loss:   mean=45.5835, std=57.7342
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10588235294117647, 'auc': 0.520751953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=48.7382, std=57.4083
[DEBUG][MIA] Test Set Loss:   mean=51.6915, std=58.5664
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.48075199999999996, 'task': 8}
Total correct retain:  463  Total retain:  2500
Total correct forget:  9356  Total forget:  47500
Total correct test:  88  Total test:  500
Total correct forget test:  1882  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.176, 0.154, 0.18, 0.2, 0.196, 0.208, 0.212, 0.204, 0.202, 0.202, 0.198, 0.188, 0.2, 0.16, 0.242, 0.186, 0.25, 0.204, 0.204, 0.174]
Unlearning task: 8
Accuracy, Confidence: (0.1953125, 0.9949499368667603)
broken out of loop
Accuracy, Confidence: (0.19921875, 0.9805347919464111)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=22.6386, std=23.2618
[DEBUG][MIA] Test Set Loss:   mean=20.6171, std=21.0713
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09411764705882353, 'auc': 0.50701904296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=21.2382, std=19.5551
[DEBUG][MIA] Test Set Loss:   mean=20.2728, std=18.8604
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10800000000000001, 'auc': 0.485152, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=44.5873, std=60.2270
[DEBUG][MIA] Test Set Loss:   mean=40.7230, std=57.0803
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.07058823529411765, 'auc': 0.50152587890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=51.4208, std=64.5784
[DEBUG][MIA] Test Set Loss:   mean=48.2442, std=61.4845
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.505992, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=42.1941, std=49.1920
[DEBUG][MIA] Test Set Loss:   mean=40.1357, std=45.0243
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10588235294117647, 'auc': 0.507568359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=39.7066, std=42.1920
[DEBUG][MIA] Test Set Loss:   mean=38.2267, std=41.8434
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11400000000000002, 'auc': 0.48916800000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=64.4136, std=82.3755
[DEBUG][MIA] Test Set Loss:   mean=55.8309, std=68.5028
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.08627450980392157, 'auc': 0.514984130859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=73.0089, std=87.2070
[DEBUG][MIA] Test Set Loss:   mean=65.9945, std=79.4163
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11399999999999999, 'auc': 0.47691999999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=41.2675, std=54.1531
[DEBUG][MIA] Test Set Loss:   mean=41.6386, std=56.4536
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.518585205078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=41.3179, std=56.2902
[DEBUG][MIA] Test Set Loss:   mean=42.2615, std=52.8027
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.09, 'auc': 0.52224, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=27.5155, std=31.9183
[DEBUG][MIA] Test Set Loss:   mean=28.3325, std=31.9625
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1568627450980392, 'auc': 0.511566162109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=26.6718, std=29.5800
[DEBUG][MIA] Test Set Loss:   mean=28.6790, std=30.3775
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10800000000000001, 'auc': 0.530152, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=29.2370, std=27.2008
[DEBUG][MIA] Test Set Loss:   mean=27.5224, std=26.8535
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08627450980392157, 'auc': 0.48077392578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=28.6662, std=27.0844
[DEBUG][MIA] Test Set Loss:   mean=28.5571, std=26.2975
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10400000000000001, 'auc': 0.503344, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.5002, std=48.1462
[DEBUG][MIA] Test Set Loss:   mean=33.9978, std=39.9647
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.47137451171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=35.1097, std=43.5984
[DEBUG][MIA] Test Set Loss:   mean=36.2396, std=43.9362
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.48706399999999994, 'task': 8}
Total correct retain:  462  Total retain:  2500
Total correct forget:  9414  Total forget:  47500
Total correct test:  89  Total test:  500
Total correct forget test:  1867  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.178, 0.156, 0.154, 0.2, 0.2, 0.21, 0.228, 0.208, 0.208, 0.208, 0.192, 0.162, 0.204, 0.172, 0.226, 0.186, 0.248, 0.208, 0.214, 0.15]
Unlearning task: 7
Accuracy, Confidence: (0.234375, 0.9880006313323975)
broken out of loop
Accuracy, Confidence: (0.234375, 0.9756954908370972)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=16.2139, std=16.7301
[DEBUG][MIA] Test Set Loss:   mean=17.1596, std=17.0309
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.11372549019607844, 'auc': 0.478240966796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=15.6844, std=15.3689
[DEBUG][MIA] Test Set Loss:   mean=13.8807, std=14.8390
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.11600000000000002, 'auc': 0.463424, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=36.3305, std=49.2973
[DEBUG][MIA] Test Set Loss:   mean=37.0591, std=52.3307
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.14901960784313725, 'auc': 0.48297119140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=37.4578, std=49.8018
[DEBUG][MIA] Test Set Loss:   mean=40.2475, std=54.0375
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.092, 'auc': 0.47999200000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=37.9960, std=42.4085
[DEBUG][MIA] Test Set Loss:   mean=37.8943, std=41.6144
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10588235294117647, 'auc': 0.496337890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=33.3490, std=35.7628
[DEBUG][MIA] Test Set Loss:   mean=33.2522, std=35.9460
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.495808, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=46.4800, std=62.8349
[DEBUG][MIA] Test Set Loss:   mean=50.2825, std=63.8699
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.500030517578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=46.9626, std=60.4246
[DEBUG][MIA] Test Set Loss:   mean=47.9973, std=61.1299
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.503024, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=30.1313, std=42.8448
[DEBUG][MIA] Test Set Loss:   mean=35.7337, std=42.3745
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.10196078431372549, 'auc': 0.449951171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=34.1230, std=46.0503
[DEBUG][MIA] Test Set Loss:   mean=33.8548, std=43.6726
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.08199999999999999, 'auc': 0.50904, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.8421, std=22.0413
[DEBUG][MIA] Test Set Loss:   mean=22.4300, std=25.7621
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10588235294117647, 'auc': 0.48406982421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=24.7223, std=27.6607
[DEBUG][MIA] Test Set Loss:   mean=23.2579, std=26.9077
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.1, 'auc': 0.521048, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=19.7628, std=19.1601
[DEBUG][MIA] Test Set Loss:   mean=22.5254, std=23.2412
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08235294117647059, 'auc': 0.483734130859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=23.5264, std=23.7249
[DEBUG][MIA] Test Set Loss:   mean=22.7958, std=24.0986
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.098, 'auc': 0.515256, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.5748, std=40.1234
[DEBUG][MIA] Test Set Loss:   mean=23.6593, std=29.3267
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.09411764705882353, 'auc': 0.425079345703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=31.5449, std=35.9967
[DEBUG][MIA] Test Set Loss:   mean=26.8688, std=33.2722
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10800000000000001, 'auc': 0.535576, 'task': 8}
Total correct retain:  463  Total retain:  2500
Total correct forget:  9403  Total forget:  47500
Total correct test:  86  Total test:  500
Total correct forget test:  1831  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.172, 0.154, 0.144, 0.18, 0.182, 0.208, 0.23, 0.21, 0.208, 0.226, 0.188, 0.156, 0.204, 0.166, 0.214, 0.176, 0.248, 0.206, 0.222, 0.14]
Unlearning task: 6
Accuracy, Confidence: (0.1875, 0.9617709517478943)
broken out of loop
Accuracy, Confidence: (0.19140625, 0.9558191299438477)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.0097, std=12.5518
[DEBUG][MIA] Test Set Loss:   mean=12.5924, std=12.6491
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.508544921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.5572, std=11.4835
[DEBUG][MIA] Test Set Loss:   mean=12.1379, std=13.1541
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.12200000000000003, 'auc': 0.541112, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=34.5917, std=43.5031
[DEBUG][MIA] Test Set Loss:   mean=28.6334, std=39.8981
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.470611572265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=30.0485, std=42.5397
[DEBUG][MIA] Test Set Loss:   mean=30.6973, std=42.7949
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.098, 'auc': 0.48024799999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=32.5860, std=36.6266
[DEBUG][MIA] Test Set Loss:   mean=24.2711, std=27.8115
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10588235294117647, 'auc': 0.445831298828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=25.7184, std=28.1999
[DEBUG][MIA] Test Set Loss:   mean=29.3864, std=32.2781
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.094, 'auc': 0.520168, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=45.4843, std=60.8728
[DEBUG][MIA] Test Set Loss:   mean=44.3174, std=58.5926
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09803921568627451, 'auc': 0.4853515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=41.3586, std=56.6984
[DEBUG][MIA] Test Set Loss:   mean=40.1575, std=54.2732
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10600000000000001, 'auc': 0.5089440000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=24.8618, std=32.9879
[DEBUG][MIA] Test Set Loss:   mean=25.3042, std=35.0612
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.08627450980392157, 'auc': 0.48492431640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=24.7837, std=35.0135
[DEBUG][MIA] Test Set Loss:   mean=30.7428, std=40.9893
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.10200000000000001, 'auc': 0.457248, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.5234, std=24.2619
[DEBUG][MIA] Test Set Loss:   mean=17.0394, std=20.0432
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.499176025390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.2018, std=22.4667
[DEBUG][MIA] Test Set Loss:   mean=18.7979, std=22.8630
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10600000000000001, 'auc': 0.48465600000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.8281, std=18.5459
[DEBUG][MIA] Test Set Loss:   mean=17.9299, std=19.7015
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.13333333333333333, 'auc': 0.485809326171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=19.1978, std=19.3730
[DEBUG][MIA] Test Set Loss:   mean=18.3475, std=19.3159
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.09, 'auc': 0.48444000000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=24.2310, std=32.9427
[DEBUG][MIA] Test Set Loss:   mean=22.2412, std=28.1884
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.08627450980392157, 'auc': 0.479949951171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=20.2653, std=26.4823
[DEBUG][MIA] Test Set Loss:   mean=20.3726, std=25.2224
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11600000000000002, 'auc': 0.5221439999999999, 'task': 8}
Total correct retain:  471  Total retain:  2500
Total correct forget:  9382  Total forget:  47500
Total correct test:  87  Total test:  500
Total correct forget test:  1814  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.174, 0.158, 0.16, 0.172, 0.17, 0.216, 0.23, 0.208, 0.202, 0.226, 0.186, 0.14, 0.206, 0.164, 0.214, 0.164, 0.242, 0.204, 0.242, 0.124]
Unlearning task: 5
Accuracy, Confidence: (0.16015625, 0.9336972236633301)
broken out of loop
Accuracy, Confidence: (0.15625, 0.9098215103149414)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.2534, std=10.3692
[DEBUG][MIA] Test Set Loss:   mean=9.5350, std=11.4041
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.45062255859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.5468, std=11.2953
[DEBUG][MIA] Test Set Loss:   mean=10.3523, std=11.0938
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.5062239999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=22.4886, std=32.8644
[DEBUG][MIA] Test Set Loss:   mean=26.4929, std=39.8921
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.08627450980392157, 'auc': 0.5228271484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=26.4893, std=35.7565
[DEBUG][MIA] Test Set Loss:   mean=24.9672, std=38.2708
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.512168, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=24.1587, std=30.9035
[DEBUG][MIA] Test Set Loss:   mean=23.8926, std=27.6742
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10196078431372549, 'auc': 0.48779296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=22.3180, std=25.2586
[DEBUG][MIA] Test Set Loss:   mean=23.5974, std=27.2041
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.12, 'auc': 0.49882399999999993, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=35.0161, std=49.5797
[DEBUG][MIA] Test Set Loss:   mean=29.7710, std=44.3459
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.45782470703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=36.7298, std=51.7677
[DEBUG][MIA] Test Set Loss:   mean=35.1863, std=47.8600
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.088, 'auc': 0.495424, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=22.8727, std=32.9223
[DEBUG][MIA] Test Set Loss:   mean=20.8306, std=29.4913
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.12156862745098038, 'auc': 0.478271484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=25.7101, std=35.3504
[DEBUG][MIA] Test Set Loss:   mean=21.7801, std=31.8863
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11400000000000002, 'auc': 0.48082400000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.1520, std=19.3724
[DEBUG][MIA] Test Set Loss:   mean=16.1867, std=19.2122
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.52056884765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.0011, std=14.6579
[DEBUG][MIA] Test Set Loss:   mean=15.8702, std=19.9908
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11399999999999999, 'auc': 0.533272, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.6743, std=13.7100
[DEBUG][MIA] Test Set Loss:   mean=16.9772, std=17.3819
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.09019607843137255, 'auc': 0.571502685546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=13.9855, std=16.7365
[DEBUG][MIA] Test Set Loss:   mean=14.5243, std=15.3383
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.47723999999999994, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=19.6204, std=24.0253
[DEBUG][MIA] Test Set Loss:   mean=17.5372, std=23.9498
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.14509803921568626, 'auc': 0.528228759765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=18.6664, std=24.3726
[DEBUG][MIA] Test Set Loss:   mean=18.3360, std=24.6806
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11399999999999999, 'auc': 0.512584, 'task': 8}
Total correct retain:  468  Total retain:  2500
Total correct forget:  9385  Total forget:  47500
Total correct test:  84  Total test:  500
Total correct forget test:  1792  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.168, 0.182, 0.144, 0.18, 0.146, 0.214, 0.234, 0.202, 0.196, 0.24, 0.182, 0.142, 0.212, 0.162, 0.2, 0.16, 0.234, 0.206, 0.248, 0.1]
Unlearning task: 4
Accuracy, Confidence: (0.2109375, 0.9324190020561218)
broken out of loop
Accuracy, Confidence: (0.203125, 0.919813871383667)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.3679, std=9.2974
[DEBUG][MIA] Test Set Loss:   mean=7.6722, std=7.9960
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.5128173828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.0697, std=8.8152
[DEBUG][MIA] Test Set Loss:   mean=8.4298, std=9.3887
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10400000000000001, 'auc': 0.5173439999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=20.3419, std=29.8348
[DEBUG][MIA] Test Set Loss:   mean=23.0729, std=31.7247
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10588235294117647, 'auc': 0.53558349609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=22.0886, std=31.3211
[DEBUG][MIA] Test Set Loss:   mean=21.4346, std=31.2060
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.088, 'auc': 0.48206400000000005, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=24.2327, std=28.2266
[DEBUG][MIA] Test Set Loss:   mean=20.0041, std=24.5478
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.08627450980392157, 'auc': 0.46954345703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=20.2587, std=22.9423
[DEBUG][MIA] Test Set Loss:   mean=17.7037, std=21.3994
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11200000000000002, 'auc': 0.473816, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=27.1829, std=41.0767
[DEBUG][MIA] Test Set Loss:   mean=32.3985, std=42.6921
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.12549019607843137, 'auc': 0.47021484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=35.4494, std=45.3812
[DEBUG][MIA] Test Set Loss:   mean=32.0737, std=42.7207
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10600000000000001, 'auc': 0.526416, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.5015, std=25.5827
[DEBUG][MIA] Test Set Loss:   mean=15.7690, std=23.1845
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09019607843137255, 'auc': 0.500885009765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=19.4348, std=28.1869
[DEBUG][MIA] Test Set Loss:   mean=19.6552, std=29.0609
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11200000000000002, 'auc': 0.501544, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.6526, std=16.4750
[DEBUG][MIA] Test Set Loss:   mean=12.4921, std=16.2472
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.11372549019607843, 'auc': 0.489501953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.5853, std=16.7638
[DEBUG][MIA] Test Set Loss:   mean=12.9655, std=16.7712
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.511064, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.8996, std=11.6165
[DEBUG][MIA] Test Set Loss:   mean=12.0905, std=13.2881
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.52093505859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.4678, std=13.1709
[DEBUG][MIA] Test Set Loss:   mean=11.3313, std=12.5996
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10800000000000001, 'auc': 0.5037280000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=17.8458, std=22.5635
[DEBUG][MIA] Test Set Loss:   mean=15.7780, std=22.6914
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.08235294117647059, 'auc': 0.56231689453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=14.3649, std=19.4493
[DEBUG][MIA] Test Set Loss:   mean=15.0409, std=20.1819
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.08, 'auc': 0.493992, 'task': 8}
Total correct retain:  472  Total retain:  2500
Total correct forget:  9319  Total forget:  47500
Total correct test:  83  Total test:  500
Total correct forget test:  1807  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.166, 0.192, 0.148, 0.176, 0.146, 0.226, 0.246, 0.196, 0.214, 0.252, 0.188, 0.13, 0.212, 0.17, 0.182, 0.162, 0.232, 0.206, 0.252, 0.084]
Unlearning task: 3
Accuracy, Confidence: (0.16015625, 0.9355816841125488)
broken out of loop
Accuracy, Confidence: (0.15234375, 0.9212843775749207)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.0698, std=8.8780
[DEBUG][MIA] Test Set Loss:   mean=6.4788, std=7.5523
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.489501953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.5649, std=9.3141
[DEBUG][MIA] Test Set Loss:   mean=7.2762, std=8.0970
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10400000000000001, 'auc': 0.49351999999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=17.0518, std=25.0576
[DEBUG][MIA] Test Set Loss:   mean=19.0885, std=25.8773
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.4698486328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=18.2784, std=24.4413
[DEBUG][MIA] Test Set Loss:   mean=19.9564, std=29.0784
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10800000000000001, 'auc': 0.52856, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.3370, std=22.5107
[DEBUG][MIA] Test Set Loss:   mean=14.9055, std=17.9639
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10980392156862746, 'auc': 0.53021240234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=16.6378, std=20.7463
[DEBUG][MIA] Test Set Loss:   mean=18.0690, std=20.6910
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.126, 'auc': 0.469728, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.8648, std=35.9281
[DEBUG][MIA] Test Set Loss:   mean=28.1024, std=35.9371
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.11372549019607843, 'auc': 0.4326171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.0858, std=30.2607
[DEBUG][MIA] Test Set Loss:   mean=25.8571, std=36.4245
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10200000000000001, 'auc': 0.46942400000000006, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=15.7019, std=20.8107
[DEBUG][MIA] Test Set Loss:   mean=17.4726, std=25.1428
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.08627450980392157, 'auc': 0.497161865234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=15.4752, std=21.7737
[DEBUG][MIA] Test Set Loss:   mean=18.8271, std=27.7572
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11200000000000002, 'auc': 0.48595999999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.6034, std=12.3306
[DEBUG][MIA] Test Set Loss:   mean=11.8641, std=16.0095
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.13725490196078433, 'auc': 0.446014404296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.3611, std=14.1019
[DEBUG][MIA] Test Set Loss:   mean=10.8537, std=14.1732
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.1, 'auc': 0.519072, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.9763, std=9.7604
[DEBUG][MIA] Test Set Loss:   mean=11.4480, std=13.1675
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09411764705882353, 'auc': 0.53253173828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.1337, std=12.4733
[DEBUG][MIA] Test Set Loss:   mean=9.8003, std=11.0422
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.08399999999999999, 'auc': 0.5295839999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.8115, std=19.5706
[DEBUG][MIA] Test Set Loss:   mean=13.6741, std=19.3975
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10980392156862746, 'auc': 0.545623779296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.6683, std=17.6472
[DEBUG][MIA] Test Set Loss:   mean=13.9037, std=17.3813
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.13399999999999998, 'auc': 0.48795999999999995, 'task': 8}
Total correct retain:  478  Total retain:  2500
Total correct forget:  9424  Total forget:  47500
Total correct test:  92  Total test:  500
Total correct forget test:  1840  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.184, 0.202, 0.144, 0.17, 0.158, 0.238, 0.246, 0.196, 0.23, 0.254, 0.184, 0.14, 0.216, 0.182, 0.162, 0.162, 0.228, 0.212, 0.278, 0.078]
Unlearning task: 2
Accuracy, Confidence: (0.2265625, 0.8448405861854553)
broken out of loop
Accuracy, Confidence: (0.31640625, 0.9748433828353882)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 7, 9, 7, 5, 6, 7, 9, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=15.4437, std=19.3853
[DEBUG][MIA] Test Set Loss:   mean=17.6579, std=18.4991
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09019607843137255, 'auc': 0.44183349609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 5 7 7 6 5 5 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 7 6 7 6 8 9 8 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=15.8030, std=18.7992
[DEBUG][MIA] Test Set Loss:   mean=16.3217, std=18.8208
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10200000000000001, 'auc': 0.492136, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 14, 14, 13, 12, 12, 10, 13, 11, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.7269, std=6.9431
[DEBUG][MIA] Test Set Loss:   mean=8.9732, std=7.1054
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.08627450980392157, 'auc': 0.491851806640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 11 11 14 10 14 12 13 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 10 13 10 13 14 10 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.9926, std=6.9665
[DEBUG][MIA] Test Set Loss:   mean=8.3855, std=7.3098
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.448, 'cv_acc': 0.094, 'auc': 0.42616, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 15, 19, 16, 18, 16, 15, 15, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.6390, std=6.7596
[DEBUG][MIA] Test Set Loss:   mean=5.1718, std=5.6843
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09411764705882353, 'auc': 0.4910888671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 16 15 19 15 16 19 17 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 18 17 16 16 18 16 17 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.0242, std=6.0059
[DEBUG][MIA] Test Set Loss:   mean=5.5214, std=6.2642
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11600000000000002, 'auc': 0.536144, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 21, 21, 21, 22, 23, 21, 20, 24, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.2573, std=10.2783
[DEBUG][MIA] Test Set Loss:   mean=8.2267, std=8.5598
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09411764705882353, 'auc': 0.488006591796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 22 22 24 23 20 23 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 21 20 22 23 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.8130, std=8.6572
[DEBUG][MIA] Test Set Loss:   mean=7.9541, std=8.2927
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.092, 'auc': 0.483544, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 25, 29, 29, 29, 27, 27, 26, 25, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.2532, std=7.1752
[DEBUG][MIA] Test Set Loss:   mean=5.0775, std=6.4527
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11764705882352941, 'auc': 0.486328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 25 29 28 27 29 25 28 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 26 27 29 29 29 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.6555, std=8.8119
[DEBUG][MIA] Test Set Loss:   mean=6.2892, std=8.1681
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11200000000000002, 'auc': 0.503856, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 31, 34, 34, 32, 33, 31, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.7988, std=4.6782
[DEBUG][MIA] Test Set Loss:   mean=4.8404, std=4.7609
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.50341796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 30 34 32 33 30 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 34 32 32 32 31 32 30 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.8927, std=5.2658
[DEBUG][MIA] Test Set Loss:   mean=5.4665, std=4.9462
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.098, 'auc': 0.51976, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 39, 38, 37, 39, 37, 39, 37, 35, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1574, std=5.0653
[DEBUG][MIA] Test Set Loss:   mean=3.8550, std=4.2417
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.4935302734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 39 35 36 39 36 39 35 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 35 37 35 39 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.9783, std=4.6691
[DEBUG][MIA] Test Set Loss:   mean=4.3603, std=4.4696
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.094, 'auc': 0.46412800000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 42, 41, 41, 41, 43, 43, 40, 41, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2879, std=8.1441
[DEBUG][MIA] Test Set Loss:   mean=6.5908, std=6.5869
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10980392156862746, 'auc': 0.5025634765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 44 41 44 41 43 41 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 44 40 42 41 42 43 44 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0198, std=7.8657
[DEBUG][MIA] Test Set Loss:   mean=7.2019, std=7.5795
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08, 'auc': 0.51664, 'task': 8}
Total correct retain:  763  Total retain:  2500
Total correct forget:  11969  Total forget:  47500
Total correct test:  150  Total test:  500
Total correct forget test:  2407  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.3, 0.298, 0.206, 0.322, 0.304, 0.298, 0.284, 0.348, 0.224, 0.332, 0.2, 0.164, 0.23, 0.26, 0.134, 0.168, 0.236, 0.182, 0.296, 0.328]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['dolphin', 'lawn-mower', 'porcupine', 'mushrooms', 'bowls', 'boy', 'poppies', 'couch', 'pears', 'tractor', 'bus', 'tiger', 'raccoon', 'castle', 'palm', 'cloud', 'tulips', 'shark', 'lamp', 'pine', 'television', 'chimpanzee', 'motorcycle', 'caterpillar', 'beetle', 'squirrel', 'girl', 'woman', 'elephant', 'telephone', 'table', 'cockroach', 'trout', 'bee', 'leopard', 'seal', 'roses', 'wardrobe', 'crab', 'maple', 'bed', 'man', 'skunk', 'chair', 'train', 'kangaroo', 'flatfish', 'orchids', 'whale', 'apples', 'pickup truck', 'plates', 'road', 'bicycle', 'butterfly', 'clock', 'beaver', 'lobster', 'aquarium fish', 'oak', 'cans', 'baby', 'shrew', 'bridge', 'fox', 'computer keyboard', 'house', 'cattle', 'snail', 'snake', 'turtle', 'otter', 'forest', 'plain', 'possum', 'sea', 'worm', 'rabbit', 'streetcar', 'mountain', 'mouse', 'camel', 'willow', 'oranges', 'skyscraper', 'sunflowers', 'wolf', 'bottles', 'bear', 'ray', 'rocket', 'cups', 'lion', 'lizard', 'tank', 'crocodile', 'hamster', 'spider', 'dinosaur', 'sweet peppers']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2341  Total retain:  2500
Total correct forget:  9322  Total forget:  47500
Total correct test:  369  Total test:  500
Total correct forget test:  1859  Total test forget:  9500
After learning task 1
Task accuracies: [0.738, 0.22, 0.2, 0.084, 0.15, 0.2, 0.166, 0.204, 0.18, 0.148, 0.226, 0.202, 0.168, 0.228, 0.216, 0.146, 0.324, 0.204, 0.186, 0.266]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0194, std=0.0957
[DEBUG][MIA] Test Set Loss:   mean=1.1989, std=2.5897
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2431372549019608, 'auc': 0.621978759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0226, std=0.1543
[DEBUG][MIA] Test Set Loss:   mean=0.9352, std=2.1814
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.23199999999999998, 'auc': 0.677336, 'task': 1}
2 1
Total correct retain:  1805  Total retain:  2500
Total correct forget:  11836  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  2221  Total test forget:  9500
After learning task 2
Task accuracies: [0.576, 0.788, 0.184, 0.19, 0.204, 0.2, 0.174, 0.14, 0.232, 0.184, 0.21, 0.212, 0.152, 0.19, 0.248, 0.164, 0.226, 0.154, 0.252, 0.338]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3121, std=0.9673
[DEBUG][MIA] Test Set Loss:   mean=1.6523, std=2.4946
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2627450980392157, 'auc': 0.694244384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8221, std=1.7661
[DEBUG][MIA] Test Set Loss:   mean=1.8937, std=3.1322
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.192, 'auc': 0.603728, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0631, std=0.3041
[DEBUG][MIA] Test Set Loss:   mean=1.0515, std=2.5159
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.1764705882352941, 'auc': 0.668243408203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0560, std=0.2979
[DEBUG][MIA] Test Set Loss:   mean=1.3225, std=2.8994
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.654, 'cv_acc': 0.20400000000000001, 'auc': 0.700896, 'task': 2}
3 2
Total correct retain:  1767  Total retain:  2500
Total correct forget:  12875  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  2407  Total test forget:  9500
After learning task 3
Task accuracies: [0.614, 0.576, 0.778, 0.138, 0.228, 0.194, 0.176, 0.156, 0.248, 0.158, 0.196, 0.234, 0.172, 0.24, 0.158, 0.174, 0.216, 0.208, 0.324, 0.24]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0989, std=0.3950
[DEBUG][MIA] Test Set Loss:   mean=1.6059, std=2.7067
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.4666666666666667, 'auc': 0.719635009765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1690, std=2.5203
[DEBUG][MIA] Test Set Loss:   mean=1.6913, std=2.8962
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.17200000000000001, 'auc': 0.5703119999999999, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0149
[DEBUG][MIA] Test Set Loss:   mean=1.1421, std=2.1992
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2823529411764706, 'auc': 0.77349853515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3742, std=1.3426
[DEBUG][MIA] Test Set Loss:   mean=1.3196, std=2.5255
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.21600000000000003, 'auc': 0.6288, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0439, std=0.2209
[DEBUG][MIA] Test Set Loss:   mean=0.7095, std=1.9529
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.1764705882352941, 'auc': 0.61676025390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0121, std=0.0637
[DEBUG][MIA] Test Set Loss:   mean=0.6360, std=1.8265
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.16599999999999998, 'auc': 0.5974, 'task': 3}
4 3
Total correct retain:  1611  Total retain:  2500
Total correct forget:  14528  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  2663  Total test forget:  9500
After learning task 4
Task accuracies: [0.576, 0.592, 0.71, 0.862, 0.232, 0.198, 0.192, 0.192, 0.208, 0.1, 0.198, 0.248, 0.14, 0.244, 0.174, 0.156, 0.212, 0.116, 0.242, 0.31]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0885, std=0.3211
[DEBUG][MIA] Test Set Loss:   mean=2.2583, std=3.6920
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.4470588235294118, 'auc': 0.728790283203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5591, std=2.7030
[DEBUG][MIA] Test Set Loss:   mean=2.2422, std=3.4356
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10600000000000001, 'auc': 0.552064, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0059
[DEBUG][MIA] Test Set Loss:   mean=1.6331, std=2.9124
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2980392156862745, 'auc': 0.8316650390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4810, std=1.1688
[DEBUG][MIA] Test Set Loss:   mean=1.4267, std=2.6007
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.188, 'auc': 0.619992, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0351, std=0.2044
[DEBUG][MIA] Test Set Loss:   mean=0.5213, std=1.2808
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.21176470588235294, 'auc': 0.624176025390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2655, std=0.8710
[DEBUG][MIA] Test Set Loss:   mean=0.6917, std=1.7285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.15999999999999998, 'auc': 0.591472, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0206
[DEBUG][MIA] Test Set Loss:   mean=0.5792, std=1.7580
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.20392156862745098, 'auc': 0.638946533203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0134
[DEBUG][MIA] Test Set Loss:   mean=0.5438, std=1.3651
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.202, 'auc': 0.644128, 'task': 4}
5 4
Total correct retain:  1662  Total retain:  2500
Total correct forget:  15968  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  2949  Total test forget:  9500
After learning task 5
Task accuracies: [0.592, 0.592, 0.676, 0.818, 0.86, 0.226, 0.188, 0.126, 0.228, 0.216, 0.2, 0.234, 0.134, 0.216, 0.176, 0.136, 0.22, 0.188, 0.208, 0.256]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1047, std=0.5324
[DEBUG][MIA] Test Set Loss:   mean=1.9142, std=3.3675
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6980392156862745, 'auc': 0.725128173828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8875, std=1.8838
[DEBUG][MIA] Test Set Loss:   mean=2.0076, std=3.2915
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.118, 'auc': 0.598256, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0276
[DEBUG][MIA] Test Set Loss:   mean=1.7279, std=2.7093
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.6627450980392157, 'auc': 0.833251953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0079, std=2.1026
[DEBUG][MIA] Test Set Loss:   mean=1.3354, std=2.5077
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.162, 'auc': 0.55176, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0182, std=0.1163
[DEBUG][MIA] Test Set Loss:   mean=0.9081, std=2.0329
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2, 'auc': 0.67547607421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5110, std=1.2910
[DEBUG][MIA] Test Set Loss:   mean=0.7668, std=1.7506
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.13399999999999998, 'auc': 0.534504, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0120
[DEBUG][MIA] Test Set Loss:   mean=1.0805, std=1.9947
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.25098039215686274, 'auc': 0.729278564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3080, std=0.8906
[DEBUG][MIA] Test Set Loss:   mean=0.9202, std=1.9373
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.22599999999999998, 'auc': 0.576376, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=1.6029, std=3.1285
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.6745098039215687, 'auc': 0.771697998046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0110, std=0.1104
[DEBUG][MIA] Test Set Loss:   mean=1.1411, std=2.4197
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.632, 'auc': 0.7663040000000001, 'task': 5}
6 5
Total correct retain:  1710  Total retain:  2500
Total correct forget:  17671  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3172  Total test forget:  9500
After learning task 6
Task accuracies: [0.606, 0.614, 0.664, 0.79, 0.72, 0.712, 0.19, 0.154, 0.238, 0.196, 0.196, 0.23, 0.166, 0.198, 0.194, 0.202, 0.23, 0.146, 0.222, 0.282]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0495, std=0.1848
[DEBUG][MIA] Test Set Loss:   mean=1.7255, std=2.7986
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.48235294117647054, 'auc': 0.730865478515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7086, std=3.0827
[DEBUG][MIA] Test Set Loss:   mean=2.1765, std=3.7323
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.51488, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0072, std=0.0325
[DEBUG][MIA] Test Set Loss:   mean=1.8481, std=2.9485
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.6784313725490196, 'auc': 0.83575439453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2029, std=2.3826
[DEBUG][MIA] Test Set Loss:   mean=1.7623, std=2.9140
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.126, 'auc': 0.576584, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0240, std=0.1337
[DEBUG][MIA] Test Set Loss:   mean=1.0585, std=2.2903
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.22745098039215686, 'auc': 0.718902587890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8573, std=1.8847
[DEBUG][MIA] Test Set Loss:   mean=0.7079, std=1.5699
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.15, 'auc': 0.540288, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.1690, std=2.2917
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.27450980392156865, 'auc': 0.78387451171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6090, std=1.5270
[DEBUG][MIA] Test Set Loss:   mean=1.1601, std=2.3597
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12200000000000003, 'auc': 0.583152, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.5368, std=2.5715
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.29803921568627445, 'auc': 0.82366943359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1653, std=0.5298
[DEBUG][MIA] Test Set Loss:   mean=1.6612, std=2.7327
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.24000000000000005, 'auc': 0.7063200000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.0852, std=2.7732
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.23529411764705882, 'auc': 0.68572998046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0246
[DEBUG][MIA] Test Set Loss:   mean=0.7776, std=1.8952
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.656, 'cv_acc': 0.23600000000000004, 'auc': 0.7359680000000001, 'task': 6}
7 6
Total correct retain:  1687  Total retain:  2500
Total correct forget:  19121  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3359  Total test forget:  9500
After learning task 7
Task accuracies: [0.606, 0.606, 0.634, 0.784, 0.736, 0.65, 0.796, 0.166, 0.246, 0.152, 0.2, 0.254, 0.148, 0.216, 0.192, 0.176, 0.194, 0.108, 0.186, 0.274]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0120
[DEBUG][MIA] Test Set Loss:   mean=2.3044, std=4.0466
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6980392156862745, 'auc': 0.7696533203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6293, std=3.1497
[DEBUG][MIA] Test Set Loss:   mean=2.1942, std=3.6641
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.13799999999999998, 'auc': 0.5451440000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0136, std=0.0642
[DEBUG][MIA] Test Set Loss:   mean=2.0318, std=3.0619
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7019607843137254, 'auc': 0.835601806640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0585, std=2.1891
[DEBUG][MIA] Test Set Loss:   mean=1.5999, std=2.7819
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.14599999999999996, 'auc': 0.582992, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0507, std=0.2761
[DEBUG][MIA] Test Set Loss:   mean=1.0562, std=2.2742
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.23137254901960783, 'auc': 0.679534912109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6677, std=1.8463
[DEBUG][MIA] Test Set Loss:   mean=1.0828, std=2.2794
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.096, 'auc': 0.525704, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.0502, std=2.2405
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2823529411764706, 'auc': 0.7923583984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5834, std=1.4590
[DEBUG][MIA] Test Set Loss:   mean=1.2583, std=2.4333
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10200000000000001, 'auc': 0.606776, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.5265, std=2.6545
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6941176470588235, 'auc': 0.86395263671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3949, std=1.1326
[DEBUG][MIA] Test Set Loss:   mean=1.3797, std=2.4520
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.23600000000000004, 'auc': 0.6486959999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=1.2559, std=2.0775
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.28627450980392155, 'auc': 0.744232177734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1714, std=0.6522
[DEBUG][MIA] Test Set Loss:   mean=1.0607, std=1.9279
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.21600000000000003, 'auc': 0.6651999999999999, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0054
[DEBUG][MIA] Test Set Loss:   mean=0.6013, std=1.7233
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.1843137254901961, 'auc': 0.641876220703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0134, std=0.1737
[DEBUG][MIA] Test Set Loss:   mean=0.5923, std=1.7872
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.192, 'auc': 0.6419440000000001, 'task': 7}
8 7
Total correct retain:  1668  Total retain:  2500
Total correct forget:  20760  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3647  Total test forget:  9500
After learning task 8
Task accuracies: [0.606, 0.586, 0.634, 0.778, 0.74, 0.63, 0.712, 0.86, 0.25, 0.18, 0.202, 0.248, 0.128, 0.206, 0.204, 0.178, 0.166, 0.108, 0.164, 0.32]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0433, std=0.1796
[DEBUG][MIA] Test Set Loss:   mean=2.2473, std=3.8059
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6313725490196079, 'auc': 0.729827880859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2340, std=2.5129
[DEBUG][MIA] Test Set Loss:   mean=1.6838, std=3.2957
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.156, 'auc': 0.522656, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0090
[DEBUG][MIA] Test Set Loss:   mean=1.7663, std=2.9247
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7411764705882352, 'auc': 0.853607177734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0248, std=2.2026
[DEBUG][MIA] Test Set Loss:   mean=1.4719, std=2.5555
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.17, 'auc': 0.586896, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0533, std=0.3223
[DEBUG][MIA] Test Set Loss:   mean=1.1848, std=2.5392
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.18823529411764706, 'auc': 0.71490478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8153, std=2.1233
[DEBUG][MIA] Test Set Loss:   mean=0.8931, std=2.0343
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.5584640000000001, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.2300, std=2.3943
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2705882352941177, 'auc': 0.834869384765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6600, std=1.6210
[DEBUG][MIA] Test Set Loss:   mean=0.9777, std=2.0785
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11400000000000002, 'auc': 0.569728, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0096
[DEBUG][MIA] Test Set Loss:   mean=2.1183, std=3.1016
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.6705882352941177, 'auc': 0.864837646484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8083, std=1.8649
[DEBUG][MIA] Test Set Loss:   mean=1.9888, std=3.1905
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.16999999999999998, 'auc': 0.6322320000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.1322, std=2.0861
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2901960784313726, 'auc': 0.826202392578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3431, std=0.9752
[DEBUG][MIA] Test Set Loss:   mean=1.2535, std=2.3297
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.202, 'auc': 0.6244879999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0088, std=0.0452
[DEBUG][MIA] Test Set Loss:   mean=0.7897, std=1.9660
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.23137254901960783, 'auc': 0.662017822265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2902, std=0.9883
[DEBUG][MIA] Test Set Loss:   mean=1.0227, std=2.2536
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.162, 'auc': 0.5977600000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0406
[DEBUG][MIA] Test Set Loss:   mean=0.5031, std=1.6145
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.22745098039215686, 'auc': 0.613861083984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0114, std=0.0849
[DEBUG][MIA] Test Set Loss:   mean=0.6991, std=1.6971
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.21800000000000003, 'auc': 0.6727679999999999, 'task': 8}
Total correct retain:  1577  Total retain:  2500
Total correct forget:  22487  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  4015  Total test forget:  9500
After learning task 9
Task accuracies: [0.614, 0.622, 0.658, 0.804, 0.744, 0.602, 0.716, 0.768, 0.808, 0.19, 0.198, 0.284, 0.174, 0.204, 0.19, 0.194, 0.216, 0.148, 0.174, 0.336]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0444, std=0.3052
[DEBUG][MIA] Test Set Loss:   mean=2.0835, std=3.6096
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6745098039215687, 'auc': 0.7333984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5719, std=3.0336
[DEBUG][MIA] Test Set Loss:   mean=1.8123, std=3.1617
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11400000000000002, 'auc': 0.531504, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0122, std=0.0575
[DEBUG][MIA] Test Set Loss:   mean=1.6836, std=2.7687
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7411764705882353, 'auc': 0.86309814453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9956, std=2.0830
[DEBUG][MIA] Test Set Loss:   mean=1.7307, std=2.8045
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10800000000000001, 'auc': 0.584112, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0312
[DEBUG][MIA] Test Set Loss:   mean=0.9056, std=2.0581
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.19215686274509805, 'auc': 0.713958740234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5967, std=1.8548
[DEBUG][MIA] Test Set Loss:   mean=0.8581, std=2.1138
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.13399999999999998, 'auc': 0.535336, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0187
[DEBUG][MIA] Test Set Loss:   mean=1.3805, std=2.6048
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2823529411764706, 'auc': 0.82269287109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8980, std=2.0945
[DEBUG][MIA] Test Set Loss:   mean=1.4532, std=2.8358
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12200000000000003, 'auc': 0.5749439999999999, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0110
[DEBUG][MIA] Test Set Loss:   mean=2.1028, std=3.1980
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.5764705882352941, 'auc': 0.860565185546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7345, std=1.6277
[DEBUG][MIA] Test Set Loss:   mean=1.9490, std=3.1080
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.186, 'auc': 0.635112, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.0256, std=1.9898
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2784313725490196, 'auc': 0.82177734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4735, std=1.2260
[DEBUG][MIA] Test Set Loss:   mean=1.4574, std=2.6246
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.172, 'auc': 0.63156, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=0.9439, std=2.0764
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.21960784313725493, 'auc': 0.753448486328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3543, std=1.0503
[DEBUG][MIA] Test Set Loss:   mean=0.8945, std=2.1386
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13399999999999998, 'auc': 0.59572, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.4538, std=2.6636
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.24705882352941178, 'auc': 0.778045654296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0978, std=0.3460
[DEBUG][MIA] Test Set Loss:   mean=1.1227, std=2.4522
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.23399999999999999, 'auc': 0.6200800000000001, 'task': 8}
Total correct retain:  1574  Total retain:  2500
Total correct forget:  24030  Total forget:  47500
Total correct test:  299  Total test:  500
Total correct forget test:  4295  Total test forget:  9500
After learning task 10
Task accuracies: [0.598, 0.636, 0.626, 0.816, 0.708, 0.598, 0.714, 0.818, 0.736, 0.888, 0.198, 0.254, 0.122, 0.21, 0.194, 0.22, 0.21, 0.146, 0.162, 0.334]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0774, std=0.3708
[DEBUG][MIA] Test Set Loss:   mean=2.3911, std=3.7074
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2901960784313726, 'auc': 0.77996826171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6934, std=3.4583
[DEBUG][MIA] Test Set Loss:   mean=2.3817, std=3.6277
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10600000000000001, 'auc': 0.5548, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0185
[DEBUG][MIA] Test Set Loss:   mean=1.7743, std=2.7827
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.2980392156862745, 'auc': 0.85198974609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8975, std=2.2957
[DEBUG][MIA] Test Set Loss:   mean=1.8827, std=3.2968
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.12800000000000003, 'auc': 0.5814, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0365, std=0.3923
[DEBUG][MIA] Test Set Loss:   mean=0.6929, std=1.9362
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.203921568627451, 'auc': 0.7354736328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6347, std=1.6830
[DEBUG][MIA] Test Set Loss:   mean=0.9598, std=2.2190
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.1, 'auc': 0.459944, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.4307, std=2.7969
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.28627450980392155, 'auc': 0.859130859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9777, std=2.3439
[DEBUG][MIA] Test Set Loss:   mean=1.5623, std=2.9681
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.13999999999999999, 'auc': 0.5886079999999999, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0172, std=0.0835
[DEBUG][MIA] Test Set Loss:   mean=1.4073, std=2.8985
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7137254901960783, 'auc': 0.80218505859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0377, std=2.5523
[DEBUG][MIA] Test Set Loss:   mean=1.9373, std=3.0800
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.15399999999999997, 'auc': 0.622672, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=1.3231, std=2.5611
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30196078431372547, 'auc': 0.8148193359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4789, std=1.2523
[DEBUG][MIA] Test Set Loss:   mean=1.2860, std=2.3133
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.178, 'auc': 0.618872, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0054
[DEBUG][MIA] Test Set Loss:   mean=0.6418, std=1.4786
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2431372549019608, 'auc': 0.7528076171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3061, std=1.0352
[DEBUG][MIA] Test Set Loss:   mean=0.9001, std=1.9776
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.13799999999999998, 'auc': 0.606672, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=0.8784, std=1.6873
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2823529411764706, 'auc': 0.76239013671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1991, std=0.6313
[DEBUG][MIA] Test Set Loss:   mean=0.9639, std=1.9266
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.184, 'auc': 0.6229680000000001, 'task': 8}
Total correct retain:  1601  Total retain:  2500
Total correct forget:  25484  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  4597  Total test forget:  9500
After learning task 11
Task accuracies: [0.588, 0.618, 0.666, 0.802, 0.696, 0.616, 0.724, 0.796, 0.742, 0.864, 0.884, 0.28, 0.138, 0.204, 0.176, 0.164, 0.206, 0.188, 0.148, 0.282]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9963566064834595)
broken out of loop
Accuracy, Confidence: (0.328125, 0.9863172769546509)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.8627, std=16.5852
[DEBUG][MIA] Test Set Loss:   mean=11.4489, std=14.9259
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.4677734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.5589, std=15.3680
[DEBUG][MIA] Test Set Loss:   mean=13.0986, std=18.1313
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10600000000000001, 'auc': 0.506656, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.9250, std=12.7355
[DEBUG][MIA] Test Set Loss:   mean=9.1029, std=11.1790
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.08235294117647059, 'auc': 0.522064208984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.3868, std=10.7320
[DEBUG][MIA] Test Set Loss:   mean=9.6846, std=11.3900
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.12600000000000003, 'auc': 0.49901599999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.6723, std=18.9443
[DEBUG][MIA] Test Set Loss:   mean=12.1951, std=18.0770
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.07450980392156863, 'auc': 0.563446044921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=10.0854, std=19.6238
[DEBUG][MIA] Test Set Loss:   mean=11.6497, std=19.6735
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.461464, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.5255, std=21.0982
[DEBUG][MIA] Test Set Loss:   mean=20.4064, std=19.5122
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09019607843137255, 'auc': 0.496337890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.8155, std=21.0864
[DEBUG][MIA] Test Set Loss:   mean=21.6134, std=21.9819
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.094, 'auc': 0.500504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.9527, std=19.2737
[DEBUG][MIA] Test Set Loss:   mean=15.0161, std=17.7365
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627452, 'auc': 0.476470947265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=17.0221, std=19.9318
[DEBUG][MIA] Test Set Loss:   mean=16.3969, std=18.3464
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.49595199999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.4619, std=28.0473
[DEBUG][MIA] Test Set Loss:   mean=26.8587, std=31.5543
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.09803921568627452, 'auc': 0.45623779296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=24.3652, std=32.0950
[DEBUG][MIA] Test Set Loss:   mean=24.7900, std=29.6824
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10200000000000001, 'auc': 0.468312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.0604, std=14.7227
[DEBUG][MIA] Test Set Loss:   mean=9.7392, std=14.2960
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.08627450980392157, 'auc': 0.52435302734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.2894, std=13.1476
[DEBUG][MIA] Test Set Loss:   mean=11.1157, std=15.2042
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.1, 'auc': 0.502048, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=16.8532, std=18.7676
[DEBUG][MIA] Test Set Loss:   mean=12.9463, std=13.6076
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.10588235294117647, 'auc': 0.53961181640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.9325, std=17.1110
[DEBUG][MIA] Test Set Loss:   mean=12.6247, std=14.8282
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.094, 'auc': 0.5049199999999999, 'task': 8}
Total correct retain:  694  Total retain:  2500
Total correct forget:  11086  Total forget:  47500
Total correct test:  141  Total test:  500
Total correct forget test:  2168  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.282, 0.232, 0.294, 0.282, 0.2, 0.182, 0.232, 0.302, 0.26, 0.228, 0.28, 0.194, 0.08, 0.126, 0.188, 0.228, 0.212, 0.27, 0.32, 0.226]
Unlearning task: 10
Accuracy, Confidence: (0.24609375, 0.9196045994758606)
broken out of loop
Accuracy, Confidence: (0.24609375, 0.9114304780960083)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.7315, std=14.6138
[DEBUG][MIA] Test Set Loss:   mean=9.8858, std=13.5012
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10980392156862746, 'auc': 0.49530029296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.1338, std=13.7770
[DEBUG][MIA] Test Set Loss:   mean=11.0998, std=14.7761
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.074, 'auc': 0.51716, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.7465, std=9.9785
[DEBUG][MIA] Test Set Loss:   mean=8.3932, std=10.5296
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12941176470588237, 'auc': 0.4984130859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.5360, std=10.5603
[DEBUG][MIA] Test Set Loss:   mean=7.5087, std=9.6703
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11599999999999999, 'auc': 0.43532000000000004, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.6570, std=18.0594
[DEBUG][MIA] Test Set Loss:   mean=10.6007, std=18.0271
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11372549019607843, 'auc': 0.47845458984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.7298, std=14.2285
[DEBUG][MIA] Test Set Loss:   mean=11.9203, std=18.8829
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.098, 'auc': 0.5436799999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=18.1094, std=18.3934
[DEBUG][MIA] Test Set Loss:   mean=19.5949, std=19.4543
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.08627450980392157, 'auc': 0.482269287109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=19.3240, std=18.5354
[DEBUG][MIA] Test Set Loss:   mean=18.6823, std=17.9340
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.092, 'auc': 0.491648, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=14.8363, std=16.5861
[DEBUG][MIA] Test Set Loss:   mean=14.6802, std=16.8625
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.49237060546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=16.0674, std=18.7399
[DEBUG][MIA] Test Set Loss:   mean=14.9533, std=16.9370
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.5119440000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.8331, std=23.2052
[DEBUG][MIA] Test Set Loss:   mean=21.5885, std=24.9788
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.45849609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.9309, std=22.9178
[DEBUG][MIA] Test Set Loss:   mean=20.0993, std=23.4101
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.096, 'auc': 0.510056, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.5718, std=17.6105
[DEBUG][MIA] Test Set Loss:   mean=9.9996, std=14.2009
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.09411764705882353, 'auc': 0.531982421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.7161, std=13.2131
[DEBUG][MIA] Test Set Loss:   mean=10.7429, std=14.3100
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.51572, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.8797, std=15.4922
[DEBUG][MIA] Test Set Loss:   mean=13.0408, std=14.5064
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.500579833984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.2352, std=14.6627
[DEBUG][MIA] Test Set Loss:   mean=11.8701, std=13.7110
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.496008, 'task': 8}
Total correct retain:  699  Total retain:  2500
Total correct forget:  11254  Total forget:  47500
Total correct test:  139  Total test:  500
Total correct forget test:  2182  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.278, 0.248, 0.308, 0.294, 0.196, 0.192, 0.232, 0.298, 0.266, 0.226, 0.3, 0.196, 0.076, 0.122, 0.192, 0.224, 0.182, 0.274, 0.318, 0.22]
Unlearning task: 9
Accuracy, Confidence: (0.27734375, 0.9532946348190308)
broken out of loop
Accuracy, Confidence: (0.1953125, 0.9952387809753418)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.3141, std=7.1055
[DEBUG][MIA] Test Set Loss:   mean=5.8300, std=6.9654
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09411764705882353, 'auc': 0.56597900390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.9512, std=7.0160
[DEBUG][MIA] Test Set Loss:   mean=6.2751, std=6.7424
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.1, 'auc': 0.46931199999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.8432, std=9.0071
[DEBUG][MIA] Test Set Loss:   mean=11.6597, std=8.5761
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10196078431372549, 'auc': 0.50946044921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.9954, std=8.1852
[DEBUG][MIA] Test Set Loss:   mean=12.1319, std=8.6737
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.1, 'auc': 0.536272, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.2031, std=6.1960
[DEBUG][MIA] Test Set Loss:   mean=7.4025, std=6.7523
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.1607843137254902, 'auc': 0.49822998046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.4989, std=5.6534
[DEBUG][MIA] Test Set Loss:   mean=7.1129, std=6.3602
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.10600000000000001, 'auc': 0.4773759999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3968, std=4.3642
[DEBUG][MIA] Test Set Loss:   mean=6.0729, std=4.6005
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09803921568627451, 'auc': 0.5469970703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.9062, std=4.7054
[DEBUG][MIA] Test Set Loss:   mean=5.7538, std=4.2345
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11399999999999999, 'auc': 0.498672, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.6352, std=7.9327
[DEBUG][MIA] Test Set Loss:   mean=9.9369, std=8.0698
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09411764705882353, 'auc': 0.5098876953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.2690, std=7.4998
[DEBUG][MIA] Test Set Loss:   mean=10.7398, std=8.1136
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.118, 'auc': 0.445488, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.9960, std=8.3773
[DEBUG][MIA] Test Set Loss:   mean=10.3536, std=8.4532
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09803921568627451, 'auc': 0.521240234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.0215, std=8.3844
[DEBUG][MIA] Test Set Loss:   mean=11.0486, std=8.4830
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.092, 'auc': 0.464512, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.9728, std=5.5127
[DEBUG][MIA] Test Set Loss:   mean=5.2147, std=5.2398
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10980392156862746, 'auc': 0.46722412109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.5764, std=5.7496
[DEBUG][MIA] Test Set Loss:   mean=5.1732, std=5.5555
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.096, 'auc': 0.4828, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=45.4663, std=30.1318
[DEBUG][MIA] Test Set Loss:   mean=47.8214, std=34.9107
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.11372549019607843, 'auc': 0.520538330078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=49.4830, std=29.7391
[DEBUG][MIA] Test Set Loss:   mean=46.8584, std=32.9896
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.092, 'auc': 0.47304, 'task': 8}
Total correct retain:  744  Total retain:  2500
Total correct forget:  10408  Total forget:  47500
Total correct test:  149  Total test:  500
Total correct forget test:  2050  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.298, 0.274, 0.214, 0.208, 0.164, 0.19, 0.222, 0.22, 0.188, 0.228, 0.21, 0.2, 0.158, 0.212, 0.186, 0.2, 0.254, 0.212, 0.234, 0.326]
Unlearning task: 8
Accuracy, Confidence: (0.22265625, 0.7313594222068787)
broken out of loop
Accuracy, Confidence: (0.23828125, 0.7018078565597534)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2946, std=6.6698
[DEBUG][MIA] Test Set Loss:   mean=5.9526, std=7.0382
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09411764705882353, 'auc': 0.51092529296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2383, std=6.1348
[DEBUG][MIA] Test Set Loss:   mean=5.5516, std=6.2854
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.448, 'cv_acc': 0.08199999999999999, 'auc': 0.45672, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.3039, std=7.7479
[DEBUG][MIA] Test Set Loss:   mean=10.6199, std=7.6679
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.07450980392156863, 'auc': 0.4537353515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.7620, std=8.1120
[DEBUG][MIA] Test Set Loss:   mean=9.5610, std=7.4555
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.092, 'auc': 0.492224, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1677, std=6.4138
[DEBUG][MIA] Test Set Loss:   mean=6.8415, std=6.2647
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10980392156862746, 'auc': 0.50469970703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.4760, std=5.7288
[DEBUG][MIA] Test Set Loss:   mean=6.8312, std=6.1683
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10400000000000001, 'auc': 0.49128, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.7362, std=4.2910
[DEBUG][MIA] Test Set Loss:   mean=5.4414, std=3.9113
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.10980392156862746, 'auc': 0.567626953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6722, std=3.9361
[DEBUG][MIA] Test Set Loss:   mean=5.0222, std=3.8537
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10800000000000001, 'auc': 0.533488, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.3885, std=6.9961
[DEBUG][MIA] Test Set Loss:   mean=8.6630, std=6.9456
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.0784313725490196, 'auc': 0.5557861328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.9642, std=7.8261
[DEBUG][MIA] Test Set Loss:   mean=9.7485, std=7.5382
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.08399999999999999, 'auc': 0.538208, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.5823, std=8.0957
[DEBUG][MIA] Test Set Loss:   mean=9.9831, std=8.2315
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.49298095703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.7868, std=8.2683
[DEBUG][MIA] Test Set Loss:   mean=9.1602, std=7.9971
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11200000000000002, 'auc': 0.475344, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.2321, std=5.2164
[DEBUG][MIA] Test Set Loss:   mean=4.7076, std=5.6804
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.12941176470588237, 'auc': 0.466796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7583, std=5.7964
[DEBUG][MIA] Test Set Loss:   mean=5.2943, std=5.8516
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.11200000000000002, 'auc': 0.47384000000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=41.9641, std=30.8164
[DEBUG][MIA] Test Set Loss:   mean=49.2198, std=34.4628
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09411764705882353, 'auc': 0.444580078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=45.7338, std=29.8903
[DEBUG][MIA] Test Set Loss:   mean=46.3821, std=30.8064
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10200000000000001, 'auc': 0.505944, 'task': 8}
Total correct retain:  646  Total retain:  2500
Total correct forget:  10155  Total forget:  47500
Total correct test:  115  Total test:  500
Total correct forget test:  2017  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.23, 0.26, 0.212, 0.202, 0.168, 0.188, 0.214, 0.248, 0.182, 0.222, 0.2, 0.202, 0.172, 0.17, 0.186, 0.194, 0.222, 0.216, 0.254, 0.322]
Unlearning task: 7
Accuracy, Confidence: (0.203125, 0.8154935240745544)
broken out of loop
Accuracy, Confidence: (0.203125, 0.7709795236587524)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.6325, std=5.9025
[DEBUG][MIA] Test Set Loss:   mean=5.6202, std=6.0978
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.1215686274509804, 'auc': 0.50592041015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3784, std=5.6653
[DEBUG][MIA] Test Set Loss:   mean=5.7303, std=6.2171
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.08, 'auc': 0.488896, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.9409, std=6.4714
[DEBUG][MIA] Test Set Loss:   mean=7.2877, std=6.4400
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09019607843137255, 'auc': 0.486328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.8734, std=6.5178
[DEBUG][MIA] Test Set Loss:   mean=7.2477, std=6.3018
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.11800000000000002, 'auc': 0.482552, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.3548, std=5.8688
[DEBUG][MIA] Test Set Loss:   mean=6.4276, std=5.4445
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.16078431372549018, 'auc': 0.47943115234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.0127, std=5.7845
[DEBUG][MIA] Test Set Loss:   mean=5.8742, std=5.2729
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.501232, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.3834, std=3.9187
[DEBUG][MIA] Test Set Loss:   mean=4.8415, std=3.7751
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09803921568627451, 'auc': 0.44866943359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8045, std=4.0261
[DEBUG][MIA] Test Set Loss:   mean=4.6857, std=3.9664
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.1, 'auc': 0.4888799999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.3514, std=7.0072
[DEBUG][MIA] Test Set Loss:   mean=8.8397, std=7.7910
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10588235294117647, 'auc': 0.5513916015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.2717, std=6.8187
[DEBUG][MIA] Test Set Loss:   mean=8.3041, std=7.1577
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11400000000000002, 'auc': 0.495008, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9665, std=7.3145
[DEBUG][MIA] Test Set Loss:   mean=9.3036, std=7.6536
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.1568627450980392, 'auc': 0.4443359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.2464, std=8.0743
[DEBUG][MIA] Test Set Loss:   mean=8.8352, std=7.5299
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10600000000000001, 'auc': 0.51152, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.6328, std=4.8178
[DEBUG][MIA] Test Set Loss:   mean=4.7825, std=4.9427
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.50823974609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5628, std=4.8897
[DEBUG][MIA] Test Set Loss:   mean=4.8370, std=5.4581
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.096, 'auc': 0.488128, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=45.4309, std=29.3831
[DEBUG][MIA] Test Set Loss:   mean=46.2394, std=33.1173
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.12941176470588237, 'auc': 0.501220703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=42.3561, std=29.8555
[DEBUG][MIA] Test Set Loss:   mean=42.8857, std=32.0595
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10200000000000001, 'auc': 0.501552, 'task': 8}
Total correct retain:  518  Total retain:  2500
Total correct forget:  9979  Total forget:  47500
Total correct test:  101  Total test:  500
Total correct forget test:  1979  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.202, 0.236, 0.23, 0.198, 0.178, 0.188, 0.19, 0.248, 0.178, 0.23, 0.18, 0.214, 0.196, 0.154, 0.176, 0.186, 0.212, 0.192, 0.286, 0.286]
Unlearning task: 6
Accuracy, Confidence: (0.2265625, 0.8638988733291626)
broken out of loop
Accuracy, Confidence: (0.19921875, 0.8308970928192139)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.5809, std=5.5176
[DEBUG][MIA] Test Set Loss:   mean=5.2694, std=5.6973
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.1215686274509804, 'auc': 0.51641845703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3860, std=5.6835
[DEBUG][MIA] Test Set Loss:   mean=5.3300, std=5.8847
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.098, 'auc': 0.5010399999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.1098, std=5.9636
[DEBUG][MIA] Test Set Loss:   mean=5.1576, std=4.8968
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09411764705882353, 'auc': 0.4595947265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4859, std=5.5491
[DEBUG][MIA] Test Set Loss:   mean=5.8217, std=5.2643
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.09, 'auc': 0.47358399999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2254, std=5.6178
[DEBUG][MIA] Test Set Loss:   mean=6.1007, std=5.6876
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.49163818359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9425, std=5.9230
[DEBUG][MIA] Test Set Loss:   mean=5.7591, std=5.4189
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.072, 'auc': 0.502032, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5897, std=3.9163
[DEBUG][MIA] Test Set Loss:   mean=5.0971, std=4.0795
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.12941176470588237, 'auc': 0.5408935546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6409, std=3.7238
[DEBUG][MIA] Test Set Loss:   mean=5.0684, std=4.1377
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.09, 'auc': 0.529728, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.5542, std=6.2516
[DEBUG][MIA] Test Set Loss:   mean=7.2384, std=7.0651
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.510009765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.2923, std=6.4259
[DEBUG][MIA] Test Set Loss:   mean=7.3539, std=6.9787
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.540528, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.1843, std=8.2447
[DEBUG][MIA] Test Set Loss:   mean=8.6328, std=7.7143
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.12156862745098038, 'auc': 0.4923095703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.3674, std=8.1912
[DEBUG][MIA] Test Set Loss:   mean=8.7156, std=7.6270
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.52016, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7738, std=3.6593
[DEBUG][MIA] Test Set Loss:   mean=4.2622, std=4.6619
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11372549019607843, 'auc': 0.49151611328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5629, std=4.6199
[DEBUG][MIA] Test Set Loss:   mean=4.2097, std=4.9831
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.09, 'auc': 0.460064, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=41.3271, std=27.3149
[DEBUG][MIA] Test Set Loss:   mean=43.7505, std=31.0687
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.52667236328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=43.5883, std=33.3016
[DEBUG][MIA] Test Set Loss:   mean=43.8673, std=34.0977
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.096, 'auc': 0.494024, 'task': 8}
Total correct retain:  449  Total retain:  2500
Total correct forget:  9801  Total forget:  47500
Total correct test:  95  Total test:  500
Total correct forget test:  1983  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.19, 0.23, 0.25, 0.208, 0.146, 0.216, 0.162, 0.26, 0.16, 0.246, 0.16, 0.232, 0.166, 0.164, 0.178, 0.192, 0.24, 0.204, 0.27, 0.282]
Unlearning task: 5
Accuracy, Confidence: (0.1640625, 0.7658502459526062)
broken out of loop
Accuracy, Confidence: (0.16015625, 0.7734854817390442)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.7792, std=5.9121
[DEBUG][MIA] Test Set Loss:   mean=5.2312, std=6.0245
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09019607843137255, 'auc': 0.468505859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3957, std=5.7647
[DEBUG][MIA] Test Set Loss:   mean=5.2214, std=5.8742
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.4828799999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7377, std=5.2783
[DEBUG][MIA] Test Set Loss:   mean=5.0241, std=5.4251
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.48028564453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3693, std=5.9018
[DEBUG][MIA] Test Set Loss:   mean=5.2866, std=5.1159
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.48014399999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7464, std=5.8103
[DEBUG][MIA] Test Set Loss:   mean=5.4998, std=4.7894
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11764705882352941, 'auc': 0.47796630859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7649, std=5.6532
[DEBUG][MIA] Test Set Loss:   mean=5.7881, std=5.6071
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.096, 'auc': 0.49156800000000006, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5852, std=3.9936
[DEBUG][MIA] Test Set Loss:   mean=4.7310, std=3.6969
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12549019607843137, 'auc': 0.52239990234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6618, std=4.5673
[DEBUG][MIA] Test Set Loss:   mean=4.5671, std=3.8977
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.096, 'auc': 0.509856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4548, std=6.1555
[DEBUG][MIA] Test Set Loss:   mean=6.9495, std=6.8532
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09019607843137255, 'auc': 0.50341796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7717, std=6.8637
[DEBUG][MIA] Test Set Loss:   mean=6.5330, std=6.8340
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.118, 'auc': 0.475008, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.0119, std=7.3307
[DEBUG][MIA] Test Set Loss:   mean=8.5268, std=7.8029
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09019607843137255, 'auc': 0.50909423828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3779, std=7.7146
[DEBUG][MIA] Test Set Loss:   mean=8.4605, std=7.4798
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10400000000000001, 'auc': 0.508176, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1692, std=4.3882
[DEBUG][MIA] Test Set Loss:   mean=4.1143, std=4.6091
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.0784313725490196, 'auc': 0.47833251953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2228, std=4.2898
[DEBUG][MIA] Test Set Loss:   mean=3.9876, std=4.4774
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.094, 'auc': 0.473952, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.6464, std=28.7394
[DEBUG][MIA] Test Set Loss:   mean=41.8569, std=33.3071
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.09019607843137255, 'auc': 0.43634033203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=39.2895, std=34.3801
[DEBUG][MIA] Test Set Loss:   mean=43.4449, std=34.4862
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.08, 'auc': 0.5455599999999999, 'task': 8}
Total correct retain:  424  Total retain:  2500
Total correct forget:  9848  Total forget:  47500
Total correct test:  89  Total test:  500
Total correct forget test:  1985  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.178, 0.232, 0.252, 0.224, 0.15, 0.25, 0.148, 0.262, 0.182, 0.24, 0.158, 0.24, 0.174, 0.146, 0.164, 0.182, 0.234, 0.194, 0.266, 0.272]
Unlearning task: 4
Accuracy, Confidence: (0.20703125, 0.752239465713501)
broken out of loop
Accuracy, Confidence: (0.19921875, 0.7450958490371704)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.7057, std=5.7001
[DEBUG][MIA] Test Set Loss:   mean=5.2945, std=5.5938
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.08627450980392157, 'auc': 0.4847412109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.1326, std=5.1775
[DEBUG][MIA] Test Set Loss:   mean=5.3280, std=5.6668
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.092, 'auc': 0.49807999999999997, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7395, std=5.1384
[DEBUG][MIA] Test Set Loss:   mean=4.2175, std=4.6500
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.4656982421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1807, std=5.2993
[DEBUG][MIA] Test Set Loss:   mean=5.0006, std=5.6642
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.098, 'auc': 0.5215360000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8138, std=5.9069
[DEBUG][MIA] Test Set Loss:   mean=5.3007, std=5.5548
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09803921568627451, 'auc': 0.5172119140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7877, std=5.7788
[DEBUG][MIA] Test Set Loss:   mean=5.5035, std=5.5600
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.096, 'auc': 0.5092160000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.7096, std=4.6454
[DEBUG][MIA] Test Set Loss:   mean=4.7242, std=3.6525
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09019607843137255, 'auc': 0.53424072265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.7697, std=4.3499
[DEBUG][MIA] Test Set Loss:   mean=4.9587, std=4.3657
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.096, 'auc': 0.485456, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.8080, std=6.2190
[DEBUG][MIA] Test Set Loss:   mean=6.3491, std=6.6103
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09411764705882353, 'auc': 0.5145263671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.1135, std=6.8440
[DEBUG][MIA] Test Set Loss:   mean=6.7466, std=6.9408
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.098, 'auc': 0.470688, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9973, std=7.6660
[DEBUG][MIA] Test Set Loss:   mean=8.0485, std=7.3955
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.51129150390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8761, std=7.5103
[DEBUG][MIA] Test Set Loss:   mean=8.8173, std=7.4819
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.543776, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8222, std=4.1143
[DEBUG][MIA] Test Set Loss:   mean=4.2605, std=4.7718
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.08627450980392157, 'auc': 0.52557373046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8490, std=4.6531
[DEBUG][MIA] Test Set Loss:   mean=3.9969, std=4.7609
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.092, 'auc': 0.5296960000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.6238, std=29.2583
[DEBUG][MIA] Test Set Loss:   mean=41.6558, std=32.0625
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.10588235294117647, 'auc': 0.43536376953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.4867, std=31.9092
[DEBUG][MIA] Test Set Loss:   mean=41.8042, std=34.6395
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.096, 'auc': 0.455728, 'task': 8}
Total correct retain:  444  Total retain:  2500
Total correct forget:  9902  Total forget:  47500
Total correct test:  93  Total test:  500
Total correct forget test:  1998  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.186, 0.224, 0.256, 0.218, 0.158, 0.264, 0.134, 0.256, 0.186, 0.256, 0.168, 0.236, 0.182, 0.156, 0.17, 0.178, 0.232, 0.192, 0.262, 0.268]
Unlearning task: 3
Accuracy, Confidence: (0.26953125, 0.8109129071235657)
broken out of loop
Accuracy, Confidence: (0.27734375, 0.8060932159423828)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.2606, std=5.3567
[DEBUG][MIA] Test Set Loss:   mean=5.6744, std=5.8936
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10196078431372549, 'auc': 0.529541015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.1335, std=5.5353
[DEBUG][MIA] Test Set Loss:   mean=5.7280, std=6.0750
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.1, 'auc': 0.47225599999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.6394, std=5.4252
[DEBUG][MIA] Test Set Loss:   mean=4.7538, std=4.3061
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.12941176470588237, 'auc': 0.4683837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4121, std=5.9369
[DEBUG][MIA] Test Set Loss:   mean=4.6267, std=5.1229
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.094, 'auc': 0.534032, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9060, std=6.0251
[DEBUG][MIA] Test Set Loss:   mean=6.1241, std=6.2391
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.15294117647058822, 'auc': 0.474365234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.4798, std=5.7680
[DEBUG][MIA] Test Set Loss:   mean=5.7310, std=5.9854
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.128, 'auc': 0.485376, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.7843, std=4.0109
[DEBUG][MIA] Test Set Loss:   mean=5.3759, std=3.9448
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.09803921568627451, 'auc': 0.5579833984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3868, std=5.0810
[DEBUG][MIA] Test Set Loss:   mean=5.2484, std=4.9002
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.094, 'auc': 0.49785599999999997, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3419, std=5.7557
[DEBUG][MIA] Test Set Loss:   mean=6.4710, std=6.8600
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.08627450980392157, 'auc': 0.47332763671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0002, std=6.0500
[DEBUG][MIA] Test Set Loss:   mean=6.6406, std=7.0340
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.1, 'auc': 0.5047999999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7580, std=7.8221
[DEBUG][MIA] Test Set Loss:   mean=9.5811, std=8.1969
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.09803921568627451, 'auc': 0.57208251953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.4398, std=7.9729
[DEBUG][MIA] Test Set Loss:   mean=8.6491, std=8.0078
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.088, 'auc': 0.4880000000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.2845, std=3.8325
[DEBUG][MIA] Test Set Loss:   mean=4.3483, std=5.6964
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09019607843137255, 'auc': 0.4486083984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8231, std=4.6939
[DEBUG][MIA] Test Set Loss:   mean=4.0554, std=5.0740
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.08399999999999999, 'auc': 0.477904, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.5652, std=30.4498
[DEBUG][MIA] Test Set Loss:   mean=43.8316, std=38.9347
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.07058823529411765, 'auc': 0.55401611328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=38.3165, std=31.9311
[DEBUG][MIA] Test Set Loss:   mean=39.9373, std=34.1842
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10400000000000001, 'auc': 0.512384, 'task': 8}
Total correct retain:  445  Total retain:  2500
Total correct forget:  10031  Total forget:  47500
Total correct test:  92  Total test:  500
Total correct forget test:  1993  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.184, 0.23, 0.256, 0.216, 0.162, 0.268, 0.138, 0.256, 0.196, 0.254, 0.162, 0.238, 0.178, 0.146, 0.168, 0.178, 0.222, 0.194, 0.254, 0.27]
Unlearning task: 2
Accuracy, Confidence: (0.23828125, 0.7402839660644531)
broken out of loop
Accuracy, Confidence: (0.234375, 0.7213706970214844)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 5, 8, 5, 7, 7, 7, 5, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3078, std=4.6197
[DEBUG][MIA] Test Set Loss:   mean=5.5293, std=5.9832
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.10588235294117647, 'auc': 0.44305419921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 5 5 9 9 9 5 6 7 6]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 9 5 7 8 8 5 5 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.8769, std=5.2232
[DEBUG][MIA] Test Set Loss:   mean=4.8917, std=5.2279
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.096, 'auc': 0.51008, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([12, 12, 11, 10, 12, 10, 12, 13, 14, 12], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.8056, std=5.6215
[DEBUG][MIA] Test Set Loss:   mean=5.3210, std=6.1950
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09411764705882353, 'auc': 0.4642333984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 14 12 14 11 12 12 12 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 14 13 12 10 13 14 12 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1435, std=5.8581
[DEBUG][MIA] Test Set Loss:   mean=4.7370, std=5.0698
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.086, 'auc': 0.5030239999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 16, 17, 15, 19, 18, 15, 17, 18, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7785, std=5.6261
[DEBUG][MIA] Test Set Loss:   mean=4.3125, std=4.6580
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10196078431372549, 'auc': 0.4244384765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 19 17 16 15 17 19 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 15 18 16 17 17 16 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.6750, std=5.7328
[DEBUG][MIA] Test Set Loss:   mean=5.0335, std=5.7015
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11200000000000002, 'auc': 0.53184, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 23, 20, 24, 22, 21, 22, 20, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5040, std=4.5130
[DEBUG][MIA] Test Set Loss:   mean=5.1476, std=5.3066
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.08235294117647059, 'auc': 0.46209716796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 21 20 23 23 20 20 22 21 24]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 24 23 21 21 21 23 20 23 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6308, std=4.8193
[DEBUG][MIA] Test Set Loss:   mean=5.0778, std=5.3380
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10200000000000001, 'auc': 0.52256, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 27, 26, 28, 26, 26, 27, 27, 27, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.8212, std=6.0591
[DEBUG][MIA] Test Set Loss:   mean=7.3848, std=7.0654
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.09019607843137255, 'auc': 0.44232177734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 27 26 26 28 28 28 27 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 28 28 26 28 25 27 25 27 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3882, std=5.9721
[DEBUG][MIA] Test Set Loss:   mean=6.4733, std=6.7743
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.5433600000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 30, 33, 34, 32, 33, 33, 33, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8193, std=7.5836
[DEBUG][MIA] Test Set Loss:   mean=7.8178, std=7.4348
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09411764705882353, 'auc': 0.498046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 34 31 30 33 34 34 30 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 33 34 32 33 32 31 31 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.2424, std=7.9091
[DEBUG][MIA] Test Set Loss:   mean=8.4244, std=7.7489
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11000000000000001, 'auc': 0.5105759999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 39, 39, 39, 35, 38, 35, 37, 37, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.6476, std=4.0074
[DEBUG][MIA] Test Set Loss:   mean=3.4856, std=3.6137
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.510009765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 39 39 39 35 38 37 36 38 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 38 38 39 38 36 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.9883, std=4.8129
[DEBUG][MIA] Test Set Loss:   mean=4.2819, std=5.2725
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.122, 'auc': 0.487296, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 42, 44, 42, 43, 40, 41, 41, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.1071, std=29.4579
[DEBUG][MIA] Test Set Loss:   mean=41.1097, std=38.6705
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10980392156862746, 'auc': 0.53350830078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 43 41 42 41 42 43 41 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 43 41 43]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=34.5628, std=31.8756
[DEBUG][MIA] Test Set Loss:   mean=40.8521, std=36.0882
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10200000000000001, 'auc': 0.544856, 'task': 8}
Total correct retain:  453  Total retain:  2500
Total correct forget:  10149  Total forget:  47500
Total correct test:  98  Total test:  500
Total correct forget test:  2033  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.196, 0.222, 0.252, 0.218, 0.17, 0.278, 0.136, 0.272, 0.202, 0.256, 0.168, 0.254, 0.176, 0.154, 0.172, 0.186, 0.224, 0.188, 0.244, 0.294]
Command line arguments:
number_of_gpus: 1
algorithm: ALT-NEGGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 20
unlearn_mem_strength: 0.5
unlearn_batch_size: 10
average_over_n_runs: 3
salun: 0
salun_strength: 0.2
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 07:51:21 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 37%   65C    P0             68W /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['willow', 'forest', 'beetle', 'tulips', 'flatfish', 'streetcar', 'sea', 'chimpanzee', 'fox', 'lizard', 'oranges', 'couch', 'kangaroo', 'ray', 'wolf', 'shrew', 'lobster', 'bus', 'porcupine', 'skyscraper', 'sunflowers', 'girl', 'caterpillar', 'possum', 'roses', 'train', 'orchids', 'raccoon', 'trout', 'bee', 'clock', 'dinosaur', 'cups', 'bed', 'table', 'turtle', 'crab', 'castle', 'skunk', 'bottles', 'rocket', 'house', 'snake', 'woman', 'snail', 'palm', 'telephone', 'otter', 'cloud', 'bridge', 'crocodile', 'cockroach', 'camel', 'butterfly', 'worm', 'mouse', 'pine', 'pickup truck', 'man', 'hamster', 'apples', 'lawn-mower', 'sweet peppers', 'bowls', 'squirrel', 'mushrooms', 'tiger', 'bear', 'oak', 'chair', 'shark', 'cattle', 'leopard', 'computer keyboard', 'seal', 'motorcycle', 'maple', 'plain', 'road', 'dolphin', 'boy', 'spider', 'television', 'tank', 'lion', 'lamp', 'whale', 'cans', 'beaver', 'wardrobe', 'baby', 'elephant', 'plates', 'tractor', 'mountain', 'rabbit', 'poppies', 'bicycle', 'aquarium fish', 'pears']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2156  Total retain:  2500
Total correct forget:  9628  Total forget:  47500
Total correct test:  338  Total test:  500
Total correct forget test:  1934  Total test forget:  9500
After learning task 1
Task accuracies: [0.676, 0.172, 0.192, 0.234, 0.168, 0.212, 0.202, 0.202, 0.192, 0.2, 0.196, 0.182, 0.194, 0.284, 0.184, 0.316, 0.176, 0.152, 0.196, 0.214]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0206
[DEBUG][MIA] Test Set Loss:   mean=0.7126, std=2.0350
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.18823529411764706, 'auc': 0.66357421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0085, std=0.0700
[DEBUG][MIA] Test Set Loss:   mean=0.6512, std=1.9494
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.21000000000000002, 'auc': 0.648896, 'task': 1}
2 1
Total correct retain:  1904  Total retain:  2500
Total correct forget:  11562  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  2222  Total test forget:  9500
After learning task 2
Task accuracies: [0.64, 0.848, 0.212, 0.18, 0.18, 0.206, 0.2, 0.274, 0.22, 0.2, 0.17, 0.214, 0.198, 0.27, 0.18, 0.146, 0.152, 0.23, 0.166, 0.198]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0717, std=0.3192
[DEBUG][MIA] Test Set Loss:   mean=1.5689, std=2.3807
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.615686274509804, 'auc': 0.738311767578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8231, std=1.7240
[DEBUG][MIA] Test Set Loss:   mean=1.6044, std=2.4653
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.192, 'auc': 0.603688, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0111, std=0.0686
[DEBUG][MIA] Test Set Loss:   mean=0.6993, std=2.0723
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.23137254901960783, 'auc': 0.669586181640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0240, std=0.2300
[DEBUG][MIA] Test Set Loss:   mean=0.9262, std=2.5745
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.22599999999999998, 'auc': 0.6798480000000001, 'task': 2}
3 2
Total correct retain:  1753  Total retain:  2500
Total correct forget:  12732  Total forget:  47500
Total correct test:  299  Total test:  500
Total correct forget test:  2367  Total test forget:  9500
After learning task 3
Task accuracies: [0.598, 0.618, 0.806, 0.2, 0.178, 0.19, 0.21, 0.268, 0.184, 0.198, 0.142, 0.148, 0.226, 0.254, 0.126, 0.234, 0.134, 0.222, 0.182, 0.214]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=0.8851, std=1.7578
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.30196078431372547, 'auc': 0.707000732421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5818, std=1.4039
[DEBUG][MIA] Test Set Loss:   mean=0.8554, std=1.8912
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.14200000000000002, 'auc': 0.545216, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.3050, std=2.4319
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.28627450980392155, 'auc': 0.761199951171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4304, std=1.2009
[DEBUG][MIA] Test Set Loss:   mean=1.1899, std=2.3641
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.20800000000000002, 'auc': 0.616216, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0300, std=0.3010
[DEBUG][MIA] Test Set Loss:   mean=1.2443, std=2.5116
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.24705882352941178, 'auc': 0.733856201171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0053, std=0.0499
[DEBUG][MIA] Test Set Loss:   mean=1.2374, std=2.6799
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.658, 'cv_acc': 0.254, 'auc': 0.701512, 'task': 3}
4 3
Total correct retain:  1787  Total retain:  2500
Total correct forget:  14744  Total forget:  47500
Total correct test:  333  Total test:  500
Total correct forget test:  2719  Total test forget:  9500
After learning task 4
Task accuracies: [0.666, 0.728, 0.698, 0.76, 0.186, 0.238, 0.192, 0.202, 0.182, 0.248, 0.204, 0.166, 0.206, 0.25, 0.15, 0.25, 0.174, 0.284, 0.156, 0.164]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0148, std=0.0458
[DEBUG][MIA] Test Set Loss:   mean=1.1633, std=2.0318
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.25098039215686274, 'auc': 0.690460205078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0941, std=2.0719
[DEBUG][MIA] Test Set Loss:   mean=1.2148, std=2.0479
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.154, 'auc': 0.513744, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.2614, std=2.6142
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6784313725490196, 'auc': 0.774627685546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6650, std=1.6616
[DEBUG][MIA] Test Set Loss:   mean=1.4086, std=2.8896
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.174, 'auc': 0.56004, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0181, std=0.0954
[DEBUG][MIA] Test Set Loss:   mean=1.3736, std=2.6209
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.25098039215686274, 'auc': 0.736236572265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5228, std=1.4979
[DEBUG][MIA] Test Set Loss:   mean=1.6752, std=3.0279
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.202, 'auc': 0.626024, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0097, std=0.0512
[DEBUG][MIA] Test Set Loss:   mean=1.1070, std=2.4863
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.20784313725490194, 'auc': 0.707733154296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0125, std=0.1387
[DEBUG][MIA] Test Set Loss:   mean=1.1113, std=2.5321
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.23199999999999998, 'auc': 0.6844159999999999, 'task': 4}
5 4
Total correct retain:  1805  Total retain:  2500
Total correct forget:  15800  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  2841  Total test forget:  9500
After learning task 5
Task accuracies: [0.674, 0.666, 0.71, 0.684, 0.766, 0.186, 0.162, 0.256, 0.186, 0.188, 0.192, 0.168, 0.188, 0.256, 0.15, 0.19, 0.13, 0.224, 0.208, 0.172]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0311
[DEBUG][MIA] Test Set Loss:   mean=1.2537, std=2.3718
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7058823529411764, 'auc': 0.7562255859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2975, std=2.6180
[DEBUG][MIA] Test Set Loss:   mean=1.3997, std=2.4347
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.132, 'auc': 0.5587440000000001, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.6420, std=2.9657
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.29411764705882354, 'auc': 0.810028076171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7666, std=1.9524
[DEBUG][MIA] Test Set Loss:   mean=1.5281, std=2.8195
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15, 'auc': 0.577096, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0145
[DEBUG][MIA] Test Set Loss:   mean=1.5914, std=2.9296
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2941176470588235, 'auc': 0.758453369140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6491, std=1.6796
[DEBUG][MIA] Test Set Loss:   mean=1.5721, std=2.7828
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.198, 'auc': 0.6033040000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=1.1988, std=2.2395
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24705882352941178, 'auc': 0.787872314453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3388, std=1.0846
[DEBUG][MIA] Test Set Loss:   mean=1.2733, std=2.6736
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.21000000000000002, 'auc': 0.654072, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0066
[DEBUG][MIA] Test Set Loss:   mean=0.5476, std=1.6244
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.23137254901960783, 'auc': 0.731353759765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=0.5070, std=1.6765
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.23199999999999998, 'auc': 0.711184, 'task': 5}
6 5
Total correct retain:  1756  Total retain:  2500
Total correct forget:  17726  Total forget:  47500
Total correct test:  325  Total test:  500
Total correct forget test:  3170  Total test forget:  9500
After learning task 6
Task accuracies: [0.65, 0.672, 0.686, 0.666, 0.704, 0.836, 0.188, 0.272, 0.206, 0.192, 0.184, 0.138, 0.2, 0.266, 0.17, 0.194, 0.13, 0.228, 0.18, 0.228]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0198
[DEBUG][MIA] Test Set Loss:   mean=1.1565, std=2.4141
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.3058823529411765, 'auc': 0.815643310546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8200, std=1.8593
[DEBUG][MIA] Test Set Loss:   mean=1.1299, std=2.2554
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11000000000000001, 'auc': 0.55744, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.9188, std=3.2412
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.30196078431372547, 'auc': 0.81732177734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1668, std=2.4321
[DEBUG][MIA] Test Set Loss:   mean=1.7677, std=3.3443
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11400000000000002, 'auc': 0.563616, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0153
[DEBUG][MIA] Test Set Loss:   mean=1.4509, std=2.5323
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7333333333333333, 'auc': 0.835205078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8983, std=2.0418
[DEBUG][MIA] Test Set Loss:   mean=1.1714, std=2.0892
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.202, 'auc': 0.594256, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0081, std=0.0385
[DEBUG][MIA] Test Set Loss:   mean=1.4785, std=2.7209
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2666666666666667, 'auc': 0.7833251953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7771, std=1.7672
[DEBUG][MIA] Test Set Loss:   mean=1.8082, std=3.0885
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.152, 'auc': 0.617048, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.0741, std=2.1361
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.3058823529411765, 'auc': 0.792144775390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3537, std=0.9672
[DEBUG][MIA] Test Set Loss:   mean=1.2947, std=2.2600
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.194, 'auc': 0.6272, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0404
[DEBUG][MIA] Test Set Loss:   mean=1.3465, std=2.4745
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.23137254901960785, 'auc': 0.7293701171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0116, std=0.0737
[DEBUG][MIA] Test Set Loss:   mean=1.1560, std=2.2907
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.27999999999999997, 'auc': 0.730032, 'task': 6}
7 6
Total correct retain:  1638  Total retain:  2500
Total correct forget:  18983  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  3319  Total test forget:  9500
After learning task 7
Task accuracies: [0.616, 0.696, 0.642, 0.658, 0.664, 0.686, 0.726, 0.238, 0.192, 0.176, 0.196, 0.208, 0.206, 0.254, 0.142, 0.186, 0.116, 0.212, 0.204, 0.236]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.9529, std=1.9112
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.25098039215686274, 'auc': 0.8114013671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1511, std=2.5115
[DEBUG][MIA] Test Set Loss:   mean=1.3166, std=2.6154
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.13399999999999998, 'auc': 0.536936, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.4544, std=2.5894
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2784313725490196, 'auc': 0.809173583984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2404, std=2.3242
[DEBUG][MIA] Test Set Loss:   mean=1.7779, std=2.9141
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.12799999999999997, 'auc': 0.5422959999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8059, std=2.9716
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.27450980392156865, 'auc': 0.869049072265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8640, std=1.9998
[DEBUG][MIA] Test Set Loss:   mean=1.2163, std=2.3768
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.186, 'auc': 0.560888, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0442, std=0.3034
[DEBUG][MIA] Test Set Loss:   mean=1.4582, std=2.8833
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2941176470588235, 'auc': 0.742279052734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0756, std=2.4169
[DEBUG][MIA] Test Set Loss:   mean=1.8302, std=3.2475
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.154, 'auc': 0.554368, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.6746, std=2.4738
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.2901960784313725, 'auc': 0.876556396484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5320, std=1.4451
[DEBUG][MIA] Test Set Loss:   mean=1.3875, std=2.4821
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.18, 'auc': 0.610072, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.2150, std=2.3036
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.3058823529411765, 'auc': 0.7890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1759, std=0.6926
[DEBUG][MIA] Test Set Loss:   mean=1.4079, std=2.5315
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.254, 'auc': 0.695664, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0115
[DEBUG][MIA] Test Set Loss:   mean=1.0098, std=2.2225
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2235294117647059, 'auc': 0.648406982421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0067, std=0.0565
[DEBUG][MIA] Test Set Loss:   mean=0.8316, std=2.0343
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.22800000000000004, 'auc': 0.648984, 'task': 7}
8 7
Total correct retain:  1675  Total retain:  2500
Total correct forget:  20505  Total forget:  47500
Total correct test:  326  Total test:  500
Total correct forget test:  3632  Total test forget:  9500
After learning task 8
Task accuracies: [0.652, 0.732, 0.638, 0.696, 0.644, 0.688, 0.682, 0.8, 0.196, 0.2, 0.214, 0.196, 0.21, 0.308, 0.156, 0.166, 0.126, 0.224, 0.18, 0.208]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.3209, std=2.7615
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2901960784313725, 'auc': 0.782012939453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0569, std=2.2716
[DEBUG][MIA] Test Set Loss:   mean=1.3789, std=2.7617
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.13599999999999998, 'auc': 0.562248, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.4646, std=2.6539
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.7098039215686275, 'auc': 0.834503173828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2391, std=2.7094
[DEBUG][MIA] Test Set Loss:   mean=1.5461, std=2.9977
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.146, 'auc': 0.572448, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.8426, std=3.4679
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.3098039215686274, 'auc': 0.79180908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8473, std=1.8175
[DEBUG][MIA] Test Set Loss:   mean=1.7138, std=3.1239
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.16999999999999998, 'auc': 0.560576, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0159, std=0.0597
[DEBUG][MIA] Test Set Loss:   mean=1.6981, std=3.1599
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.5450980392156862, 'auc': 0.778533935546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9900, std=2.2144
[DEBUG][MIA] Test Set Loss:   mean=1.4411, std=2.7106
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12400000000000003, 'auc': 0.549608, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.6019, std=2.6437
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7098039215686274, 'auc': 0.866943359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8466, std=1.8096
[DEBUG][MIA] Test Set Loss:   mean=1.7407, std=2.9889
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.194, 'auc': 0.60144, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.6562, std=2.6640
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7137254901960784, 'auc': 0.821044921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5863, std=1.3655
[DEBUG][MIA] Test Set Loss:   mean=1.8538, std=3.0754
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.196, 'auc': 0.6192719999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.1961, std=2.2852
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.26666666666666666, 'auc': 0.81365966796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1863, std=0.7230
[DEBUG][MIA] Test Set Loss:   mean=1.1749, std=2.2829
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.21200000000000002, 'auc': 0.6663279999999999, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=1.5182, std=2.4715
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.25882352941176473, 'auc': 0.74114990234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=1.5286, std=2.7987
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.696, 'cv_acc': 0.26, 'auc': 0.771312, 'task': 8}
Total correct retain:  1665  Total retain:  2500
Total correct forget:  21774  Total forget:  47500
Total correct test:  321  Total test:  500
Total correct forget test:  3844  Total test forget:  9500
After learning task 9
Task accuracies: [0.642, 0.706, 0.668, 0.68, 0.678, 0.66, 0.638, 0.718, 0.696, 0.194, 0.164, 0.2, 0.25, 0.252, 0.158, 0.158, 0.188, 0.264, 0.204, 0.212]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.2443, std=2.8206
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2823529411764706, 'auc': 0.807769775390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2439, std=2.6449
[DEBUG][MIA] Test Set Loss:   mean=1.3267, std=2.7576
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.146, 'auc': 0.510448, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.5825, std=2.6911
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7372549019607842, 'auc': 0.831451416015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0747, std=2.2863
[DEBUG][MIA] Test Set Loss:   mean=1.9211, std=3.0271
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.10800000000000001, 'auc': 0.568272, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.7625, std=2.9227
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.28627450980392155, 'auc': 0.80743408203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2346, std=2.5427
[DEBUG][MIA] Test Set Loss:   mean=1.8257, std=3.0619
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10400000000000001, 'auc': 0.560136, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0863, std=0.5914
[DEBUG][MIA] Test Set Loss:   mean=1.7742, std=2.9822
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.23529411764705882, 'auc': 0.775390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1699, std=2.2464
[DEBUG][MIA] Test Set Loss:   mean=1.4093, std=2.6822
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.15, 'auc': 0.5057520000000001, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.5143, std=2.5483
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7058823529411765, 'auc': 0.8359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1775, std=2.5032
[DEBUG][MIA] Test Set Loss:   mean=2.0987, std=3.3331
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.146, 'auc': 0.590024, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.8835, std=3.1271
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7333333333333333, 'auc': 0.874908447265625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8605, std=1.9184
[DEBUG][MIA] Test Set Loss:   mean=1.6504, std=2.8086
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.188, 'auc': 0.622784, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.1443, std=2.2358
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2901960784313726, 'auc': 0.834625244140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3907, std=1.1515
[DEBUG][MIA] Test Set Loss:   mean=1.3603, std=2.5903
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.22000000000000003, 'auc': 0.634616, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.9875, std=3.3802
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7254901960784313, 'auc': 0.8526611328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2623, std=0.9398
[DEBUG][MIA] Test Set Loss:   mean=1.8253, std=3.1470
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.266, 'auc': 0.708256, 'task': 8}
Total correct retain:  1648  Total retain:  2500
Total correct forget:  23385  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  4033  Total test forget:  9500
After learning task 10
Task accuracies: [0.6, 0.71, 0.634, 0.67, 0.668, 0.628, 0.628, 0.684, 0.626, 0.812, 0.166, 0.192, 0.246, 0.272, 0.152, 0.148, 0.16, 0.252, 0.206, 0.212]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0053
[DEBUG][MIA] Test Set Loss:   mean=1.5414, std=3.2766
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30196078431372547, 'auc': 0.737457275390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2024, std=2.5776
[DEBUG][MIA] Test Set Loss:   mean=1.5322, std=2.9017
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.1, 'auc': 0.578112, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.6514, std=2.9830
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2666666666666667, 'auc': 0.86553955078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9423, std=2.1719
[DEBUG][MIA] Test Set Loss:   mean=1.6770, std=3.0270
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.132, 'auc': 0.5952, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.7683, std=3.0248
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.7372549019607844, 'auc': 0.8232421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4529, std=2.8563
[DEBUG][MIA] Test Set Loss:   mean=2.0578, std=3.1076
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.158, 'auc': 0.533216, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0558, std=0.3197
[DEBUG][MIA] Test Set Loss:   mean=1.4477, std=2.7762
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.29411764705882354, 'auc': 0.72161865234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0042, std=2.3305
[DEBUG][MIA] Test Set Loss:   mean=1.6457, std=2.9563
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11800000000000002, 'auc': 0.5906880000000001, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5027, std=2.5279
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7176470588235293, 'auc': 0.8809814453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8438, std=1.9918
[DEBUG][MIA] Test Set Loss:   mean=1.9014, std=3.1136
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.196, 'auc': 0.604552, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.9308, std=2.9701
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7568627450980392, 'auc': 0.8262939453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7761, std=1.8504
[DEBUG][MIA] Test Set Loss:   mean=1.8465, std=2.8928
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.17200000000000001, 'auc': 0.644232, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.0660, std=2.1135
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6941176470588235, 'auc': 0.818359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6668, std=1.6653
[DEBUG][MIA] Test Set Loss:   mean=1.3182, std=2.3176
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.196, 'auc': 0.5743600000000001, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.6366, std=2.9031
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.30588235294117644, 'auc': 0.812774658203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6366, std=1.6335
[DEBUG][MIA] Test Set Loss:   mean=1.9705, std=3.3627
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.24, 'auc': 0.63968, 'task': 8}
Total correct retain:  1648  Total retain:  2500
Total correct forget:  24849  Total forget:  47500
Total correct test:  322  Total test:  500
Total correct forget test:  4271  Total test forget:  9500
After learning task 11
Task accuracies: [0.644, 0.666, 0.658, 0.624, 0.666, 0.62, 0.622, 0.668, 0.632, 0.714, 0.826, 0.202, 0.252, 0.298, 0.16, 0.116, 0.194, 0.18, 0.192, 0.252]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9979583024978638)
broken out of loop
Accuracy, Confidence: (0.265625, 0.9628982543945312)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3145, std=1.0289
[DEBUG][MIA] Test Set Loss:   mean=2.5488, std=3.7785
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2117647058823529, 'auc': 0.7200927734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4796, std=3.0517
[DEBUG][MIA] Test Set Loss:   mean=2.0338, std=3.5383
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.148, 'auc': 0.528008, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6398, std=1.7952
[DEBUG][MIA] Test Set Loss:   mean=2.7422, std=4.5123
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.25098039215686274, 'auc': 0.690948486328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6909, std=4.5425
[DEBUG][MIA] Test Set Loss:   mean=2.8269, std=5.2052
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.092, 'auc': 0.498112, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2652, std=0.9711
[DEBUG][MIA] Test Set Loss:   mean=1.7777, std=3.3553
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.16862745098039214, 'auc': 0.71002197265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4779, std=3.1261
[DEBUG][MIA] Test Set Loss:   mean=1.8198, std=3.4285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11600000000000002, 'auc': 0.52284, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6641, std=1.7251
[DEBUG][MIA] Test Set Loss:   mean=1.8555, std=3.8922
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.23137254901960783, 'auc': 0.615386962890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0212, std=3.5865
[DEBUG][MIA] Test Set Loss:   mean=2.1609, std=3.5846
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.12200000000000003, 'auc': 0.522864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6182, std=1.8034
[DEBUG][MIA] Test Set Loss:   mean=2.4439, std=3.6282
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.22745098039215686, 'auc': 0.696563720703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9818, std=3.6282
[DEBUG][MIA] Test Set Loss:   mean=2.2051, std=3.5565
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.13399999999999998, 'auc': 0.545032, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3616, std=1.2099
[DEBUG][MIA] Test Set Loss:   mean=1.9185, std=2.5126
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.5607843137254902, 'auc': 0.73944091796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2445, std=2.2261
[DEBUG][MIA] Test Set Loss:   mean=1.8804, std=2.7642
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.184, 'auc': 0.5664480000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6225, std=1.7850
[DEBUG][MIA] Test Set Loss:   mean=1.6363, std=3.2192
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.4431372549019608, 'auc': 0.585723876953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2493, std=2.3638
[DEBUG][MIA] Test Set Loss:   mean=2.2376, std=3.7843
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11599999999999999, 'auc': 0.556176, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.3256, std=3.1759
[DEBUG][MIA] Test Set Loss:   mean=2.6785, std=4.1832
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.2235294117647059, 'auc': 0.60791015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0928, std=3.9660
[DEBUG][MIA] Test Set Loss:   mean=3.2345, std=4.4502
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11800000000000002, 'auc': 0.599344, 'task': 8}
Total correct retain:  1469  Total retain:  2500
Total correct forget:  20153  Total forget:  47500
Total correct test:  279  Total test:  500
Total correct forget test:  3653  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.558, 0.626, 0.604, 0.674, 0.594, 0.556, 0.53, 0.624, 0.512, 0.546, 0.29, 0.194, 0.172, 0.274, 0.186, 0.162, 0.162, 0.186, 0.188, 0.226]
Unlearning task: 10
Accuracy, Confidence: (0.7421875, 0.8912364840507507)
broken out of loop
Accuracy, Confidence: (0.41015625, 0.9160371422767639)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9516, std=2.1897
[DEBUG][MIA] Test Set Loss:   mean=2.3524, std=3.7076
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.20392156862745098, 'auc': 0.616424560546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1896, std=3.6895
[DEBUG][MIA] Test Set Loss:   mean=2.1269, std=3.0586
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10200000000000001, 'auc': 0.504464, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0251, std=2.3538
[DEBUG][MIA] Test Set Loss:   mean=3.1033, std=4.0937
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.1764705882352941, 'auc': 0.67681884765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5236, std=3.8056
[DEBUG][MIA] Test Set Loss:   mean=3.2722, std=4.3952
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.094, 'auc': 0.54292, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4711, std=1.3695
[DEBUG][MIA] Test Set Loss:   mean=2.3043, std=3.5514
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.1764705882352941, 'auc': 0.713134765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8062, std=2.8408
[DEBUG][MIA] Test Set Loss:   mean=2.4527, std=3.6214
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.094, 'auc': 0.551248, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7564, std=2.9575
[DEBUG][MIA] Test Set Loss:   mean=3.0850, std=3.9239
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.12156862745098038, 'auc': 0.5999755859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1837, std=3.9476
[DEBUG][MIA] Test Set Loss:   mean=3.6468, std=4.3449
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.088, 'auc': 0.53272, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9650, std=3.4440
[DEBUG][MIA] Test Set Loss:   mean=3.3796, std=4.4885
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.09411764705882353, 'auc': 0.62347412109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.9949, std=4.2463
[DEBUG][MIA] Test Set Loss:   mean=3.7637, std=4.8472
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.553464, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2112, std=2.6426
[DEBUG][MIA] Test Set Loss:   mean=3.1190, std=4.2870
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.21176470588235294, 'auc': 0.68707275390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7612, std=2.9951
[DEBUG][MIA] Test Set Loss:   mean=2.9624, std=3.9611
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.144, 'auc': 0.599136, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7778, std=2.0784
[DEBUG][MIA] Test Set Loss:   mean=2.5433, std=4.2240
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.18431372549019606, 'auc': 0.67022705078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2949, std=2.8862
[DEBUG][MIA] Test Set Loss:   mean=1.7881, std=3.1736
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11600000000000002, 'auc': 0.5825279999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9677, std=3.2788
[DEBUG][MIA] Test Set Loss:   mean=3.0490, std=3.5221
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.1568627450980392, 'auc': 0.62640380859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.2064, std=3.4936
[DEBUG][MIA] Test Set Loss:   mean=3.2101, std=4.1118
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.12400000000000003, 'auc': 0.589456, 'task': 8}
Total correct retain:  1219  Total retain:  2500
Total correct forget:  17436  Total forget:  47500
Total correct test:  229  Total test:  500
Total correct forget test:  3184  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.458, 0.572, 0.516, 0.554, 0.45, 0.448, 0.484, 0.582, 0.422, 0.322, 0.222, 0.194, 0.128, 0.31, 0.176, 0.234, 0.14, 0.22, 0.234, 0.16]
Unlearning task: 9
Accuracy, Confidence: (0.62890625, 0.8834221959114075)
broken out of loop
Accuracy, Confidence: (0.4140625, 0.9021435976028442)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5538, std=1.4333
[DEBUG][MIA] Test Set Loss:   mean=2.7616, std=3.6744
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2117647058823529, 'auc': 0.69915771484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8724, std=2.9761
[DEBUG][MIA] Test Set Loss:   mean=2.1479, std=3.5193
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11600000000000002, 'auc': 0.51636, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4172, std=2.7482
[DEBUG][MIA] Test Set Loss:   mean=3.8208, std=5.7969
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.21176470588235294, 'auc': 0.649200439453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.9748, std=4.6360
[DEBUG][MIA] Test Set Loss:   mean=3.3321, std=4.8092
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10800000000000001, 'auc': 0.5139279999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6754, std=1.6954
[DEBUG][MIA] Test Set Loss:   mean=2.3577, std=3.3314
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.22745098039215686, 'auc': 0.707183837890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9774, std=3.1588
[DEBUG][MIA] Test Set Loss:   mean=1.7917, std=2.8478
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.15599999999999997, 'auc': 0.46990400000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6394, std=1.2531
[DEBUG][MIA] Test Set Loss:   mean=1.3814, std=2.2731
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.19607843137254904, 'auc': 0.587615966796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3853, std=2.6179
[DEBUG][MIA] Test Set Loss:   mean=1.6343, std=2.8884
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.098, 'auc': 0.542376, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6650, std=1.5726
[DEBUG][MIA] Test Set Loss:   mean=2.0151, std=3.1962
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2392156862745098, 'auc': 0.686676025390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8147, std=2.9807
[DEBUG][MIA] Test Set Loss:   mean=2.4663, std=3.7841
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11400000000000002, 'auc': 0.554824, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6314, std=1.4223
[DEBUG][MIA] Test Set Loss:   mean=2.0220, std=2.6542
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.3137254901960784, 'auc': 0.715301513671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5221, std=2.3134
[DEBUG][MIA] Test Set Loss:   mean=2.4846, std=3.3376
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.176, 'auc': 0.5915360000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6775, std=1.7725
[DEBUG][MIA] Test Set Loss:   mean=1.8778, std=3.4787
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.18823529411764706, 'auc': 0.6298828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9658, std=4.1607
[DEBUG][MIA] Test Set Loss:   mean=1.8495, std=3.5071
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.194, 'auc': 0.5196879999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.4046, std=16.4756
[DEBUG][MIA] Test Set Loss:   mean=13.0012, std=18.2301
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10980392156862746, 'auc': 0.57269287109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.6157, std=18.4110
[DEBUG][MIA] Test Set Loss:   mean=12.8476, std=17.2367
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11399999999999999, 'auc': 0.5390640000000001, 'task': 8}
Total correct retain:  1298  Total retain:  2500
Total correct forget:  17603  Total forget:  47500
Total correct test:  253  Total test:  500
Total correct forget test:  3242  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.506, 0.6, 0.506, 0.522, 0.618, 0.552, 0.458, 0.592, 0.264, 0.246, 0.208, 0.194, 0.106, 0.29, 0.186, 0.26, 0.192, 0.212, 0.216, 0.262]
Unlearning task: 8
Accuracy, Confidence: (0.79296875, 0.8914339542388916)
broken out of loop
Accuracy, Confidence: (0.4609375, 0.9332618117332458)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4237, std=1.1522
[DEBUG][MIA] Test Set Loss:   mean=2.0419, std=3.2256
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2156862745098039, 'auc': 0.6573486328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7781, std=3.1270
[DEBUG][MIA] Test Set Loss:   mean=1.6613, std=2.8701
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11200000000000002, 'auc': 0.49228, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2637, std=3.4632
[DEBUG][MIA] Test Set Loss:   mean=3.3408, std=5.4736
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.19607843137254904, 'auc': 0.65118408203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8313, std=7.0227
[DEBUG][MIA] Test Set Loss:   mean=4.0359, std=5.9671
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.092, 'auc': 0.551152, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1096, std=3.0076
[DEBUG][MIA] Test Set Loss:   mean=1.8160, std=2.4008
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.29411764705882354, 'auc': 0.6651611328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8579, std=2.6394
[DEBUG][MIA] Test Set Loss:   mean=2.2105, std=3.4269
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.094, 'auc': 0.5262, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6679, std=1.6139
[DEBUG][MIA] Test Set Loss:   mean=1.5930, std=3.4581
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.1843137254901961, 'auc': 0.58984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3623, std=2.2538
[DEBUG][MIA] Test Set Loss:   mean=1.7488, std=2.8247
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.556216, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4545, std=1.1364
[DEBUG][MIA] Test Set Loss:   mean=2.0821, std=2.7694
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2235294117647059, 'auc': 0.7205810546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3138, std=2.2904
[DEBUG][MIA] Test Set Loss:   mean=2.0854, std=3.0200
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.086, 'auc': 0.581216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2356, std=1.9692
[DEBUG][MIA] Test Set Loss:   mean=2.2799, std=2.4039
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.4313725490196078, 'auc': 0.6680908203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.1242, std=2.8672
[DEBUG][MIA] Test Set Loss:   mean=2.2526, std=2.5712
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11000000000000001, 'auc': 0.524904, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.1134, std=17.4611
[DEBUG][MIA] Test Set Loss:   mean=9.3700, std=16.9712
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.1176470588235294, 'auc': 0.4051513671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.5843, std=16.8312
[DEBUG][MIA] Test Set Loss:   mean=10.3737, std=18.2487
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.12200000000000003, 'auc': 0.48744, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.5317, std=15.0139
[DEBUG][MIA] Test Set Loss:   mean=8.9718, std=14.9013
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.16862745098039217, 'auc': 0.5263671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.7545, std=16.6082
[DEBUG][MIA] Test Set Loss:   mean=10.5619, std=15.7719
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10600000000000001, 'auc': 0.571016, 'task': 8}
Total correct retain:  1326  Total retain:  2500
Total correct forget:  16828  Total forget:  47500
Total correct test:  236  Total test:  500
Total correct forget test:  3100  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.472, 0.622, 0.522, 0.476, 0.6, 0.564, 0.394, 0.348, 0.316, 0.314, 0.21, 0.182, 0.142, 0.23, 0.184, 0.236, 0.19, 0.222, 0.222, 0.226]
Unlearning task: 7
Accuracy, Confidence: (0.68359375, 0.8347693085670471)
broken out of loop
Accuracy, Confidence: (0.4140625, 0.8635679483413696)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6505, std=1.5186
[DEBUG][MIA] Test Set Loss:   mean=2.1212, std=2.8542
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2392156862745098, 'auc': 0.67694091796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1928, std=2.9067
[DEBUG][MIA] Test Set Loss:   mean=2.3096, std=3.0817
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.12000000000000002, 'auc': 0.51056, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8164, std=2.3020
[DEBUG][MIA] Test Set Loss:   mean=3.2678, std=4.2656
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.20392156862745098, 'auc': 0.7794189453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4919, std=4.1072
[DEBUG][MIA] Test Set Loss:   mean=2.9031, std=3.8370
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.122, 'auc': 0.551536, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8050, std=1.4877
[DEBUG][MIA] Test Set Loss:   mean=1.9368, std=2.4730
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.5725490196078431, 'auc': 0.68572998046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7385, std=2.3044
[DEBUG][MIA] Test Set Loss:   mean=1.7160, std=2.2497
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.16, 'auc': 0.513424, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4865, std=1.0181
[DEBUG][MIA] Test Set Loss:   mean=1.6124, std=2.7848
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.2156862745098039, 'auc': 0.5877685546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5823, std=2.5408
[DEBUG][MIA] Test Set Loss:   mean=1.6918, std=2.6115
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.088, 'auc': 0.50864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5479, std=1.1577
[DEBUG][MIA] Test Set Loss:   mean=1.8693, std=2.5165
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.5764705882352941, 'auc': 0.69573974609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4263, std=2.6989
[DEBUG][MIA] Test Set Loss:   mean=1.8636, std=2.4299
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.10800000000000001, 'auc': 0.579984, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.7838, std=7.2959
[DEBUG][MIA] Test Set Loss:   mean=5.4223, std=6.4047
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.08627450980392157, 'auc': 0.58917236328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3294, std=6.4256
[DEBUG][MIA] Test Set Loss:   mean=6.3004, std=7.1687
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.08399999999999999, 'auc': 0.5507839999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.4106, std=12.6192
[DEBUG][MIA] Test Set Loss:   mean=6.3214, std=8.9490
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10980392156862746, 'auc': 0.4501953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.8090, std=10.6173
[DEBUG][MIA] Test Set Loss:   mean=6.6995, std=9.4998
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.460312, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5788, std=10.8609
[DEBUG][MIA] Test Set Loss:   mean=6.3653, std=10.3316
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.12941176470588234, 'auc': 0.54180908203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.8369, std=14.4463
[DEBUG][MIA] Test Set Loss:   mean=7.1692, std=11.0173
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.458, 'cv_acc': 0.14400000000000002, 'auc': 0.484544, 'task': 8}
Total correct retain:  1326  Total retain:  2500
Total correct forget:  16176  Total forget:  47500
Total correct test:  250  Total test:  500
Total correct forget test:  2962  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.5, 0.492, 0.514, 0.492, 0.61, 0.522, 0.266, 0.294, 0.298, 0.282, 0.222, 0.204, 0.126, 0.274, 0.178, 0.26, 0.232, 0.214, 0.21, 0.234]
Unlearning task: 6
Accuracy, Confidence: (0.8359375, 0.8848770260810852)
broken out of loop
Accuracy, Confidence: (0.40625, 0.9334242939949036)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0418, std=4.1268
[DEBUG][MIA] Test Set Loss:   mean=3.5553, std=5.3463
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.09803921568627451, 'auc': 0.61199951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6689, std=5.4317
[DEBUG][MIA] Test Set Loss:   mean=3.9212, std=5.5376
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.096, 'auc': 0.485384, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9569, std=2.3878
[DEBUG][MIA] Test Set Loss:   mean=2.5867, std=3.2592
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.23137254901960783, 'auc': 0.70794677734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0225, std=3.1327
[DEBUG][MIA] Test Set Loss:   mean=2.2839, std=3.6228
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.533504, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4518, std=0.8849
[DEBUG][MIA] Test Set Loss:   mean=2.0869, std=3.3772
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.38823529411764707, 'auc': 0.70843505859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7019, std=2.5720
[DEBUG][MIA] Test Set Loss:   mean=1.8926, std=2.8517
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.12600000000000003, 'auc': 0.5132159999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0417, std=3.1021
[DEBUG][MIA] Test Set Loss:   mean=2.8919, std=3.7277
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.15294117647058822, 'auc': 0.563629150390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1446, std=4.6308
[DEBUG][MIA] Test Set Loss:   mean=3.0676, std=4.3297
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.495344, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.1859, std=9.2788
[DEBUG][MIA] Test Set Loss:   mean=7.5957, std=8.6895
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.11764705882352941, 'auc': 0.465667724609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.4748, std=8.6824
[DEBUG][MIA] Test Set Loss:   mean=8.0384, std=8.9421
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10400000000000001, 'auc': 0.47768, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6621, std=6.4087
[DEBUG][MIA] Test Set Loss:   mean=7.6985, std=7.3705
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.09019607843137255, 'auc': 0.408935546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.4373, std=5.9991
[DEBUG][MIA] Test Set Loss:   mean=6.7172, std=6.2719
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.448, 'cv_acc': 0.10200000000000001, 'auc': 0.430496, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.6533, std=12.4703
[DEBUG][MIA] Test Set Loss:   mean=9.6849, std=12.9863
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12156862745098038, 'auc': 0.51214599609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.1471, std=12.7070
[DEBUG][MIA] Test Set Loss:   mean=8.9597, std=11.3479
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.094, 'auc': 0.48352799999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.2486, std=13.2175
[DEBUG][MIA] Test Set Loss:   mean=11.7159, std=14.1435
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09803921568627451, 'auc': 0.568389892578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.8332, std=14.5085
[DEBUG][MIA] Test Set Loss:   mean=9.5437, std=12.9243
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11400000000000002, 'auc': 0.527944, 'task': 8}
Total correct retain:  1143  Total retain:  2500
Total correct forget:  14227  Total forget:  47500
Total correct test:  203  Total test:  500
Total correct forget test:  2695  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.406, 0.422, 0.552, 0.542, 0.472, 0.34, 0.226, 0.308, 0.332, 0.198, 0.184, 0.202, 0.122, 0.256, 0.188, 0.222, 0.184, 0.196, 0.238, 0.206]
Unlearning task: 5
Accuracy, Confidence: (0.60546875, 0.8992964029312134)
broken out of loop
Accuracy, Confidence: (0.375, 0.9294092655181885)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.6151, std=7.6370
[DEBUG][MIA] Test Set Loss:   mean=5.6439, std=7.3342
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09803921568627451, 'auc': 0.58209228515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.9918, std=7.6524
[DEBUG][MIA] Test Set Loss:   mean=5.0881, std=6.5047
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.1, 'auc': 0.5192, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3190, std=2.7617
[DEBUG][MIA] Test Set Loss:   mean=2.7253, std=3.5944
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.1607843137254902, 'auc': 0.6480712890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0645, std=3.4568
[DEBUG][MIA] Test Set Loss:   mean=2.8116, std=3.9130
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.458, 'cv_acc': 0.094, 'auc': 0.422304, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8471, std=2.9596
[DEBUG][MIA] Test Set Loss:   mean=2.4195, std=2.6914
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.17647058823529413, 'auc': 0.62249755859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2175, std=2.8472
[DEBUG][MIA] Test Set Loss:   mean=2.5162, std=3.0311
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.532464, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.9012, std=8.4687
[DEBUG][MIA] Test Set Loss:   mean=8.2277, std=9.8816
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.08235294117647059, 'auc': 0.527740478515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.3194, std=9.1732
[DEBUG][MIA] Test Set Loss:   mean=7.4040, std=8.8583
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.11599999999999999, 'auc': 0.46817600000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.1543, std=10.5871
[DEBUG][MIA] Test Set Loss:   mean=9.1555, std=9.5523
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10196078431372549, 'auc': 0.56890869140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.6899, std=9.2210
[DEBUG][MIA] Test Set Loss:   mean=7.7566, std=8.3410
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.092, 'auc': 0.5222640000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9932, std=9.5619
[DEBUG][MIA] Test Set Loss:   mean=7.4853, std=7.7413
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10196078431372549, 'auc': 0.4573974609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6390, std=9.7075
[DEBUG][MIA] Test Set Loss:   mean=7.5312, std=8.2310
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10200000000000001, 'auc': 0.47473600000000005, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.5694, std=11.4915
[DEBUG][MIA] Test Set Loss:   mean=10.1583, std=11.1738
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.09803921568627451, 'auc': 0.46441650390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.2263, std=12.0743
[DEBUG][MIA] Test Set Loss:   mean=11.1213, std=11.3754
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10600000000000001, 'auc': 0.491448, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.3930, std=12.2217
[DEBUG][MIA] Test Set Loss:   mean=10.4973, std=12.0204
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.13725490196078433, 'auc': 0.50177001953125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.4377, std=13.2437
[DEBUG][MIA] Test Set Loss:   mean=10.4093, std=11.5754
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.5094799999999999, 'task': 8}
Total correct retain:  1111  Total retain:  2500
Total correct forget:  13233  Total forget:  47500
Total correct test:  198  Total test:  500
Total correct forget test:  2453  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.396, 0.388, 0.5, 0.416, 0.362, 0.292, 0.236, 0.278, 0.262, 0.196, 0.214, 0.23, 0.11, 0.26, 0.19, 0.228, 0.162, 0.152, 0.196, 0.234]
Unlearning task: 4
Accuracy, Confidence: (0.6171875, 0.8549567461013794)
broken out of loop
Accuracy, Confidence: (0.39453125, 0.8769046068191528)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1160, std=3.7330
[DEBUG][MIA] Test Set Loss:   mean=2.9196, std=3.6769
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.19215686274509805, 'auc': 0.59991455078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.3197, std=4.3670
[DEBUG][MIA] Test Set Loss:   mean=3.0882, std=3.9219
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.49925600000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9093, std=3.5776
[DEBUG][MIA] Test Set Loss:   mean=3.6317, std=5.0414
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.15686274509803924, 'auc': 0.605133056640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6976, std=4.3865
[DEBUG][MIA] Test Set Loss:   mean=3.0283, std=4.5101
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11200000000000002, 'auc': 0.5162, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9082, std=8.7156
[DEBUG][MIA] Test Set Loss:   mean=7.5900, std=9.2291
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10196078431372549, 'auc': 0.56610107421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.5358, std=8.5472
[DEBUG][MIA] Test Set Loss:   mean=6.8687, std=8.4288
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.094, 'auc': 0.468232, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3167, std=5.4420
[DEBUG][MIA] Test Set Loss:   mean=7.2032, std=6.6558
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.10588235294117647, 'auc': 0.428619384765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.5082, std=6.9592
[DEBUG][MIA] Test Set Loss:   mean=6.1056, std=6.4216
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.096, 'auc': 0.517736, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.0039, std=8.1956
[DEBUG][MIA] Test Set Loss:   mean=6.2606, std=7.2734
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09411764705882353, 'auc': 0.4951171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0357, std=6.9776
[DEBUG][MIA] Test Set Loss:   mean=6.9199, std=7.5869
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.1, 'auc': 0.5396400000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.4589, std=5.2423
[DEBUG][MIA] Test Set Loss:   mean=5.8183, std=5.1034
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.4814453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6380, std=4.7186
[DEBUG][MIA] Test Set Loss:   mean=6.2389, std=5.4685
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10400000000000001, 'auc': 0.522512, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.5772, std=7.6557
[DEBUG][MIA] Test Set Loss:   mean=6.6922, std=7.5998
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.13333333333333333, 'auc': 0.51263427734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9012, std=7.1434
[DEBUG][MIA] Test Set Loss:   mean=6.6123, std=7.5996
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.08199999999999999, 'auc': 0.4711200000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.3767, std=9.2052
[DEBUG][MIA] Test Set Loss:   mean=8.7188, std=8.9647
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.10980392156862746, 'auc': 0.5760498046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.7320, std=10.2487
[DEBUG][MIA] Test Set Loss:   mean=8.9047, std=9.5873
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.096, 'auc': 0.5248959999999999, 'task': 8}
Total correct retain:  966  Total retain:  2500
Total correct forget:  12994  Total forget:  47500
Total correct test:  182  Total test:  500
Total correct forget test:  2482  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.364, 0.434, 0.522, 0.29, 0.37, 0.338, 0.22, 0.344, 0.234, 0.204, 0.164, 0.196, 0.118, 0.248, 0.176, 0.25, 0.194, 0.182, 0.266, 0.214]
Unlearning task: 3
Accuracy, Confidence: (0.66796875, 0.9039508700370789)
broken out of loop
Accuracy, Confidence: (0.33984375, 0.939711332321167)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7469, std=2.7015
[DEBUG][MIA] Test Set Loss:   mean=3.3586, std=4.2788
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.20392156862745098, 'auc': 0.63714599609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7823, std=3.4412
[DEBUG][MIA] Test Set Loss:   mean=3.1732, std=3.8970
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10600000000000001, 'auc': 0.476576, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.8310, std=11.1264
[DEBUG][MIA] Test Set Loss:   mean=7.6107, std=8.9362
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.09411764705882353, 'auc': 0.517913818359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.7481, std=10.1678
[DEBUG][MIA] Test Set Loss:   mean=9.1434, std=9.7995
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.094, 'auc': 0.51092, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1768, std=6.8276
[DEBUG][MIA] Test Set Loss:   mean=7.5237, std=6.4971
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12156862745098038, 'auc': 0.526123046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1561, std=6.2706
[DEBUG][MIA] Test Set Loss:   mean=8.1465, std=6.9213
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10200000000000001, 'auc': 0.539088, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.5515, std=4.6914
[DEBUG][MIA] Test Set Loss:   mean=4.5968, std=5.0335
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09411764705882353, 'auc': 0.507293701171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2895, std=5.5804
[DEBUG][MIA] Test Set Loss:   mean=5.4666, std=5.6321
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.152, 'auc': 0.48796800000000007, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.5846, std=6.5258
[DEBUG][MIA] Test Set Loss:   mean=6.6139, std=6.5106
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11764705882352941, 'auc': 0.5074462890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.1424, std=6.0558
[DEBUG][MIA] Test Set Loss:   mean=5.9120, std=6.1839
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10400000000000001, 'auc': 0.48639999999999994, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.9897, std=4.5157
[DEBUG][MIA] Test Set Loss:   mean=3.7349, std=4.0630
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10980392156862744, 'auc': 0.51611328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.1831, std=4.7705
[DEBUG][MIA] Test Set Loss:   mean=4.3003, std=4.6305
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10800000000000001, 'auc': 0.46849599999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1580, std=4.4703
[DEBUG][MIA] Test Set Loss:   mean=5.2120, std=4.4817
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.16470588235294117, 'auc': 0.5843505859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5327, std=4.6188
[DEBUG][MIA] Test Set Loss:   mean=5.0214, std=4.8157
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.528184, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.3675, std=8.7327
[DEBUG][MIA] Test Set Loss:   mean=8.8713, std=8.7501
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.486053466796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.8507, std=8.5877
[DEBUG][MIA] Test Set Loss:   mean=9.6019, std=8.4405
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.08399999999999999, 'auc': 0.468256, 'task': 8}
Total correct retain:  1038  Total retain:  2500
Total correct forget:  12063  Total forget:  47500
Total correct test:  202  Total test:  500
Total correct forget test:  2360  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.404, 0.42, 0.306, 0.228, 0.388, 0.3, 0.308, 0.318, 0.182, 0.206, 0.184, 0.212, 0.12, 0.208, 0.178, 0.338, 0.198, 0.146, 0.238, 0.242]
Unlearning task: 2
Accuracy, Confidence: (0.58203125, 0.8633062839508057)
broken out of loop
Accuracy, Confidence: (0.30859375, 0.9241458177566528)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 9, 8, 9, 6, 9, 8, 6, 9, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.7520, std=9.2925
[DEBUG][MIA] Test Set Loss:   mean=7.6784, std=8.6993
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.12156862745098038, 'auc': 0.468841552734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 6 7 5 6 8 8 8 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 6 5 7 6 8 6 7 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.8027, std=8.5999
[DEBUG][MIA] Test Set Loss:   mean=9.4884, std=9.5478
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.126, 'auc': 0.44168, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 13, 13, 11, 10, 13, 12, 14, 13, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.6436, std=13.0364
[DEBUG][MIA] Test Set Loss:   mean=10.1029, std=10.8878
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.52203369140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 12 14 14 10 12 12 14 10 13]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 12 13 13 11 12 12 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.9049, std=12.3520
[DEBUG][MIA] Test Set Loss:   mean=10.2690, std=12.0524
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10200000000000001, 'auc': 0.5207120000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 18, 15, 17, 18, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=10.1114, std=8.6097
[DEBUG][MIA] Test Set Loss:   mean=11.2081, std=8.2171
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09411764705882353, 'auc': 0.5465087890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 16 19 19 18 18 15 16 15 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 18 17 19 15 16 16 17 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=10.8689, std=7.9513
[DEBUG][MIA] Test Set Loss:   mean=11.2743, std=8.2416
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11399999999999999, 'auc': 0.48596800000000007, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 22, 22, 24, 22, 20, 24, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8143, std=4.5413
[DEBUG][MIA] Test Set Loss:   mean=5.6695, std=5.2405
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11372549019607843, 'auc': 0.44677734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 23 23 21 21 22 23 22 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 24 24 20 20 22 24 23 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3652, std=5.3505
[DEBUG][MIA] Test Set Loss:   mean=5.6686, std=5.2743
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10400000000000001, 'auc': 0.48451999999999995, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 26, 26, 26, 29, 29, 25, 25, 25, 28], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.8081, std=7.2714
[DEBUG][MIA] Test Set Loss:   mean=7.5201, std=7.5486
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11764705882352941, 'auc': 0.45135498046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 29 27 27 26 27 26 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 28 26 29 28 27 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.0075, std=7.4980
[DEBUG][MIA] Test Set Loss:   mean=6.7322, std=7.0686
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.08399999999999999, 'auc': 0.50316, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 32, 33, 31, 32, 32, 33, 33, 30, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5742, std=6.1399
[DEBUG][MIA] Test Set Loss:   mean=3.7608, std=4.9209
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.1215686274509804, 'auc': 0.509979248046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 34 30 34 34 31 31 32 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 30 30 32 30 31 30 34 31 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.8655, std=5.8283
[DEBUG][MIA] Test Set Loss:   mean=5.0534, std=5.9259
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10200000000000001, 'auc': 0.5758319999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([38, 38, 38, 38, 39, 39, 36, 36, 36, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2407, std=4.7946
[DEBUG][MIA] Test Set Loss:   mean=5.8660, std=5.9902
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09411764705882353, 'auc': 0.42437744140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 39 36 38 38 35 35 36 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 38 35 38 37 39 36 36 38 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.6464, std=5.8208
[DEBUG][MIA] Test Set Loss:   mean=5.5953, std=5.4409
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.098, 'auc': 0.49935999999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 43, 41, 42, 43, 40, 42, 40, 42, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.6574, std=9.6367
[DEBUG][MIA] Test Set Loss:   mean=11.9599, std=8.8896
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.09803921568627451, 'auc': 0.484588623046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [42 42 43 41 44 40 40 41 42 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 44 44 42 42 40 44 43 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.0540, std=9.7214
[DEBUG][MIA] Test Set Loss:   mean=12.3582, std=8.8920
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.098, 'auc': 0.48377600000000004, 'task': 8}
Total correct retain:  835  Total retain:  2500
Total correct forget:  10737  Total forget:  47500
Total correct test:  157  Total test:  500
Total correct forget test:  2087  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.314, 0.272, 0.29, 0.132, 0.312, 0.26, 0.334, 0.254, 0.136, 0.176, 0.15, 0.208, 0.144, 0.192, 0.194, 0.226, 0.208, 0.156, 0.22, 0.31]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['oranges', 'mouse', 'road', 'leopard', 'snail', 'rocket', 'elephant', 'cans', 'tulips', 'wolf', 'maple', 'crocodile', 'shark', 'pine', 'pickup truck', 'porcupine', 'tiger', 'lion', 'dinosaur', 'butterfly', 'otter', 'train', 'sweet peppers', 'cockroach', 'beetle', 'pears', 'baby', 'bowls', 'woman', 'crab', 'possum', 'lobster', 'tank', 'bed', 'lawn-mower', 'bear', 'mountain', 'kangaroo', 'forest', 'lizard', 'aquarium fish', 'raccoon', 'shrew', 'orchids', 'castle', 'plain', 'flatfish', 'house', 'plates', 'roses', 'whale', 'wardrobe', 'turtle', 'caterpillar', 'sea', 'poppies', 'cups', 'ray', 'spider', 'bus', 'cloud', 'dolphin', 'bee', 'oak', 'hamster', 'girl', 'beaver', 'lamp', 'bottles', 'apples', 'worm', 'squirrel', 'computer keyboard', 'fox', 'chair', 'man', 'clock', 'palm', 'mushrooms', 'trout', 'table', 'bridge', 'snake', 'skunk', 'telephone', 'bicycle', 'willow', 'chimpanzee', 'couch', 'skyscraper', 'cattle', 'tractor', 'sunflowers', 'streetcar', 'seal', 'television', 'boy', 'camel', 'motorcycle', 'rabbit']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2191  Total retain:  2500
Total correct forget:  9245  Total forget:  47500
Total correct test:  360  Total test:  500
Total correct forget test:  1868  Total test forget:  9500
After learning task 1
Task accuracies: [0.72, 0.294, 0.268, 0.17, 0.234, 0.192, 0.2, 0.182, 0.196, 0.2, 0.216, 0.112, 0.174, 0.156, 0.2, 0.188, 0.184, 0.192, 0.23, 0.148]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0294
[DEBUG][MIA] Test Set Loss:   mean=1.2030, std=2.4034
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.21960784313725493, 'auc': 0.706634521484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.0794
[DEBUG][MIA] Test Set Loss:   mean=1.1799, std=2.5855
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.22200000000000003, 'auc': 0.683528, 'task': 1}
2 1
Total correct retain:  1924  Total retain:  2500
Total correct forget:  11796  Total forget:  47500
Total correct test:  343  Total test:  500
Total correct forget test:  2264  Total test forget:  9500
After learning task 2
Task accuracies: [0.686, 0.768, 0.25, 0.228, 0.186, 0.204, 0.204, 0.316, 0.292, 0.2, 0.168, 0.11, 0.186, 0.18, 0.198, 0.172, 0.214, 0.174, 0.25, 0.228]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.1766, std=2.6279
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2980392156862745, 'auc': 0.769927978515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4294, std=1.1365
[DEBUG][MIA] Test Set Loss:   mean=1.0465, std=2.2106
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.21600000000000003, 'auc': 0.59816, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0130, std=0.1221
[DEBUG][MIA] Test Set Loss:   mean=0.5863, std=1.6160
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.20784313725490197, 'auc': 0.757598876953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0143
[DEBUG][MIA] Test Set Loss:   mean=0.7938, std=2.1441
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.236, 'auc': 0.693832, 'task': 2}
3 2
Total correct retain:  1765  Total retain:  2500
Total correct forget:  13120  Total forget:  47500
Total correct test:  310  Total test:  500
Total correct forget test:  2450  Total test forget:  9500
After learning task 3
Task accuracies: [0.62, 0.732, 0.814, 0.198, 0.206, 0.196, 0.202, 0.244, 0.246, 0.198, 0.202, 0.13, 0.176, 0.154, 0.198, 0.212, 0.172, 0.208, 0.16, 0.252]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0167
[DEBUG][MIA] Test Set Loss:   mean=1.5518, std=2.6337
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2901960784313726, 'auc': 0.76361083984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7509, std=1.8318
[DEBUG][MIA] Test Set Loss:   mean=1.4412, std=2.4883
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.142, 'auc': 0.5958640000000001, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0187, std=0.1073
[DEBUG][MIA] Test Set Loss:   mean=1.4125, std=2.5443
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2705882352941177, 'auc': 0.7298583984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5113, std=1.3636
[DEBUG][MIA] Test Set Loss:   mean=1.4142, std=2.6245
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.17400000000000002, 'auc': 0.612032, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.1518
[DEBUG][MIA] Test Set Loss:   mean=1.0893, std=2.2639
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.23137254901960783, 'auc': 0.699066162109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0357
[DEBUG][MIA] Test Set Loss:   mean=1.1955, std=2.6857
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.666, 'cv_acc': 0.22999999999999998, 'auc': 0.7182240000000001, 'task': 3}
4 3
Total correct retain:  1785  Total retain:  2500
Total correct forget:  14003  Total forget:  47500
Total correct test:  326  Total test:  500
Total correct forget test:  2589  Total test forget:  9500
After learning task 4
Task accuracies: [0.652, 0.686, 0.714, 0.766, 0.164, 0.198, 0.206, 0.206, 0.172, 0.204, 0.218, 0.148, 0.162, 0.126, 0.192, 0.24, 0.16, 0.198, 0.174, 0.244]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0062
[DEBUG][MIA] Test Set Loss:   mean=1.3255, std=2.5454
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.30196078431372547, 'auc': 0.794464111328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7743, std=1.8747
[DEBUG][MIA] Test Set Loss:   mean=1.4791, std=2.5668
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.11200000000000002, 'auc': 0.569968, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0268, std=0.0906
[DEBUG][MIA] Test Set Loss:   mean=1.4740, std=2.9129
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.25098039215686274, 'auc': 0.756622314453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1840, std=2.6649
[DEBUG][MIA] Test Set Loss:   mean=1.4186, std=2.6588
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.152, 'auc': 0.5423279999999999, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0159
[DEBUG][MIA] Test Set Loss:   mean=1.2864, std=2.2767
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6941176470588235, 'auc': 0.787445068359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4265, std=1.1879
[DEBUG][MIA] Test Set Loss:   mean=1.4650, std=2.6406
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.15, 'auc': 0.6355919999999999, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0150, std=0.0996
[DEBUG][MIA] Test Set Loss:   mean=1.0437, std=2.2867
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2156862745098039, 'auc': 0.756072998046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0229, std=0.2139
[DEBUG][MIA] Test Set Loss:   mean=0.9547, std=2.2468
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.264, 'auc': 0.7297520000000001, 'task': 4}
5 4
Total correct retain:  1758  Total retain:  2500
Total correct forget:  15781  Total forget:  47500
Total correct test:  324  Total test:  500
Total correct forget test:  2895  Total test forget:  9500
After learning task 5
Task accuracies: [0.648, 0.688, 0.674, 0.68, 0.754, 0.184, 0.196, 0.226, 0.31, 0.202, 0.218, 0.142, 0.154, 0.148, 0.194, 0.25, 0.208, 0.15, 0.162, 0.25]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.5157, std=2.5311
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2901960784313725, 'auc': 0.774566650390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2764, std=2.3159
[DEBUG][MIA] Test Set Loss:   mean=1.5550, std=2.8755
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.5249199999999999, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0371, std=0.1372
[DEBUG][MIA] Test Set Loss:   mean=2.0900, std=3.2398
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2627450980392157, 'auc': 0.782257080078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2379, std=2.5288
[DEBUG][MIA] Test Set Loss:   mean=1.7496, std=2.8394
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.15399999999999997, 'auc': 0.5676239999999999, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0163, std=0.0662
[DEBUG][MIA] Test Set Loss:   mean=1.9015, std=3.3412
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6941176470588235, 'auc': 0.754180908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0416, std=2.1401
[DEBUG][MIA] Test Set Loss:   mean=2.0974, std=3.3578
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.152, 'auc': 0.59884, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0053
[DEBUG][MIA] Test Set Loss:   mean=1.2629, std=2.4663
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2901960784313726, 'auc': 0.832061767578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3146, std=0.8312
[DEBUG][MIA] Test Set Loss:   mean=1.5104, std=2.5518
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.2, 'auc': 0.66784, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0122
[DEBUG][MIA] Test Set Loss:   mean=1.6247, std=2.7958
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.24313725490196075, 'auc': 0.79486083984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0103, std=0.0803
[DEBUG][MIA] Test Set Loss:   mean=1.5237, std=3.0405
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.688, 'cv_acc': 0.27199999999999996, 'auc': 0.782312, 'task': 5}
6 5
Total correct retain:  1750  Total retain:  2500
Total correct forget:  17003  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  3070  Total test forget:  9500
After learning task 6
Task accuracies: [0.63, 0.684, 0.646, 0.62, 0.68, 0.706, 0.202, 0.33, 0.268, 0.198, 0.206, 0.128, 0.144, 0.196, 0.186, 0.23, 0.146, 0.13, 0.222, 0.218]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.5336, std=2.4772
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.28627450980392155, 'auc': 0.815887451171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0433, std=2.1352
[DEBUG][MIA] Test Set Loss:   mean=1.4115, std=2.4997
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.098, 'auc': 0.548056, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0063, std=0.0396
[DEBUG][MIA] Test Set Loss:   mean=1.1839, std=2.6398
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.3137254901960784, 'auc': 0.774444580078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8337, std=1.9375
[DEBUG][MIA] Test Set Loss:   mean=1.6541, std=2.8944
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.096, 'auc': 0.611904, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0157
[DEBUG][MIA] Test Set Loss:   mean=1.8582, std=3.1112
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.28627450980392155, 'auc': 0.7833251953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7411, std=1.8777
[DEBUG][MIA] Test Set Loss:   mean=1.7632, std=2.9010
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.15, 'auc': 0.59956, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.2823, std=2.2255
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7254901960784313, 'auc': 0.835784912109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5939, std=1.6802
[DEBUG][MIA] Test Set Loss:   mean=1.6362, std=2.7174
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.17200000000000001, 'auc': 0.61708, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=2.0088, std=3.5804
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7176470588235294, 'auc': 0.8604736328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2481, std=0.7821
[DEBUG][MIA] Test Set Loss:   mean=2.0853, std=3.4172
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.258, 'auc': 0.728088, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0173
[DEBUG][MIA] Test Set Loss:   mean=0.2915, std=0.8351
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.20784313725490197, 'auc': 0.686676025390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0246
[DEBUG][MIA] Test Set Loss:   mean=0.7126, std=1.8425
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.252, 'auc': 0.72956, 'task': 6}
7 6
Total correct retain:  1717  Total retain:  2500
Total correct forget:  18699  Total forget:  47500
Total correct test:  304  Total test:  500
Total correct forget test:  3273  Total test forget:  9500
After learning task 7
Task accuracies: [0.608, 0.69, 0.68, 0.65, 0.648, 0.61, 0.788, 0.238, 0.31, 0.2, 0.18, 0.142, 0.168, 0.146, 0.148, 0.262, 0.214, 0.126, 0.196, 0.15]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0069, std=0.0265
[DEBUG][MIA] Test Set Loss:   mean=1.6892, std=2.8789
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.6862745098039216, 'auc': 0.7359619140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4978, std=3.0012
[DEBUG][MIA] Test Set Loss:   mean=1.4125, std=2.4380
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.09, 'auc': 0.5432159999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0097
[DEBUG][MIA] Test Set Loss:   mean=1.3976, std=2.7583
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6823529411764706, 'auc': 0.79864501953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0813, std=2.3228
[DEBUG][MIA] Test Set Loss:   mean=1.5433, std=3.0488
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.13399999999999998, 'auc': 0.5276959999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=2.2391, std=3.5280
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.6862745098039216, 'auc': 0.85211181640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9188, std=2.2096
[DEBUG][MIA] Test Set Loss:   mean=1.7039, std=2.9729
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.13, 'auc': 0.6068239999999999, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0063
[DEBUG][MIA] Test Set Loss:   mean=1.5454, std=2.6711
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7411764705882353, 'auc': 0.84521484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9522, std=1.9972
[DEBUG][MIA] Test Set Loss:   mean=1.5521, std=2.6101
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.184, 'auc': 0.603568, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=2.2790, std=3.3461
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7568627450980393, 'auc': 0.862823486328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4473, std=1.1900
[DEBUG][MIA] Test Set Loss:   mean=1.9073, std=2.9645
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.24400000000000005, 'auc': 0.7040959999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.2730, std=2.3676
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7058823529411764, 'auc': 0.831512451171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2020, std=0.5794
[DEBUG][MIA] Test Set Loss:   mean=1.2478, std=2.2203
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.2, 'auc': 0.656568, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0174
[DEBUG][MIA] Test Set Loss:   mean=1.3162, std=2.4652
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.23137254901960783, 'auc': 0.7086181640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0208
[DEBUG][MIA] Test Set Loss:   mean=1.1311, std=2.6785
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.256, 'auc': 0.7733599999999999, 'task': 7}
8 7
Total correct retain:  1670  Total retain:  2500
Total correct forget:  20254  Total forget:  47500
Total correct test:  313  Total test:  500
Total correct forget test:  3524  Total test forget:  9500
After learning task 8
Task accuracies: [0.626, 0.672, 0.688, 0.646, 0.644, 0.574, 0.698, 0.758, 0.258, 0.2, 0.212, 0.172, 0.184, 0.198, 0.156, 0.224, 0.176, 0.148, 0.25, 0.19]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0076
[DEBUG][MIA] Test Set Loss:   mean=1.4809, std=2.6210
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2392156862745098, 'auc': 0.823516845703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1842, std=2.3848
[DEBUG][MIA] Test Set Loss:   mean=1.4357, std=2.6005
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10800000000000001, 'auc': 0.442288, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.3493, std=2.4167
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2823529411764706, 'auc': 0.821197509765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0420, std=2.2392
[DEBUG][MIA] Test Set Loss:   mean=1.4472, std=2.8069
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.142, 'auc': 0.564136, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.9776, std=2.8519
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7058823529411764, 'auc': 0.8740234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0290, std=2.0885
[DEBUG][MIA] Test Set Loss:   mean=1.7875, std=3.0085
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.164, 'auc': 0.582584, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.7890, std=3.1887
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6980392156862745, 'auc': 0.879608154296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0844, std=2.1621
[DEBUG][MIA] Test Set Loss:   mean=1.6837, std=2.9208
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.14999999999999997, 'auc': 0.585704, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=2.3264, std=3.1290
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.7450980392156863, 'auc': 0.911773681640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5250, std=1.3913
[DEBUG][MIA] Test Set Loss:   mean=2.0310, std=3.1642
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.242, 'auc': 0.692632, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.1567, std=2.0820
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2901960784313725, 'auc': 0.899200439453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3860, std=1.0180
[DEBUG][MIA] Test Set Loss:   mean=0.7810, std=1.6010
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.21400000000000002, 'auc': 0.607352, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.2005, std=2.4181
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2941176470588235, 'auc': 0.765167236328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1314, std=0.5014
[DEBUG][MIA] Test Set Loss:   mean=1.2249, std=2.4347
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.21600000000000003, 'auc': 0.68968, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0185
[DEBUG][MIA] Test Set Loss:   mean=1.1883, std=2.5329
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.19999999999999998, 'auc': 0.716033935546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0197
[DEBUG][MIA] Test Set Loss:   mean=0.7109, std=1.9290
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.22000000000000003, 'auc': 0.6747679999999999, 'task': 8}
Total correct retain:  1663  Total retain:  2500
Total correct forget:  21670  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3794  Total test forget:  9500
After learning task 9
Task accuracies: [0.606, 0.7, 0.668, 0.634, 0.644, 0.566, 0.698, 0.728, 0.832, 0.198, 0.236, 0.152, 0.192, 0.198, 0.16, 0.238, 0.19, 0.132, 0.196, 0.226]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0115
[DEBUG][MIA] Test Set Loss:   mean=1.9832, std=3.4528
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25098039215686274, 'auc': 0.833160400390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4895, std=3.0753
[DEBUG][MIA] Test Set Loss:   mean=1.4708, std=2.9649
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11000000000000001, 'auc': 0.49591999999999997, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.5997, std=2.8951
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.30588235294117644, 'auc': 0.83404541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9792, std=2.3774
[DEBUG][MIA] Test Set Loss:   mean=1.3009, std=2.5873
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.15199999999999997, 'auc': 0.553424, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=2.0996, std=3.1837
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7372549019607844, 'auc': 0.829498291015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1871, std=2.1247
[DEBUG][MIA] Test Set Loss:   mean=2.0164, std=3.2225
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.166, 'auc': 0.5559120000000001, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=1.8624, std=3.2083
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7411764705882353, 'auc': 0.838348388671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2245, std=2.7206
[DEBUG][MIA] Test Set Loss:   mean=1.9531, std=3.2761
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.16999999999999998, 'auc': 0.5788, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=2.2012, std=3.5737
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7215686274509804, 'auc': 0.863922119140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9667, std=2.0770
[DEBUG][MIA] Test Set Loss:   mean=2.1480, std=3.4204
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.242, 'auc': 0.6348, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.2678, std=2.3133
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.27450980392156865, 'auc': 0.877838134765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5555, std=1.3513
[DEBUG][MIA] Test Set Loss:   mean=1.4105, std=2.4937
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.21400000000000002, 'auc': 0.635256, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0091
[DEBUG][MIA] Test Set Loss:   mean=1.3388, std=2.3969
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6666666666666666, 'auc': 0.8502197265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2799, std=0.7934
[DEBUG][MIA] Test Set Loss:   mean=1.4046, std=2.4710
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.20800000000000002, 'auc': 0.679376, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=0.8811, std=1.9534
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2392156862745098, 'auc': 0.721466064453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1073, std=0.4684
[DEBUG][MIA] Test Set Loss:   mean=0.8583, std=2.0491
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.192, 'auc': 0.6235120000000001, 'task': 8}
Total correct retain:  1752  Total retain:  2500
Total correct forget:  23132  Total forget:  47500
Total correct test:  318  Total test:  500
Total correct forget test:  4028  Total test forget:  9500
After learning task 10
Task accuracies: [0.636, 0.704, 0.696, 0.592, 0.608, 0.576, 0.674, 0.652, 0.788, 0.88, 0.192, 0.13, 0.182, 0.256, 0.164, 0.24, 0.182, 0.148, 0.182, 0.21]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.6726, std=3.3831
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.26666666666666666, 'auc': 0.737640380859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5856, std=3.0964
[DEBUG][MIA] Test Set Loss:   mean=1.5271, std=3.0876
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.094, 'auc': 0.48646400000000006, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.8898, std=3.2495
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.29411764705882354, 'auc': 0.898468017578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3090, std=3.0772
[DEBUG][MIA] Test Set Loss:   mean=1.7405, std=2.9223
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11400000000000002, 'auc': 0.574624, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0318, std=0.2492
[DEBUG][MIA] Test Set Loss:   mean=2.3839, std=3.7114
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.45098039215686275, 'auc': 0.815277099609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4848, std=2.9123
[DEBUG][MIA] Test Set Loss:   mean=2.0239, std=3.1890
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.142, 'auc': 0.567512, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0199
[DEBUG][MIA] Test Set Loss:   mean=1.9897, std=3.3548
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2980392156862745, 'auc': 0.878204345703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1979, std=2.4769
[DEBUG][MIA] Test Set Loss:   mean=1.7508, std=2.7748
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.132, 'auc': 0.605992, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0102
[DEBUG][MIA] Test Set Loss:   mean=1.9306, std=3.2294
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7529411764705882, 'auc': 0.88787841796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7123, std=1.4978
[DEBUG][MIA] Test Set Loss:   mean=1.9495, std=2.9741
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.22600000000000003, 'auc': 0.641632, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.3747, std=2.3507
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7333333333333334, 'auc': 0.831573486328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6682, std=1.5450
[DEBUG][MIA] Test Set Loss:   mean=1.5884, std=2.5017
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.168, 'auc': 0.641672, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.1393, std=2.5220
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.2901960784313725, 'auc': 0.871917724609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8320, std=1.8834
[DEBUG][MIA] Test Set Loss:   mean=1.3683, std=2.4561
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.188, 'auc': 0.59016, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=0.8926, std=1.9764
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2823529411764706, 'auc': 0.80780029296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1750, std=0.5849
[DEBUG][MIA] Test Set Loss:   mean=0.9563, std=1.9202
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.184, 'auc': 0.6266, 'task': 8}
Total correct retain:  1757  Total retain:  2500
Total correct forget:  24527  Total forget:  47500
Total correct test:  318  Total test:  500
Total correct forget test:  4272  Total test forget:  9500
After learning task 11
Task accuracies: [0.636, 0.71, 0.658, 0.602, 0.618, 0.574, 0.638, 0.676, 0.76, 0.854, 0.8, 0.15, 0.18, 0.182, 0.172, 0.242, 0.186, 0.152, 0.174, 0.216]
Unlearning task: 11
Accuracy, Confidence: (0.99609375, 0.9900212287902832)
broken out of loop
Accuracy, Confidence: (0.30078125, 0.9722216129302979)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7537, std=2.4244
[DEBUG][MIA] Test Set Loss:   mean=2.1568, std=3.6205
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.21960784313725493, 'auc': 0.675628662109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7208, std=3.0433
[DEBUG][MIA] Test Set Loss:   mean=1.7012, std=2.6656
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.122, 'auc': 0.516256, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9042, std=2.2074
[DEBUG][MIA] Test Set Loss:   mean=3.2112, std=4.8237
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2235294117647059, 'auc': 0.69305419921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.9289, std=4.5852
[DEBUG][MIA] Test Set Loss:   mean=3.0611, std=4.4194
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.092, 'auc': 0.48372800000000005, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4967, std=1.4165
[DEBUG][MIA] Test Set Loss:   mean=2.7108, std=3.4321
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.24313725490196075, 'auc': 0.6812744140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9087, std=2.7233
[DEBUG][MIA] Test Set Loss:   mean=2.7211, std=3.2536
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.122, 'auc': 0.557808, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1154, std=2.9785
[DEBUG][MIA] Test Set Loss:   mean=2.3002, std=3.7059
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.22745098039215686, 'auc': 0.616912841796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9365, std=3.2089
[DEBUG][MIA] Test Set Loss:   mean=2.2173, std=3.1127
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.092, 'auc': 0.46908, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7212, std=1.2928
[DEBUG][MIA] Test Set Loss:   mean=1.9354, std=2.4395
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.6313725490196079, 'auc': 0.656158447265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2116, std=1.6952
[DEBUG][MIA] Test Set Loss:   mean=2.1627, std=2.3882
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.21000000000000002, 'auc': 0.6130080000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8530, std=2.0855
[DEBUG][MIA] Test Set Loss:   mean=1.9531, std=2.7140
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2941176470588235, 'auc': 0.679443359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5247, std=2.6180
[DEBUG][MIA] Test Set Loss:   mean=2.3728, std=3.1445
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.142, 'auc': 0.5902719999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5500, std=1.2250
[DEBUG][MIA] Test Set Loss:   mean=1.6173, std=2.5606
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2235294117647059, 'auc': 0.6500244140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9908, std=1.5403
[DEBUG][MIA] Test Set Loss:   mean=1.7406, std=2.3881
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.11600000000000002, 'auc': 0.580304, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5156, std=1.2984
[DEBUG][MIA] Test Set Loss:   mean=0.9606, std=1.8534
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.2235294117647059, 'auc': 0.555419921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5766, std=1.2059
[DEBUG][MIA] Test Set Loss:   mean=1.0664, std=1.6385
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.13999999999999999, 'auc': 0.58256, 'task': 8}
Total correct retain:  1581  Total retain:  2500
Total correct forget:  20012  Total forget:  47500
Total correct test:  290  Total test:  500
Total correct forget test:  3678  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.58, 0.622, 0.53, 0.496, 0.534, 0.456, 0.508, 0.564, 0.672, 0.732, 0.322, 0.22, 0.28, 0.3, 0.194, 0.21, 0.116, 0.178, 0.21, 0.212]
Unlearning task: 10
Accuracy, Confidence: (0.83984375, 0.890742838382721)
broken out of loop
Accuracy, Confidence: (0.31640625, 0.9426149129867554)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0269, std=2.0854
[DEBUG][MIA] Test Set Loss:   mean=2.7932, std=3.5746
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2392156862745098, 'auc': 0.652008056640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3199, std=3.3273
[DEBUG][MIA] Test Set Loss:   mean=2.6102, std=3.6570
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11200000000000002, 'auc': 0.5312, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8615, std=3.4969
[DEBUG][MIA] Test Set Loss:   mean=3.9127, std=7.2266
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.13333333333333336, 'auc': 0.63519287109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1856, std=4.7684
[DEBUG][MIA] Test Set Loss:   mean=3.2578, std=4.9543
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.088, 'auc': 0.509104, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8450, std=1.9036
[DEBUG][MIA] Test Set Loss:   mean=3.6917, std=3.8761
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.39607843137254906, 'auc': 0.7408447265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.7833, std=3.4586
[DEBUG][MIA] Test Set Loss:   mean=3.3065, std=3.8503
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11400000000000002, 'auc': 0.532448, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4082, std=7.6006
[DEBUG][MIA] Test Set Loss:   mean=2.2682, std=2.8050
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.13333333333333333, 'auc': 0.69049072265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0248, std=3.8105
[DEBUG][MIA] Test Set Loss:   mean=2.7166, std=4.7881
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.09, 'auc': 0.548128, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4545, std=0.8392
[DEBUG][MIA] Test Set Loss:   mean=2.0749, std=2.2757
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.5882352941176471, 'auc': 0.76934814453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2112, std=1.5948
[DEBUG][MIA] Test Set Loss:   mean=1.9366, std=2.2256
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.192, 'auc': 0.599648, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2060, std=2.6632
[DEBUG][MIA] Test Set Loss:   mean=2.3613, std=3.3586
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.23529411764705882, 'auc': 0.6087646484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9249, std=3.3840
[DEBUG][MIA] Test Set Loss:   mean=2.4814, std=3.6085
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.154, 'auc': 0.555216, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8259, std=1.4338
[DEBUG][MIA] Test Set Loss:   mean=1.8180, std=2.2241
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2235294117647059, 'auc': 0.62451171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4600, std=2.1144
[DEBUG][MIA] Test Set Loss:   mean=1.8691, std=2.5554
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12000000000000002, 'auc': 0.556656, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.0326, std=2.0880
[DEBUG][MIA] Test Set Loss:   mean=2.1859, std=2.6641
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.16470588235294117, 'auc': 0.6876220703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4488, std=2.3978
[DEBUG][MIA] Test Set Loss:   mean=1.5605, std=2.0275
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.144, 'auc': 0.5541119999999999, 'task': 8}
Total correct retain:  1264  Total retain:  2500
Total correct forget:  17589  Total forget:  47500
Total correct test:  248  Total test:  500
Total correct forget test:  3253  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.496, 0.538, 0.53, 0.426, 0.49, 0.418, 0.488, 0.518, 0.528, 0.296, 0.27, 0.318, 0.202, 0.254, 0.2, 0.188, 0.122, 0.19, 0.232, 0.298]
Unlearning task: 9
Accuracy, Confidence: (0.73828125, 0.8214707970619202)
broken out of loop
Accuracy, Confidence: (0.3515625, 0.9262359142303467)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5757, std=1.3588
[DEBUG][MIA] Test Set Loss:   mean=2.1258, std=3.0653
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.3254901960784314, 'auc': 0.66754150390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2039, std=2.9330
[DEBUG][MIA] Test Set Loss:   mean=2.3842, std=3.0251
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.530504, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3782, std=3.0545
[DEBUG][MIA] Test Set Loss:   mean=3.1324, std=5.3198
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.23529411764705882, 'auc': 0.649017333984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3472, std=4.0441
[DEBUG][MIA] Test Set Loss:   mean=2.8445, std=4.8341
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.529672, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6293, std=2.0030
[DEBUG][MIA] Test Set Loss:   mean=2.7943, std=4.0541
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.22745098039215686, 'auc': 0.7213134765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1403, std=3.4651
[DEBUG][MIA] Test Set Loss:   mean=2.7667, std=3.6655
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.072, 'auc': 0.43179999999999996, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5422, std=3.8246
[DEBUG][MIA] Test Set Loss:   mean=2.5452, std=3.4097
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20784313725490197, 'auc': 0.65576171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8714, std=3.4547
[DEBUG][MIA] Test Set Loss:   mean=2.3614, std=2.8833
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.10600000000000001, 'auc': 0.588464, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6282, std=1.0014
[DEBUG][MIA] Test Set Loss:   mean=1.9480, std=2.2917
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.6392156862745099, 'auc': 0.7120361328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5182, std=2.1316
[DEBUG][MIA] Test Set Loss:   mean=2.5130, std=2.6809
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.158, 'auc': 0.631472, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8808, std=2.2925
[DEBUG][MIA] Test Set Loss:   mean=2.6739, std=3.7373
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2549019607843137, 'auc': 0.6563720703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7315, std=3.1410
[DEBUG][MIA] Test Set Loss:   mean=2.6108, std=3.9529
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.132, 'auc': 0.557536, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0150, std=1.7735
[DEBUG][MIA] Test Set Loss:   mean=2.6338, std=3.8849
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.2156862745098039, 'auc': 0.634033203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8653, std=2.7625
[DEBUG][MIA] Test Set Loss:   mean=2.7477, std=4.0286
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10200000000000001, 'auc': 0.558616, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.1103, std=14.1148
[DEBUG][MIA] Test Set Loss:   mean=8.3265, std=13.4302
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.12549019607843137, 'auc': 0.45819091796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.6073, std=15.5326
[DEBUG][MIA] Test Set Loss:   mean=9.4141, std=14.0026
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10400000000000001, 'auc': 0.496784, 'task': 8}
Total correct retain:  1483  Total retain:  2500
Total correct forget:  17405  Total forget:  47500
Total correct test:  283  Total test:  500
Total correct forget test:  3207  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.566, 0.508, 0.542, 0.476, 0.528, 0.4, 0.52, 0.48, 0.33, 0.304, 0.286, 0.232, 0.222, 0.248, 0.188, 0.208, 0.14, 0.206, 0.308, 0.288]
Unlearning task: 8
Accuracy, Confidence: (0.6953125, 0.8256442546844482)
broken out of loop
Accuracy, Confidence: (0.26953125, 0.946332573890686)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7231, std=1.6383
[DEBUG][MIA] Test Set Loss:   mean=2.1428, std=4.2631
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.16470588235294117, 'auc': 0.633758544921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7410, std=3.0243
[DEBUG][MIA] Test Set Loss:   mean=2.0281, std=3.4091
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.12200000000000003, 'auc': 0.47024, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4471, std=2.5430
[DEBUG][MIA] Test Set Loss:   mean=2.7257, std=3.1227
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.1764705882352941, 'auc': 0.64111328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9813, std=2.9231
[DEBUG][MIA] Test Set Loss:   mean=2.5757, std=3.5053
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.13, 'auc': 0.544488, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3275, std=0.7562
[DEBUG][MIA] Test Set Loss:   mean=2.2250, std=2.8899
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.26666666666666666, 'auc': 0.7132568359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9171, std=2.6780
[DEBUG][MIA] Test Set Loss:   mean=1.9705, std=2.7541
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.12200000000000003, 'auc': 0.49652799999999997, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6927, std=3.2286
[DEBUG][MIA] Test Set Loss:   mean=2.9480, std=4.0813
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.06274509803921569, 'auc': 0.63385009765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4834, std=4.1064
[DEBUG][MIA] Test Set Loss:   mean=2.3137, std=3.4645
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11000000000000001, 'auc': 0.5187360000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4191, std=2.8533
[DEBUG][MIA] Test Set Loss:   mean=3.2154, std=3.4752
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5215686274509804, 'auc': 0.6943359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7769, std=2.7809
[DEBUG][MIA] Test Set Loss:   mean=2.8604, std=3.5868
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.144, 'auc': 0.622112, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2837, std=2.4222
[DEBUG][MIA] Test Set Loss:   mean=3.1543, std=3.7236
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.2392156862745098, 'auc': 0.66802978515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6983, std=2.9317
[DEBUG][MIA] Test Set Loss:   mean=2.5516, std=3.2611
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11200000000000002, 'auc': 0.5995360000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.7587, std=11.5406
[DEBUG][MIA] Test Set Loss:   mean=9.9117, std=12.3052
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.08627450980392157, 'auc': 0.45745849609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.4489, std=10.8694
[DEBUG][MIA] Test Set Loss:   mean=10.3269, std=13.3120
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.086, 'auc': 0.508112, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.4263, std=15.6451
[DEBUG][MIA] Test Set Loss:   mean=10.8155, std=12.2210
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.14901960784313723, 'auc': 0.4783935546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.0135, std=12.2739
[DEBUG][MIA] Test Set Loss:   mean=12.4694, std=14.2270
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10800000000000001, 'auc': 0.557968, 'task': 8}
Total correct retain:  1433  Total retain:  2500
Total correct forget:  15928  Total forget:  47500
Total correct test:  274  Total test:  500
Total correct forget test:  2950  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.548, 0.612, 0.504, 0.528, 0.484, 0.364, 0.51, 0.272, 0.29, 0.242, 0.27, 0.168, 0.252, 0.24, 0.18, 0.16, 0.144, 0.192, 0.234, 0.254]
Unlearning task: 7
Accuracy, Confidence: (0.6953125, 0.8260382413864136)
broken out of loop
Accuracy, Confidence: (0.27734375, 0.9411217570304871)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5268, std=6.1504
[DEBUG][MIA] Test Set Loss:   mean=3.3536, std=5.2389
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.08235294117647059, 'auc': 0.450103759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6211, std=5.4579
[DEBUG][MIA] Test Set Loss:   mean=3.4276, std=5.1801
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.08399999999999999, 'auc': 0.49268799999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7819, std=3.5974
[DEBUG][MIA] Test Set Loss:   mean=3.2310, std=4.6296
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.16862745098039214, 'auc': 0.62139892578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.7340, std=4.1748
[DEBUG][MIA] Test Set Loss:   mean=3.2530, std=4.7671
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11399999999999999, 'auc': 0.517344, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6123, std=3.0821
[DEBUG][MIA] Test Set Loss:   mean=2.8539, std=3.6476
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.11764705882352941, 'auc': 0.6083984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0749, std=4.4078
[DEBUG][MIA] Test Set Loss:   mean=2.8771, std=4.0321
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.096, 'auc': 0.482832, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1882, std=5.3770
[DEBUG][MIA] Test Set Loss:   mean=3.9261, std=6.5713
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10196078431372549, 'auc': 0.46954345703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6292, std=5.9217
[DEBUG][MIA] Test Set Loss:   mean=3.5066, std=5.1499
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.5016959999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5380, std=3.4360
[DEBUG][MIA] Test Set Loss:   mean=2.9613, std=3.3952
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.13333333333333336, 'auc': 0.57080078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.6529, std=3.8358
[DEBUG][MIA] Test Set Loss:   mean=3.3313, std=3.9209
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.11399999999999999, 'auc': 0.5661919999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=14.4356, std=15.8477
[DEBUG][MIA] Test Set Loss:   mean=16.4283, std=17.9058
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.48394775390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.5218, std=16.6975
[DEBUG][MIA] Test Set Loss:   mean=15.1554, std=16.9008
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10800000000000001, 'auc': 0.48771200000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=15.1611, std=18.4213
[DEBUG][MIA] Test Set Loss:   mean=17.8929, std=23.9698
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.498779296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=16.1262, std=21.0323
[DEBUG][MIA] Test Set Loss:   mean=14.0390, std=17.9036
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.4947039999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.8386, std=16.5745
[DEBUG][MIA] Test Set Loss:   mean=17.1588, std=16.8162
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.11372549019607843, 'auc': 0.47119140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=15.3758, std=15.4694
[DEBUG][MIA] Test Set Loss:   mean=15.6678, std=16.1092
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11000000000000001, 'auc': 0.501328, 'task': 8}
Total correct retain:  1130  Total retain:  2500
Total correct forget:  13918  Total forget:  47500
Total correct test:  207  Total test:  500
Total correct forget test:  2650  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.414, 0.436, 0.444, 0.482, 0.43, 0.372, 0.282, 0.324, 0.224, 0.182, 0.272, 0.164, 0.222, 0.25, 0.196, 0.204, 0.178, 0.218, 0.16, 0.26]
Unlearning task: 6
Accuracy, Confidence: (0.49609375, 0.8100897669792175)
broken out of loop
Accuracy, Confidence: (0.34765625, 0.9200741052627563)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8851, std=1.4949
[DEBUG][MIA] Test Set Loss:   mean=2.0370, std=2.9467
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.10196078431372549, 'auc': 0.61517333984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8679, std=2.6460
[DEBUG][MIA] Test Set Loss:   mean=1.9529, std=2.7386
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.094, 'auc': 0.48616, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5629, std=2.9026
[DEBUG][MIA] Test Set Loss:   mean=2.9454, std=4.5361
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.12941176470588234, 'auc': 0.57708740234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3977, std=3.5565
[DEBUG][MIA] Test Set Loss:   mean=2.5110, std=4.0408
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10600000000000001, 'auc': 0.49624, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9910, std=1.9767
[DEBUG][MIA] Test Set Loss:   mean=2.3523, std=2.8836
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.19215686274509802, 'auc': 0.653045654296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2621, std=3.0986
[DEBUG][MIA] Test Set Loss:   mean=2.5476, std=3.6895
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.1, 'auc': 0.504728, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6109, std=2.6063
[DEBUG][MIA] Test Set Loss:   mean=1.9967, std=2.7740
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.08627450980392157, 'auc': 0.43280029296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2406, std=3.6675
[DEBUG][MIA] Test Set Loss:   mean=1.9877, std=3.2743
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.096, 'auc': 0.50584, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4493, std=7.0388
[DEBUG][MIA] Test Set Loss:   mean=6.2457, std=7.0652
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1803921568627451, 'auc': 0.4873046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.3258, std=6.5786
[DEBUG][MIA] Test Set Loss:   mean=7.0202, std=6.9622
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.09, 'auc': 0.525744, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.7763, std=13.8459
[DEBUG][MIA] Test Set Loss:   mean=13.0907, std=14.0452
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.493896484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.7266, std=12.2793
[DEBUG][MIA] Test Set Loss:   mean=11.1656, std=12.1961
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10400000000000001, 'auc': 0.490312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.0952, std=10.3643
[DEBUG][MIA] Test Set Loss:   mean=10.2501, std=12.3436
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.1450980392156863, 'auc': 0.485260009765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.7068, std=10.6503
[DEBUG][MIA] Test Set Loss:   mean=11.1214, std=13.3723
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10400000000000001, 'auc': 0.452496, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.0754, std=10.9706
[DEBUG][MIA] Test Set Loss:   mean=10.3694, std=11.3550
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.13333333333333336, 'auc': 0.473907470703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.4852, std=10.7826
[DEBUG][MIA] Test Set Loss:   mean=11.4084, std=10.0645
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.10200000000000001, 'auc': 0.46160000000000007, 'task': 8}
Total correct retain:  1301  Total retain:  2500
Total correct forget:  14119  Total forget:  47500
Total correct test:  236  Total test:  500
Total correct forget test:  2747  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.472, 0.538, 0.514, 0.468, 0.538, 0.268, 0.278, 0.306, 0.234, 0.172, 0.276, 0.2, 0.23, 0.25, 0.2, 0.202, 0.158, 0.206, 0.196, 0.26]
Unlearning task: 5
Accuracy, Confidence: (0.59765625, 0.8380671739578247)
broken out of loop
Accuracy, Confidence: (0.328125, 0.9280874133110046)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9470, std=1.4405
[DEBUG][MIA] Test Set Loss:   mean=2.3345, std=2.7738
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2235294117647059, 'auc': 0.66131591796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2934, std=2.7026
[DEBUG][MIA] Test Set Loss:   mean=2.1767, std=2.5818
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11400000000000002, 'auc': 0.48344000000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1465, std=7.5582
[DEBUG][MIA] Test Set Loss:   mean=7.1107, std=9.2462
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.1215686274509804, 'auc': 0.5877685546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.7227, std=6.8103
[DEBUG][MIA] Test Set Loss:   mean=5.9156, std=7.1197
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11200000000000002, 'auc': 0.501816, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1669, std=3.5782
[DEBUG][MIA] Test Set Loss:   mean=4.2213, std=5.8564
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.13333333333333336, 'auc': 0.6480712890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.5410, std=4.6899
[DEBUG][MIA] Test Set Loss:   mean=3.7321, std=5.0432
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11200000000000002, 'auc': 0.5040159999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.8755, std=18.6538
[DEBUG][MIA] Test Set Loss:   mean=11.9735, std=16.5548
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.494415283203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.4778, std=16.5063
[DEBUG][MIA] Test Set Loss:   mean=13.1762, std=17.7458
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.495776, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.4204, std=5.7629
[DEBUG][MIA] Test Set Loss:   mean=5.4556, std=5.2993
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.11372549019607843, 'auc': 0.571746826171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.4081, std=6.0861
[DEBUG][MIA] Test Set Loss:   mean=5.5420, std=5.2967
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.530672, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=15.0000, std=18.5917
[DEBUG][MIA] Test Set Loss:   mean=13.1968, std=14.7878
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.14901960784313725, 'auc': 0.496826171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=14.7808, std=16.9136
[DEBUG][MIA] Test Set Loss:   mean=13.6806, std=16.1386
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10400000000000001, 'auc': 0.5166879999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.5504, std=11.4989
[DEBUG][MIA] Test Set Loss:   mean=9.1185, std=10.0337
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.08235294117647059, 'auc': 0.4808349609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.0541, std=12.5047
[DEBUG][MIA] Test Set Loss:   mean=10.6650, std=12.7605
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10600000000000001, 'auc': 0.472688, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.2301, std=13.8890
[DEBUG][MIA] Test Set Loss:   mean=10.4172, std=10.6442
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.467529296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.0397, std=11.6522
[DEBUG][MIA] Test Set Loss:   mean=9.4095, std=10.8591
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.094, 'auc': 0.50332, 'task': 8}
Total correct retain:  1467  Total retain:  2500
Total correct forget:  12864  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  2514  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.564, 0.468, 0.304, 0.448, 0.306, 0.312, 0.258, 0.322, 0.266, 0.2, 0.234, 0.128, 0.198, 0.256, 0.196, 0.234, 0.236, 0.178, 0.27, 0.214]
Unlearning task: 4
Accuracy, Confidence: (0.58203125, 0.8222541809082031)
broken out of loop
Accuracy, Confidence: (0.3984375, 0.86903977394104)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9940, std=3.3993
[DEBUG][MIA] Test Set Loss:   mean=3.2852, std=3.6795
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.1803921568627451, 'auc': 0.63983154296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0171, std=3.6949
[DEBUG][MIA] Test Set Loss:   mean=2.8700, std=3.4844
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.096, 'auc': 0.502848, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5914, std=4.0147
[DEBUG][MIA] Test Set Loss:   mean=4.2607, std=5.0344
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.1607843137254902, 'auc': 0.63531494140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.9273, std=5.1496
[DEBUG][MIA] Test Set Loss:   mean=4.3345, std=5.0871
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10800000000000001, 'auc': 0.533936, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.0511, std=8.1910
[DEBUG][MIA] Test Set Loss:   mean=7.8082, std=7.9345
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.1568627450980392, 'auc': 0.59466552734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.7257, std=7.9149
[DEBUG][MIA] Test Set Loss:   mean=8.2711, std=8.5144
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.092, 'auc': 0.550352, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.8787, std=8.0167
[DEBUG][MIA] Test Set Loss:   mean=7.0738, std=8.5857
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.50390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.4354, std=9.9302
[DEBUG][MIA] Test Set Loss:   mean=7.7185, std=7.8658
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.096, 'auc': 0.484864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7132, std=5.7573
[DEBUG][MIA] Test Set Loss:   mean=5.8061, std=5.7904
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.12549019607843137, 'auc': 0.58203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.1267, std=5.2822
[DEBUG][MIA] Test Set Loss:   mean=6.1434, std=5.6475
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12, 'auc': 0.5556719999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.2348, std=7.0355
[DEBUG][MIA] Test Set Loss:   mean=8.5353, std=6.5824
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4453125, 'cv_acc': 0.10196078431372549, 'auc': 0.426025390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.9958, std=7.5820
[DEBUG][MIA] Test Set Loss:   mean=8.5076, std=6.6895
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.094, 'auc': 0.49205600000000005, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.1188, std=6.6979
[DEBUG][MIA] Test Set Loss:   mean=5.8662, std=8.0802
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.08627450980392157, 'auc': 0.51708984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9552, std=8.1674
[DEBUG][MIA] Test Set Loss:   mean=6.2935, std=7.6378
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11000000000000001, 'auc': 0.465872, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.7738, std=5.4999
[DEBUG][MIA] Test Set Loss:   mean=5.3218, std=5.4376
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09803921568627452, 'auc': 0.45574951171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.4885, std=5.9075
[DEBUG][MIA] Test Set Loss:   mean=5.3642, std=5.8550
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.1, 'auc': 0.497984, 'task': 8}
Total correct retain:  1069  Total retain:  2500
Total correct forget:  13442  Total forget:  47500
Total correct test:  206  Total test:  500
Total correct forget test:  2586  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.412, 0.42, 0.324, 0.322, 0.332, 0.252, 0.278, 0.37, 0.29, 0.268, 0.27, 0.154, 0.194, 0.212, 0.196, 0.268, 0.334, 0.23, 0.19, 0.268]
Unlearning task: 3
Accuracy, Confidence: (0.5390625, 0.8568210601806641)
broken out of loop
Accuracy, Confidence: (0.42578125, 0.9185935258865356)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.9762, std=5.8251
[DEBUG][MIA] Test Set Loss:   mean=4.0295, std=5.5705
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.16470588235294117, 'auc': 0.5926513671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6429, std=5.1800
[DEBUG][MIA] Test Set Loss:   mean=4.3318, std=5.6780
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10600000000000001, 'auc': 0.45668000000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.9213, std=12.2362
[DEBUG][MIA] Test Set Loss:   mean=10.4979, std=12.0270
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.10196078431372549, 'auc': 0.3919677734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.1266, std=12.8077
[DEBUG][MIA] Test Set Loss:   mean=10.9161, std=12.9582
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.09, 'auc': 0.47830399999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.7005, std=12.0871
[DEBUG][MIA] Test Set Loss:   mean=9.2045, std=10.8380
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.14901960784313725, 'auc': 0.52490234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.7171, std=12.9480
[DEBUG][MIA] Test Set Loss:   mean=9.5935, std=11.5020
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10400000000000001, 'auc': 0.483872, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.3279, std=8.0772
[DEBUG][MIA] Test Set Loss:   mean=8.6281, std=9.1137
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09411764705882353, 'auc': 0.467041015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.3334, std=11.0125
[DEBUG][MIA] Test Set Loss:   mean=7.7952, std=9.9526
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10600000000000001, 'auc': 0.49232000000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.3958, std=5.1251
[DEBUG][MIA] Test Set Loss:   mean=6.1759, std=4.9511
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.10980392156862746, 'auc': 0.6190185546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.8670, std=5.6345
[DEBUG][MIA] Test Set Loss:   mean=6.1080, std=5.2997
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11000000000000001, 'auc': 0.525072, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7205, std=7.7765
[DEBUG][MIA] Test Set Loss:   mean=8.8749, std=6.8306
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.11372549019607843, 'auc': 0.56414794921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.3898, std=7.2459
[DEBUG][MIA] Test Set Loss:   mean=8.4737, std=7.3734
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.094, 'auc': 0.488176, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.6232, std=9.3100
[DEBUG][MIA] Test Set Loss:   mean=7.4139, std=9.8585
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.1215686274509804, 'auc': 0.499908447265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.5160, std=8.8889
[DEBUG][MIA] Test Set Loss:   mean=7.2733, std=8.7842
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.098, 'auc': 0.46577599999999997, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9574, std=7.2708
[DEBUG][MIA] Test Set Loss:   mean=7.4137, std=7.2812
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.52545166015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.7020, std=6.4600
[DEBUG][MIA] Test Set Loss:   mean=6.7074, std=7.6792
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10600000000000001, 'auc': 0.5305599999999999, 'task': 8}
Total correct retain:  1020  Total retain:  2500
Total correct forget:  13129  Total forget:  47500
Total correct test:  201  Total test:  500
Total correct forget test:  2553  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.402, 0.406, 0.292, 0.302, 0.342, 0.286, 0.286, 0.344, 0.294, 0.278, 0.262, 0.152, 0.2, 0.202, 0.194, 0.252, 0.346, 0.244, 0.162, 0.262]
Unlearning task: 2
Accuracy, Confidence: (0.6328125, 0.8777546882629395)
broken out of loop
Accuracy, Confidence: (0.3359375, 0.9710901975631714)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([6, 9, 9, 7, 8, 5, 5, 8, 8, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=25.3611, std=29.9381
[DEBUG][MIA] Test Set Loss:   mean=27.1056, std=29.9292
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08235294117647059, 'auc': 0.53472900390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 8 5 9 5 6 6 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 5 8 9 7 6 5 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=28.1085, std=29.5606
[DEBUG][MIA] Test Set Loss:   mean=27.7710, std=30.3052
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.1, 'auc': 0.507248, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 14, 13, 13, 11, 11, 11, 10, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=27.1277, std=26.6263
[DEBUG][MIA] Test Set Loss:   mean=32.2654, std=26.1178
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.09803921568627451, 'auc': 0.435791015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 13 13 10 12 10 10 12 13 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 12 14 10 13 14 14 13 14]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=30.5360, std=26.5215
[DEBUG][MIA] Test Set Loss:   mean=31.4564, std=24.8958
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.48626400000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 19, 15, 18, 19, 17, 19, 15, 17, 19], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=20.5785, std=23.4054
[DEBUG][MIA] Test Set Loss:   mean=16.8888, std=21.0312
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.11764705882352941, 'auc': 0.4744873046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 17 16 18 18 15 15 17 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 17 15 17 15 17 17 18 15 18]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.9148, std=22.0556
[DEBUG][MIA] Test Set Loss:   mean=18.1024, std=20.4828
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.5019199999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 21, 21, 22, 21, 22, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=14.2991, std=19.9408
[DEBUG][MIA] Test Set Loss:   mean=11.5956, std=16.8984
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09019607843137255, 'auc': 0.477813720703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 23 21 20 22 22 20 24 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 24 21 22 23 23 22 22 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=13.7059, std=19.0507
[DEBUG][MIA] Test Set Loss:   mean=14.1293, std=19.0878
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.088, 'auc': 0.5056080000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 29, 28, 28, 29, 26, 29, 25, 27, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.7429, std=8.6148
[DEBUG][MIA] Test Set Loss:   mean=9.6613, std=9.9872
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.11372549019607843, 'auc': 0.594146728515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 29 29 28 26 27 26 25 25 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 26 29 27 29 25 29 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.5606, std=9.4344
[DEBUG][MIA] Test Set Loss:   mean=9.4961, std=9.5634
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10800000000000001, 'auc': 0.46212, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([30, 32, 31, 33, 30, 30, 30, 33, 30, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.3218, std=12.8787
[DEBUG][MIA] Test Set Loss:   mean=13.2093, std=13.7398
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.09803921568627451, 'auc': 0.426910400390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 31 30 30 30 30 30 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 34 32 30 31 30 31 34 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.9978, std=12.3830
[DEBUG][MIA] Test Set Loss:   mean=10.3298, std=11.4817
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.136, 'auc': 0.49707199999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 39, 38, 36, 38, 35, 35, 37, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=14.9652, std=13.3765
[DEBUG][MIA] Test Set Loss:   mean=14.6752, std=14.9029
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10196078431372549, 'auc': 0.481964111328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 37 36 37 36 37 38 37 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 37 36 37 37 39 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=15.2523, std=13.8776
[DEBUG][MIA] Test Set Loss:   mean=14.8062, std=13.2050
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10800000000000001, 'auc': 0.510888, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 42, 43, 42, 41, 43, 43, 40, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.3700, std=7.3794
[DEBUG][MIA] Test Set Loss:   mean=6.6046, std=8.0065
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.12156862745098038, 'auc': 0.43994140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 44 42 44 41 41 42 43 41 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 43 44 40 42 41 43 40 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7381, std=8.5471
[DEBUG][MIA] Test Set Loss:   mean=6.5422, std=7.3916
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.11200000000000002, 'auc': 0.48793600000000004, 'task': 8}
Total correct retain:  1093  Total retain:  2500
Total correct forget:  10600  Total forget:  47500
Total correct test:  192  Total test:  500
Total correct forget test:  2081  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.384, 0.252, 0.252, 0.264, 0.304, 0.3, 0.254, 0.244, 0.31, 0.248, 0.2, 0.186, 0.194, 0.174, 0.152, 0.132, 0.212, 0.2, 0.088, 0.196]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['lawn-mower', 'dinosaur', 'mouse', 'otter', 'lobster', 'cattle', 'leopard', 'pine', 'squirrel', 'beetle', 'worm', 'pears', 'streetcar', 'trout', 'bus', 'camel', 'road', 'shark', 'table', 'kangaroo', 'hamster', 'seal', 'poppies', 'castle', 'crocodile', 'turtle', 'wolf', 'snake', 'bed', 'palm', 'plates', 'bee', 'boy', 'ray', 'lion', 'raccoon', 'bridge', 'lizard', 'tank', 'apples', 'sea', 'tiger', 'butterfly', 'rocket', 'whale', 'sunflowers', 'girl', 'bicycle', 'couch', 'rabbit', 'man', 'cans', 'mountain', 'house', 'bowls', 'motorcycle', 'crab', 'dolphin', 'lamp', 'orchids', 'caterpillar', 'cloud', 'snail', 'mushrooms', 'cockroach', 'clock', 'aquarium fish', 'maple', 'tractor', 'baby', 'train', 'tulips', 'wardrobe', 'cups', 'flatfish', 'possum', 'chimpanzee', 'chair', 'beaver', 'telephone', 'roses', 'shrew', 'bear', 'forest', 'skyscraper', 'oak', 'woman', 'elephant', 'oranges', 'porcupine', 'willow', 'skunk', 'fox', 'spider', 'bottles', 'computer keyboard', 'sweet peppers', 'plain', 'television', 'pickup truck']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  1997  Total retain:  2500
Total correct forget:  9389  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  1873  Total test forget:  9500
After learning task 1
Task accuracies: [0.64, 0.222, 0.176, 0.26, 0.206, 0.196, 0.214, 0.228, 0.26, 0.136, 0.2, 0.13, 0.18, 0.19, 0.196, 0.124, 0.224, 0.182, 0.2, 0.222]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0475, std=0.2189
[DEBUG][MIA] Test Set Loss:   mean=1.9100, std=3.0044
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2235294117647059, 'auc': 0.760986328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0972, std=0.3980
[DEBUG][MIA] Test Set Loss:   mean=1.5080, std=2.6940
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.258, 'auc': 0.751056, 'task': 1}
2 1
Total correct retain:  1753  Total retain:  2500
Total correct forget:  11584  Total forget:  47500
Total correct test:  301  Total test:  500
Total correct forget test:  2132  Total test forget:  9500
After learning task 2
Task accuracies: [0.602, 0.69, 0.216, 0.234, 0.206, 0.198, 0.21, 0.142, 0.182, 0.19, 0.176, 0.162, 0.22, 0.186, 0.202, 0.218, 0.172, 0.236, 0.19, 0.234]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0107, std=0.0163
[DEBUG][MIA] Test Set Loss:   mean=1.9427, std=2.8129
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.7529411764705882, 'auc': 0.8778076171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6399, std=1.6562
[DEBUG][MIA] Test Set Loss:   mean=1.6930, std=2.5117
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.198, 'auc': 0.684048, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0529, std=0.4958
[DEBUG][MIA] Test Set Loss:   mean=1.0358, std=2.6161
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.27450980392156865, 'auc': 0.739349365234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0610, std=0.4473
[DEBUG][MIA] Test Set Loss:   mean=1.2175, std=2.5414
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.23200000000000004, 'auc': 0.7548, 'task': 2}
3 2
Total correct retain:  1712  Total retain:  2500
Total correct forget:  13015  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  2362  Total test forget:  9500
After learning task 3
Task accuracies: [0.614, 0.594, 0.736, 0.222, 0.194, 0.2, 0.2, 0.17, 0.186, 0.2, 0.206, 0.168, 0.216, 0.162, 0.24, 0.214, 0.206, 0.232, 0.18, 0.198]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0110, std=0.0806
[DEBUG][MIA] Test Set Loss:   mean=1.8247, std=2.6295
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7490196078431373, 'auc': 0.849853515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8822, std=1.6702
[DEBUG][MIA] Test Set Loss:   mean=1.6623, std=2.3748
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.15599999999999997, 'auc': 0.6124320000000001, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.4093, std=2.6729
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7411764705882353, 'auc': 0.857666015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3501, std=1.0381
[DEBUG][MIA] Test Set Loss:   mean=1.3631, std=2.3193
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.196, 'auc': 0.7045439999999998, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0120, std=0.0632
[DEBUG][MIA] Test Set Loss:   mean=0.9886, std=2.6750
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.24705882352941178, 'auc': 0.685791015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0427
[DEBUG][MIA] Test Set Loss:   mean=1.0402, std=2.5159
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.652, 'cv_acc': 0.22999999999999998, 'auc': 0.721584, 'task': 3}
4 3
Total correct retain:  1690  Total retain:  2500
Total correct forget:  14561  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  2617  Total test forget:  9500
After learning task 4
Task accuracies: [0.576, 0.59, 0.652, 0.78, 0.186, 0.18, 0.196, 0.176, 0.158, 0.2, 0.178, 0.248, 0.188, 0.182, 0.25, 0.238, 0.162, 0.266, 0.182, 0.222]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0107
[DEBUG][MIA] Test Set Loss:   mean=1.8183, std=2.6987
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7843137254901961, 'auc': 0.88232421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9352, std=1.7072
[DEBUG][MIA] Test Set Loss:   mean=1.9102, std=2.8043
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.15999999999999998, 'auc': 0.6119840000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.7397, std=2.8107
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7686274509803921, 'auc': 0.883209228515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7078, std=1.7043
[DEBUG][MIA] Test Set Loss:   mean=1.6098, std=2.7830
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.22199999999999998, 'auc': 0.61924, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0193, std=0.0728
[DEBUG][MIA] Test Set Loss:   mean=1.3960, std=2.7766
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2705882352941177, 'auc': 0.71636962890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4061, std=1.1066
[DEBUG][MIA] Test Set Loss:   mean=1.2411, std=2.3569
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.198, 'auc': 0.6315359999999999, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0236
[DEBUG][MIA] Test Set Loss:   mean=0.7490, std=2.0332
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2784313725490196, 'auc': 0.669891357421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0244, std=0.3279
[DEBUG][MIA] Test Set Loss:   mean=0.8415, std=2.0301
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.646, 'cv_acc': 0.242, 'auc': 0.7125600000000001, 'task': 4}
5 4
Total correct retain:  1646  Total retain:  2500
Total correct forget:  15955  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  2840  Total test forget:  9500
After learning task 5
Task accuracies: [0.592, 0.57, 0.622, 0.704, 0.794, 0.174, 0.212, 0.182, 0.192, 0.18, 0.192, 0.214, 0.184, 0.224, 0.206, 0.238, 0.214, 0.206, 0.162, 0.21]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.9017, std=3.4090
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7411764705882352, 'auc': 0.871795654296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0830, std=2.0302
[DEBUG][MIA] Test Set Loss:   mean=1.8637, std=3.1191
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11400000000000002, 'auc': 0.582216, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=1.7928, std=2.8223
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7529411764705882, 'auc': 0.917449951171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8474, std=1.8631
[DEBUG][MIA] Test Set Loss:   mean=1.8218, std=2.6757
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.164, 'auc': 0.640016, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.1866, std=2.4101
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.28627450980392155, 'auc': 0.767242431640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5470, std=1.5406
[DEBUG][MIA] Test Set Loss:   mean=1.3463, std=2.6828
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.16999999999999998, 'auc': 0.6237520000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=1.4021, std=2.6382
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.7215686274509804, 'auc': 0.775360107421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3058, std=1.0483
[DEBUG][MIA] Test Set Loss:   mean=1.2302, std=2.3770
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.22200000000000003, 'auc': 0.6321599999999999, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0751
[DEBUG][MIA] Test Set Loss:   mean=0.8722, std=1.9465
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.27058823529411763, 'auc': 0.735809326171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0703
[DEBUG][MIA] Test Set Loss:   mean=1.1702, std=2.2427
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.23600000000000004, 'auc': 0.780264, 'task': 5}
6 5
Total correct retain:  1657  Total retain:  2500
Total correct forget:  17625  Total forget:  47500
Total correct test:  284  Total test:  500
Total correct forget test:  3127  Total test forget:  9500
After learning task 6
Task accuracies: [0.568, 0.64, 0.598, 0.704, 0.702, 0.742, 0.21, 0.196, 0.194, 0.196, 0.202, 0.234, 0.184, 0.262, 0.214, 0.222, 0.19, 0.206, 0.13, 0.228]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0246
[DEBUG][MIA] Test Set Loss:   mean=1.6178, std=2.8187
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7529411764705882, 'auc': 0.875823974609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2763, std=2.3067
[DEBUG][MIA] Test Set Loss:   mean=1.7643, std=2.4246
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11200000000000002, 'auc': 0.5902879999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=2.2084, std=3.0852
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7764705882352941, 'auc': 0.92822265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3303, std=2.4219
[DEBUG][MIA] Test Set Loss:   mean=2.3057, std=3.2108
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.144, 'auc': 0.61592, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0182, std=0.1028
[DEBUG][MIA] Test Set Loss:   mean=1.3825, std=2.4880
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2901960784313726, 'auc': 0.747528076171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7775, std=1.8952
[DEBUG][MIA] Test Set Loss:   mean=1.5905, std=2.9136
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.14, 'auc': 0.591536, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.4404, std=2.5845
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.27450980392156865, 'auc': 0.831268310546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6205, std=1.5612
[DEBUG][MIA] Test Set Loss:   mean=1.5498, std=2.7518
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.184, 'auc': 0.6324719999999999, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.2567, std=2.3633
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7372549019607844, 'auc': 0.82208251953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2949, std=0.8133
[DEBUG][MIA] Test Set Loss:   mean=1.3244, std=2.4863
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.236, 'auc': 0.6650800000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0165, std=0.0985
[DEBUG][MIA] Test Set Loss:   mean=1.0472, std=2.3350
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.25098039215686274, 'auc': 0.69085693359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0122
[DEBUG][MIA] Test Set Loss:   mean=0.9807, std=2.2298
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.242, 'auc': 0.7129439999999999, 'task': 6}
7 6
Total correct retain:  1597  Total retain:  2500
Total correct forget:  18889  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  3277  Total test forget:  9500
After learning task 7
Task accuracies: [0.556, 0.596, 0.552, 0.664, 0.662, 0.682, 0.784, 0.19, 0.188, 0.2, 0.202, 0.224, 0.168, 0.3, 0.214, 0.244, 0.15, 0.17, 0.146, 0.218]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=2.0604, std=3.0654
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7333333333333333, 'auc': 0.919677734375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4489, std=2.5255
[DEBUG][MIA] Test Set Loss:   mean=1.8855, std=2.8989
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.094, 'auc': 0.5742320000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=2.0842, std=3.2863
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7529411764705882, 'auc': 0.894866943359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2007, std=2.2317
[DEBUG][MIA] Test Set Loss:   mean=2.0070, std=2.8902
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.13200000000000003, 'auc': 0.6053599999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0121
[DEBUG][MIA] Test Set Loss:   mean=1.5247, std=3.1155
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.3058823529411765, 'auc': 0.7633056640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2403, std=2.6217
[DEBUG][MIA] Test Set Loss:   mean=1.6664, std=2.7871
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.172, 'auc': 0.55008, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.0479, std=2.4556
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.3137254901960784, 'auc': 0.820648193359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6867, std=2.0215
[DEBUG][MIA] Test Set Loss:   mean=1.2981, std=2.6367
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.156, 'auc': 0.603664, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0119
[DEBUG][MIA] Test Set Loss:   mean=1.3942, std=2.1897
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7294117647058824, 'auc': 0.8145751953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3986, std=1.1597
[DEBUG][MIA] Test Set Loss:   mean=1.5956, std=2.7177
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.19, 'auc': 0.6756400000000001, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0049
[DEBUG][MIA] Test Set Loss:   mean=1.2706, std=2.5793
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2980392156862745, 'auc': 0.738983154296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3330, std=1.1300
[DEBUG][MIA] Test Set Loss:   mean=1.4465, std=2.5585
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.21199999999999997, 'auc': 0.6561279999999999, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0065
[DEBUG][MIA] Test Set Loss:   mean=0.7126, std=1.6912
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.22745098039215686, 'auc': 0.719757080078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0123
[DEBUG][MIA] Test Set Loss:   mean=0.9270, std=2.1529
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.244, 'auc': 0.703808, 'task': 7}
8 7
Total correct retain:  1568  Total retain:  2500
Total correct forget:  20439  Total forget:  47500
Total correct test:  281  Total test:  500
Total correct forget test:  3560  Total test forget:  9500
After learning task 8
Task accuracies: [0.562, 0.572, 0.572, 0.654, 0.704, 0.646, 0.686, 0.792, 0.168, 0.218, 0.184, 0.272, 0.18, 0.262, 0.236, 0.258, 0.17, 0.196, 0.16, 0.19]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0319
[DEBUG][MIA] Test Set Loss:   mean=2.3320, std=3.2424
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7411764705882353, 'auc': 0.85498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6675, std=2.6327
[DEBUG][MIA] Test Set Loss:   mean=2.0583, std=3.1192
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.174, 'auc': 0.559192, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.9951, std=3.0523
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.788235294117647, 'auc': 0.87060546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3035, std=2.2777
[DEBUG][MIA] Test Set Loss:   mean=1.9705, std=3.0697
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.13, 'auc': 0.550024, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=1.9869, std=3.2101
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.27450980392156865, 'auc': 0.809478759765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7620, std=1.8641
[DEBUG][MIA] Test Set Loss:   mean=1.7669, std=3.0564
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.11000000000000001, 'auc': 0.577784, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.7162, std=3.1473
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.27058823529411763, 'auc': 0.84423828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5886, std=1.6293
[DEBUG][MIA] Test Set Loss:   mean=1.3755, std=2.7361
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.15999999999999998, 'auc': 0.62116, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.7086, std=2.8957
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2980392156862745, 'auc': 0.82183837890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7513, std=1.7981
[DEBUG][MIA] Test Set Loss:   mean=1.5642, std=2.4964
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.18, 'auc': 0.6415120000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0064
[DEBUG][MIA] Test Set Loss:   mean=1.6873, std=3.3249
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6431372549019608, 'auc': 0.762603759765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5314, std=1.5279
[DEBUG][MIA] Test Set Loss:   mean=1.7652, std=3.2593
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.186, 'auc': 0.6277200000000001, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0077
[DEBUG][MIA] Test Set Loss:   mean=1.1501, std=2.2837
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2784313725490196, 'auc': 0.808258056640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2300, std=0.9250
[DEBUG][MIA] Test Set Loss:   mean=1.1759, std=2.3606
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.196, 'auc': 0.6593600000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0479
[DEBUG][MIA] Test Set Loss:   mean=1.0014, std=2.5882
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2235294117647059, 'auc': 0.701904296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0261, std=0.1464
[DEBUG][MIA] Test Set Loss:   mean=0.6329, std=1.6378
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.21400000000000002, 'auc': 0.673144, 'task': 8}
Total correct retain:  1645  Total retain:  2500
Total correct forget:  21953  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  3832  Total test forget:  9500
After learning task 9
Task accuracies: [0.564, 0.568, 0.586, 0.672, 0.67, 0.652, 0.692, 0.736, 0.816, 0.202, 0.162, 0.25, 0.184, 0.236, 0.266, 0.264, 0.116, 0.208, 0.172, 0.212]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=2.2321, std=3.2339
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7529411764705882, 'auc': 0.8817138671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4017, std=2.3157
[DEBUG][MIA] Test Set Loss:   mean=2.4416, std=3.5090
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.138, 'auc': 0.5996079999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.7779, std=3.0533
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.792156862745098, 'auc': 0.8826904296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0619, std=2.0219
[DEBUG][MIA] Test Set Loss:   mean=1.8691, std=3.0788
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12200000000000003, 'auc': 0.6013519999999999, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0212, std=0.0832
[DEBUG][MIA] Test Set Loss:   mean=1.4964, std=2.8378
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.4352941176470589, 'auc': 0.736236572265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3507, std=2.7622
[DEBUG][MIA] Test Set Loss:   mean=2.1609, std=3.5338
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.15799999999999997, 'auc': 0.57564, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.5316, std=2.6523
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.31764705882352945, 'auc': 0.8521728515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8041, std=2.0207
[DEBUG][MIA] Test Set Loss:   mean=1.5690, std=3.0132
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13000000000000003, 'auc': 0.620032, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=1.6416, std=2.4110
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2980392156862745, 'auc': 0.85089111328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0259, std=2.1279
[DEBUG][MIA] Test Set Loss:   mean=1.5452, std=2.6197
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.188, 'auc': 0.590112, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.4488, std=2.7842
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2823529411764706, 'auc': 0.8062744140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4130, std=1.2196
[DEBUG][MIA] Test Set Loss:   mean=1.4065, std=2.9585
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.21600000000000003, 'auc': 0.604032, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.1581, std=1.8405
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2901960784313725, 'auc': 0.847625732421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3832, std=1.0516
[DEBUG][MIA] Test Set Loss:   mean=1.3409, std=2.5851
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.20400000000000001, 'auc': 0.635224, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0219, std=0.1103
[DEBUG][MIA] Test Set Loss:   mean=1.2412, std=2.1555
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.26666666666666666, 'auc': 0.75079345703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3001, std=1.0362
[DEBUG][MIA] Test Set Loss:   mean=0.9987, std=2.0354
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.18200000000000002, 'auc': 0.63352, 'task': 8}
Total correct retain:  1624  Total retain:  2500
Total correct forget:  22918  Total forget:  47500
Total correct test:  293  Total test:  500
Total correct forget test:  3992  Total test forget:  9500
After learning task 10
Task accuracies: [0.586, 0.576, 0.59, 0.632, 0.658, 0.646, 0.718, 0.682, 0.718, 0.762, 0.198, 0.228, 0.178, 0.222, 0.204, 0.248, 0.152, 0.222, 0.136, 0.214]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=2.2245, std=3.2516
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7843137254901961, 'auc': 0.87353515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6610, std=2.8672
[DEBUG][MIA] Test Set Loss:   mean=2.0736, std=3.2966
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.154, 'auc': 0.568552, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.9254, std=2.9084
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7176470588235294, 'auc': 0.919525146484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1520, std=2.2021
[DEBUG][MIA] Test Set Loss:   mean=2.0947, std=2.9151
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.16599999999999998, 'auc': 0.583664, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=1.6871, std=2.8400
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6823529411764706, 'auc': 0.81396484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2455, std=2.4189
[DEBUG][MIA] Test Set Loss:   mean=1.7710, std=3.1438
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.142, 'auc': 0.547328, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.3716, std=2.6317
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.27450980392156865, 'auc': 0.8392333984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0684, std=2.1925
[DEBUG][MIA] Test Set Loss:   mean=1.3826, std=2.8818
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.16999999999999998, 'auc': 0.54472, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.4496, std=2.2638
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7490196078431373, 'auc': 0.89630126953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9039, std=2.0610
[DEBUG][MIA] Test Set Loss:   mean=1.5486, std=2.6335
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.176, 'auc': 0.598024, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.7498, std=3.7385
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.30196078431372547, 'auc': 0.79949951171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7397, std=1.8254
[DEBUG][MIA] Test Set Loss:   mean=1.3070, std=2.8586
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.15999999999999998, 'auc': 0.564976, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.4270, std=2.4507
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7411764705882353, 'auc': 0.83465576171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6348, std=1.5158
[DEBUG][MIA] Test Set Loss:   mean=1.4896, std=2.8536
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.16799999999999998, 'auc': 0.606584, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0109
[DEBUG][MIA] Test Set Loss:   mean=0.7278, std=1.7547
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.29803921568627445, 'auc': 0.743560791015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3770, std=1.1280
[DEBUG][MIA] Test Set Loss:   mean=1.1810, std=2.3364
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.13999999999999999, 'auc': 0.6324160000000001, 'task': 8}
Total correct retain:  1603  Total retain:  2500
Total correct forget:  24550  Total forget:  47500
Total correct test:  281  Total test:  500
Total correct forget test:  4203  Total test forget:  9500
After learning task 11
Task accuracies: [0.562, 0.556, 0.554, 0.652, 0.708, 0.644, 0.716, 0.688, 0.724, 0.648, 0.79, 0.172, 0.178, 0.246, 0.218, 0.234, 0.132, 0.216, 0.136, 0.194]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9980502724647522)
broken out of loop
Accuracy, Confidence: (0.328125, 0.9507653713226318)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4888, std=2.5522
[DEBUG][MIA] Test Set Loss:   mean=3.7508, std=4.5056
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.5450980392156863, 'auc': 0.7034912109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.9330, std=3.5420
[DEBUG][MIA] Test Set Loss:   mean=3.7642, std=4.5399
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11200000000000002, 'auc': 0.5457919999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2824, std=2.4061
[DEBUG][MIA] Test Set Loss:   mean=2.3046, std=3.0474
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.21960784313725493, 'auc': 0.636444091796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4340, std=3.3547
[DEBUG][MIA] Test Set Loss:   mean=2.9565, std=3.7827
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.096, 'auc': 0.44966400000000006, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1268, std=1.9128
[DEBUG][MIA] Test Set Loss:   mean=2.3273, std=3.3503
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.15294117647058822, 'auc': 0.6109619140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1721, std=3.2333
[DEBUG][MIA] Test Set Loss:   mean=2.8554, std=3.7107
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.126, 'auc': 0.551288, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.5327, std=3.4268
[DEBUG][MIA] Test Set Loss:   mean=5.0615, std=4.7657
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2823529411764706, 'auc': 0.680877685546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0400, std=4.4053
[DEBUG][MIA] Test Set Loss:   mean=4.8158, std=4.8397
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.098, 'auc': 0.54952, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2209, std=2.4435
[DEBUG][MIA] Test Set Loss:   mean=4.5710, std=3.7818
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.4470588235294118, 'auc': 0.6832275390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.5943, std=3.5926
[DEBUG][MIA] Test Set Loss:   mean=4.5967, std=4.1820
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11599999999999999, 'auc': 0.5664, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4083, std=2.5587
[DEBUG][MIA] Test Set Loss:   mean=3.1010, std=3.9571
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.15294117647058825, 'auc': 0.63714599609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2991, std=3.4387
[DEBUG][MIA] Test Set Loss:   mean=3.1539, std=4.0726
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.068, 'auc': 0.568384, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2164, std=2.3598
[DEBUG][MIA] Test Set Loss:   mean=3.5664, std=3.3190
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.30588235294117644, 'auc': 0.62457275390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0647, std=2.9661
[DEBUG][MIA] Test Set Loss:   mean=3.8103, std=3.4133
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.10400000000000001, 'auc': 0.565488, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.2762, std=2.3634
[DEBUG][MIA] Test Set Loss:   mean=1.9334, std=2.7642
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.19215686274509802, 'auc': 0.5977783203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.2588, std=2.3089
[DEBUG][MIA] Test Set Loss:   mean=1.8274, std=2.7008
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.142, 'auc': 0.563416, 'task': 8}
Total correct retain:  1154  Total retain:  2500
Total correct forget:  15853  Total forget:  47500
Total correct test:  202  Total test:  500
Total correct forget test:  2806  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.404, 0.36, 0.484, 0.484, 0.304, 0.254, 0.496, 0.272, 0.574, 0.47, 0.268, 0.206, 0.194, 0.164, 0.206, 0.2, 0.168, 0.182, 0.2, 0.126]
Unlearning task: 10
Accuracy, Confidence: (0.6640625, 0.8121699690818787)
broken out of loop
Accuracy, Confidence: (0.4609375, 0.9318897724151611)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9891, std=2.6953
[DEBUG][MIA] Test Set Loss:   mean=4.0477, std=6.3454
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.19215686274509805, 'auc': 0.72900390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.9614, std=7.6144
[DEBUG][MIA] Test Set Loss:   mean=4.3505, std=6.6226
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12, 'auc': 0.536608, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4476, std=1.1523
[DEBUG][MIA] Test Set Loss:   mean=2.1015, std=3.2251
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.45098039215686275, 'auc': 0.74993896484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2406, std=3.6015
[DEBUG][MIA] Test Set Loss:   mean=2.3323, std=3.1138
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.13000000000000003, 'auc': 0.542416, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5226, std=3.3406
[DEBUG][MIA] Test Set Loss:   mean=4.0040, std=4.5686
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2549019607843137, 'auc': 0.712799072265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.9687, std=4.2460
[DEBUG][MIA] Test Set Loss:   mean=3.7819, std=4.6446
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10400000000000001, 'auc': 0.5650080000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9098, std=2.2832
[DEBUG][MIA] Test Set Loss:   mean=4.1556, std=5.2177
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.4196078431372549, 'auc': 0.78363037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6853, std=3.6192
[DEBUG][MIA] Test Set Loss:   mean=3.3454, std=4.3235
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.188, 'auc': 0.549752, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8907, std=1.6008
[DEBUG][MIA] Test Set Loss:   mean=4.2408, std=6.2094
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2431372549019608, 'auc': 0.733612060546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.8739, std=5.1783
[DEBUG][MIA] Test Set Loss:   mean=3.5081, std=5.0942
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10800000000000001, 'auc': 0.5381119999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1135, std=0.2468
[DEBUG][MIA] Test Set Loss:   mean=1.5364, std=2.3157
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.47058823529411764, 'auc': 0.745025634765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7917, std=1.3501
[DEBUG][MIA] Test Set Loss:   mean=1.5941, std=2.3532
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.184, 'auc': 0.59552, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4802, std=0.8650
[DEBUG][MIA] Test Set Loss:   mean=1.9432, std=2.9992
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2392156862745098, 'auc': 0.6923828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6063, std=2.8904
[DEBUG][MIA] Test Set Loss:   mean=2.4506, std=4.0179
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.1, 'auc': 0.5884320000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4431, std=0.9159
[DEBUG][MIA] Test Set Loss:   mean=1.8141, std=2.6133
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.2156862745098039, 'auc': 0.67913818359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1866, std=1.7270
[DEBUG][MIA] Test Set Loss:   mean=1.5972, std=2.4657
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.196, 'auc': 0.532208, 'task': 8}
Total correct retain:  1334  Total retain:  2500
Total correct forget:  17189  Total forget:  47500
Total correct test:  235  Total test:  500
Total correct forget test:  3042  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.47, 0.42, 0.528, 0.394, 0.38, 0.412, 0.596, 0.484, 0.582, 0.304, 0.246, 0.138, 0.192, 0.202, 0.218, 0.208, 0.234, 0.194, 0.222, 0.13]
Unlearning task: 9
Accuracy, Confidence: (0.7734375, 0.8534810543060303)
broken out of loop
Accuracy, Confidence: (0.26171875, 0.943996012210846)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2665, std=3.8795
[DEBUG][MIA] Test Set Loss:   mean=3.7716, std=4.9936
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.24705882352941178, 'auc': 0.626708984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.4900, std=4.7037
[DEBUG][MIA] Test Set Loss:   mean=3.9648, std=5.1089
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.092, 'auc': 0.474416, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7677, std=1.9509
[DEBUG][MIA] Test Set Loss:   mean=2.6279, std=3.4306
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25882352941176473, 'auc': 0.71893310546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1578, std=3.0911
[DEBUG][MIA] Test Set Loss:   mean=2.7722, std=3.4718
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11400000000000002, 'auc': 0.570848, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9429, std=1.8519
[DEBUG][MIA] Test Set Loss:   mean=2.6183, std=3.5750
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.2549019607843137, 'auc': 0.6712646484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3877, std=3.5993
[DEBUG][MIA] Test Set Loss:   mean=2.7669, std=3.9101
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.13, 'auc': 0.5278639999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9148, std=2.0234
[DEBUG][MIA] Test Set Loss:   mean=2.9278, std=3.6985
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2627450980392157, 'auc': 0.712982177734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4715, std=3.4603
[DEBUG][MIA] Test Set Loss:   mean=3.0390, std=3.8929
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.136, 'auc': 0.5442, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8762, std=2.0301
[DEBUG][MIA] Test Set Loss:   mean=2.3763, std=3.4510
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.3176470588235294, 'auc': 0.6513671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5110, std=3.8895
[DEBUG][MIA] Test Set Loss:   mean=2.4393, std=3.4852
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.13599999999999998, 'auc': 0.532376, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6348, std=2.3368
[DEBUG][MIA] Test Set Loss:   mean=3.2769, std=3.4707
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.32941176470588235, 'auc': 0.6348876953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.8588, std=3.3051
[DEBUG][MIA] Test Set Loss:   mean=3.1853, std=3.5669
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10200000000000001, 'auc': 0.530336, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0992, std=2.1719
[DEBUG][MIA] Test Set Loss:   mean=2.3785, std=3.0627
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.3843137254901961, 'auc': 0.64617919921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.0351, std=2.9758
[DEBUG][MIA] Test Set Loss:   mean=2.7319, std=3.4301
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.12000000000000002, 'auc': 0.55856, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.5461, std=9.1935
[DEBUG][MIA] Test Set Loss:   mean=9.4893, std=8.5431
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.12941176470588237, 'auc': 0.469024658203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.8978, std=9.2628
[DEBUG][MIA] Test Set Loss:   mean=10.8476, std=9.7328
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10200000000000001, 'auc': 0.47006400000000004, 'task': 8}
Total correct retain:  1326  Total retain:  2500
Total correct forget:  16160  Total forget:  47500
Total correct test:  238  Total test:  500
Total correct forget test:  2931  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.476, 0.416, 0.442, 0.51, 0.464, 0.504, 0.37, 0.458, 0.22, 0.314, 0.254, 0.202, 0.194, 0.184, 0.286, 0.236, 0.19, 0.224, 0.26, 0.134]
Unlearning task: 8
Accuracy, Confidence: (0.6953125, 0.8625000715255737)
broken out of loop
Accuracy, Confidence: (0.3984375, 0.9458272457122803)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6182, std=1.4101
[DEBUG][MIA] Test Set Loss:   mean=3.1213, std=4.6210
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.5843137254901961, 'auc': 0.733489990234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7010, std=3.9490
[DEBUG][MIA] Test Set Loss:   mean=2.9317, std=3.9252
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.12, 'auc': 0.52956, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8355, std=1.7739
[DEBUG][MIA] Test Set Loss:   mean=3.3371, std=3.6579
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.3882352941176471, 'auc': 0.71484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6025, std=3.6541
[DEBUG][MIA] Test Set Loss:   mean=3.3888, std=3.7366
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.10400000000000001, 'auc': 0.584832, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1129, std=4.3836
[DEBUG][MIA] Test Set Loss:   mean=3.6847, std=5.5567
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.15294117647058825, 'auc': 0.641571044921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0268, std=5.0099
[DEBUG][MIA] Test Set Loss:   mean=4.1988, std=6.0951
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11000000000000001, 'auc': 0.548608, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6405, std=2.9244
[DEBUG][MIA] Test Set Loss:   mean=4.2749, std=5.3968
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.19215686274509808, 'auc': 0.6873779296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2300, std=4.4784
[DEBUG][MIA] Test Set Loss:   mean=4.1364, std=5.2601
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12, 'auc': 0.556, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7159, std=2.9529
[DEBUG][MIA] Test Set Loss:   mean=3.9702, std=4.8255
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.12941176470588237, 'auc': 0.654266357421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.2824, std=4.1810
[DEBUG][MIA] Test Set Loss:   mean=4.1270, std=5.2596
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.5316000000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0312, std=1.7438
[DEBUG][MIA] Test Set Loss:   mean=2.2850, std=3.4070
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.23529411764705882, 'auc': 0.627044677734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8678, std=2.7784
[DEBUG][MIA] Test Set Loss:   mean=2.5218, std=3.3424
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.12000000000000002, 'auc': 0.560488, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.1253, std=11.2210
[DEBUG][MIA] Test Set Loss:   mean=10.1835, std=12.4014
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.08627450980392157, 'auc': 0.426605224609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.7487, std=12.0806
[DEBUG][MIA] Test Set Loss:   mean=9.6317, std=11.2151
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10400000000000001, 'auc': 0.488008, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.9710, std=10.6544
[DEBUG][MIA] Test Set Loss:   mean=8.6331, std=9.7698
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10196078431372549, 'auc': 0.511016845703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.4788, std=10.6693
[DEBUG][MIA] Test Set Loss:   mean=10.4645, std=10.9079
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.11399999999999999, 'auc': 0.474104, 'task': 8}
Total correct retain:  1422  Total retain:  2500
Total correct forget:  15829  Total forget:  47500
Total correct test:  256  Total test:  500
Total correct forget test:  2949  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.512, 0.438, 0.402, 0.498, 0.378, 0.404, 0.472, 0.334, 0.272, 0.322, 0.27, 0.252, 0.186, 0.228, 0.24, 0.214, 0.264, 0.32, 0.234, 0.17]
Unlearning task: 7
Accuracy, Confidence: (0.68359375, 0.8736677765846252)
broken out of loop
Accuracy, Confidence: (0.3203125, 0.9179234504699707)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5193, std=1.3661
[DEBUG][MIA] Test Set Loss:   mean=2.9558, std=3.8680
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6117647058823529, 'auc': 0.74212646484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1516, std=3.2530
[DEBUG][MIA] Test Set Loss:   mean=2.7217, std=3.6924
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.094, 'auc': 0.5543279999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9272, std=1.6987
[DEBUG][MIA] Test Set Loss:   mean=3.0007, std=3.0472
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.5529411764705883, 'auc': 0.748046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8384, std=3.1924
[DEBUG][MIA] Test Set Loss:   mean=3.2033, std=3.3807
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.096, 'auc': 0.474448, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3028, std=2.5463
[DEBUG][MIA] Test Set Loss:   mean=3.3137, std=4.9867
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.203921568627451, 'auc': 0.633819580078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0631, std=4.5697
[DEBUG][MIA] Test Set Loss:   mean=3.6764, std=5.1260
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11200000000000002, 'auc': 0.527168, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2275, std=2.8957
[DEBUG][MIA] Test Set Loss:   mean=4.1394, std=5.1997
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.16862745098039217, 'auc': 0.720947265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8856, std=4.5146
[DEBUG][MIA] Test Set Loss:   mean=3.6107, std=5.0882
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11400000000000002, 'auc': 0.5497920000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6621, std=3.7243
[DEBUG][MIA] Test Set Loss:   mean=3.3357, std=4.6185
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.19607843137254902, 'auc': 0.6439208984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.3785, std=5.2776
[DEBUG][MIA] Test Set Loss:   mean=4.0388, std=5.3650
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.098, 'auc': 0.448288, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.6642, std=8.0956
[DEBUG][MIA] Test Set Loss:   mean=8.9587, std=7.5628
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.11372549019607844, 'auc': 0.5701904296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.5574, std=7.3638
[DEBUG][MIA] Test Set Loss:   mean=9.3499, std=8.5488
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.458, 'cv_acc': 0.08399999999999999, 'auc': 0.442816, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.4179, std=10.4467
[DEBUG][MIA] Test Set Loss:   mean=8.3517, std=9.5100
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.10980392156862746, 'auc': 0.423187255859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.1609, std=10.7132
[DEBUG][MIA] Test Set Loss:   mean=7.7953, std=9.1199
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10800000000000001, 'auc': 0.435056, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.1614, std=9.4519
[DEBUG][MIA] Test Set Loss:   mean=7.6288, std=8.7011
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.07450980392156863, 'auc': 0.44964599609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.2929, std=8.4125
[DEBUG][MIA] Test Set Loss:   mean=7.7744, std=8.5124
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.096, 'auc': 0.47838400000000003, 'task': 8}
Total correct retain:  1291  Total retain:  2500
Total correct forget:  15622  Total forget:  47500
Total correct test:  224  Total test:  500
Total correct forget test:  2924  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.448, 0.484, 0.354, 0.514, 0.456, 0.492, 0.244, 0.352, 0.308, 0.336, 0.286, 0.208, 0.19, 0.224, 0.238, 0.196, 0.252, 0.304, 0.232, 0.178]
Unlearning task: 6
Accuracy, Confidence: (0.72265625, 0.9088973999023438)
broken out of loop
Accuracy, Confidence: (0.4375, 0.9428744316101074)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2213, std=2.3931
[DEBUG][MIA] Test Set Loss:   mean=2.7632, std=3.9106
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.4862745098039216, 'auc': 0.6409912109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5527, std=4.2450
[DEBUG][MIA] Test Set Loss:   mean=2.8766, std=3.2321
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10800000000000001, 'auc': 0.458472, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2959, std=2.0476
[DEBUG][MIA] Test Set Loss:   mean=3.5773, std=3.3293
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.34901960784313724, 'auc': 0.70855712890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2423, std=3.4970
[DEBUG][MIA] Test Set Loss:   mean=3.6331, std=3.7991
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11399999999999999, 'auc': 0.527976, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2990, std=4.2420
[DEBUG][MIA] Test Set Loss:   mean=4.5346, std=6.6881
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.1607843137254902, 'auc': 0.626373291015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.4161, std=5.9669
[DEBUG][MIA] Test Set Loss:   mean=4.8469, std=6.7330
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.5082, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4973, std=2.9713
[DEBUG][MIA] Test Set Loss:   mean=3.9190, std=5.0283
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.18823529411764706, 'auc': 0.656982421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5960, std=5.7863
[DEBUG][MIA] Test Set Loss:   mean=4.3223, std=5.5730
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10200000000000001, 'auc': 0.570264, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.3892, std=10.3532
[DEBUG][MIA] Test Set Loss:   mean=10.0796, std=10.3790
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.11372549019607844, 'auc': 0.432098388671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=10.4420, std=11.3781
[DEBUG][MIA] Test Set Loss:   mean=9.7787, std=11.1667
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.1, 'auc': 0.50692, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8593, std=8.3220
[DEBUG][MIA] Test Set Loss:   mean=9.3597, std=8.0745
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.11764705882352941, 'auc': 0.442291259765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.6114, std=8.5789
[DEBUG][MIA] Test Set Loss:   mean=9.7381, std=8.6048
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11200000000000002, 'auc': 0.501936, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.6249, std=13.4844
[DEBUG][MIA] Test Set Loss:   mean=11.0710, std=13.3474
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627451, 'auc': 0.51898193359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.7858, std=11.3700
[DEBUG][MIA] Test Set Loss:   mean=12.1918, std=13.8219
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.48534399999999994, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.9084, std=13.1343
[DEBUG][MIA] Test Set Loss:   mean=13.1766, std=14.1397
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.49822998046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.3871, std=13.8888
[DEBUG][MIA] Test Set Loss:   mean=13.4007, std=14.1143
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10400000000000001, 'auc': 0.531968, 'task': 8}
Total correct retain:  1347  Total retain:  2500
Total correct forget:  14432  Total forget:  47500
Total correct test:  257  Total test:  500
Total correct forget test:  2699  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.514, 0.38, 0.342, 0.474, 0.4, 0.318, 0.284, 0.292, 0.276, 0.282, 0.276, 0.252, 0.202, 0.242, 0.22, 0.22, 0.214, 0.312, 0.254, 0.158]
Unlearning task: 5
Accuracy, Confidence: (0.63671875, 0.8754971623420715)
broken out of loop
Accuracy, Confidence: (0.32421875, 0.929505467414856)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5859, std=2.4279
[DEBUG][MIA] Test Set Loss:   mean=3.5290, std=3.6135
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.40784313725490196, 'auc': 0.67681884765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0363, std=3.4759
[DEBUG][MIA] Test Set Loss:   mean=3.3354, std=3.6073
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.530672, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6030, std=2.5456
[DEBUG][MIA] Test Set Loss:   mean=3.2653, std=3.5015
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.36470588235294116, 'auc': 0.63763427734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2170, std=3.5790
[DEBUG][MIA] Test Set Loss:   mean=3.6930, std=3.6291
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.10400000000000001, 'auc': 0.455856, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5355, std=4.4384
[DEBUG][MIA] Test Set Loss:   mean=4.1720, std=5.4615
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.12941176470588234, 'auc': 0.637847900390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.4381, std=5.0594
[DEBUG][MIA] Test Set Loss:   mean=4.1239, std=5.6567
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.1, 'auc': 0.550968, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.1803, std=9.4013
[DEBUG][MIA] Test Set Loss:   mean=9.9858, std=9.4340
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.11764705882352941, 'auc': 0.56195068359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.2844, std=9.2708
[DEBUG][MIA] Test Set Loss:   mean=10.6029, std=10.1147
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.1, 'auc': 0.522672, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.5057, std=10.2193
[DEBUG][MIA] Test Set Loss:   mean=8.6048, std=9.1012
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.10196078431372549, 'auc': 0.53240966796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.6608, std=8.8311
[DEBUG][MIA] Test Set Loss:   mean=8.3803, std=9.0642
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.08399999999999999, 'auc': 0.5079279999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9577, std=8.1842
[DEBUG][MIA] Test Set Loss:   mean=6.4887, std=7.4835
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.1450980392156863, 'auc': 0.454864501953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.0769, std=6.6741
[DEBUG][MIA] Test Set Loss:   mean=6.9622, std=7.2916
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10400000000000001, 'auc': 0.529288, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=11.4734, std=10.6364
[DEBUG][MIA] Test Set Loss:   mean=9.0450, std=9.8847
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44921875, 'cv_acc': 0.12941176470588237, 'auc': 0.43341064453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.7615, std=10.4560
[DEBUG][MIA] Test Set Loss:   mean=11.3780, std=10.6819
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10600000000000001, 'auc': 0.444896, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.5547, std=11.7400
[DEBUG][MIA] Test Set Loss:   mean=12.1379, std=12.0471
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.54974365234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.1963, std=12.0881
[DEBUG][MIA] Test Set Loss:   mean=12.4464, std=11.7011
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.1, 'auc': 0.455808, 'task': 8}
Total correct retain:  1123  Total retain:  2500
Total correct forget:  13101  Total forget:  47500
Total correct test:  195  Total test:  500
Total correct forget test:  2441  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.39, 0.34, 0.332, 0.402, 0.246, 0.318, 0.296, 0.212, 0.264, 0.284, 0.268, 0.184, 0.196, 0.206, 0.2, 0.234, 0.274, 0.256, 0.226, 0.144]
Unlearning task: 4
Accuracy, Confidence: (0.58203125, 0.8902435302734375)
broken out of loop
Accuracy, Confidence: (0.35546875, 0.9219478368759155)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2220, std=3.3229
[DEBUG][MIA] Test Set Loss:   mean=4.4120, std=4.1567
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.20392156862745098, 'auc': 0.69158935546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6155, std=4.5584
[DEBUG][MIA] Test Set Loss:   mean=3.8874, std=4.0945
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.122, 'auc': 0.538704, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1120, std=2.8919
[DEBUG][MIA] Test Set Loss:   mean=3.7330, std=3.6786
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.1607843137254902, 'auc': 0.6431884765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.0248, std=4.0570
[DEBUG][MIA] Test Set Loss:   mean=3.9782, std=3.9033
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.500368, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.4382, std=8.9118
[DEBUG][MIA] Test Set Loss:   mean=9.0527, std=9.6181
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11764705882352941, 'auc': 0.521484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.6122, std=8.6068
[DEBUG][MIA] Test Set Loss:   mean=9.1114, std=9.2440
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10800000000000001, 'auc': 0.544312, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.3602, std=7.5578
[DEBUG][MIA] Test Set Loss:   mean=7.3080, std=7.3089
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.16862745098039217, 'auc': 0.56866455078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.9887, std=6.7272
[DEBUG][MIA] Test Set Loss:   mean=7.7474, std=7.7003
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11600000000000002, 'auc': 0.517424, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=12.6575, std=12.4524
[DEBUG][MIA] Test Set Loss:   mean=11.9940, std=12.1360
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.11764705882352941, 'auc': 0.488433837890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=14.1503, std=12.9903
[DEBUG][MIA] Test Set Loss:   mean=12.7764, std=12.8324
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.1, 'auc': 0.5354639999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.4066, std=9.3110
[DEBUG][MIA] Test Set Loss:   mean=8.6263, std=8.0231
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.09803921568627451, 'auc': 0.545379638671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.8985, std=8.7259
[DEBUG][MIA] Test Set Loss:   mean=8.8061, std=8.5194
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.46136, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.3962, std=11.5241
[DEBUG][MIA] Test Set Loss:   mean=12.9123, std=10.6438
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.1215686274509804, 'auc': 0.53302001953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.0511, std=11.0758
[DEBUG][MIA] Test Set Loss:   mean=12.1231, std=10.9809
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.5081279999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.0078, std=9.6706
[DEBUG][MIA] Test Set Loss:   mean=11.3171, std=10.3265
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09411764705882353, 'auc': 0.506256103515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.4180, std=10.5815
[DEBUG][MIA] Test Set Loss:   mean=11.6998, std=10.5605
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.1, 'auc': 0.5114400000000001, 'task': 8}
Total correct retain:  1047  Total retain:  2500
Total correct forget:  11576  Total forget:  47500
Total correct test:  212  Total test:  500
Total correct forget test:  2174  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.424, 0.292, 0.282, 0.3, 0.218, 0.272, 0.274, 0.128, 0.238, 0.27, 0.276, 0.172, 0.196, 0.144, 0.184, 0.194, 0.274, 0.226, 0.246, 0.162]
Unlearning task: 3
Accuracy, Confidence: (0.5078125, 0.818000078201294)
broken out of loop
Accuracy, Confidence: (0.37890625, 0.831231415271759)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2322, std=2.9848
[DEBUG][MIA] Test Set Loss:   mean=3.8852, std=3.5757
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.3372549019607843, 'auc': 0.653076171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.6379, std=3.9124
[DEBUG][MIA] Test Set Loss:   mean=3.9036, std=3.7742
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.094, 'auc': 0.46952, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7143, std=5.1506
[DEBUG][MIA] Test Set Loss:   mean=5.4795, std=5.3872
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.25490196078431376, 'auc': 0.54888916015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.1775, std=5.1860
[DEBUG][MIA] Test Set Loss:   mean=5.5152, std=5.3212
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10800000000000001, 'auc': 0.5172640000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.0034, std=9.5892
[DEBUG][MIA] Test Set Loss:   mean=9.5500, std=8.6681
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12156862745098038, 'auc': 0.53790283203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.8672, std=8.4090
[DEBUG][MIA] Test Set Loss:   mean=9.4425, std=9.4479
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.11200000000000002, 'auc': 0.5480159999999998, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.5588, std=8.5164
[DEBUG][MIA] Test Set Loss:   mean=9.3494, std=9.6688
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.12549019607843137, 'auc': 0.563079833984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.6710, std=8.8460
[DEBUG][MIA] Test Set Loss:   mean=8.9463, std=8.5108
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.128, 'auc': 0.516704, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=11.1377, std=12.4021
[DEBUG][MIA] Test Set Loss:   mean=10.6977, std=11.7210
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11372549019607843, 'auc': 0.51141357421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=13.0488, std=12.9861
[DEBUG][MIA] Test Set Loss:   mean=12.5427, std=12.2083
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10400000000000001, 'auc': 0.49723200000000006, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.1688, std=9.6812
[DEBUG][MIA] Test Set Loss:   mean=9.8107, std=8.5385
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08627450980392157, 'auc': 0.533843994140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.9723, std=8.7567
[DEBUG][MIA] Test Set Loss:   mean=9.3990, std=8.3466
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.098, 'auc': 0.518888, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.3446, std=11.4695
[DEBUG][MIA] Test Set Loss:   mean=11.1986, std=10.7235
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.11764705882352941, 'auc': 0.4781494140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.7750, std=10.8171
[DEBUG][MIA] Test Set Loss:   mean=11.6291, std=9.9436
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.09, 'auc': 0.477184, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.2514, std=10.6286
[DEBUG][MIA] Test Set Loss:   mean=11.3490, std=11.0163
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.09803921568627451, 'auc': 0.4681396484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.2677, std=10.5113
[DEBUG][MIA] Test Set Loss:   mean=12.0568, std=10.4098
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.096, 'auc': 0.473128, 'task': 8}
Total correct retain:  1121  Total retain:  2500
Total correct forget:  11247  Total forget:  47500
Total correct test:  226  Total test:  500
Total correct forget test:  2133  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.452, 0.274, 0.262, 0.298, 0.196, 0.286, 0.272, 0.112, 0.226, 0.258, 0.282, 0.214, 0.196, 0.152, 0.196, 0.19, 0.222, 0.22, 0.248, 0.162]
Unlearning task: 2
Accuracy, Confidence: (0.4765625, 0.818462610244751)
broken out of loop
Accuracy, Confidence: (0.328125, 0.8966269493103027)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 5, 9, 9, 9, 8, 6, 9, 7, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.6444, std=6.5457
[DEBUG][MIA] Test Set Loss:   mean=8.0572, std=6.6674
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.30588235294117644, 'auc': 0.56787109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 8 7 7 6 6 6 7 5 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 7 5 7 8 9 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.6776, std=6.7053
[DEBUG][MIA] Test Set Loss:   mean=7.8652, std=6.5924
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09, 'auc': 0.49211199999999994, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 11, 10, 10, 14, 13, 12, 12, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.8194, std=5.6040
[DEBUG][MIA] Test Set Loss:   mean=5.9776, std=5.9427
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.13725490196078433, 'auc': 0.57098388671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 10 10 12 12 12 14 11 11 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 11 13 14 11 11 13 10 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.4348, std=6.2796
[DEBUG][MIA] Test Set Loss:   mean=6.1804, std=6.3091
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.1, 'auc': 0.45260799999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 17, 16, 18, 17, 19, 18, 17, 18, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.4088, std=8.3039
[DEBUG][MIA] Test Set Loss:   mean=10.8608, std=10.5692
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.09411764705882353, 'auc': 0.408660888671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 19 18 18 17 15 19 15 17 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 19 17 17 15 19 17 19 16 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.4326, std=8.8957
[DEBUG][MIA] Test Set Loss:   mean=9.1904, std=9.3618
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.16199999999999998, 'auc': 0.5209199999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 22, 21, 20, 21, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.9718, std=8.5933
[DEBUG][MIA] Test Set Loss:   mean=9.3376, std=9.3784
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.11372549019607844, 'auc': 0.55145263671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 23 23 21 22 24 24 21 22 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 23 20 23 20 20 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.3730, std=8.1606
[DEBUG][MIA] Test Set Loss:   mean=9.3750, std=9.1288
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.47540799999999994, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 29, 27, 28, 27, 29, 29, 25, 29, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=12.1487, std=12.3701
[DEBUG][MIA] Test Set Loss:   mean=12.6358, std=12.2726
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09019607843137255, 'auc': 0.529327392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 27 26 29 27 25 26 25 29 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 25 29 29 27 27 29 27 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=12.3097, std=12.4268
[DEBUG][MIA] Test Set Loss:   mean=11.3076, std=12.1672
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.4764, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([33, 34, 34, 30, 31, 31, 30, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.7435, std=9.9348
[DEBUG][MIA] Test Set Loss:   mean=11.1548, std=9.6286
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.511383056640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 32 31 34 30 32 33 32 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 30 32 31 34 33 31 32 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.7061, std=9.5388
[DEBUG][MIA] Test Set Loss:   mean=10.3689, std=9.2141
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.509872, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 38, 37, 36, 39, 37, 38, 38, 39, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.8947, std=11.7678
[DEBUG][MIA] Test Set Loss:   mean=12.2955, std=10.7589
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.12941176470588237, 'auc': 0.49468994140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 35 35 38 35 39 37 36 35 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 35 39 38 35 36 37 36 39 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=12.6178, std=11.4342
[DEBUG][MIA] Test Set Loss:   mean=12.3129, std=10.7753
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.50104, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 41, 43, 42, 41, 43, 42, 42, 44, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=14.1735, std=12.1519
[DEBUG][MIA] Test Set Loss:   mean=11.8198, std=10.7083
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.12941176470588237, 'auc': 0.445343017578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [40 40 42 40 43 44 43 41 44 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 42 40 43 40 43 40 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=13.0372, std=12.0516
[DEBUG][MIA] Test Set Loss:   mean=13.4207, std=11.7383
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10800000000000001, 'auc': 0.487592, 'task': 8}
Total correct retain:  1024  Total retain:  2500
Total correct forget:  11348  Total forget:  47500
Total correct test:  188  Total test:  500
Total correct forget test:  2175  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.376, 0.234, 0.24, 0.284, 0.226, 0.292, 0.258, 0.118, 0.24, 0.266, 0.254, 0.238, 0.194, 0.176, 0.228, 0.216, 0.236, 0.236, 0.246, 0.168]
Command line arguments:
number_of_gpus: 1
algorithm: neggrad
alpha: 0.5
learn_mem_strength: 0.5
learn_batch_size: 20
unlearn_mem_strength: 0.5
unlearn_batch_size: 10
average_over_n_runs: 3
salun: 0
salun_strength: 0.2
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 11:00:46 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 44%   70C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['baby', 'wardrobe', 'bridge', 'cups', 'sweet peppers', 'lawn-mower', 'bus', 'couch', 'castle', 'tulips', 'fox', 'lizard', 'raccoon', 'ray', 'plain', 'sunflowers', 'caterpillar', 'leopard', 'clock', 'pears', 'elephant', 'dinosaur', 'crab', 'camel', 'oak', 'sea', 'lobster', 'otter', 'mountain', 'mouse', 'lion', 'crocodile', 'beetle', 'tank', 'house', 'hamster', 'road', 'worm', 'streetcar', 'skyscraper', 'roses', 'tiger', 'dolphin', 'telephone', 'poppies', 'maple', 'spider', 'tractor', 'chimpanzee', 'table', 'pine', 'squirrel', 'aquarium fish', 'bed', 'willow', 'pickup truck', 'orchids', 'mushrooms', 'butterfly', 'whale', 'wolf', 'seal', 'rabbit', 'trout', 'oranges', 'palm', 'bee', 'possum', 'turtle', 'shark', 'shrew', 'lamp', 'bowls', 'kangaroo', 'television', 'chair', 'computer keyboard', 'cockroach', 'rocket', 'cloud', 'plates', 'porcupine', 'forest', 'snail', 'motorcycle', 'boy', 'train', 'snake', 'girl', 'flatfish', 'skunk', 'man', 'bear', 'beaver', 'bottles', 'cattle', 'woman', 'bicycle', 'apples', 'cans']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2269  Total retain:  2500
Total correct forget:  10008  Total forget:  47500
Total correct test:  385  Total test:  500
Total correct forget test:  1923  Total test forget:  9500
After learning task 1
Task accuracies: [0.77, 0.276, 0.206, 0.226, 0.194, 0.222, 0.29, 0.158, 0.158, 0.194, 0.19, 0.2, 0.104, 0.136, 0.284, 0.112, 0.228, 0.188, 0.218, 0.262]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0335
[DEBUG][MIA] Test Set Loss:   mean=0.8031, std=1.9849
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.20392156862745098, 'auc': 0.68096923828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0208, std=0.2192
[DEBUG][MIA] Test Set Loss:   mean=0.6951, std=1.9493
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.202, 'auc': 0.699344, 'task': 1}
2 1
Total correct retain:  2075  Total retain:  2500
Total correct forget:  11762  Total forget:  47500
Total correct test:  370  Total test:  500
Total correct forget test:  2241  Total test forget:  9500
After learning task 2
Task accuracies: [0.74, 0.83, 0.208, 0.182, 0.202, 0.268, 0.264, 0.166, 0.192, 0.182, 0.182, 0.202, 0.196, 0.166, 0.296, 0.132, 0.246, 0.216, 0.204, 0.148]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0123, std=0.0582
[DEBUG][MIA] Test Set Loss:   mean=1.0693, std=2.1641
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2823529411764706, 'auc': 0.7684326171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3933, std=1.0776
[DEBUG][MIA] Test Set Loss:   mean=1.1090, std=2.0506
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.15, 'auc': 0.61252, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0359, std=0.1865
[DEBUG][MIA] Test Set Loss:   mean=1.0189, std=2.3573
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.20784313725490197, 'auc': 0.6494140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0105, std=0.0943
[DEBUG][MIA] Test Set Loss:   mean=0.8957, std=2.0692
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.20600000000000002, 'auc': 0.69236, 'task': 2}
3 2
Total correct retain:  1831  Total retain:  2500
Total correct forget:  13872  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  2597  Total test forget:  9500
After learning task 3
Task accuracies: [0.674, 0.758, 0.794, 0.248, 0.166, 0.34, 0.26, 0.174, 0.252, 0.206, 0.166, 0.2, 0.222, 0.19, 0.26, 0.14, 0.23, 0.212, 0.226, 0.15]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=1.2764, std=2.6405
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2666666666666667, 'auc': 0.830902099609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5598, std=1.4822
[DEBUG][MIA] Test Set Loss:   mean=0.9998, std=2.1801
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12400000000000003, 'auc': 0.549896, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0366, std=0.1451
[DEBUG][MIA] Test Set Loss:   mean=1.3687, std=2.3104
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.24705882352941172, 'auc': 0.722259521484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4597, std=1.2520
[DEBUG][MIA] Test Set Loss:   mean=1.2738, std=2.4527
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.182, 'auc': 0.628408, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0312, std=0.1743
[DEBUG][MIA] Test Set Loss:   mean=0.8706, std=2.0291
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2235294117647059, 'auc': 0.672332763671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0354
[DEBUG][MIA] Test Set Loss:   mean=1.2074, std=2.5639
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.668, 'cv_acc': 0.21400000000000002, 'auc': 0.69664, 'task': 3}
4 3
Total correct retain:  1905  Total retain:  2500
Total correct forget:  15114  Total forget:  47500
Total correct test:  358  Total test:  500
Total correct forget test:  2805  Total test forget:  9500
After learning task 4
Task accuracies: [0.716, 0.748, 0.7, 0.764, 0.202, 0.254, 0.224, 0.19, 0.204, 0.174, 0.194, 0.2, 0.276, 0.166, 0.302, 0.14, 0.23, 0.226, 0.232, 0.184]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0860, std=0.4984
[DEBUG][MIA] Test Set Loss:   mean=1.6203, std=3.1922
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.22745098039215686, 'auc': 0.721710205078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0666, std=2.3790
[DEBUG][MIA] Test Set Loss:   mean=1.4046, std=2.8451
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.15599999999999997, 'auc': 0.549952, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=1.2717, std=2.3841
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6784313725490196, 'auc': 0.803253173828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6334, std=1.4313
[DEBUG][MIA] Test Set Loss:   mean=1.0965, std=2.1048
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.17, 'auc': 0.560784, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0141, std=0.0538
[DEBUG][MIA] Test Set Loss:   mean=1.4040, std=2.5587
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6784313725490196, 'auc': 0.7481689453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3324, std=0.9247
[DEBUG][MIA] Test Set Loss:   mean=1.2174, std=2.3048
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.21200000000000002, 'auc': 0.6394880000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0344, std=0.1158
[DEBUG][MIA] Test Set Loss:   mean=0.8200, std=1.7482
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2156862745098039, 'auc': 0.659576416015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0392, std=0.3162
[DEBUG][MIA] Test Set Loss:   mean=0.7078, std=1.7456
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.21399999999999997, 'auc': 0.6355999999999999, 'task': 4}
5 4
Total correct retain:  1737  Total retain:  2500
Total correct forget:  16859  Total forget:  47500
Total correct test:  313  Total test:  500
Total correct forget test:  3063  Total test forget:  9500
After learning task 5
Task accuracies: [0.626, 0.704, 0.678, 0.696, 0.792, 0.244, 0.226, 0.162, 0.234, 0.212, 0.194, 0.208, 0.256, 0.162, 0.284, 0.138, 0.244, 0.228, 0.222, 0.242]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0268, std=0.1617
[DEBUG][MIA] Test Set Loss:   mean=1.7510, std=2.9271
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.30980392156862746, 'auc': 0.7615966796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9298, std=1.8736
[DEBUG][MIA] Test Set Loss:   mean=1.6607, std=2.9323
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.15799999999999997, 'auc': 0.561752, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.5515, std=2.6348
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.27450980392156865, 'auc': 0.830535888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7158, std=1.6433
[DEBUG][MIA] Test Set Loss:   mean=1.1176, std=2.0224
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.126, 'auc': 0.5676160000000001, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0292, std=0.1559
[DEBUG][MIA] Test Set Loss:   mean=1.5081, std=2.7256
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6705882352941177, 'auc': 0.752410888671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6549, std=1.5283
[DEBUG][MIA] Test Set Loss:   mean=1.4089, std=2.3519
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.202, 'auc': 0.596104, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0067, std=0.0190
[DEBUG][MIA] Test Set Loss:   mean=1.4053, std=2.8375
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.29411764705882354, 'auc': 0.76300048828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5568, std=1.4882
[DEBUG][MIA] Test Set Loss:   mean=1.3741, std=2.5837
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.188, 'auc': 0.5902560000000001, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0388, std=0.2225
[DEBUG][MIA] Test Set Loss:   mean=1.5688, std=2.8865
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.24705882352941172, 'auc': 0.750030517578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0280, std=0.2461
[DEBUG][MIA] Test Set Loss:   mean=1.2239, std=2.5593
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.26, 'auc': 0.745392, 'task': 5}
6 5
Total correct retain:  1748  Total retain:  2500
Total correct forget:  17466  Total forget:  47500
Total correct test:  324  Total test:  500
Total correct forget test:  3114  Total test forget:  9500
After learning task 6
Task accuracies: [0.648, 0.67, 0.688, 0.634, 0.704, 0.72, 0.27, 0.164, 0.242, 0.188, 0.178, 0.2, 0.208, 0.174, 0.238, 0.106, 0.244, 0.218, 0.244, 0.138]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0112, std=0.0499
[DEBUG][MIA] Test Set Loss:   mean=1.9810, std=3.9103
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2784313725490196, 'auc': 0.80670166015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8949, std=2.1308
[DEBUG][MIA] Test Set Loss:   mean=1.4495, std=2.6886
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.142, 'auc': 0.582296, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.2162, std=2.3991
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30980392156862746, 'auc': 0.75732421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8637, std=1.7547
[DEBUG][MIA] Test Set Loss:   mean=1.4867, std=2.4826
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.570536, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0075
[DEBUG][MIA] Test Set Loss:   mean=1.0546, std=2.1561
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7333333333333334, 'auc': 0.808990478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7532, std=1.7002
[DEBUG][MIA] Test Set Loss:   mean=1.7392, std=2.8685
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.178, 'auc': 0.626336, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0208, std=0.1017
[DEBUG][MIA] Test Set Loss:   mean=1.6962, std=2.9588
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.27058823529411763, 'auc': 0.717529296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7327, std=1.6963
[DEBUG][MIA] Test Set Loss:   mean=1.5228, std=2.8186
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.158, 'auc': 0.557064, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0509
[DEBUG][MIA] Test Set Loss:   mean=1.4708, std=2.6164
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2784313725490196, 'auc': 0.776123046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3349, std=1.1783
[DEBUG][MIA] Test Set Loss:   mean=1.7170, std=2.9685
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.22599999999999998, 'auc': 0.654264, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0661
[DEBUG][MIA] Test Set Loss:   mean=0.7516, std=1.9658
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.23529411764705882, 'auc': 0.710693359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0499
[DEBUG][MIA] Test Set Loss:   mean=0.9495, std=2.0996
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.21600000000000003, 'auc': 0.6865680000000001, 'task': 6}
7 6
Total correct retain:  1810  Total retain:  2500
Total correct forget:  18940  Total forget:  47500
Total correct test:  346  Total test:  500
Total correct forget test:  3406  Total test forget:  9500
After learning task 7
Task accuracies: [0.692, 0.7, 0.67, 0.678, 0.666, 0.65, 0.812, 0.14, 0.256, 0.208, 0.192, 0.202, 0.204, 0.158, 0.274, 0.102, 0.262, 0.214, 0.282, 0.142]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1077, std=0.7114
[DEBUG][MIA] Test Set Loss:   mean=1.6769, std=2.7135
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.23529411764705882, 'auc': 0.772613525390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2824, std=2.5007
[DEBUG][MIA] Test Set Loss:   mean=2.0168, std=3.6821
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.098, 'auc': 0.568768, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.3310, std=2.4319
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.29411764705882354, 'auc': 0.847320556640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8352, std=1.9105
[DEBUG][MIA] Test Set Loss:   mean=1.3847, std=2.5533
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.12600000000000003, 'auc': 0.58584, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0766, std=0.3632
[DEBUG][MIA] Test Set Loss:   mean=2.0711, std=3.0829
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.5999999999999999, 'auc': 0.803436279296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0097, std=1.9843
[DEBUG][MIA] Test Set Loss:   mean=1.8699, std=2.8817
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15599999999999997, 'auc': 0.585936, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.2574, std=2.4631
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.27450980392156865, 'auc': 0.7889404296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6490, std=1.5598
[DEBUG][MIA] Test Set Loss:   mean=1.3046, std=2.6206
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.178, 'auc': 0.5633440000000001, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0177
[DEBUG][MIA] Test Set Loss:   mean=1.6170, std=2.6062
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7333333333333333, 'auc': 0.842254638671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4038, std=0.9999
[DEBUG][MIA] Test Set Loss:   mean=1.7666, std=2.7803
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.236, 'auc': 0.6544399999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0114
[DEBUG][MIA] Test Set Loss:   mean=0.9549, std=2.1880
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.7058823529411764, 'auc': 0.76898193359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3224, std=0.8945
[DEBUG][MIA] Test Set Loss:   mean=1.1582, std=2.2737
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.194, 'auc': 0.607616, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0122, std=0.0549
[DEBUG][MIA] Test Set Loss:   mean=0.8753, std=1.9854
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.22745098039215686, 'auc': 0.665496826171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0391
[DEBUG][MIA] Test Set Loss:   mean=0.7643, std=1.9655
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.21799999999999997, 'auc': 0.647672, 'task': 7}
8 7
Total correct retain:  1710  Total retain:  2500
Total correct forget:  20560  Total forget:  47500
Total correct test:  313  Total test:  500
Total correct forget test:  3596  Total test forget:  9500
After learning task 8
Task accuracies: [0.626, 0.67, 0.692, 0.598, 0.704, 0.634, 0.714, 0.8, 0.252, 0.218, 0.198, 0.202, 0.224, 0.17, 0.24, 0.104, 0.212, 0.194, 0.25, 0.116]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=1.4829, std=2.9593
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.3058823529411765, 'auc': 0.7779541015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1054, std=2.1342
[DEBUG][MIA] Test Set Loss:   mean=1.2563, std=2.8082
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11800000000000002, 'auc': 0.5464479999999999, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0127, std=0.0794
[DEBUG][MIA] Test Set Loss:   mean=1.3761, std=2.2067
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7019607843137255, 'auc': 0.78533935546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2242, std=2.2714
[DEBUG][MIA] Test Set Loss:   mean=1.6456, std=2.7180
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10400000000000001, 'auc': 0.5295200000000001, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.3353, std=2.3244
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6941176470588235, 'auc': 0.86419677734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9575, std=2.0578
[DEBUG][MIA] Test Set Loss:   mean=1.4905, std=2.7215
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.168, 'auc': 0.567256, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0439, std=0.1890
[DEBUG][MIA] Test Set Loss:   mean=1.9689, std=3.4582
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2901960784313725, 'auc': 0.70562744140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9768, std=2.2022
[DEBUG][MIA] Test Set Loss:   mean=1.4625, std=2.5771
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.16399999999999998, 'auc': 0.56728, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0846, std=0.2538
[DEBUG][MIA] Test Set Loss:   mean=2.6064, std=3.8679
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.623529411764706, 'auc': 0.778656005859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2303, std=2.5760
[DEBUG][MIA] Test Set Loss:   mean=2.4603, std=3.7574
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.166, 'auc': 0.589256, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0066
[DEBUG][MIA] Test Set Loss:   mean=1.3254, std=2.2059
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.29411764705882354, 'auc': 0.82421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4604, std=1.3407
[DEBUG][MIA] Test Set Loss:   mean=1.2512, std=2.4209
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.182, 'auc': 0.617672, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0468, std=0.1454
[DEBUG][MIA] Test Set Loss:   mean=1.2769, std=2.5808
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.26666666666666666, 'auc': 0.69769287109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4750, std=1.2099
[DEBUG][MIA] Test Set Loss:   mean=1.3850, std=2.5161
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.16599999999999998, 'auc': 0.610576, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0099, std=0.0486
[DEBUG][MIA] Test Set Loss:   mean=0.9548, std=2.2984
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.24313725490196075, 'auc': 0.70086669921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0074, std=0.0526
[DEBUG][MIA] Test Set Loss:   mean=1.0212, std=2.2994
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.22400000000000003, 'auc': 0.723368, 'task': 8}
Total correct retain:  1885  Total retain:  2500
Total correct forget:  21745  Total forget:  47500
Total correct test:  351  Total test:  500
Total correct forget test:  3861  Total test forget:  9500
After learning task 9
Task accuracies: [0.702, 0.72, 0.654, 0.688, 0.67, 0.584, 0.706, 0.69, 0.778, 0.204, 0.194, 0.208, 0.204, 0.14, 0.276, 0.13, 0.19, 0.222, 0.248, 0.216]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0068
[DEBUG][MIA] Test Set Loss:   mean=1.7020, std=3.2580
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.29411764705882354, 'auc': 0.837646484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1713, std=2.5123
[DEBUG][MIA] Test Set Loss:   mean=1.7355, std=3.1769
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.088, 'auc': 0.5803039999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0134
[DEBUG][MIA] Test Set Loss:   mean=1.4759, std=2.6715
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7176470588235295, 'auc': 0.831939697265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8999, std=1.8910
[DEBUG][MIA] Test Set Loss:   mean=1.3313, std=2.3475
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10800000000000001, 'auc': 0.590368, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=1.4448, std=2.6592
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.2823529411764706, 'auc': 0.820098876953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9161, std=2.1251
[DEBUG][MIA] Test Set Loss:   mean=1.6249, std=2.9508
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.146, 'auc': 0.5604399999999999, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0124
[DEBUG][MIA] Test Set Loss:   mean=1.6105, std=2.6757
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24313725490196075, 'auc': 0.720855712890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0889, std=2.1673
[DEBUG][MIA] Test Set Loss:   mean=1.4084, std=2.5372
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10400000000000001, 'auc': 0.514656, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0096, std=0.0464
[DEBUG][MIA] Test Set Loss:   mean=2.2173, std=3.6378
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6705882352941176, 'auc': 0.814453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0187, std=2.1965
[DEBUG][MIA] Test Set Loss:   mean=2.1699, std=3.2453
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.2, 'auc': 0.6217360000000001, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0133
[DEBUG][MIA] Test Set Loss:   mean=1.4156, std=2.1928
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7058823529411764, 'auc': 0.8492431640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5451, std=1.3189
[DEBUG][MIA] Test Set Loss:   mean=1.1809, std=2.2372
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.182, 'auc': 0.6049599999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0206, std=0.0747
[DEBUG][MIA] Test Set Loss:   mean=1.2041, std=2.3225
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.25882352941176473, 'auc': 0.74468994140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4262, std=1.0588
[DEBUG][MIA] Test Set Loss:   mean=1.0806, std=2.1994
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.15999999999999998, 'auc': 0.568184, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0384, std=0.2385
[DEBUG][MIA] Test Set Loss:   mean=0.7810, std=1.8498
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2549019607843137, 'auc': 0.708160400390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2068, std=0.8349
[DEBUG][MIA] Test Set Loss:   mean=1.0906, std=2.1196
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.19999999999999998, 'auc': 0.6621920000000001, 'task': 8}
Total correct retain:  1733  Total retain:  2500
Total correct forget:  23261  Total forget:  47500
Total correct test:  334  Total test:  500
Total correct forget test:  4111  Total test forget:  9500
After learning task 10
Task accuracies: [0.668, 0.672, 0.67, 0.682, 0.688, 0.612, 0.666, 0.744, 0.704, 0.828, 0.194, 0.206, 0.21, 0.168, 0.268, 0.086, 0.204, 0.216, 0.212, 0.192]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0338
[DEBUG][MIA] Test Set Loss:   mean=1.6698, std=3.0359
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.4666666666666666, 'auc': 0.79266357421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4251, std=2.9600
[DEBUG][MIA] Test Set Loss:   mean=1.6193, std=3.1540
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.13999999999999999, 'auc': 0.5527040000000001, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.0951, std=3.0835
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7058823529411765, 'auc': 0.837432861328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4154, std=2.5599
[DEBUG][MIA] Test Set Loss:   mean=1.5638, std=2.5899
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.154, 'auc': 0.509984, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.9204, std=3.5112
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.25882352941176473, 'auc': 0.82208251953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3362, std=2.6520
[DEBUG][MIA] Test Set Loss:   mean=1.9307, std=3.3238
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11800000000000002, 'auc': 0.551056, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0146
[DEBUG][MIA] Test Set Loss:   mean=1.4596, std=2.5720
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.29411764705882354, 'auc': 0.774169921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1807, std=2.4703
[DEBUG][MIA] Test Set Loss:   mean=1.6063, std=2.8782
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.142, 'auc': 0.551768, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0095, std=0.0363
[DEBUG][MIA] Test Set Loss:   mean=2.2667, std=3.6984
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6509803921568629, 'auc': 0.7742919921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1813, std=2.5277
[DEBUG][MIA] Test Set Loss:   mean=2.3204, std=3.4319
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.21400000000000002, 'auc': 0.606248, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.1308, std=1.9914
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7058823529411766, 'auc': 0.85882568359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1716, std=2.3792
[DEBUG][MIA] Test Set Loss:   mean=1.2731, std=2.2851
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.15999999999999998, 'auc': 0.5666640000000001, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0161
[DEBUG][MIA] Test Set Loss:   mean=0.9711, std=2.0749
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.6588235294117648, 'auc': 0.78607177734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6324, std=1.6494
[DEBUG][MIA] Test Set Loss:   mean=1.1810, std=2.2713
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.176, 'auc': 0.597504, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0705, std=0.3263
[DEBUG][MIA] Test Set Loss:   mean=1.3460, std=2.7021
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2705882352941177, 'auc': 0.74652099609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5150, std=1.4733
[DEBUG][MIA] Test Set Loss:   mean=1.4812, std=2.7936
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.18, 'auc': 0.6055039999999999, 'task': 8}
Total correct retain:  1758  Total retain:  2500
Total correct forget:  24591  Total forget:  47500
Total correct test:  335  Total test:  500
Total correct forget test:  4259  Total test forget:  9500
After learning task 11
Task accuracies: [0.67, 0.67, 0.632, 0.646, 0.69, 0.576, 0.65, 0.714, 0.668, 0.772, 0.768, 0.22, 0.202, 0.164, 0.238, 0.086, 0.222, 0.218, 0.21, 0.172]
Unlearning task: 11
Accuracy, Confidence: (0.99609375, 0.9966199994087219)
broken out of loop
Accuracy, Confidence: (0.4765625, 0.9472885727882385)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9662, std=2.5287
[DEBUG][MIA] Test Set Loss:   mean=3.9386, std=5.6816
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.21960784313725493, 'auc': 0.724151611328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5137, std=4.1111
[DEBUG][MIA] Test Set Loss:   mean=3.2180, std=4.4544
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.09, 'auc': 0.557448, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9214, std=2.2788
[DEBUG][MIA] Test Set Loss:   mean=3.3565, std=3.8722
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.5647058823529412, 'auc': 0.735809326171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4651, std=3.5768
[DEBUG][MIA] Test Set Loss:   mean=2.8454, std=3.6109
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.128, 'auc': 0.5491280000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5665, std=1.6470
[DEBUG][MIA] Test Set Loss:   mean=2.6143, std=3.4456
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2901960784313725, 'auc': 0.7279052734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1452, std=3.1554
[DEBUG][MIA] Test Set Loss:   mean=2.6909, std=3.6663
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.16199999999999998, 'auc': 0.536648, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8382, std=1.8618
[DEBUG][MIA] Test Set Loss:   mean=3.1257, std=4.2099
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2549019607843137, 'auc': 0.68988037109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3052, std=3.7374
[DEBUG][MIA] Test Set Loss:   mean=3.0824, std=3.9220
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11000000000000001, 'auc': 0.5663039999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9166, std=2.2881
[DEBUG][MIA] Test Set Loss:   mean=3.1955, std=3.9743
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5490196078431373, 'auc': 0.70611572265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.6261, std=3.6529
[DEBUG][MIA] Test Set Loss:   mean=3.2651, std=4.3189
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.182, 'auc': 0.539088, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5114, std=1.3437
[DEBUG][MIA] Test Set Loss:   mean=2.9375, std=3.5619
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.6235294117647059, 'auc': 0.756011962890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2788, std=3.4557
[DEBUG][MIA] Test Set Loss:   mean=2.9951, std=3.6545
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11800000000000002, 'auc': 0.5753039999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9737, std=2.0866
[DEBUG][MIA] Test Set Loss:   mean=2.5067, std=3.3593
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.24705882352941178, 'auc': 0.6524658203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9348, std=3.4887
[DEBUG][MIA] Test Set Loss:   mean=2.2889, std=3.1475
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.126, 'auc': 0.5493680000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.3273, std=2.2925
[DEBUG][MIA] Test Set Loss:   mean=2.3942, std=3.5832
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.18823529411764706, 'auc': 0.589569091796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8265, std=2.9879
[DEBUG][MIA] Test Set Loss:   mean=2.9572, std=3.8442
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10200000000000001, 'auc': 0.604752, 'task': 8}
Total correct retain:  1262  Total retain:  2500
Total correct forget:  18126  Total forget:  47500
Total correct test:  251  Total test:  500
Total correct forget test:  3212  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.502, 0.5, 0.466, 0.494, 0.466, 0.47, 0.452, 0.538, 0.48, 0.502, 0.358, 0.242, 0.172, 0.152, 0.206, 0.116, 0.168, 0.212, 0.23, 0.2]
Unlearning task: 10
Accuracy, Confidence: (0.8046875, 0.9077904224395752)
broken out of loop
Accuracy, Confidence: (0.46875, 0.8833684921264648)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2297, std=2.2950
[DEBUG][MIA] Test Set Loss:   mean=3.9354, std=5.4699
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.20392156862745098, 'auc': 0.687896728515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0671, std=5.0431
[DEBUG][MIA] Test Set Loss:   mean=3.7800, std=5.2812
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.092, 'auc': 0.493984, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5145, std=2.9184
[DEBUG][MIA] Test Set Loss:   mean=3.3360, std=4.0776
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.24705882352941178, 'auc': 0.656402587890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5014, std=4.4992
[DEBUG][MIA] Test Set Loss:   mean=3.3503, std=4.0717
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.128, 'auc': 0.503736, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9795, std=1.9144
[DEBUG][MIA] Test Set Loss:   mean=3.7694, std=4.0987
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2392156862745098, 'auc': 0.72711181640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.7215, std=3.7294
[DEBUG][MIA] Test Set Loss:   mean=3.3588, std=3.9146
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.549824, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3133, std=2.5406
[DEBUG][MIA] Test Set Loss:   mean=3.4059, std=4.1201
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.21176470588235294, 'auc': 0.705474853515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2375, std=4.3064
[DEBUG][MIA] Test Set Loss:   mean=4.1297, std=4.8494
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.12600000000000003, 'auc': 0.54996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1269, std=5.0281
[DEBUG][MIA] Test Set Loss:   mean=4.4073, std=4.7805
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.21176470588235294, 'auc': 0.693115234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.0427, std=4.1870
[DEBUG][MIA] Test Set Loss:   mean=3.6783, std=4.5064
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.154, 'auc': 0.5476319999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9167, std=2.2901
[DEBUG][MIA] Test Set Loss:   mean=3.3755, std=4.1215
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.21960784313725493, 'auc': 0.724700927734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4395, std=3.3217
[DEBUG][MIA] Test Set Loss:   mean=3.1265, std=3.8990
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11600000000000002, 'auc': 0.549032, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6838, std=3.2044
[DEBUG][MIA] Test Set Loss:   mean=3.1575, std=4.0101
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.23137254901960785, 'auc': 0.659912109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.4055, std=3.5301
[DEBUG][MIA] Test Set Loss:   mean=3.2434, std=4.0577
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.444, 'cv_acc': 0.10400000000000001, 'auc': 0.45367199999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4074, std=2.5578
[DEBUG][MIA] Test Set Loss:   mean=2.5279, std=3.0622
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.1843137254901961, 'auc': 0.6324462890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0866, std=3.2246
[DEBUG][MIA] Test Set Loss:   mean=2.6668, std=3.3462
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.134, 'auc': 0.5670399999999999, 'task': 8}
Total correct retain:  1239  Total retain:  2500
Total correct forget:  16002  Total forget:  47500
Total correct test:  239  Total test:  500
Total correct forget test:  2872  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.478, 0.44, 0.416, 0.418, 0.42, 0.416, 0.44, 0.442, 0.494, 0.304, 0.302, 0.232, 0.14, 0.128, 0.2, 0.096, 0.214, 0.206, 0.23, 0.206]
Unlearning task: 9
Accuracy, Confidence: (0.65234375, 0.8872470855712891)
broken out of loop
Accuracy, Confidence: (0.36328125, 0.9272177219390869)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6842, std=3.6483
[DEBUG][MIA] Test Set Loss:   mean=4.3074, std=5.6053
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.21176470588235294, 'auc': 0.690826416015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0589, std=5.3997
[DEBUG][MIA] Test Set Loss:   mean=4.4605, std=5.4795
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.098, 'auc': 0.526128, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8300, std=2.6772
[DEBUG][MIA] Test Set Loss:   mean=4.1707, std=4.6205
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.3843137254901961, 'auc': 0.656524658203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.6166, std=4.1955
[DEBUG][MIA] Test Set Loss:   mean=4.5116, std=4.5190
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.1, 'auc': 0.43941600000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3863, std=3.9287
[DEBUG][MIA] Test Set Loss:   mean=5.0495, std=4.6404
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.18823529411764706, 'auc': 0.708038330078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.2141, std=5.1629
[DEBUG][MIA] Test Set Loss:   mean=4.7319, std=5.0026
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.092, 'auc': 0.5313279999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2682, std=3.5320
[DEBUG][MIA] Test Set Loss:   mean=5.0824, std=5.2756
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2235294117647059, 'auc': 0.69342041015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.9126, std=5.4631
[DEBUG][MIA] Test Set Loss:   mean=4.7800, std=5.0299
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.134, 'auc': 0.505992, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1925, std=4.5682
[DEBUG][MIA] Test Set Loss:   mean=4.4859, std=5.3762
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2, 'auc': 0.649871826171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.3130, std=4.8444
[DEBUG][MIA] Test Set Loss:   mean=4.2698, std=5.3822
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.092, 'auc': 0.5682560000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3283, std=3.6124
[DEBUG][MIA] Test Set Loss:   mean=4.8453, std=4.8506
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.5254901960784315, 'auc': 0.67864990234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.9533, std=5.3144
[DEBUG][MIA] Test Set Loss:   mean=5.2055, std=5.1814
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.122, 'auc': 0.520816, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2788, std=3.5046
[DEBUG][MIA] Test Set Loss:   mean=4.1495, std=5.2480
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.18039215686274512, 'auc': 0.62652587890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.6527, std=4.5712
[DEBUG][MIA] Test Set Loss:   mean=4.1676, std=5.0506
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11400000000000002, 'auc': 0.517952, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.5982, std=8.6708
[DEBUG][MIA] Test Set Loss:   mean=8.3818, std=8.5484
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.11372549019607843, 'auc': 0.501220703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.6651, std=7.4907
[DEBUG][MIA] Test Set Loss:   mean=8.1147, std=8.4073
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.088, 'auc': 0.44556, 'task': 8}
Total correct retain:  1235  Total retain:  2500
Total correct forget:  13827  Total forget:  47500
Total correct test:  235  Total test:  500
Total correct forget test:  2477  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.47, 0.38, 0.368, 0.354, 0.32, 0.4, 0.282, 0.414, 0.278, 0.328, 0.218, 0.216, 0.17, 0.132, 0.162, 0.148, 0.154, 0.198, 0.252, 0.18]
Unlearning task: 8
Accuracy, Confidence: (0.55859375, 0.8841128349304199)
broken out of loop
Accuracy, Confidence: (0.55078125, 0.8892003297805786)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7152, std=2.7241
[DEBUG][MIA] Test Set Loss:   mean=3.5016, std=4.1791
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.23137254901960783, 'auc': 0.629241943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0728, std=4.6075
[DEBUG][MIA] Test Set Loss:   mean=3.8431, std=4.5176
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.086, 'auc': 0.485712, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4149, std=2.6150
[DEBUG][MIA] Test Set Loss:   mean=3.8957, std=4.0831
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.5450980392156862, 'auc': 0.718994140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8617, std=3.7732
[DEBUG][MIA] Test Set Loss:   mean=4.1189, std=4.3136
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.10400000000000001, 'auc': 0.586176, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8516, std=4.0616
[DEBUG][MIA] Test Set Loss:   mean=4.6781, std=5.3062
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.12549019607843137, 'auc': 0.6151123046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.4169, std=4.8704
[DEBUG][MIA] Test Set Loss:   mean=4.4389, std=5.2179
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10800000000000001, 'auc': 0.495232, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4939, std=2.2318
[DEBUG][MIA] Test Set Loss:   mean=4.0526, std=4.0979
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.5882352941176471, 'auc': 0.7109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1191, std=3.6088
[DEBUG][MIA] Test Set Loss:   mean=4.0449, std=3.9541
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10400000000000001, 'auc': 0.579296, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8415, std=2.4406
[DEBUG][MIA] Test Set Loss:   mean=2.9263, std=3.5161
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2627450980392157, 'auc': 0.716033935546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.0412, std=3.1855
[DEBUG][MIA] Test Set Loss:   mean=3.4755, std=4.6686
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.11400000000000002, 'auc': 0.587696, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3570, std=3.3510
[DEBUG][MIA] Test Set Loss:   mean=5.3933, std=5.0893
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.5529411764705883, 'auc': 0.6822509765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0008, std=4.7191
[DEBUG][MIA] Test Set Loss:   mean=5.2083, std=4.8816
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.132, 'auc': 0.573376, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0277, std=4.6518
[DEBUG][MIA] Test Set Loss:   mean=4.7746, std=5.4758
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.1764705882352941, 'auc': 0.6417236328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.3721, std=5.3586
[DEBUG][MIA] Test Set Loss:   mean=4.5092, std=5.3469
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10200000000000001, 'auc': 0.49795999999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.4590, std=8.1925
[DEBUG][MIA] Test Set Loss:   mean=8.9852, std=7.8703
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.12549019607843137, 'auc': 0.489349365234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.1582, std=7.9980
[DEBUG][MIA] Test Set Loss:   mean=9.2766, std=7.9299
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.10600000000000001, 'auc': 0.452872, 'task': 8}
Total correct retain:  1091  Total retain:  2500
Total correct forget:  13998  Total forget:  47500
Total correct test:  213  Total test:  500
Total correct forget test:  2525  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.426, 0.404, 0.364, 0.35, 0.29, 0.45, 0.298, 0.354, 0.258, 0.324, 0.258, 0.216, 0.178, 0.164, 0.178, 0.152, 0.19, 0.21, 0.274, 0.138]
Unlearning task: 7
Accuracy, Confidence: (0.55859375, 0.889634907245636)
broken out of loop
Accuracy, Confidence: (0.58984375, 0.8645471930503845)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1340, std=2.1398
[DEBUG][MIA] Test Set Loss:   mean=3.3286, std=3.8564
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.47058823529411764, 'auc': 0.71484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.5639, std=4.0876
[DEBUG][MIA] Test Set Loss:   mean=3.6029, std=4.2645
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.5057200000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5135, std=2.5605
[DEBUG][MIA] Test Set Loss:   mean=3.7105, std=4.1046
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2588235294117647, 'auc': 0.67327880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.8972, std=4.2065
[DEBUG][MIA] Test Set Loss:   mean=4.0998, std=4.3571
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12000000000000002, 'auc': 0.508456, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3086, std=3.6388
[DEBUG][MIA] Test Set Loss:   mean=4.4984, std=4.8508
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.22745098039215686, 'auc': 0.651641845703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0621, std=4.7278
[DEBUG][MIA] Test Set Loss:   mean=3.6789, std=4.4045
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.124, 'auc': 0.47407999999999995, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3626, std=2.1700
[DEBUG][MIA] Test Set Loss:   mean=4.0803, std=4.1578
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.23529411764705882, 'auc': 0.72857666015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.6235, std=4.4074
[DEBUG][MIA] Test Set Loss:   mean=4.0092, std=3.7630
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.096, 'auc': 0.557904, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.0130, std=3.7799
[DEBUG][MIA] Test Set Loss:   mean=3.3444, std=4.5143
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.22745098039215686, 'auc': 0.6092529296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7745, std=4.4523
[DEBUG][MIA] Test Set Loss:   mean=3.7310, std=4.7525
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.11000000000000001, 'auc': 0.58652, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.1163, std=3.3099
[DEBUG][MIA] Test Set Loss:   mean=5.3002, std=4.8455
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5254901960784314, 'auc': 0.7088623046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0397, std=4.7307
[DEBUG][MIA] Test Set Loss:   mean=5.1446, std=5.1496
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.10800000000000001, 'auc': 0.5613199999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7227, std=5.1187
[DEBUG][MIA] Test Set Loss:   mean=4.9788, std=5.3428
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10980392156862746, 'auc': 0.597991943359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.3586, std=6.3976
[DEBUG][MIA] Test Set Loss:   mean=5.5265, std=6.3229
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10400000000000001, 'auc': 0.5120560000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.3055, std=7.1953
[DEBUG][MIA] Test Set Loss:   mean=7.1855, std=7.3288
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09803921568627451, 'auc': 0.536590576171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.1789, std=6.9230
[DEBUG][MIA] Test Set Loss:   mean=7.0815, std=7.0074
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.098, 'auc': 0.5431360000000001, 'task': 8}
Total correct retain:  1276  Total retain:  2500
Total correct forget:  14025  Total forget:  47500
Total correct test:  239  Total test:  500
Total correct forget test:  2507  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.478, 0.39, 0.366, 0.374, 0.32, 0.45, 0.278, 0.328, 0.274, 0.326, 0.242, 0.208, 0.17, 0.16, 0.164, 0.158, 0.188, 0.198, 0.268, 0.152]
Unlearning task: 6
Accuracy, Confidence: (0.68359375, 0.9028557538986206)
broken out of loop
Accuracy, Confidence: (0.42578125, 0.9169777035713196)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9728, std=3.1868
[DEBUG][MIA] Test Set Loss:   mean=4.0888, std=5.3633
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.24705882352941178, 'auc': 0.632110595703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.2230, std=4.9464
[DEBUG][MIA] Test Set Loss:   mean=4.2724, std=5.1089
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10600000000000001, 'auc': 0.50972, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.8147, std=4.7017
[DEBUG][MIA] Test Set Loss:   mean=4.9954, std=5.8297
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.1803921568627451, 'auc': 0.65411376953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.0432, std=5.7487
[DEBUG][MIA] Test Set Loss:   mean=4.7137, std=5.1479
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.11000000000000001, 'auc': 0.48560799999999993, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6510, std=2.6283
[DEBUG][MIA] Test Set Loss:   mean=4.6793, std=5.0292
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2235294117647059, 'auc': 0.70428466796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.3314, std=4.0919
[DEBUG][MIA] Test Set Loss:   mean=3.9986, std=4.5185
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10400000000000001, 'auc': 0.544184, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8647, std=1.6694
[DEBUG][MIA] Test Set Loss:   mean=3.1834, std=3.5176
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.5215686274509803, 'auc': 0.73980712890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8211, std=3.4318
[DEBUG][MIA] Test Set Loss:   mean=3.5144, std=3.8853
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.118, 'auc': 0.561136, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.2710, std=8.3037
[DEBUG][MIA] Test Set Loss:   mean=6.8557, std=7.7122
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.12941176470588237, 'auc': 0.595977783203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.2481, std=8.9481
[DEBUG][MIA] Test Set Loss:   mean=7.6923, std=7.9572
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.45443999999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.0157, std=4.3979
[DEBUG][MIA] Test Set Loss:   mean=5.8430, std=5.7554
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.4313725490196078, 'auc': 0.67645263671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.4468, std=4.8828
[DEBUG][MIA] Test Set Loss:   mean=5.3025, std=5.4136
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.118, 'auc': 0.549096, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0014, std=4.6614
[DEBUG][MIA] Test Set Loss:   mean=3.9661, std=5.3099
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.1764705882352941, 'auc': 0.56903076171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8297, std=5.1793
[DEBUG][MIA] Test Set Loss:   mean=4.3533, std=5.7558
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.08399999999999999, 'auc': 0.527968, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.4296, std=6.6038
[DEBUG][MIA] Test Set Loss:   mean=6.1105, std=6.2798
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.14901960784313723, 'auc': 0.4921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.4437, std=6.5768
[DEBUG][MIA] Test Set Loss:   mean=6.4400, std=6.3311
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.5049520000000001, 'task': 8}
Total correct retain:  1090  Total retain:  2500
Total correct forget:  13294  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  2401  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.444, 0.39, 0.292, 0.39, 0.34, 0.264, 0.294, 0.37, 0.282, 0.316, 0.238, 0.258, 0.168, 0.176, 0.134, 0.094, 0.156, 0.212, 0.258, 0.17]
Unlearning task: 5
Accuracy, Confidence: (0.7578125, 0.8488503694534302)
broken out of loop
Accuracy, Confidence: (0.66796875, 0.8424689769744873)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3439, std=2.2831
[DEBUG][MIA] Test Set Loss:   mean=3.2802, std=4.2967
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.5686274509803921, 'auc': 0.66375732421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.3763, std=4.1150
[DEBUG][MIA] Test Set Loss:   mean=3.6090, std=4.2313
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.088, 'auc': 0.5205119999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6822, std=2.8815
[DEBUG][MIA] Test Set Loss:   mean=4.2293, std=4.8924
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.6392156862745099, 'auc': 0.659759521484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2809, std=4.2328
[DEBUG][MIA] Test Set Loss:   mean=4.8136, std=5.1169
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.10200000000000001, 'auc': 0.576568, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2608, std=3.4552
[DEBUG][MIA] Test Set Loss:   mean=4.6490, std=5.1350
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.4784313725490196, 'auc': 0.64532470703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.5305, std=4.6645
[DEBUG][MIA] Test Set Loss:   mean=4.0260, std=4.4847
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.5536880000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3398, std=2.7391
[DEBUG][MIA] Test Set Loss:   mean=4.5517, std=4.0853
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.5647058823529412, 'auc': 0.78729248046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5276, std=4.3374
[DEBUG][MIA] Test Set Loss:   mean=4.4265, std=4.1519
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.13199999999999998, 'auc': 0.587688, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.9510, std=6.3540
[DEBUG][MIA] Test Set Loss:   mean=6.4505, std=6.7863
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.11372549019607843, 'auc': 0.65179443359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.6879, std=8.0373
[DEBUG][MIA] Test Set Loss:   mean=6.1231, std=6.9456
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.092, 'auc': 0.49826399999999993, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.5941, std=3.9292
[DEBUG][MIA] Test Set Loss:   mean=5.6773, std=5.0821
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.39607843137254906, 'auc': 0.706207275390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5104, std=5.1643
[DEBUG][MIA] Test Set Loss:   mean=5.5679, std=5.4461
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.13, 'auc': 0.564728, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.5324, std=3.9511
[DEBUG][MIA] Test Set Loss:   mean=3.8429, std=5.1727
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.1843137254901961, 'auc': 0.60528564453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.9920, std=5.1391
[DEBUG][MIA] Test Set Loss:   mean=4.0843, std=5.1927
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.118, 'auc': 0.5112960000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.9802, std=6.5131
[DEBUG][MIA] Test Set Loss:   mean=6.9474, std=6.4446
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10588235294117647, 'auc': 0.547576904296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.9145, std=6.5409
[DEBUG][MIA] Test Set Loss:   mean=6.9689, std=6.4347
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.088, 'auc': 0.447608, 'task': 8}
Total correct retain:  1156  Total retain:  2500
Total correct forget:  13778  Total forget:  47500
Total correct test:  233  Total test:  500
Total correct forget test:  2467  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.466, 0.418, 0.346, 0.388, 0.292, 0.302, 0.304, 0.398, 0.276, 0.36, 0.228, 0.226, 0.164, 0.168, 0.142, 0.1, 0.17, 0.22, 0.256, 0.176]
Unlearning task: 4
Accuracy, Confidence: (0.609375, 0.8907289505004883)
broken out of loop
Accuracy, Confidence: (0.59375, 0.917093813419342)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4236, std=1.2437
[DEBUG][MIA] Test Set Loss:   mean=3.4631, std=4.7962
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.27450980392156865, 'auc': 0.7742919921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6582, std=3.8660
[DEBUG][MIA] Test Set Loss:   mean=3.0441, std=4.1980
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11600000000000002, 'auc': 0.535616, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9268, std=3.7239
[DEBUG][MIA] Test Set Loss:   mean=4.1403, std=5.1495
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.34509803921568627, 'auc': 0.652557373046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.2268, std=5.2082
[DEBUG][MIA] Test Set Loss:   mean=4.1961, std=5.1266
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.12000000000000002, 'auc': 0.497056, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.7118, std=5.7223
[DEBUG][MIA] Test Set Loss:   mean=6.8315, std=7.3211
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.23137254901960783, 'auc': 0.645477294921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9967, std=7.6338
[DEBUG][MIA] Test Set Loss:   mean=7.0262, std=7.4588
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.1, 'auc': 0.5451840000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6046, std=4.0858
[DEBUG][MIA] Test Set Loss:   mean=4.7622, std=5.0541
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.36470588235294116, 'auc': 0.65625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.6273, std=5.0293
[DEBUG][MIA] Test Set Loss:   mean=4.7410, std=5.0275
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.142, 'auc': 0.5092479999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.5506, std=8.3159
[DEBUG][MIA] Test Set Loss:   mean=7.8313, std=8.6472
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.12156862745098038, 'auc': 0.62359619140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.9696, std=8.9985
[DEBUG][MIA] Test Set Loss:   mean=7.1565, std=7.4745
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.086, 'auc': 0.53552, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.3703, std=6.9917
[DEBUG][MIA] Test Set Loss:   mean=6.6360, std=6.9440
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.34509803921568627, 'auc': 0.645233154296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.1449, std=7.3208
[DEBUG][MIA] Test Set Loss:   mean=6.9854, std=7.6387
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.096, 'auc': 0.53432, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7276, std=6.1886
[DEBUG][MIA] Test Set Loss:   mean=6.8928, std=7.5666
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.09019607843137255, 'auc': 0.58367919921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.0012, std=7.1604
[DEBUG][MIA] Test Set Loss:   mean=6.8444, std=7.1742
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.094, 'auc': 0.535336, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.8995, std=7.8740
[DEBUG][MIA] Test Set Loss:   mean=7.2427, std=8.2373
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.57476806640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9941, std=8.3113
[DEBUG][MIA] Test Set Loss:   mean=7.1118, std=8.2846
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.098, 'auc': 0.493264, 'task': 8}
Total correct retain:  1302  Total retain:  2500
Total correct forget:  13693  Total forget:  47500
Total correct test:  259  Total test:  500
Total correct forget test:  2555  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.518, 0.482, 0.42, 0.376, 0.292, 0.33, 0.272, 0.296, 0.328, 0.366, 0.256, 0.282, 0.12, 0.122, 0.154, 0.158, 0.194, 0.222, 0.24, 0.2]
Unlearning task: 3
Accuracy, Confidence: (0.6640625, 0.8992942571640015)
broken out of loop
Accuracy, Confidence: (0.5078125, 0.877183198928833)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1008, std=1.8949
[DEBUG][MIA] Test Set Loss:   mean=3.4408, std=3.8462
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.47058823529411764, 'auc': 0.689361572265625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.2960, std=3.9396
[DEBUG][MIA] Test Set Loss:   mean=3.4907, std=4.3803
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10400000000000001, 'auc': 0.503312, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2850, std=4.7345
[DEBUG][MIA] Test Set Loss:   mean=6.8298, std=6.9010
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.3137254901960785, 'auc': 0.670196533203125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.7173, std=5.7106
[DEBUG][MIA] Test Set Loss:   mean=6.9247, std=6.9887
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.092, 'auc': 0.531688, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.6501, std=6.6587
[DEBUG][MIA] Test Set Loss:   mean=6.6649, std=7.0176
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.18823529411764708, 'auc': 0.58685302734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.6712, std=7.3560
[DEBUG][MIA] Test Set Loss:   mean=7.3012, std=7.4429
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.517752, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.5203, std=3.2295
[DEBUG][MIA] Test Set Loss:   mean=6.0499, std=5.3100
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.23921568627450984, 'auc': 0.7265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.4931, std=5.2617
[DEBUG][MIA] Test Set Loss:   mean=5.9644, std=5.3667
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.5327679999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1172, std=6.4502
[DEBUG][MIA] Test Set Loss:   mean=7.3947, std=8.0246
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.3828125, 'cv_acc': 0.09019607843137255, 'auc': 0.366668701171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.0082, std=8.8338
[DEBUG][MIA] Test Set Loss:   mean=7.1172, std=7.8082
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.487472, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.8563, std=6.4991
[DEBUG][MIA] Test Set Loss:   mean=6.5098, std=6.4255
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.42745098039215684, 'auc': 0.6617431640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.7297, std=6.8377
[DEBUG][MIA] Test Set Loss:   mean=6.9397, std=6.7535
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.088, 'auc': 0.572552, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7883, std=5.5780
[DEBUG][MIA] Test Set Loss:   mean=4.6774, std=5.0890
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.17254901960784313, 'auc': 0.61083984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2425, std=5.7489
[DEBUG][MIA] Test Set Loss:   mean=4.8372, std=5.8933
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.544192, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2865, std=7.3506
[DEBUG][MIA] Test Set Loss:   mean=7.0546, std=6.5722
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.506744384765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0833, std=7.9116
[DEBUG][MIA] Test Set Loss:   mean=7.5639, std=7.5922
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10600000000000001, 'auc': 0.543944, 'task': 8}
Total correct retain:  1182  Total retain:  2500
Total correct forget:  12551  Total forget:  47500
Total correct test:  247  Total test:  500
Total correct forget test:  2312  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.494, 0.444, 0.294, 0.314, 0.234, 0.31, 0.248, 0.312, 0.26, 0.324, 0.232, 0.238, 0.176, 0.166, 0.144, 0.122, 0.162, 0.212, 0.254, 0.178]
Unlearning task: 2
Accuracy, Confidence: (0.6875, 0.8852752447128296)
broken out of loop
Accuracy, Confidence: (0.578125, 0.8856375217437744)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 8, 7, 7, 6, 6, 7, 6, 5], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7164, std=4.6130
[DEBUG][MIA] Test Set Loss:   mean=6.4311, std=7.2062
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.2392156862745098, 'auc': 0.690765380859375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [8 8 9 7 5 6 6 5 7 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [9 9 5 5 8 9 6 7 8 9]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.2540, std=7.7762
[DEBUG][MIA] Test Set Loss:   mean=6.1503, std=7.0149
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.096, 'auc': 0.49807199999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 14, 10, 13, 12, 14, 10, 10, 12, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.4130, std=5.2043
[DEBUG][MIA] Test Set Loss:   mean=6.1507, std=5.9107
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.28627450980392155, 'auc': 0.5928955078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 10 13 12 10 12 11 13 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [10 12 13 13 10 14 12 14 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.8046, std=5.4922
[DEBUG][MIA] Test Set Loss:   mean=7.1781, std=6.6328
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11800000000000002, 'auc': 0.553152, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([16, 16, 19, 18, 16, 18, 16, 17, 17, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.5750, std=6.4755
[DEBUG][MIA] Test Set Loss:   mean=7.2521, std=7.4407
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.17254901960784313, 'auc': 0.62811279296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 17 18 16 17 17 16 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 17 15 15 18 18 16 19 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.7641, std=7.4204
[DEBUG][MIA] Test Set Loss:   mean=7.3497, std=8.1496
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10600000000000001, 'auc': 0.507136, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([22, 24, 22, 22, 23, 24, 24, 21, 21, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.1143, std=5.0484
[DEBUG][MIA] Test Set Loss:   mean=7.4725, std=6.5759
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.45098039215686275, 'auc': 0.66912841796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 23 23 20 21 21 24 22 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 24 22 23 20 20 22 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.3091, std=6.4496
[DEBUG][MIA] Test Set Loss:   mean=6.9660, std=6.1091
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10600000000000001, 'auc': 0.54352, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 26, 25, 28, 27, 26, 28, 28, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.9948, std=6.9461
[DEBUG][MIA] Test Set Loss:   mean=7.1041, std=7.4361
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.10980392156862744, 'auc': 0.605194091796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 25 26 28 25 27 29 28 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 25 25 28 28 25 25 29 25 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.9723, std=8.0831
[DEBUG][MIA] Test Set Loss:   mean=6.8093, std=6.8727
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.086, 'auc': 0.518824, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 32, 30, 30, 31, 34, 30, 32, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.4960, std=5.8870
[DEBUG][MIA] Test Set Loss:   mean=8.0358, std=6.6303
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.20392156862745098, 'auc': 0.68316650390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 34 34 31 33 31 32 30 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 32 30 30 30 33 31 31 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.3352, std=7.2204
[DEBUG][MIA] Test Set Loss:   mean=8.0467, std=7.3589
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10800000000000001, 'auc': 0.537152, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([37, 37, 37, 35, 39, 39, 35, 36, 35, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.6961, std=6.1137
[DEBUG][MIA] Test Set Loss:   mean=6.5537, std=5.8516
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.10196078431372549, 'auc': 0.63482666015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 39 37 36 39 37 38 36 38 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 35 35 39 35 37 35 36 38 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.4060, std=5.7346
[DEBUG][MIA] Test Set Loss:   mean=6.0974, std=6.0940
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.467152, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 44, 40, 40, 42, 43, 41, 42, 42, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0785, std=8.9097
[DEBUG][MIA] Test Set Loss:   mean=8.7356, std=9.5236
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4453125, 'cv_acc': 0.10980392156862746, 'auc': 0.43316650390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 40 41 40 44 44 42 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [40 40 40 40 42 42 42 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.0798, std=9.2853
[DEBUG][MIA] Test Set Loss:   mean=8.5945, std=8.9869
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.094, 'auc': 0.529784, 'task': 8}
Total correct retain:  1288  Total retain:  2500
Total correct forget:  11737  Total forget:  47500
Total correct test:  251  Total test:  500
Total correct forget test:  2186  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.502, 0.302, 0.26, 0.302, 0.212, 0.284, 0.208, 0.288, 0.284, 0.332, 0.24, 0.236, 0.184, 0.176, 0.138, 0.12, 0.168, 0.202, 0.256, 0.18]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['chair', 'bottles', 'beaver', 'raccoon', 'oak', 'tractor', 'poppies', 'road', 'shark', 'telephone', 'bus', 'bowls', 'lamp', 'baby', 'motorcycle', 'mountain', 'forest', 'hamster', 'camel', 'cans', 'orchids', 'chimpanzee', 'woman', 'aquarium fish', 'streetcar', 'house', 'mouse', 'palm', 'pickup truck', 'crab', 'dinosaur', 'bee', 'table', 'whale', 'turtle', 'shrew', 'beetle', 'porcupine', 'pine', 'tank', 'otter', 'squirrel', 'sea', 'castle', 'trout', 'sweet peppers', 'dolphin', 'lawn-mower', 'wolf', 'cloud', 'train', 'snake', 'oranges', 'spider', 'maple', 'wardrobe', 'kangaroo', 'bear', 'roses', 'lobster', 'lion', 'boy', 'crocodile', 'skunk', 'clock', 'rocket', 'pears', 'plain', 'ray', 'skyscraper', 'possum', 'snail', 'sunflowers', 'rabbit', 'worm', 'fox', 'bridge', 'mushrooms', 'cattle', 'caterpillar', 'tulips', 'cups', 'cockroach', 'lizard', 'bicycle', 'bed', 'girl', 'flatfish', 'computer keyboard', 'leopard', 'tiger', 'butterfly', 'television', 'willow', 'couch', 'apples', 'man', 'seal', 'plates', 'elephant']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2325  Total retain:  2500
Total correct forget:  9138  Total forget:  47500
Total correct test:  384  Total test:  500
Total correct forget test:  1809  Total test forget:  9500
After learning task 1
Task accuracies: [0.768, 0.256, 0.22, 0.17, 0.176, 0.244, 0.152, 0.206, 0.208, 0.154, 0.2, 0.194, 0.114, 0.206, 0.208, 0.236, 0.176, 0.14, 0.206, 0.152]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0245
[DEBUG][MIA] Test Set Loss:   mean=0.6540, std=1.7768
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.17254901960784313, 'auc': 0.54315185546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0151
[DEBUG][MIA] Test Set Loss:   mean=0.6050, std=1.7636
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.194, 'auc': 0.568584, 'task': 1}
2 1
Total correct retain:  2067  Total retain:  2500
Total correct forget:  11381  Total forget:  47500
Total correct test:  358  Total test:  500
Total correct forget test:  2131  Total test forget:  9500
After learning task 2
Task accuracies: [0.716, 0.864, 0.222, 0.108, 0.19, 0.15, 0.194, 0.216, 0.264, 0.214, 0.198, 0.194, 0.096, 0.208, 0.192, 0.204, 0.198, 0.186, 0.244, 0.12]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0102
[DEBUG][MIA] Test Set Loss:   mean=0.6388, std=1.3319
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.23921568627450984, 'auc': 0.703704833984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4249, std=1.0252
[DEBUG][MIA] Test Set Loss:   mean=0.5551, std=1.3458
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.13599999999999998, 'auc': 0.513248, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0323
[DEBUG][MIA] Test Set Loss:   mean=0.7480, std=1.7808
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2549019607843137, 'auc': 0.725341796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0102
[DEBUG][MIA] Test Set Loss:   mean=0.9475, std=2.1102
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.666, 'cv_acc': 0.21600000000000003, 'auc': 0.7499119999999999, 'task': 2}
3 2
Total correct retain:  2005  Total retain:  2500
Total correct forget:  12818  Total forget:  47500
Total correct test:  367  Total test:  500
Total correct forget test:  2372  Total test forget:  9500
After learning task 3
Task accuracies: [0.734, 0.812, 0.786, 0.112, 0.186, 0.16, 0.148, 0.25, 0.3, 0.184, 0.21, 0.188, 0.118, 0.186, 0.198, 0.204, 0.196, 0.176, 0.208, 0.122]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=0.7463, std=1.7818
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2235294117647059, 'auc': 0.72418212890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5332, std=1.4364
[DEBUG][MIA] Test Set Loss:   mean=0.4548, std=1.2028
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.142, 'auc': 0.508336, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=1.0919, std=2.0568
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.27058823529411763, 'auc': 0.8189697265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3900, std=0.8636
[DEBUG][MIA] Test Set Loss:   mean=1.0926, std=2.2420
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.186, 'auc': 0.611824, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0215
[DEBUG][MIA] Test Set Loss:   mean=0.6970, std=2.0882
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.25882352941176473, 'auc': 0.723785400390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0149
[DEBUG][MIA] Test Set Loss:   mean=0.8837, std=2.0285
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.652, 'cv_acc': 0.238, 'auc': 0.7325280000000001, 'task': 3}
4 3
Total correct retain:  2012  Total retain:  2500
Total correct forget:  14420  Total forget:  47500
Total correct test:  372  Total test:  500
Total correct forget test:  2646  Total test forget:  9500
After learning task 4
Task accuracies: [0.744, 0.806, 0.742, 0.784, 0.196, 0.162, 0.162, 0.252, 0.308, 0.138, 0.192, 0.19, 0.078, 0.198, 0.164, 0.19, 0.202, 0.172, 0.21, 0.146]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=0.6303, std=1.7318
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.25098039215686274, 'auc': 0.783233642578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6447, std=1.6166
[DEBUG][MIA] Test Set Loss:   mean=0.8252, std=1.9758
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.12600000000000003, 'auc': 0.515576, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.8517, std=2.1451
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2823529411764706, 'auc': 0.847808837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5600, std=1.4219
[DEBUG][MIA] Test Set Loss:   mean=1.1149, std=2.2363
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.17, 'auc': 0.609776, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=0.8410, std=1.9554
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2705882352941177, 'auc': 0.803192138671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2536, std=0.9353
[DEBUG][MIA] Test Set Loss:   mean=0.7682, std=1.6629
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.22599999999999998, 'auc': 0.6072160000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0174
[DEBUG][MIA] Test Set Loss:   mean=0.7765, std=2.0073
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.21568627450980396, 'auc': 0.7073974609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=0.5812, std=1.7012
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.22199999999999998, 'auc': 0.687208, 'task': 4}
5 4
Total correct retain:  1888  Total retain:  2500
Total correct forget:  16244  Total forget:  47500
Total correct test:  347  Total test:  500
Total correct forget test:  2961  Total test forget:  9500
After learning task 5
Task accuracies: [0.694, 0.794, 0.742, 0.744, 0.828, 0.168, 0.19, 0.208, 0.292, 0.168, 0.218, 0.21, 0.114, 0.162, 0.182, 0.172, 0.18, 0.18, 0.216, 0.154]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=0.5562, std=1.5618
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2235294117647059, 'auc': 0.73419189453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7081, std=1.6982
[DEBUG][MIA] Test Set Loss:   mean=0.5469, std=1.4068
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11000000000000001, 'auc': 0.499432, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.0709, std=1.9923
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.30980392156862746, 'auc': 0.829742431640625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0516, std=2.2654
[DEBUG][MIA] Test Set Loss:   mean=1.2132, std=2.2292
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.094, 'auc': 0.582416, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.0453, std=1.9293
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.28627450980392155, 'auc': 0.838104248046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4090, std=0.9970
[DEBUG][MIA] Test Set Loss:   mean=1.2849, std=2.2783
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.18, 'auc': 0.617304, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=0.8921, std=1.8393
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.29411764705882354, 'auc': 0.79541015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2804, std=0.7255
[DEBUG][MIA] Test Set Loss:   mean=1.0117, std=1.8883
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.186, 'auc': 0.605936, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0079
[DEBUG][MIA] Test Set Loss:   mean=1.3931, std=2.6309
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.26666666666666666, 'auc': 0.77996826171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0468
[DEBUG][MIA] Test Set Loss:   mean=1.1981, std=2.4925
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.672, 'cv_acc': 0.246, 'auc': 0.754896, 'task': 5}
6 5
Total correct retain:  1948  Total retain:  2500
Total correct forget:  18026  Total forget:  47500
Total correct test:  355  Total test:  500
Total correct forget test:  3284  Total test forget:  9500
After learning task 6
Task accuracies: [0.71, 0.824, 0.694, 0.694, 0.726, 0.752, 0.222, 0.298, 0.344, 0.178, 0.21, 0.2, 0.114, 0.152, 0.19, 0.17, 0.2, 0.196, 0.252, 0.152]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=0.5695, std=1.6060
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.23529411764705882, 'auc': 0.75445556640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5763, std=1.5849
[DEBUG][MIA] Test Set Loss:   mean=0.7174, std=1.8883
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.124, 'auc': 0.5276879999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=1.1020, std=1.8945
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.29411764705882354, 'auc': 0.83416748046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0255, std=2.2390
[DEBUG][MIA] Test Set Loss:   mean=1.4178, std=2.4670
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.092, 'auc': 0.5932719999999999, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.1716, std=2.1682
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2980392156862745, 'auc': 0.816314697265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6870, std=1.5249
[DEBUG][MIA] Test Set Loss:   mean=1.5673, std=2.6626
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.148, 'auc': 0.5611039999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=1.3272, std=2.4433
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7254901960784315, 'auc': 0.78900146484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7700, std=1.6462
[DEBUG][MIA] Test Set Loss:   mean=1.2740, std=2.3056
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.164, 'auc': 0.591984, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.4255, std=2.5400
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2941176470588235, 'auc': 0.809234619140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3505, std=0.9971
[DEBUG][MIA] Test Set Loss:   mean=1.4664, std=2.4942
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.21799999999999997, 'auc': 0.657496, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0429, std=0.2753
[DEBUG][MIA] Test Set Loss:   mean=1.3695, std=2.6174
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2901960784313726, 'auc': 0.777801513671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0368, std=0.2601
[DEBUG][MIA] Test Set Loss:   mean=1.3704, std=2.6104
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.676, 'cv_acc': 0.614, 'auc': 0.77932, 'task': 6}
7 6
Total correct retain:  1888  Total retain:  2500
Total correct forget:  19126  Total forget:  47500
Total correct test:  350  Total test:  500
Total correct forget test:  3379  Total test forget:  9500
After learning task 7
Task accuracies: [0.7, 0.812, 0.658, 0.65, 0.67, 0.662, 0.66, 0.32, 0.316, 0.136, 0.216, 0.208, 0.134, 0.22, 0.226, 0.126, 0.198, 0.188, 0.198, 0.16]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=0.7215, std=1.9778
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.24705882352941178, 'auc': 0.756256103515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5411, std=1.3355
[DEBUG][MIA] Test Set Loss:   mean=0.6321, std=1.5822
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.088, 'auc': 0.527752, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.4701, std=2.4335
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.28627450980392155, 'auc': 0.902923583984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3569, std=2.4352
[DEBUG][MIA] Test Set Loss:   mean=1.3795, std=2.5195
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.096, 'auc': 0.552416, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.5480, std=3.2426
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7176470588235293, 'auc': 0.83697509765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7301, std=1.8437
[DEBUG][MIA] Test Set Loss:   mean=1.6118, std=2.9552
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.18200000000000002, 'auc': 0.59836, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.3713, std=2.3811
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.3058823529411765, 'auc': 0.88299560546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2466, std=2.1501
[DEBUG][MIA] Test Set Loss:   mean=1.4906, std=2.3899
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.148, 'auc': 0.560584, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=1.7857, std=2.8931
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.2901960784313726, 'auc': 0.82421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3840, std=0.9324
[DEBUG][MIA] Test Set Loss:   mean=1.3865, std=2.4916
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.21400000000000002, 'auc': 0.6239119999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.4961, std=2.6461
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7450980392156863, 'auc': 0.84197998046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1695, std=0.6565
[DEBUG][MIA] Test Set Loss:   mean=1.6580, std=2.6074
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.242, 'auc': 0.738256, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0188, std=0.1790
[DEBUG][MIA] Test Set Loss:   mean=0.7469, std=1.7650
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2627450980392157, 'auc': 0.724212646484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0622
[DEBUG][MIA] Test Set Loss:   mean=0.9845, std=2.1228
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.274, 'auc': 0.745496, 'task': 7}
8 7
Total correct retain:  1892  Total retain:  2500
Total correct forget:  20678  Total forget:  47500
Total correct test:  367  Total test:  500
Total correct forget test:  3594  Total test forget:  9500
After learning task 8
Task accuracies: [0.734, 0.806, 0.668, 0.646, 0.634, 0.67, 0.628, 0.752, 0.326, 0.134, 0.21, 0.216, 0.126, 0.202, 0.21, 0.178, 0.158, 0.196, 0.238, 0.19]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.8721, std=2.0290
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.19215686274509805, 'auc': 0.784332275390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7392, std=1.8709
[DEBUG][MIA] Test Set Loss:   mean=0.5757, std=1.5690
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10600000000000001, 'auc': 0.548024, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=1.6839, std=2.8504
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7372549019607844, 'auc': 0.806793212890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2300, std=2.4930
[DEBUG][MIA] Test Set Loss:   mean=1.6976, std=2.9804
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10600000000000001, 'auc': 0.5416559999999999, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.8356, std=3.1749
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.6980392156862746, 'auc': 0.831634521484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0207, std=1.9624
[DEBUG][MIA] Test Set Loss:   mean=1.7024, std=2.7750
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.144, 'auc': 0.599136, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=1.2395, std=2.4117
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.7294117647058824, 'auc': 0.800750732421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7608, std=1.7863
[DEBUG][MIA] Test Set Loss:   mean=1.5281, std=2.7046
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11200000000000002, 'auc': 0.60916, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.6375, std=2.9849
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7215686274509803, 'auc': 0.8056640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7396, std=1.6844
[DEBUG][MIA] Test Set Loss:   mean=1.7269, std=2.9069
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.182, 'auc': 0.61868, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.7600, std=2.5630
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7215686274509804, 'auc': 0.863616943359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4138, std=1.1869
[DEBUG][MIA] Test Set Loss:   mean=1.7039, std=2.5398
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.248, 'auc': 0.7052, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.5221, std=2.5773
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7098039215686274, 'auc': 0.77294921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3705, std=1.0367
[DEBUG][MIA] Test Set Loss:   mean=1.6366, std=2.6993
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.21200000000000002, 'auc': 0.6427919999999999, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0347
[DEBUG][MIA] Test Set Loss:   mean=1.0630, std=2.3429
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.24313725490196075, 'auc': 0.707000732421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0307
[DEBUG][MIA] Test Set Loss:   mean=1.0556, std=2.4019
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.674, 'cv_acc': 0.23399999999999999, 'auc': 0.6914000000000001, 'task': 8}
Total correct retain:  1936  Total retain:  2500
Total correct forget:  21880  Total forget:  47500
Total correct test:  369  Total test:  500
Total correct forget test:  3748  Total test forget:  9500
After learning task 9
Task accuracies: [0.738, 0.822, 0.65, 0.646, 0.654, 0.636, 0.582, 0.654, 0.772, 0.116, 0.228, 0.198, 0.128, 0.204, 0.248, 0.184, 0.166, 0.188, 0.19, 0.23]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.0455, std=2.3614
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.18039215686274512, 'auc': 0.768402099609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7677, std=2.2332
[DEBUG][MIA] Test Set Loss:   mean=0.5480, std=1.5647
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.1, 'auc': 0.5290239999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.3831, std=2.7493
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.28627450980392155, 'auc': 0.794525146484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1437, std=2.4090
[DEBUG][MIA] Test Set Loss:   mean=1.6022, std=2.8149
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11600000000000002, 'auc': 0.532504, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.3516, std=2.7795
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2901960784313725, 'auc': 0.811370849609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3707, std=2.6165
[DEBUG][MIA] Test Set Loss:   mean=1.7458, std=3.1139
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.096, 'auc': 0.558432, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.6028, std=2.9626
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.25098039215686274, 'auc': 0.84625244140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9975, std=1.9351
[DEBUG][MIA] Test Set Loss:   mean=1.3329, std=2.4061
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.156, 'auc': 0.560064, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.5027, std=2.6743
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7058823529411765, 'auc': 0.855743408203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7911, std=2.0326
[DEBUG][MIA] Test Set Loss:   mean=1.8318, std=3.0131
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.16199999999999998, 'auc': 0.61208, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0086
[DEBUG][MIA] Test Set Loss:   mean=1.9315, std=2.6801
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7607843137254902, 'auc': 0.8760986328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6307, std=1.3716
[DEBUG][MIA] Test Set Loss:   mean=2.0219, std=2.8880
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.23399999999999999, 'auc': 0.646328, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=1.5950, std=2.5302
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7098039215686274, 'auc': 0.8260498046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4688, std=1.4739
[DEBUG][MIA] Test Set Loss:   mean=1.5634, std=2.6014
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.618, 'cv_acc': 0.21600000000000003, 'auc': 0.590312, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.9076, std=3.6582
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.25098039215686274, 'auc': 0.7425537109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1345, std=0.5854
[DEBUG][MIA] Test Set Loss:   mean=1.3590, std=2.9818
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.23399999999999999, 'auc': 0.6286879999999999, 'task': 8}
Total correct retain:  1969  Total retain:  2500
Total correct forget:  24000  Total forget:  47500
Total correct test:  384  Total test:  500
Total correct forget test:  4183  Total test forget:  9500
After learning task 10
Task accuracies: [0.768, 0.83, 0.66, 0.67, 0.682, 0.654, 0.57, 0.632, 0.706, 0.89, 0.25, 0.212, 0.144, 0.216, 0.22, 0.204, 0.2, 0.186, 0.216, 0.224]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.5362, std=1.4104
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.19215686274509802, 'auc': 0.77764892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5948, std=1.8427
[DEBUG][MIA] Test Set Loss:   mean=0.6131, std=1.7053
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11000000000000001, 'auc': 0.44120000000000004, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.4223, std=2.5705
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.584313725490196, 'auc': 0.8204345703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0349, std=2.3238
[DEBUG][MIA] Test Set Loss:   mean=1.4548, std=2.6884
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11399999999999999, 'auc': 0.5409039999999999, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.2651, std=2.3315
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2941176470588235, 'auc': 0.8194580078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1750, std=2.4422
[DEBUG][MIA] Test Set Loss:   mean=1.3591, std=2.4983
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.12200000000000003, 'auc': 0.568184, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.3439, std=2.4302
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.27058823529411763, 'auc': 0.884246826171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7731, std=1.8486
[DEBUG][MIA] Test Set Loss:   mean=1.2223, std=2.2928
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.14999999999999997, 'auc': 0.574416, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.7640, std=3.2068
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.28627450980392155, 'auc': 0.848724365234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8549, std=1.9580
[DEBUG][MIA] Test Set Loss:   mean=1.5014, std=2.6997
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.156, 'auc': 0.6130559999999999, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0106, std=0.0567
[DEBUG][MIA] Test Set Loss:   mean=2.2949, std=3.3483
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7411764705882353, 'auc': 0.847198486328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7415, std=1.6807
[DEBUG][MIA] Test Set Loss:   mean=2.1994, std=3.3497
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.22400000000000003, 'auc': 0.653904, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.6022, std=2.8992
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2901960784313726, 'auc': 0.786529541015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6241, std=1.4041
[DEBUG][MIA] Test Set Loss:   mean=1.7420, std=3.1184
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.182, 'auc': 0.5982879999999999, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0347
[DEBUG][MIA] Test Set Loss:   mean=1.1707, std=2.0910
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2705882352941177, 'auc': 0.72021484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2404, std=0.6897
[DEBUG][MIA] Test Set Loss:   mean=1.2806, std=2.4433
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.21800000000000003, 'auc': 0.615208, 'task': 8}
Total correct retain:  1946  Total retain:  2500
Total correct forget:  25708  Total forget:  47500
Total correct test:  365  Total test:  500
Total correct forget test:  4504  Total test forget:  9500
After learning task 11
Task accuracies: [0.73, 0.85, 0.662, 0.666, 0.694, 0.676, 0.578, 0.676, 0.706, 0.844, 0.848, 0.21, 0.174, 0.246, 0.2, 0.188, 0.186, 0.202, 0.22, 0.182]
Unlearning task: 11
Accuracy, Confidence: (0.99609375, 0.9945316910743713)
broken out of loop
Accuracy, Confidence: (0.375, 0.9576570987701416)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.3534, std=0.9838
[DEBUG][MIA] Test Set Loss:   mean=1.1409, std=2.0596
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2235294117647059, 'auc': 0.66632080078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1500, std=2.1466
[DEBUG][MIA] Test Set Loss:   mean=1.2265, std=2.2948
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.48500000000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3193, std=5.0687
[DEBUG][MIA] Test Set Loss:   mean=3.9870, std=6.4351
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.1803921568627451, 'auc': 0.648040771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.3793, std=7.1678
[DEBUG][MIA] Test Set Loss:   mean=4.7393, std=7.0896
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.5231600000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2442, std=0.6455
[DEBUG][MIA] Test Set Loss:   mean=2.4453, std=3.2706
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.4117647058823529, 'auc': 0.7823486328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4238, std=2.2696
[DEBUG][MIA] Test Set Loss:   mean=2.3635, std=3.3460
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.178, 'auc': 0.57632, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2415, std=2.6715
[DEBUG][MIA] Test Set Loss:   mean=2.7014, std=4.1144
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.20392156862745098, 'auc': 0.659881591796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.9329, std=4.5140
[DEBUG][MIA] Test Set Loss:   mean=3.2113, std=4.4596
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.46310400000000007, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2597, std=4.6083
[DEBUG][MIA] Test Set Loss:   mean=4.0202, std=6.1571
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.19607843137254902, 'auc': 0.65008544921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.4111, std=8.1042
[DEBUG][MIA] Test Set Loss:   mean=5.4424, std=7.3600
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11000000000000001, 'auc': 0.536744, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8287, std=3.1971
[DEBUG][MIA] Test Set Loss:   mean=4.6100, std=5.1881
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.1764705882352941, 'auc': 0.691619873046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.6461, std=5.5156
[DEBUG][MIA] Test Set Loss:   mean=4.7526, std=5.9294
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.17200000000000001, 'auc': 0.582456, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4637, std=2.9655
[DEBUG][MIA] Test Set Loss:   mean=3.7262, std=4.6543
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.21176470588235294, 'auc': 0.65966796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.9336, std=4.2131
[DEBUG][MIA] Test Set Loss:   mean=4.0478, std=5.1302
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.15599999999999997, 'auc': 0.573152, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1800, std=2.6222
[DEBUG][MIA] Test Set Loss:   mean=2.4656, std=4.1739
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.19215686274509805, 'auc': 0.596160888671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.5345, std=3.0994
[DEBUG][MIA] Test Set Loss:   mean=2.4752, std=3.9044
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.11400000000000002, 'auc': 0.595736, 'task': 8}
Total correct retain:  1393  Total retain:  2500
Total correct forget:  19522  Total forget:  47500
Total correct test:  253  Total test:  500
Total correct forget test:  3515  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.506, 0.672, 0.464, 0.53, 0.51, 0.426, 0.386, 0.424, 0.556, 0.69, 0.37, 0.214, 0.22, 0.292, 0.244, 0.182, 0.288, 0.202, 0.15, 0.21]
Unlearning task: 10
Accuracy, Confidence: (0.8515625, 0.9127407073974609)
broken out of loop
Accuracy, Confidence: (0.34765625, 0.9183316826820374)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5246, std=1.4623
[DEBUG][MIA] Test Set Loss:   mean=2.0003, std=3.0850
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.16862745098039214, 'auc': 0.6904296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9022, std=3.0418
[DEBUG][MIA] Test Set Loss:   mean=1.9690, std=3.2163
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.49240799999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3431, std=3.8868
[DEBUG][MIA] Test Set Loss:   mean=3.4085, std=4.4922
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.39607843137254906, 'auc': 0.7264404296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.9036, std=4.7194
[DEBUG][MIA] Test Set Loss:   mean=3.1876, std=4.6315
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11400000000000002, 'auc': 0.53052, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7915, std=1.6325
[DEBUG][MIA] Test Set Loss:   mean=2.5212, std=3.1882
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.5725490196078431, 'auc': 0.703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1229, std=3.0703
[DEBUG][MIA] Test Set Loss:   mean=2.6575, std=3.4670
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10400000000000001, 'auc': 0.5384800000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7777, std=2.2966
[DEBUG][MIA] Test Set Loss:   mean=2.5698, std=3.6286
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.23137254901960785, 'auc': 0.741424560546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9596, std=3.2486
[DEBUG][MIA] Test Set Loss:   mean=2.9383, std=3.9291
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.092, 'auc': 0.583792, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1553, std=2.5716
[DEBUG][MIA] Test Set Loss:   mean=3.6759, std=4.5470
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.21960784313725493, 'auc': 0.707916259765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.4048, std=5.0141
[DEBUG][MIA] Test Set Loss:   mean=4.0702, std=5.4277
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11599999999999999, 'auc': 0.537384, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9281, std=2.3485
[DEBUG][MIA] Test Set Loss:   mean=3.6407, std=4.7422
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2431372549019608, 'auc': 0.753631591796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2080, std=3.7420
[DEBUG][MIA] Test Set Loss:   mean=3.6902, std=4.8315
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.15, 'auc': 0.59584, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8864, std=2.1943
[DEBUG][MIA] Test Set Loss:   mean=2.4171, std=3.1504
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2705882352941177, 'auc': 0.6710205078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.5123, std=2.5488
[DEBUG][MIA] Test Set Loss:   mean=2.9791, std=3.7664
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.14799999999999996, 'auc': 0.6180800000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9577, std=2.8560
[DEBUG][MIA] Test Set Loss:   mean=2.8223, std=3.3111
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.2235294117647059, 'auc': 0.60711669921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.1508, std=3.0811
[DEBUG][MIA] Test Set Loss:   mean=2.9335, std=3.4376
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.156, 'auc': 0.5812480000000001, 'task': 8}
Total correct retain:  1391  Total retain:  2500
Total correct forget:  17963  Total forget:  47500
Total correct test:  250  Total test:  500
Total correct forget test:  3227  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.5, 0.6, 0.506, 0.458, 0.536, 0.46, 0.462, 0.486, 0.432, 0.322, 0.348, 0.204, 0.212, 0.296, 0.196, 0.132, 0.254, 0.224, 0.174, 0.152]
Unlearning task: 9
Accuracy, Confidence: (0.59375, 0.8902915716171265)
broken out of loop
Accuracy, Confidence: (0.5, 0.9144901037216187)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8372, std=1.7574
[DEBUG][MIA] Test Set Loss:   mean=2.3512, std=3.6670
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.2, 'auc': 0.64642333984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5720, std=2.5808
[DEBUG][MIA] Test Set Loss:   mean=2.0201, std=3.0940
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.096, 'auc': 0.54292, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1493, std=3.2220
[DEBUG][MIA] Test Set Loss:   mean=3.2632, std=5.9782
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.16862745098039217, 'auc': 0.64886474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.4954, std=6.1160
[DEBUG][MIA] Test Set Loss:   mean=3.6602, std=5.4497
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.5354720000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8502, std=1.6672
[DEBUG][MIA] Test Set Loss:   mean=3.3683, std=3.9304
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25098039215686274, 'auc': 0.72491455078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5518, std=3.0195
[DEBUG][MIA] Test Set Loss:   mean=3.2312, std=3.8743
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10400000000000001, 'auc': 0.533712, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8471, std=2.0025
[DEBUG][MIA] Test Set Loss:   mean=2.6214, std=3.5726
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.3607843137254902, 'auc': 0.7344970703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2079, std=3.6379
[DEBUG][MIA] Test Set Loss:   mean=2.6137, std=3.8260
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10200000000000001, 'auc': 0.544664, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5737, std=3.3423
[DEBUG][MIA] Test Set Loss:   mean=5.5467, std=5.7466
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.18823529411764708, 'auc': 0.734130859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.4403, std=6.3149
[DEBUG][MIA] Test Set Loss:   mean=4.6185, std=5.8482
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.11000000000000001, 'auc': 0.5293680000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5559, std=3.0225
[DEBUG][MIA] Test Set Loss:   mean=4.2598, std=6.0471
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.3843137254901961, 'auc': 0.681060791015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.9501, std=4.4937
[DEBUG][MIA] Test Set Loss:   mean=4.3719, std=5.6709
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.164, 'auc': 0.569944, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3375, std=2.6471
[DEBUG][MIA] Test Set Loss:   mean=3.5801, std=4.8643
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.26666666666666666, 'auc': 0.6817626953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2085, std=3.3562
[DEBUG][MIA] Test Set Loss:   mean=3.2294, std=4.2637
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.12600000000000003, 'auc': 0.559288, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.6453, std=7.8538
[DEBUG][MIA] Test Set Loss:   mean=6.4842, std=7.6406
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.12549019607843137, 'auc': 0.54364013671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.6559, std=7.3471
[DEBUG][MIA] Test Set Loss:   mean=6.6549, std=7.3378
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.503568, 'task': 8}
Total correct retain:  1341  Total retain:  2500
Total correct forget:  17089  Total forget:  47500
Total correct test:  249  Total test:  500
Total correct forget test:  3105  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.498, 0.6, 0.504, 0.416, 0.528, 0.416, 0.438, 0.44, 0.354, 0.338, 0.33, 0.202, 0.182, 0.294, 0.188, 0.13, 0.276, 0.232, 0.156, 0.186]
Unlearning task: 8
Accuracy, Confidence: (0.6953125, 0.8655158877372742)
broken out of loop
Accuracy, Confidence: (0.5078125, 0.8682374358177185)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4878, std=1.3128
[DEBUG][MIA] Test Set Loss:   mean=1.5301, std=2.4403
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.2235294117647059, 'auc': 0.71868896484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4612, std=2.3436
[DEBUG][MIA] Test Set Loss:   mean=1.3633, std=2.2810
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10800000000000001, 'auc': 0.504192, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0949, std=2.5503
[DEBUG][MIA] Test Set Loss:   mean=3.9095, std=5.3743
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.16862745098039214, 'auc': 0.720062255859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2812, std=4.9484
[DEBUG][MIA] Test Set Loss:   mean=4.1669, std=6.0653
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11400000000000002, 'auc': 0.528064, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.3726, std=0.9241
[DEBUG][MIA] Test Set Loss:   mean=2.4045, std=2.6280
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.5882352941176471, 'auc': 0.7950439453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9765, std=2.7732
[DEBUG][MIA] Test Set Loss:   mean=2.0174, std=2.6676
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.134, 'auc': 0.518384, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7545, std=1.7518
[DEBUG][MIA] Test Set Loss:   mean=2.3334, std=3.3477
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.396078431372549, 'auc': 0.685211181640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1777, std=3.2039
[DEBUG][MIA] Test Set Loss:   mean=2.6707, std=3.6547
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.098, 'auc': 0.5406880000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1112, std=3.1826
[DEBUG][MIA] Test Set Loss:   mean=4.0254, std=5.7544
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.3686274509803922, 'auc': 0.721435546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.2686, std=5.0412
[DEBUG][MIA] Test Set Loss:   mean=4.3406, std=5.7714
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.561952, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7022, std=1.4473
[DEBUG][MIA] Test Set Loss:   mean=2.9753, std=4.2794
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.21176470588235294, 'auc': 0.7127685546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.5050, std=3.5908
[DEBUG][MIA] Test Set Loss:   mean=3.1958, std=4.5962
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.18, 'auc': 0.546368, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0496, std=4.7876
[DEBUG][MIA] Test Set Loss:   mean=5.5208, std=5.2038
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.19607843137254902, 'auc': 0.6822509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1170, std=5.2868
[DEBUG][MIA] Test Set Loss:   mean=5.5400, std=6.3255
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.098, 'auc': 0.5835039999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.8933, std=8.5445
[DEBUG][MIA] Test Set Loss:   mean=7.6034, std=7.5495
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09411764705882353, 'auc': 0.5030517578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7968, std=8.2550
[DEBUG][MIA] Test Set Loss:   mean=6.5782, std=7.3920
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.124, 'auc': 0.497584, 'task': 8}
Total correct retain:  1263  Total retain:  2500
Total correct forget:  16922  Total forget:  47500
Total correct test:  228  Total test:  500
Total correct forget test:  3088  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.456, 0.632, 0.468, 0.478, 0.506, 0.452, 0.478, 0.304, 0.302, 0.308, 0.384, 0.21, 0.198, 0.27, 0.192, 0.144, 0.266, 0.212, 0.174, 0.198]
Unlearning task: 7
Accuracy, Confidence: (0.7421875, 0.8849174976348877)
broken out of loop
Accuracy, Confidence: (0.296875, 0.887669563293457)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3158, std=2.3983
[DEBUG][MIA] Test Set Loss:   mean=2.4614, std=3.3318
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.2588235294117647, 'auc': 0.6441650390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2151, std=2.8208
[DEBUG][MIA] Test Set Loss:   mean=2.2860, std=3.1353
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.094, 'auc': 0.492896, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0598, std=2.8816
[DEBUG][MIA] Test Set Loss:   mean=3.3979, std=5.5056
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.18823529411764706, 'auc': 0.702880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1541, std=4.8970
[DEBUG][MIA] Test Set Loss:   mean=3.4608, std=5.5091
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.098, 'auc': 0.491336, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1035, std=2.9135
[DEBUG][MIA] Test Set Loss:   mean=3.0062, std=3.5610
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.23529411764705882, 'auc': 0.75823974609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4502, std=3.3669
[DEBUG][MIA] Test Set Loss:   mean=2.9197, std=3.5032
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11399999999999999, 'auc': 0.5600479999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4026, std=1.1629
[DEBUG][MIA] Test Set Loss:   mean=2.3018, std=2.9874
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2235294117647059, 'auc': 0.741485595703125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6134, std=2.5984
[DEBUG][MIA] Test Set Loss:   mean=2.1250, std=2.8308
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.09, 'auc': 0.581504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5089, std=4.7392
[DEBUG][MIA] Test Set Loss:   mean=4.7524, std=6.5917
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.13725490196078433, 'auc': 0.631011962890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1464, std=6.2252
[DEBUG][MIA] Test Set Loss:   mean=5.2250, std=6.8568
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11000000000000001, 'auc': 0.558056, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.5213, std=8.1739
[DEBUG][MIA] Test Set Loss:   mean=9.4331, std=8.2804
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.21176470588235294, 'auc': 0.586151123046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.7938, std=8.6812
[DEBUG][MIA] Test Set Loss:   mean=9.4827, std=8.5868
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.52808, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7608, std=6.2166
[DEBUG][MIA] Test Set Loss:   mean=6.4627, std=6.5127
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.17254901960784313, 'auc': 0.59307861328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.1163, std=5.6984
[DEBUG][MIA] Test Set Loss:   mean=6.0366, std=6.3173
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.544808, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.3871, std=9.3347
[DEBUG][MIA] Test Set Loss:   mean=8.1552, std=8.9522
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.12941176470588237, 'auc': 0.54962158203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0874, std=9.0476
[DEBUG][MIA] Test Set Loss:   mean=8.0525, std=9.2109
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.53996, 'task': 8}
Total correct retain:  1354  Total retain:  2500
Total correct forget:  14699  Total forget:  47500
Total correct test:  234  Total test:  500
Total correct forget test:  2700  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.468, 0.514, 0.508, 0.44, 0.528, 0.414, 0.206, 0.28, 0.33, 0.308, 0.266, 0.18, 0.11, 0.204, 0.134, 0.158, 0.238, 0.222, 0.17, 0.19]
Unlearning task: 6
Accuracy, Confidence: (0.64453125, 0.8921964168548584)
broken out of loop
Accuracy, Confidence: (0.4453125, 0.8889655470848083)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1675, std=1.8217
[DEBUG][MIA] Test Set Loss:   mean=2.1619, std=2.6365
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.1607843137254902, 'auc': 0.6231689453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9758, std=2.5623
[DEBUG][MIA] Test Set Loss:   mean=2.1453, std=2.5102
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.11000000000000001, 'auc': 0.472208, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.7169, std=5.1866
[DEBUG][MIA] Test Set Loss:   mean=5.0966, std=7.6719
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.15686274509803924, 'auc': 0.65106201171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.3042, std=8.3016
[DEBUG][MIA] Test Set Loss:   mean=5.6480, std=8.1156
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.13999999999999999, 'auc': 0.5178159999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7882, std=1.7058
[DEBUG][MIA] Test Set Loss:   mean=3.3235, std=3.4250
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.34509803921568627, 'auc': 0.7713623046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2572, std=2.6310
[DEBUG][MIA] Test Set Loss:   mean=3.0465, std=3.2684
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11200000000000002, 'auc': 0.570352, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1958, std=2.5119
[DEBUG][MIA] Test Set Loss:   mean=3.0204, std=4.6590
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.2235294117647059, 'auc': 0.6417236328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.9598, std=4.5759
[DEBUG][MIA] Test Set Loss:   mean=3.3075, std=4.7096
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.13, 'auc': 0.528552, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.6741, std=7.5329
[DEBUG][MIA] Test Set Loss:   mean=7.6977, std=9.5966
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.14509803921568626, 'auc': 0.6082763671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.0989, std=9.6636
[DEBUG][MIA] Test Set Loss:   mean=7.4585, std=8.3693
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.1, 'auc': 0.5018, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.1767, std=7.3027
[DEBUG][MIA] Test Set Loss:   mean=10.0311, std=8.6098
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4296875, 'cv_acc': 0.08235294117647059, 'auc': 0.395965576171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.1757, std=7.7775
[DEBUG][MIA] Test Set Loss:   mean=9.6836, std=7.9590
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.5587599999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8170, std=4.9199
[DEBUG][MIA] Test Set Loss:   mean=7.5108, std=7.7675
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.12549019607843137, 'auc': 0.667022705078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.9988, std=5.7197
[DEBUG][MIA] Test Set Loss:   mean=6.0300, std=6.1980
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.086, 'auc': 0.551112, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9760, std=8.6784
[DEBUG][MIA] Test Set Loss:   mean=7.4228, std=8.1136
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.10980392156862746, 'auc': 0.498626708984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=8.0058, std=8.5761
[DEBUG][MIA] Test Set Loss:   mean=8.2245, std=8.4092
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10800000000000001, 'auc': 0.51352, 'task': 8}
Total correct retain:  1123  Total retain:  2500
Total correct forget:  13502  Total forget:  47500
Total correct test:  198  Total test:  500
Total correct forget test:  2479  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.396, 0.462, 0.432, 0.41, 0.464, 0.3, 0.226, 0.264, 0.254, 0.292, 0.202, 0.186, 0.146, 0.238, 0.154, 0.158, 0.248, 0.208, 0.148, 0.166]
Unlearning task: 5
Accuracy, Confidence: (0.70703125, 0.8907895088195801)
broken out of loop
Accuracy, Confidence: (0.625, 0.8867626190185547)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.6026, std=1.2917
[DEBUG][MIA] Test Set Loss:   mean=1.5468, std=2.4359
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.2392156862745098, 'auc': 0.62677001953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0571, std=1.7194
[DEBUG][MIA] Test Set Loss:   mean=1.4097, std=1.9239
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.088, 'auc': 0.556144, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1613, std=3.4157
[DEBUG][MIA] Test Set Loss:   mean=5.6481, std=7.4889
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.34901960784313724, 'auc': 0.6519775390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.2711, std=5.7533
[DEBUG][MIA] Test Set Loss:   mean=4.8311, std=7.2804
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.5038560000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5299, std=1.1964
[DEBUG][MIA] Test Set Loss:   mean=2.3300, std=2.7417
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5843137254901961, 'auc': 0.74078369140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9263, std=2.7076
[DEBUG][MIA] Test Set Loss:   mean=2.1163, std=2.7061
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.154, 'auc': 0.524096, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8250, std=5.2525
[DEBUG][MIA] Test Set Loss:   mean=4.5372, std=5.5370
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.17254901960784313, 'auc': 0.6668701171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8857, std=6.0292
[DEBUG][MIA] Test Set Loss:   mean=4.6047, std=5.6756
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.086, 'auc': 0.490904, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.0747, std=5.8634
[DEBUG][MIA] Test Set Loss:   mean=7.2069, std=8.2844
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.14901960784313725, 'auc': 0.638671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.9891, std=7.4981
[DEBUG][MIA] Test Set Loss:   mean=6.7557, std=7.3020
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12, 'auc': 0.5439120000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7636, std=6.8041
[DEBUG][MIA] Test Set Loss:   mean=7.2930, std=7.1268
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.1215686274509804, 'auc': 0.4803466796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9388, std=6.7604
[DEBUG][MIA] Test Set Loss:   mean=8.0855, std=7.5772
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11400000000000002, 'auc': 0.49492800000000003, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.6265, std=4.6613
[DEBUG][MIA] Test Set Loss:   mean=4.8266, std=5.0009
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.12156862745098038, 'auc': 0.600830078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.3984, std=5.7825
[DEBUG][MIA] Test Set Loss:   mean=5.0529, std=5.3278
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.13600000000000004, 'auc': 0.5544720000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0446, std=7.2914
[DEBUG][MIA] Test Set Loss:   mean=7.3584, std=6.8946
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.11764705882352941, 'auc': 0.531158447265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.8359, std=7.1011
[DEBUG][MIA] Test Set Loss:   mean=7.8465, std=7.1531
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.098, 'auc': 0.45943999999999996, 'task': 8}
Total correct retain:  1210  Total retain:  2500
Total correct forget:  13852  Total forget:  47500
Total correct test:  225  Total test:  500
Total correct forget test:  2535  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.45, 0.626, 0.428, 0.462, 0.38, 0.294, 0.232, 0.28, 0.26, 0.264, 0.198, 0.202, 0.172, 0.234, 0.168, 0.15, 0.212, 0.204, 0.136, 0.168]
Unlearning task: 4
Accuracy, Confidence: (0.8203125, 0.8706637620925903)
broken out of loop
Accuracy, Confidence: (0.625, 0.8708394765853882)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8514, std=1.7502
[DEBUG][MIA] Test Set Loss:   mean=2.1308, std=2.5788
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.25882352941176473, 'auc': 0.69378662109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7533, std=2.4735
[DEBUG][MIA] Test Set Loss:   mean=2.0318, std=2.7215
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10400000000000001, 'auc': 0.46239199999999997, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0517, std=2.4724
[DEBUG][MIA] Test Set Loss:   mean=3.8618, std=5.1777
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.24313725490196075, 'auc': 0.732818603515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.2386, std=5.3046
[DEBUG][MIA] Test Set Loss:   mean=4.3603, std=5.9305
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10600000000000001, 'auc': 0.57936, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.6830, std=4.7253
[DEBUG][MIA] Test Set Loss:   mean=4.2191, std=4.3441
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.22745098039215686, 'auc': 0.668365478515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.3529, std=5.3217
[DEBUG][MIA] Test Set Loss:   mean=4.4428, std=4.9932
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.098, 'auc': 0.525088, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6113, std=4.8377
[DEBUG][MIA] Test Set Loss:   mean=3.9472, std=5.1377
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.21960784313725493, 'auc': 0.631500244140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.4406, std=5.6215
[DEBUG][MIA] Test Set Loss:   mean=3.9326, std=4.9587
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.094, 'auc': 0.487104, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1849, std=6.0535
[DEBUG][MIA] Test Set Loss:   mean=5.9699, std=6.7122
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.19999999999999998, 'auc': 0.595489501953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.6032, std=6.1859
[DEBUG][MIA] Test Set Loss:   mean=6.7759, std=6.9723
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.098, 'auc': 0.548544, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.2224, std=7.4797
[DEBUG][MIA] Test Set Loss:   mean=8.3394, std=7.8204
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.17254901960784313, 'auc': 0.545989990234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.4314, std=7.2906
[DEBUG][MIA] Test Set Loss:   mean=8.7752, std=8.0105
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.122, 'auc': 0.544312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.1909, std=3.9768
[DEBUG][MIA] Test Set Loss:   mean=6.5040, std=5.7367
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.16862745098039217, 'auc': 0.688934326171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4981, std=5.1436
[DEBUG][MIA] Test Set Loss:   mean=5.2365, std=5.2853
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.144, 'auc': 0.5606960000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.7528, std=6.7027
[DEBUG][MIA] Test Set Loss:   mean=5.7890, std=5.9358
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.11372549019607843, 'auc': 0.5382080078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.8371, std=6.5092
[DEBUG][MIA] Test Set Loss:   mean=6.1590, std=6.4851
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11000000000000001, 'auc': 0.515496, 'task': 8}
Total correct retain:  1361  Total retain:  2500
Total correct forget:  13639  Total forget:  47500
Total correct test:  253  Total test:  500
Total correct forget test:  2508  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.506, 0.56, 0.404, 0.304, 0.386, 0.298, 0.222, 0.274, 0.276, 0.324, 0.23, 0.196, 0.176, 0.268, 0.154, 0.16, 0.25, 0.22, 0.132, 0.182]
Unlearning task: 3
Accuracy, Confidence: (0.73046875, 0.8947115540504456)
broken out of loop
Accuracy, Confidence: (0.5859375, 0.8690577149391174)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9006, std=1.7296
[DEBUG][MIA] Test Set Loss:   mean=2.3926, std=2.7903
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.20392156862745098, 'auc': 0.66357421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9588, std=2.4527
[DEBUG][MIA] Test Set Loss:   mean=2.1779, std=2.7510
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.512656, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8010, std=3.6827
[DEBUG][MIA] Test Set Loss:   mean=5.8585, std=6.5449
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.21960784313725493, 'auc': 0.716766357421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.7706, std=6.0002
[DEBUG][MIA] Test Set Loss:   mean=5.5565, std=6.4955
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11000000000000001, 'auc': 0.549544, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.6965, std=7.3223
[DEBUG][MIA] Test Set Loss:   mean=6.5532, std=6.9354
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.14901960784313725, 'auc': 0.65252685546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.5362, std=6.9084
[DEBUG][MIA] Test Set Loss:   mean=6.0606, std=6.7605
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.532624, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2627, std=5.0252
[DEBUG][MIA] Test Set Loss:   mean=5.5224, std=5.1911
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.2156862745098039, 'auc': 0.67242431640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.3808, std=5.6921
[DEBUG][MIA] Test Set Loss:   mean=5.0700, std=5.9460
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.09, 'auc': 0.5210319999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1127, std=5.1774
[DEBUG][MIA] Test Set Loss:   mean=7.2031, std=7.5232
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.19607843137254902, 'auc': 0.633056640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.9143, std=6.4173
[DEBUG][MIA] Test Set Loss:   mean=6.7604, std=6.8613
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10200000000000001, 'auc': 0.530456, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.5369, std=7.4380
[DEBUG][MIA] Test Set Loss:   mean=9.0261, std=8.0316
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.14509803921568626, 'auc': 0.5633544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.8577, std=7.5874
[DEBUG][MIA] Test Set Loss:   mean=8.9250, std=7.8188
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11399999999999999, 'auc': 0.54472, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7522, std=4.8450
[DEBUG][MIA] Test Set Loss:   mean=6.1460, std=5.5323
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.12549019607843137, 'auc': 0.64984130859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7650, std=5.0531
[DEBUG][MIA] Test Set Loss:   mean=5.7664, std=5.5482
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.12200000000000003, 'auc': 0.565312, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5675, std=6.8589
[DEBUG][MIA] Test Set Loss:   mean=7.1442, std=6.2954
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09019607843137255, 'auc': 0.53778076171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.2515, std=6.4261
[DEBUG][MIA] Test Set Loss:   mean=6.6989, std=6.4911
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11000000000000001, 'auc': 0.47597599999999995, 'task': 8}
Total correct retain:  1298  Total retain:  2500
Total correct forget:  12748  Total forget:  47500
Total correct test:  241  Total test:  500
Total correct forget test:  2363  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.482, 0.526, 0.326, 0.27, 0.358, 0.29, 0.228, 0.27, 0.276, 0.27, 0.232, 0.194, 0.182, 0.248, 0.156, 0.142, 0.224, 0.22, 0.124, 0.19]
Unlearning task: 2
Accuracy, Confidence: (0.73828125, 0.8454787731170654)
broken out of loop
Accuracy, Confidence: (0.54296875, 0.874038815498352)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 9, 8, 6, 9, 6, 9, 7, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.5675, std=7.3219
[DEBUG][MIA] Test Set Loss:   mean=6.6805, std=7.7999
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.21568627450980396, 'auc': 0.62066650390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 5 8 5 5 8 7 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 8 5 8 7 8 5 7 5 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.2670, std=6.6090
[DEBUG][MIA] Test Set Loss:   mean=6.6169, std=8.2538
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.1, 'auc': 0.4576, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 12, 14, 10, 12, 13, 11, 12, 12, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.9560, std=5.0279
[DEBUG][MIA] Test Set Loss:   mean=6.5368, std=6.7180
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.41568627450980394, 'auc': 0.628326416015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [12 14 14 13 12 10 11 12 14 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 11 10 11 11 12 12 10 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.2877, std=7.9776
[DEBUG][MIA] Test Set Loss:   mean=6.8733, std=6.8555
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11000000000000001, 'auc': 0.505888, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 16, 18, 15, 19, 18, 17, 15, 18, 17], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.5358, std=6.9869
[DEBUG][MIA] Test Set Loss:   mean=6.5844, std=6.2500
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.1411764705882353, 'auc': 0.66815185546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 18 15 18 16 15 15 17 17 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [15 18 15 19 17 15 18 17 19 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.3158, std=8.1627
[DEBUG][MIA] Test Set Loss:   mean=5.4996, std=5.7775
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.454, 'cv_acc': 0.10800000000000001, 'auc': 0.45364800000000005, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 21, 20, 21, 21, 21, 20, 20, 23, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0595, std=6.4002
[DEBUG][MIA] Test Set Loss:   mean=6.8750, std=8.2153
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.13333333333333333, 'auc': 0.644775390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [23 21 24 22 20 21 24 22 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [24 21 20 21 21 21 23 20 22 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.9103, std=7.3176
[DEBUG][MIA] Test Set Loss:   mean=6.7442, std=7.3720
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10200000000000001, 'auc': 0.54608, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 28, 27, 26, 29, 26, 25, 26, 28, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3255, std=7.4451
[DEBUG][MIA] Test Set Loss:   mean=8.5752, std=8.7525
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.15294117647058822, 'auc': 0.61187744140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 29 26 25 27 25 29 25 27 27]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 28 27 28 29 29 26 29 27 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.8240, std=7.8676
[DEBUG][MIA] Test Set Loss:   mean=8.1616, std=8.9854
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.09, 'auc': 0.5023679999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 31, 34, 34, 34, 31, 31, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7792, std=8.3716
[DEBUG][MIA] Test Set Loss:   mean=9.4771, std=8.0606
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.2549019607843137, 'auc': 0.575164794921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [32 32 31 33 34 34 32 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 31 31 33 33 30 33 33 31 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.5030, std=8.0660
[DEBUG][MIA] Test Set Loss:   mean=10.1781, std=8.0399
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.1, 'auc': 0.570936, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 38, 37, 39, 35, 36, 37, 39, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.7522, std=5.5853
[DEBUG][MIA] Test Set Loss:   mean=6.7308, std=6.9816
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.12156862745098038, 'auc': 0.5911865234375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 38 38 37 37 35 39 36 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 36 37 38 39 35 38 37 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7229, std=5.9902
[DEBUG][MIA] Test Set Loss:   mean=6.7968, std=6.3049
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.118, 'auc': 0.55488, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 41, 42, 41, 43, 44, 41, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.1829, std=6.4963
[DEBUG][MIA] Test Set Loss:   mean=5.9439, std=5.9724
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12549019607843137, 'auc': 0.50299072265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 42 41 42 43 42 40 40 41 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 42 43 42 44 42 43 42 44 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.4092, std=6.2973
[DEBUG][MIA] Test Set Loss:   mean=5.9007, std=6.3954
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11399999999999999, 'auc': 0.5291520000000001, 'task': 8}
Total correct retain:  1369  Total retain:  2500
Total correct forget:  11684  Total forget:  47500
Total correct test:  244  Total test:  500
Total correct forget test:  2126  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.488, 0.34, 0.258, 0.228, 0.304, 0.264, 0.16, 0.242, 0.28, 0.304, 0.16, 0.192, 0.174, 0.212, 0.168, 0.186, 0.226, 0.25, 0.138, 0.166]
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  10
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['roses', 'aquarium fish', 'cloud', 'chimpanzee', 'shrew', 'skyscraper', 'tank', 'turtle', 'forest', 'motorcycle', 'lawn-mower', 'skunk', 'plain', 'poppies', 'beetle', 'otter', 'snail', 'boy', 'elephant', 'bee', 'pine', 'train', 'lion', 'computer keyboard', 'bowls', 'streetcar', 'mushrooms', 'house', 'tulips', 'oak', 'pears', 'rocket', 'seal', 'dinosaur', 'possum', 'willow', 'bridge', 'man', 'camel', 'lamp', 'bus', 'oranges', 'girl', 'tiger', 'cockroach', 'sweet peppers', 'kangaroo', 'orchids', 'dolphin', 'squirrel', 'caterpillar', 'pickup truck', 'lizard', 'palm', 'maple', 'snake', 'bicycle', 'shark', 'sunflowers', 'television', 'cans', 'crocodile', 'lobster', 'bed', 'clock', 'raccoon', 'couch', 'sea', 'baby', 'porcupine', 'whale', 'trout', 'table', 'worm', 'cattle', 'chair', 'flatfish', 'castle', 'hamster', 'spider', 'crab', 'beaver', 'apples', 'fox', 'bottles', 'tractor', 'plates', 'wardrobe', 'woman', 'road', 'bear', 'butterfly', 'rabbit', 'ray', 'mouse', 'telephone', 'cups', 'wolf', 'mountain', 'leopard']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2275  Total retain:  2500
Total correct forget:  10546  Total forget:  47500
Total correct test:  402  Total test:  500
Total correct forget test:  2096  Total test forget:  9500
After learning task 1
Task accuracies: [0.804, 0.18, 0.116, 0.228, 0.166, 0.282, 0.274, 0.204, 0.226, 0.284, 0.212, 0.218, 0.216, 0.198, 0.25, 0.194, 0.212, 0.198, 0.24, 0.294]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0232, std=0.1828
[DEBUG][MIA] Test Set Loss:   mean=0.6166, std=2.1487
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.20392156862745098, 'auc': 0.621856689453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0472, std=0.2343
[DEBUG][MIA] Test Set Loss:   mean=0.6863, std=2.3111
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.188, 'auc': 0.634912, 'task': 1}
2 1
Total correct retain:  2044  Total retain:  2500
Total correct forget:  11840  Total forget:  47500
Total correct test:  384  Total test:  500
Total correct forget test:  2279  Total test forget:  9500
After learning task 2
Task accuracies: [0.768, 0.86, 0.046, 0.172, 0.194, 0.26, 0.21, 0.186, 0.238, 0.206, 0.21, 0.204, 0.224, 0.198, 0.22, 0.21, 0.22, 0.248, 0.196, 0.256]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0482, std=0.2289
[DEBUG][MIA] Test Set Loss:   mean=1.0998, std=2.3391
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.27450980392156865, 'auc': 0.71923828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4889, std=1.2950
[DEBUG][MIA] Test Set Loss:   mean=1.1230, std=2.4143
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.164, 'auc': 0.580464, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0345
[DEBUG][MIA] Test Set Loss:   mean=0.5531, std=1.6603
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.1411764705882353, 'auc': 0.654815673828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0269, std=0.4105
[DEBUG][MIA] Test Set Loss:   mean=0.4690, std=1.7394
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.18, 'auc': 0.6212, 'task': 2}
3 2
Total correct retain:  2054  Total retain:  2500
Total correct forget:  13436  Total forget:  47500
Total correct test:  389  Total test:  500
Total correct forget test:  2546  Total test forget:  9500
After learning task 3
Task accuracies: [0.778, 0.722, 0.9, 0.164, 0.142, 0.16, 0.166, 0.186, 0.198, 0.202, 0.23, 0.2, 0.21, 0.202, 0.19, 0.208, 0.212, 0.24, 0.2, 0.36]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0843, std=0.3557
[DEBUG][MIA] Test Set Loss:   mean=1.1799, std=1.9595
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.26666666666666666, 'auc': 0.72576904296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9001, std=1.8908
[DEBUG][MIA] Test Set Loss:   mean=1.2829, std=2.3880
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12600000000000003, 'auc': 0.53084, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0339
[DEBUG][MIA] Test Set Loss:   mean=0.7446, std=1.7629
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.23529411764705882, 'auc': 0.7091064453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4297, std=1.2895
[DEBUG][MIA] Test Set Loss:   mean=0.7129, std=1.7877
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.148, 'auc': 0.557064, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0156
[DEBUG][MIA] Test Set Loss:   mean=1.8357, std=2.9791
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.2980392156862745, 'auc': 0.822174072265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0125, std=0.0759
[DEBUG][MIA] Test Set Loss:   mean=1.6251, std=2.8468
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.704, 'cv_acc': 0.668, 'auc': 0.805704, 'task': 3}
4 3
Total correct retain:  1953  Total retain:  2500
Total correct forget:  14714  Total forget:  47500
Total correct test:  376  Total test:  500
Total correct forget test:  2727  Total test forget:  9500
After learning task 4
Task accuracies: [0.752, 0.69, 0.818, 0.65, 0.184, 0.196, 0.172, 0.274, 0.18, 0.21, 0.214, 0.202, 0.212, 0.196, 0.134, 0.196, 0.21, 0.182, 0.204, 0.33]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0102, std=0.0453
[DEBUG][MIA] Test Set Loss:   mean=1.4834, std=2.7048
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2901960784313726, 'auc': 0.729949951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9734, std=1.9557
[DEBUG][MIA] Test Set Loss:   mean=0.9714, std=2.0117
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.124, 'auc': 0.51128, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=0.7608, std=1.9290
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2392156862745098, 'auc': 0.699676513671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5138, std=1.4198
[DEBUG][MIA] Test Set Loss:   mean=0.8510, std=1.9923
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10600000000000001, 'auc': 0.532376, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.8598, std=2.6365
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7607843137254902, 'auc': 0.908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5464, std=1.4607
[DEBUG][MIA] Test Set Loss:   mean=1.9147, std=2.7983
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.368, 'auc': 0.7063680000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0089, std=0.0646
[DEBUG][MIA] Test Set Loss:   mean=0.8160, std=1.8621
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.22745098039215686, 'auc': 0.71435546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0197
[DEBUG][MIA] Test Set Loss:   mean=1.1523, std=2.5184
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.24, 'auc': 0.76764, 'task': 4}
5 4
Total correct retain:  1847  Total retain:  2500
Total correct forget:  16080  Total forget:  47500
Total correct test:  363  Total test:  500
Total correct forget test:  2916  Total test forget:  9500
After learning task 5
Task accuracies: [0.726, 0.7, 0.784, 0.548, 0.78, 0.142, 0.15, 0.276, 0.132, 0.23, 0.218, 0.2, 0.248, 0.202, 0.17, 0.22, 0.212, 0.174, 0.188, 0.258]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0323, std=0.2250
[DEBUG][MIA] Test Set Loss:   mean=1.1999, std=2.3176
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.25098039215686274, 'auc': 0.770599365234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0729, std=2.0952
[DEBUG][MIA] Test Set Loss:   mean=1.2637, std=2.2565
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.12, 'auc': 0.5427040000000001, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=0.8423, std=2.2407
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.21960784313725487, 'auc': 0.7357177734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8078, std=2.1602
[DEBUG][MIA] Test Set Loss:   mean=0.8479, std=2.2371
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.13200000000000003, 'auc': 0.51936, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.7433, std=3.7522
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7529411764705883, 'auc': 0.879791259765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7456, std=1.7576
[DEBUG][MIA] Test Set Loss:   mean=2.6327, std=3.6262
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.194, 'auc': 0.6819439999999999, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.3416, std=2.7171
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.24705882352941178, 'auc': 0.795745849609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1341, std=0.5539
[DEBUG][MIA] Test Set Loss:   mean=1.0482, std=2.3546
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.21800000000000003, 'auc': 0.64452, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0198, std=0.1701
[DEBUG][MIA] Test Set Loss:   mean=0.5604, std=1.4278
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.20784313725490194, 'auc': 0.6768798828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=0.6172, std=1.6529
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.20400000000000001, 'auc': 0.663952, 'task': 5}
6 5
Total correct retain:  1844  Total retain:  2500
Total correct forget:  18103  Total forget:  47500
Total correct test:  344  Total test:  500
Total correct forget test:  3254  Total test forget:  9500
After learning task 6
Task accuracies: [0.688, 0.712, 0.824, 0.536, 0.746, 0.844, 0.18, 0.27, 0.128, 0.202, 0.206, 0.2, 0.23, 0.194, 0.152, 0.264, 0.224, 0.182, 0.21, 0.204]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0136, std=0.0720
[DEBUG][MIA] Test Set Loss:   mean=1.5700, std=2.4330
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7098039215686274, 'auc': 0.812530517578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9515, std=1.9549
[DEBUG][MIA] Test Set Loss:   mean=1.6404, std=2.7950
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11400000000000002, 'auc': 0.5916, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0119, std=0.0762
[DEBUG][MIA] Test Set Loss:   mean=0.7879, std=1.9040
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.23529411764705882, 'auc': 0.67010498046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7506, std=1.9574
[DEBUG][MIA] Test Set Loss:   mean=0.9884, std=2.1194
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10400000000000001, 'auc': 0.549384, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0140
[DEBUG][MIA] Test Set Loss:   mean=2.6711, std=3.7178
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7568627450980392, 'auc': 0.9010009765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2803, std=2.3939
[DEBUG][MIA] Test Set Loss:   mean=2.8407, std=3.6410
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.184, 'auc': 0.635928, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.3560, std=2.6397
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2980392156862745, 'auc': 0.79290771484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5295, std=1.4211
[DEBUG][MIA] Test Set Loss:   mean=1.7478, std=2.9278
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.174, 'auc': 0.616776, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0087, std=0.0305
[DEBUG][MIA] Test Set Loss:   mean=1.0060, std=1.9222
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2705882352941177, 'auc': 0.77923583984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4318, std=1.0356
[DEBUG][MIA] Test Set Loss:   mean=0.7874, std=1.6378
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.176, 'auc': 0.583712, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0633, std=0.3671
[DEBUG][MIA] Test Set Loss:   mean=0.9775, std=2.3185
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.25098039215686274, 'auc': 0.668426513671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0357, std=0.1839
[DEBUG][MIA] Test Set Loss:   mean=1.0868, std=2.2508
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.236, 'auc': 0.73364, 'task': 6}
7 6
Total correct retain:  1801  Total retain:  2500
Total correct forget:  19144  Total forget:  47500
Total correct test:  339  Total test:  500
Total correct forget test:  3382  Total test forget:  9500
After learning task 7
Task accuracies: [0.678, 0.64, 0.774, 0.506, 0.674, 0.756, 0.726, 0.284, 0.168, 0.166, 0.23, 0.198, 0.222, 0.194, 0.198, 0.188, 0.214, 0.184, 0.202, 0.24]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=1.4306, std=2.7269
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2823529411764706, 'auc': 0.749053955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5711, std=2.5673
[DEBUG][MIA] Test Set Loss:   mean=1.6012, std=2.9289
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.10600000000000001, 'auc': 0.473768, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0736
[DEBUG][MIA] Test Set Loss:   mean=1.0265, std=2.4126
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2588235294117647, 'auc': 0.698699951171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6997, std=1.8521
[DEBUG][MIA] Test Set Loss:   mean=1.0177, std=2.2656
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10800000000000001, 'auc': 0.545032, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=2.6547, std=3.7104
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7647058823529413, 'auc': 0.875274658203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5875, std=2.8420
[DEBUG][MIA] Test Set Loss:   mean=3.0423, std=3.9487
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.16, 'auc': 0.61916, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.1553, std=2.1198
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2980392156862745, 'auc': 0.843353271484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7287, std=1.6010
[DEBUG][MIA] Test Set Loss:   mean=1.3928, std=2.6403
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.21400000000000002, 'auc': 0.584168, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0149
[DEBUG][MIA] Test Set Loss:   mean=1.0141, std=1.9607
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2588235294117647, 'auc': 0.7216796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5075, std=1.3871
[DEBUG][MIA] Test Set Loss:   mean=0.9468, std=1.8721
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11200000000000002, 'auc': 0.577408, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0385
[DEBUG][MIA] Test Set Loss:   mean=1.2134, std=2.2535
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.27450980392156865, 'auc': 0.75933837890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2127, std=0.7840
[DEBUG][MIA] Test Set Loss:   mean=1.3478, std=2.3329
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.242, 'auc': 0.695384, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0093
[DEBUG][MIA] Test Set Loss:   mean=0.9496, std=2.1974
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.20392156862745098, 'auc': 0.737823486328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0228
[DEBUG][MIA] Test Set Loss:   mean=0.7581, std=2.1143
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.644, 'cv_acc': 0.25, 'auc': 0.707376, 'task': 7}
8 7
Total correct retain:  1808  Total retain:  2500
Total correct forget:  20442  Total forget:  47500
Total correct test:  344  Total test:  500
Total correct forget test:  3663  Total test forget:  9500
After learning task 8
Task accuracies: [0.688, 0.694, 0.778, 0.498, 0.664, 0.734, 0.684, 0.784, 0.252, 0.208, 0.224, 0.2, 0.232, 0.178, 0.236, 0.238, 0.216, 0.146, 0.186, 0.174]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0301, std=0.2653
[DEBUG][MIA] Test Set Loss:   mean=1.7188, std=3.1709
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2901960784313726, 'auc': 0.789825439453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7048, std=3.1177
[DEBUG][MIA] Test Set Loss:   mean=1.5636, std=2.8711
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11000000000000001, 'auc': 0.500704, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.3281, std=2.8830
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.23529411764705882, 'auc': 0.7889404296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7460, std=1.9197
[DEBUG][MIA] Test Set Loss:   mean=0.9621, std=2.3825
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.094, 'auc': 0.549536, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=3.3806, std=4.4525
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.7803921568627452, 'auc': 0.92510986328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6340, std=3.1634
[DEBUG][MIA] Test Set Loss:   mean=2.8688, std=4.3426
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.22400000000000003, 'auc': 0.59976, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.0983, std=2.2054
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.30196078431372547, 'auc': 0.797393798828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6598, std=1.7402
[DEBUG][MIA] Test Set Loss:   mean=1.3612, std=2.7652
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.21200000000000002, 'auc': 0.55728, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0156, std=0.0672
[DEBUG][MIA] Test Set Loss:   mean=1.1676, std=2.5128
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2549019607843137, 'auc': 0.6495361328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0187, std=2.2925
[DEBUG][MIA] Test Set Loss:   mean=1.4914, std=2.9390
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10400000000000001, 'auc': 0.538184, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0305, std=0.1335
[DEBUG][MIA] Test Set Loss:   mean=1.6101, std=2.9521
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6823529411764706, 'auc': 0.7525634765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4407, std=1.3184
[DEBUG][MIA] Test Set Loss:   mean=1.5524, std=2.7088
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.20800000000000002, 'auc': 0.670544, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0110
[DEBUG][MIA] Test Set Loss:   mean=1.5567, std=2.9814
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2392156862745098, 'auc': 0.77740478515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0832, std=0.2982
[DEBUG][MIA] Test Set Loss:   mean=1.4843, std=2.8005
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.21400000000000002, 'auc': 0.660744, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0089, std=0.0473
[DEBUG][MIA] Test Set Loss:   mean=0.4917, std=1.5083
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.16862745098039217, 'auc': 0.6783447265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0190, std=0.1324
[DEBUG][MIA] Test Set Loss:   mean=0.5443, std=1.5637
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.16399999999999998, 'auc': 0.65864, 'task': 8}
Total correct retain:  1818  Total retain:  2500
Total correct forget:  21725  Total forget:  47500
Total correct test:  338  Total test:  500
Total correct forget test:  3817  Total test forget:  9500
After learning task 9
Task accuracies: [0.676, 0.678, 0.794, 0.486, 0.662, 0.71, 0.662, 0.706, 0.856, 0.162, 0.208, 0.202, 0.202, 0.188, 0.19, 0.244, 0.212, 0.156, 0.178, 0.138]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0179, std=0.0905
[DEBUG][MIA] Test Set Loss:   mean=1.4773, std=2.4890
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.29803921568627445, 'auc': 0.7574462890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5614, std=2.9400
[DEBUG][MIA] Test Set Loss:   mean=1.8760, std=3.2557
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.1, 'auc': 0.512192, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=0.9649, std=2.0432
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25490196078431376, 'auc': 0.753631591796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6135, std=1.7347
[DEBUG][MIA] Test Set Loss:   mean=1.1632, std=2.5912
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.10400000000000001, 'auc': 0.571312, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=2.7613, std=3.7504
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7843137254901961, 'auc': 0.86663818359375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7111, std=3.0624
[DEBUG][MIA] Test Set Loss:   mean=3.3675, std=4.1573
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.098, 'auc': 0.6349440000000001, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.9978, std=2.9824
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.2823529411764706, 'auc': 0.8897705078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9397, std=1.8758
[DEBUG][MIA] Test Set Loss:   mean=1.4676, std=2.6127
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.174, 'auc': 0.55488, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0362
[DEBUG][MIA] Test Set Loss:   mean=1.0840, std=2.2810
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.26666666666666666, 'auc': 0.68212890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5785, std=1.6823
[DEBUG][MIA] Test Set Loss:   mean=1.1106, std=2.2752
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.144, 'auc': 0.606232, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0372, std=0.2039
[DEBUG][MIA] Test Set Loss:   mean=1.8317, std=2.7947
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.27450980392156865, 'auc': 0.7779541015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6026, std=1.6458
[DEBUG][MIA] Test Set Loss:   mean=1.8769, std=3.0533
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.154, 'auc': 0.650024, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.3080, std=2.4959
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2823529411764706, 'auc': 0.798370361328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3960, std=1.4667
[DEBUG][MIA] Test Set Loss:   mean=1.3518, std=2.6613
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.188, 'auc': 0.6469440000000001, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0166
[DEBUG][MIA] Test Set Loss:   mean=0.5951, std=1.8671
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2235294117647059, 'auc': 0.65875244140625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1950, std=0.6589
[DEBUG][MIA] Test Set Loss:   mean=0.7775, std=1.8059
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.16, 'auc': 0.6304639999999999, 'task': 8}
Total correct retain:  1853  Total retain:  2500
Total correct forget:  23054  Total forget:  47500
Total correct test:  342  Total test:  500
Total correct forget test:  4027  Total test forget:  9500
After learning task 10
Task accuracies: [0.684, 0.626, 0.762, 0.474, 0.66, 0.726, 0.662, 0.71, 0.806, 0.814, 0.22, 0.206, 0.204, 0.192, 0.116, 0.242, 0.204, 0.156, 0.144, 0.13]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0391
[DEBUG][MIA] Test Set Loss:   mean=1.6300, std=2.9612
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7019607843137254, 'auc': 0.83050537109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5113, std=2.8928
[DEBUG][MIA] Test Set Loss:   mean=1.5874, std=2.7426
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.502568, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0395
[DEBUG][MIA] Test Set Loss:   mean=1.1309, std=2.4347
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2627450980392157, 'auc': 0.77166748046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7796, std=1.8699
[DEBUG][MIA] Test Set Loss:   mean=0.9876, std=2.3826
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.12200000000000003, 'auc': 0.5283760000000001, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0175
[DEBUG][MIA] Test Set Loss:   mean=3.0294, std=3.8598
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7647058823529412, 'auc': 0.912872314453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7573, std=3.0184
[DEBUG][MIA] Test Set Loss:   mean=2.8733, std=3.8887
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.15, 'auc': 0.6086320000000001, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.6463, std=2.8155
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7215686274509805, 'auc': 0.893280029296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0562, std=2.4092
[DEBUG][MIA] Test Set Loss:   mean=1.7136, std=2.8774
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.144, 'auc': 0.5865600000000001, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.1320, std=2.4837
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.25098039215686274, 'auc': 0.72027587890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5450, std=1.5562
[DEBUG][MIA] Test Set Loss:   mean=1.1264, std=2.3602
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.12800000000000003, 'auc': 0.582856, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0085, std=0.0348
[DEBUG][MIA] Test Set Loss:   mean=2.0672, std=3.4663
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.4862745098039216, 'auc': 0.801727294921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6362, std=1.6833
[DEBUG][MIA] Test Set Loss:   mean=1.7087, std=2.9601
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.162, 'auc': 0.61432, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.0447, std=2.0942
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.27450980392156865, 'auc': 0.868316650390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3954, std=1.1209
[DEBUG][MIA] Test Set Loss:   mean=1.1474, std=2.1777
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.21600000000000003, 'auc': 0.6170239999999999, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0190
[DEBUG][MIA] Test Set Loss:   mean=0.6064, std=1.6359
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2156862745098039, 'auc': 0.6929931640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3753, std=1.1563
[DEBUG][MIA] Test Set Loss:   mean=0.7646, std=1.8480
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10200000000000001, 'auc': 0.554144, 'task': 8}
Total correct retain:  1790  Total retain:  2500
Total correct forget:  24771  Total forget:  47500
Total correct test:  331  Total test:  500
Total correct forget test:  4362  Total test forget:  9500
After learning task 11
Task accuracies: [0.662, 0.672, 0.75, 0.512, 0.66, 0.756, 0.624, 0.698, 0.79, 0.744, 0.792, 0.218, 0.208, 0.19, 0.14, 0.258, 0.2, 0.188, 0.168, 0.156]
Unlearning task: 11
Accuracy, Confidence: (1.0, 0.9971681833267212)
broken out of loop
Accuracy, Confidence: (0.4140625, 0.9491803646087646)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6182, std=3.4340
[DEBUG][MIA] Test Set Loss:   mean=2.9218, std=3.8253
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.38823529411764707, 'auc': 0.63787841796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5012, std=3.5037
[DEBUG][MIA] Test Set Loss:   mean=3.0034, std=4.0858
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.528952, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7898, std=1.5380
[DEBUG][MIA] Test Set Loss:   mean=1.6184, std=2.9919
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.2156862745098039, 'auc': 0.568817138671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6197, std=2.7080
[DEBUG][MIA] Test Set Loss:   mean=2.0771, std=3.3360
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10200000000000001, 'auc': 0.517416, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7862, std=1.4176
[DEBUG][MIA] Test Set Loss:   mean=2.7810, std=3.0725
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.5725490196078431, 'auc': 0.70758056640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2614, std=2.8500
[DEBUG][MIA] Test Set Loss:   mean=3.4089, std=3.7390
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.074, 'auc': 0.594336, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5942, std=3.1146
[DEBUG][MIA] Test Set Loss:   mean=3.7927, std=5.7422
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.10588235294117647, 'auc': 0.623443603515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.2571, std=5.2430
[DEBUG][MIA] Test Set Loss:   mean=3.7959, std=5.1447
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11800000000000002, 'auc': 0.554368, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9706, std=3.7036
[DEBUG][MIA] Test Set Loss:   mean=2.7774, std=4.2069
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.15686274509803924, 'auc': 0.5736083984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.4651, std=3.7194
[DEBUG][MIA] Test Set Loss:   mean=3.1017, std=4.2480
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.09, 'auc': 0.5412399999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1297, std=2.2682
[DEBUG][MIA] Test Set Loss:   mean=2.9796, std=3.8560
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2, 'auc': 0.6463623046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4790, std=2.4178
[DEBUG][MIA] Test Set Loss:   mean=2.9851, std=3.7931
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.086, 'auc': 0.62808, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.2610, std=5.4338
[DEBUG][MIA] Test Set Loss:   mean=3.8035, std=4.9124
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.14509803921568626, 'auc': 0.6041259765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.3676, std=4.9996
[DEBUG][MIA] Test Set Loss:   mean=3.5832, std=4.5870
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.12000000000000002, 'auc': 0.546176, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4581, std=2.5446
[DEBUG][MIA] Test Set Loss:   mean=2.3786, std=3.3161
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.17254901960784313, 'auc': 0.541046142578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9126, std=2.9118
[DEBUG][MIA] Test Set Loss:   mean=2.3767, std=3.2668
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.1, 'auc': 0.44734399999999996, 'task': 8}
Total correct retain:  1555  Total retain:  2500
Total correct forget:  17599  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  3206  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.594, 0.476, 0.626, 0.406, 0.41, 0.482, 0.482, 0.366, 0.542, 0.566, 0.326, 0.208, 0.206, 0.168, 0.28, 0.158, 0.198, 0.196, 0.148, 0.168]
Unlearning task: 10
Accuracy, Confidence: (0.68359375, 0.9128665328025818)
broken out of loop
Accuracy, Confidence: (0.375, 0.9370104670524597)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3314, std=2.6959
[DEBUG][MIA] Test Set Loss:   mean=2.7856, std=3.5309
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.21960784313725487, 'auc': 0.657745361328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3867, std=3.2066
[DEBUG][MIA] Test Set Loss:   mean=2.6389, std=3.5594
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10200000000000001, 'auc': 0.5143679999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9491, std=1.7959
[DEBUG][MIA] Test Set Loss:   mean=1.7105, std=2.2081
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.20392156862745098, 'auc': 0.62725830078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7508, std=2.5098
[DEBUG][MIA] Test Set Loss:   mean=1.7131, std=2.2598
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.088, 'auc': 0.509968, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4234, std=1.9812
[DEBUG][MIA] Test Set Loss:   mean=3.4889, std=3.4682
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.29803921568627456, 'auc': 0.69775390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0607, std=2.9482
[DEBUG][MIA] Test Set Loss:   mean=3.2788, std=3.3560
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11000000000000001, 'auc': 0.509024, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3252, std=2.2011
[DEBUG][MIA] Test Set Loss:   mean=3.0616, std=3.3678
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.21568627450980396, 'auc': 0.67413330078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.7365, std=3.4346
[DEBUG][MIA] Test Set Loss:   mean=3.1292, std=3.6071
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11200000000000002, 'auc': 0.5383519999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2710, std=2.3671
[DEBUG][MIA] Test Set Loss:   mean=2.4603, std=2.8708
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.11764705882352941, 'auc': 0.66033935546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2661, std=2.9429
[DEBUG][MIA] Test Set Loss:   mean=2.5336, std=3.0532
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10600000000000001, 'auc': 0.5240319999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.4407, std=4.0349
[DEBUG][MIA] Test Set Loss:   mean=4.2173, std=4.6552
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.2235294117647059, 'auc': 0.54638671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.8911, std=4.4733
[DEBUG][MIA] Test Set Loss:   mean=4.2033, std=4.5696
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10800000000000001, 'auc': 0.52688, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0906, std=1.7134
[DEBUG][MIA] Test Set Loss:   mean=2.0303, std=2.4177
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.42745098039215684, 'auc': 0.626220703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3551, std=1.7003
[DEBUG][MIA] Test Set Loss:   mean=2.1001, std=2.3254
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13, 'auc': 0.5980800000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.1373, std=3.4875
[DEBUG][MIA] Test Set Loss:   mean=2.6452, std=3.3687
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.11764705882352941, 'auc': 0.58990478515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.1445, std=3.3673
[DEBUG][MIA] Test Set Loss:   mean=2.1813, std=3.0085
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.514496, 'task': 8}
Total correct retain:  1505  Total retain:  2500
Total correct forget:  16372  Total forget:  47500
Total correct test:  299  Total test:  500
Total correct forget test:  2965  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.598, 0.484, 0.542, 0.304, 0.446, 0.462, 0.326, 0.392, 0.484, 0.35, 0.34, 0.194, 0.192, 0.198, 0.304, 0.196, 0.196, 0.2, 0.162, 0.158]
Unlearning task: 9
Accuracy, Confidence: (0.58203125, 0.8371810913085938)
broken out of loop
Accuracy, Confidence: (0.3671875, 0.8958813548088074)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0160, std=1.9685
[DEBUG][MIA] Test Set Loss:   mean=2.4574, std=2.7461
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.1803921568627451, 'auc': 0.6910400390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1833, std=2.7812
[DEBUG][MIA] Test Set Loss:   mean=2.8634, std=3.5487
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.09, 'auc': 0.534848, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8068, std=2.4760
[DEBUG][MIA] Test Set Loss:   mean=3.0170, std=2.8299
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.20392156862745098, 'auc': 0.63287353515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5619, std=3.0257
[DEBUG][MIA] Test Set Loss:   mean=2.6748, std=2.8515
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.122, 'auc': 0.521328, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5158, std=2.3194
[DEBUG][MIA] Test Set Loss:   mean=3.7604, std=3.5024
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2901960784313726, 'auc': 0.71600341796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.5928, std=3.3837
[DEBUG][MIA] Test Set Loss:   mean=3.8642, std=3.4305
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.134, 'auc': 0.5218400000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1370, std=2.0317
[DEBUG][MIA] Test Set Loss:   mean=2.5209, std=3.1140
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.37254901960784315, 'auc': 0.65325927734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1920, std=3.1586
[DEBUG][MIA] Test Set Loss:   mean=2.2952, std=3.1113
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.12400000000000003, 'auc': 0.517, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.0944, std=3.0694
[DEBUG][MIA] Test Set Loss:   mean=2.5090, std=3.3738
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.13333333333333333, 'auc': 0.56683349609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.5513, std=3.3738
[DEBUG][MIA] Test Set Loss:   mean=3.0196, std=3.7036
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.54216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.6517, std=4.6235
[DEBUG][MIA] Test Set Loss:   mean=4.6573, std=4.4064
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.19607843137254904, 'auc': 0.51129150390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.1831, std=5.1052
[DEBUG][MIA] Test Set Loss:   mean=5.5693, std=5.3976
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.126, 'auc': 0.5185440000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2825, std=1.8155
[DEBUG][MIA] Test Set Loss:   mean=2.5575, std=2.5878
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.2392156862745098, 'auc': 0.660888671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8090, std=2.2285
[DEBUG][MIA] Test Set Loss:   mean=2.5550, std=2.6618
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.15999999999999998, 'auc': 0.5905279999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.3566, std=6.0996
[DEBUG][MIA] Test Set Loss:   mean=5.9589, std=5.9670
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.08627450980392157, 'auc': 0.5518798828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.4518, std=5.6943
[DEBUG][MIA] Test Set Loss:   mean=5.6289, std=5.8282
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.08199999999999999, 'auc': 0.507744, 'task': 8}
Total correct retain:  1297  Total retain:  2500
Total correct forget:  15200  Total forget:  47500
Total correct test:  263  Total test:  500
Total correct forget test:  2736  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.526, 0.47, 0.408, 0.276, 0.46, 0.45, 0.27, 0.39, 0.296, 0.294, 0.336, 0.212, 0.186, 0.2, 0.3, 0.198, 0.198, 0.198, 0.172, 0.158]
Unlearning task: 8
Accuracy, Confidence: (0.6015625, 0.7883177995681763)
broken out of loop
Accuracy, Confidence: (0.3671875, 0.87315434217453)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5012, std=1.1057
[DEBUG][MIA] Test Set Loss:   mean=1.7564, std=2.2191
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.19215686274509805, 'auc': 0.714324951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5943, std=2.1681
[DEBUG][MIA] Test Set Loss:   mean=1.6493, std=2.3885
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.11000000000000001, 'auc': 0.48225599999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0177, std=1.4863
[DEBUG][MIA] Test Set Loss:   mean=1.8936, std=2.4453
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.16862745098039217, 'auc': 0.599609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4959, std=2.1944
[DEBUG][MIA] Test Set Loss:   mean=1.8980, std=2.3472
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11200000000000002, 'auc': 0.55488, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5279, std=3.3205
[DEBUG][MIA] Test Set Loss:   mean=4.9615, std=4.7709
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.31764705882352945, 'auc': 0.65875244140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0586, std=3.8396
[DEBUG][MIA] Test Set Loss:   mean=5.1889, std=4.8315
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.1, 'auc': 0.553808, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1556, std=2.1098
[DEBUG][MIA] Test Set Loss:   mean=2.6990, std=3.4372
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.25882352941176473, 'auc': 0.65924072265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9659, std=2.9034
[DEBUG][MIA] Test Set Loss:   mean=2.5043, std=3.1258
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.1, 'auc': 0.55616, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9678, std=2.7657
[DEBUG][MIA] Test Set Loss:   mean=2.8532, std=3.1317
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.09803921568627451, 'auc': 0.580078125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7390, std=3.3255
[DEBUG][MIA] Test Set Loss:   mean=3.0501, std=3.5747
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10600000000000001, 'auc': 0.483512, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.4986, std=4.0092
[DEBUG][MIA] Test Set Loss:   mean=5.0014, std=4.8638
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.13725490196078433, 'auc': 0.593017578125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0778, std=4.6559
[DEBUG][MIA] Test Set Loss:   mean=4.7032, std=4.8897
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.096, 'auc': 0.464576, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.9087, std=5.8719
[DEBUG][MIA] Test Set Loss:   mean=5.9437, std=5.9726
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.1411764705882353, 'auc': 0.5621337890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.4856, std=6.0724
[DEBUG][MIA] Test Set Loss:   mean=6.3253, std=5.6596
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11000000000000001, 'auc': 0.5646880000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.5137, std=4.4127
[DEBUG][MIA] Test Set Loss:   mean=4.2477, std=4.2679
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09803921568627451, 'auc': 0.56304931640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.9619, std=4.3413
[DEBUG][MIA] Test Set Loss:   mean=4.3258, std=4.3950
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.519984, 'task': 8}
Total correct retain:  1339  Total retain:  2500
Total correct forget:  15242  Total forget:  47500
Total correct test:  268  Total test:  500
Total correct forget test:  2835  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.536, 0.584, 0.492, 0.25, 0.468, 0.436, 0.336, 0.236, 0.328, 0.346, 0.366, 0.204, 0.17, 0.192, 0.318, 0.206, 0.19, 0.212, 0.176, 0.16]
Unlearning task: 7
Accuracy, Confidence: (0.41015625, 0.8575795888900757)
broken out of loop
Accuracy, Confidence: (0.36328125, 0.8899673819541931)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4725, std=1.3297
[DEBUG][MIA] Test Set Loss:   mean=1.7694, std=2.8429
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.20784313725490197, 'auc': 0.6864013671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5311, std=2.4786
[DEBUG][MIA] Test Set Loss:   mean=1.7496, std=2.8783
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10400000000000001, 'auc': 0.532, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6067, std=1.1210
[DEBUG][MIA] Test Set Loss:   mean=1.7435, std=2.4099
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.18039215686274507, 'auc': 0.64459228515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4793, std=2.3539
[DEBUG][MIA] Test Set Loss:   mean=1.7202, std=2.5267
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10200000000000001, 'auc': 0.53872, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3315, std=2.4643
[DEBUG][MIA] Test Set Loss:   mean=3.8436, std=3.8169
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.5215686274509803, 'auc': 0.72900390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2384, std=3.4918
[DEBUG][MIA] Test Set Loss:   mean=3.9858, std=3.6130
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.438, 'cv_acc': 0.094, 'auc': 0.43383999999999995, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8224, std=1.7232
[DEBUG][MIA] Test Set Loss:   mean=1.9768, std=2.5710
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.5568627450980392, 'auc': 0.629241943359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9003, std=2.7143
[DEBUG][MIA] Test Set Loss:   mean=2.1978, std=2.7270
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.12600000000000003, 'auc': 0.5378240000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0856, std=1.8221
[DEBUG][MIA] Test Set Loss:   mean=2.2410, std=2.9991
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.18823529411764706, 'auc': 0.58203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8031, std=2.5664
[DEBUG][MIA] Test Set Loss:   mean=2.2301, std=2.9917
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.1, 'auc': 0.5416000000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.0813, std=7.7814
[DEBUG][MIA] Test Set Loss:   mean=7.5577, std=7.2661
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.16862745098039217, 'auc': 0.5445556640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.7347, std=8.1175
[DEBUG][MIA] Test Set Loss:   mean=8.0806, std=8.2693
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.518736, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1658, std=4.7297
[DEBUG][MIA] Test Set Loss:   mean=4.4958, std=4.5921
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.16862745098039214, 'auc': 0.5230712890625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4190, std=4.5871
[DEBUG][MIA] Test Set Loss:   mean=5.2459, std=4.7867
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11800000000000002, 'auc': 0.5572159999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7337, std=4.1940
[DEBUG][MIA] Test Set Loss:   mean=3.0240, std=3.9524
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.560791015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.0805, std=3.6072
[DEBUG][MIA] Test Set Loss:   mean=3.4497, std=3.9206
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.529216, 'task': 8}
Total correct retain:  1247  Total retain:  2500
Total correct forget:  16238  Total forget:  47500
Total correct test:  243  Total test:  500
Total correct forget test:  2935  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.486, 0.606, 0.544, 0.302, 0.468, 0.5, 0.242, 0.246, 0.404, 0.334, 0.37, 0.184, 0.224, 0.196, 0.324, 0.192, 0.188, 0.202, 0.194, 0.15]
Unlearning task: 6
Accuracy, Confidence: (0.625, 0.8674854040145874)
broken out of loop
Accuracy, Confidence: (0.3359375, 0.8983510732650757)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4587, std=2.1038
[DEBUG][MIA] Test Set Loss:   mean=2.2843, std=2.4488
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.3529411764705882, 'auc': 0.61920166015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0864, std=2.3635
[DEBUG][MIA] Test Set Loss:   mean=2.0694, std=2.3455
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.1, 'auc': 0.49240000000000006, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2987, std=2.9169
[DEBUG][MIA] Test Set Loss:   mean=3.4451, std=3.3855
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.12549019607843137, 'auc': 0.60113525390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.1890, std=4.0454
[DEBUG][MIA] Test Set Loss:   mean=3.7440, std=3.5869
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.094, 'auc': 0.564832, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9078, std=3.4064
[DEBUG][MIA] Test Set Loss:   mean=4.3542, std=4.0994
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.19999999999999998, 'auc': 0.72900390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2045, std=3.8047
[DEBUG][MIA] Test Set Loss:   mean=4.1057, std=4.0514
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.092, 'auc': 0.5713440000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5360, std=2.6881
[DEBUG][MIA] Test Set Loss:   mean=2.7603, std=3.7156
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.24313725490196075, 'auc': 0.59991455078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6766, std=3.6995
[DEBUG][MIA] Test Set Loss:   mean=2.6941, std=3.3474
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11600000000000002, 'auc': 0.531424, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.4858, std=6.8744
[DEBUG][MIA] Test Set Loss:   mean=7.9882, std=7.2656
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.09803921568627451, 'auc': 0.55987548828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.2166, std=7.4500
[DEBUG][MIA] Test Set Loss:   mean=7.2906, std=7.8142
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.11000000000000001, 'auc': 0.5016, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.7123, std=8.3380
[DEBUG][MIA] Test Set Loss:   mean=10.8788, std=8.2729
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.07058823529411765, 'auc': 0.4493408203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.0939, std=8.3232
[DEBUG][MIA] Test Set Loss:   mean=10.7478, std=8.6331
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10200000000000001, 'auc': 0.4784320000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.5487, std=7.2837
[DEBUG][MIA] Test Set Loss:   mean=7.8255, std=6.5639
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.41015625, 'cv_acc': 0.09019607843137255, 'auc': 0.42071533203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.2905, std=7.4217
[DEBUG][MIA] Test Set Loss:   mean=7.5965, std=6.7360
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.088, 'auc': 0.46976799999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.0791, std=7.4565
[DEBUG][MIA] Test Set Loss:   mean=7.4868, std=6.8278
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.54791259765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2782, std=6.6615
[DEBUG][MIA] Test Set Loss:   mean=8.2138, std=7.3909
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.09, 'auc': 0.463728, 'task': 8}
Total correct retain:  880  Total retain:  2500
Total correct forget:  12921  Total forget:  47500
Total correct test:  188  Total test:  500
Total correct forget test:  2337  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.376, 0.46, 0.328, 0.274, 0.46, 0.302, 0.128, 0.184, 0.224, 0.212, 0.304, 0.198, 0.158, 0.2, 0.302, 0.21, 0.188, 0.212, 0.174, 0.156]
Unlearning task: 5
Accuracy, Confidence: (0.66015625, 0.8764834403991699)
broken out of loop
Accuracy, Confidence: (0.4765625, 0.9006255865097046)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3270, std=2.5454
[DEBUG][MIA] Test Set Loss:   mean=2.8066, std=3.2737
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.19215686274509805, 'auc': 0.64263916015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4538, std=3.2040
[DEBUG][MIA] Test Set Loss:   mean=2.8057, std=3.8853
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.088, 'auc': 0.4884160000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2193, std=2.1981
[DEBUG][MIA] Test Set Loss:   mean=2.9759, std=4.3845
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.20392156862745098, 'auc': 0.65447998046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.6209, std=3.8884
[DEBUG][MIA] Test Set Loss:   mean=2.8641, std=3.9450
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10200000000000001, 'auc': 0.5286879999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1779, std=2.6184
[DEBUG][MIA] Test Set Loss:   mean=3.1366, std=3.4996
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.3607843137254902, 'auc': 0.7081298828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.2577, std=3.7787
[DEBUG][MIA] Test Set Loss:   mean=3.1894, std=3.6343
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11400000000000002, 'auc': 0.510432, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8379, std=11.1328
[DEBUG][MIA] Test Set Loss:   mean=7.9665, std=11.3144
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.09803921568627451, 'auc': 0.656402587890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.9021, std=11.0097
[DEBUG][MIA] Test Set Loss:   mean=8.0779, std=12.5436
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.118, 'auc': 0.525136, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.9163, std=10.2715
[DEBUG][MIA] Test Set Loss:   mean=8.8823, std=9.7779
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.10980392156862746, 'auc': 0.55950927734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.6851, std=11.2234
[DEBUG][MIA] Test Set Loss:   mean=8.2851, std=9.6878
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10600000000000001, 'auc': 0.486416, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.3218, std=7.3425
[DEBUG][MIA] Test Set Loss:   mean=8.6286, std=8.6672
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.13725490196078433, 'auc': 0.5360107421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.5695, std=8.0405
[DEBUG][MIA] Test Set Loss:   mean=9.1582, std=8.4900
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.086, 'auc': 0.43928, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.1627, std=10.1295
[DEBUG][MIA] Test Set Loss:   mean=9.2661, std=8.5514
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10980392156862746, 'auc': 0.586669921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.4637, std=9.5970
[DEBUG][MIA] Test Set Loss:   mean=8.8244, std=8.8145
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11400000000000002, 'auc': 0.538032, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8492, std=4.9156
[DEBUG][MIA] Test Set Loss:   mean=4.6629, std=5.1400
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.10196078431372549, 'auc': 0.5614013671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1712, std=4.8038
[DEBUG][MIA] Test Set Loss:   mean=4.2097, std=4.6280
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.1, 'auc': 0.50928, 'task': 8}
Total correct retain:  1467  Total retain:  2500
Total correct forget:  13634  Total forget:  47500
Total correct test:  286  Total test:  500
Total correct forget test:  2528  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.572, 0.48, 0.486, 0.334, 0.362, 0.258, 0.264, 0.174, 0.288, 0.324, 0.266, 0.204, 0.192, 0.202, 0.306, 0.214, 0.184, 0.21, 0.17, 0.138]
Unlearning task: 4
Accuracy, Confidence: (0.71875, 0.8271627426147461)
broken out of loop
Accuracy, Confidence: (0.546875, 0.8061004877090454)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5521, std=2.7187
[DEBUG][MIA] Test Set Loss:   mean=3.2542, std=3.5299
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.19607843137254902, 'auc': 0.66033935546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6623, std=3.2283
[DEBUG][MIA] Test Set Loss:   mean=2.9875, std=3.4416
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.092, 'auc': 0.519168, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5317, std=2.4233
[DEBUG][MIA] Test Set Loss:   mean=2.8616, std=3.7711
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.14901960784313725, 'auc': 0.603759765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.7861, std=3.8753
[DEBUG][MIA] Test Set Loss:   mean=2.9120, std=3.6161
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.096, 'auc': 0.523824, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7596, std=2.6348
[DEBUG][MIA] Test Set Loss:   mean=4.3655, std=4.2981
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.22745098039215686, 'auc': 0.70904541015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0716, std=4.1973
[DEBUG][MIA] Test Set Loss:   mean=4.2425, std=4.1007
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.5171840000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.1371, std=6.4487
[DEBUG][MIA] Test Set Loss:   mean=6.4254, std=10.3375
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.12156862745098038, 'auc': 0.58123779296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7267, std=7.7899
[DEBUG][MIA] Test Set Loss:   mean=5.9986, std=8.9204
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10200000000000001, 'auc': 0.5189680000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.9012, std=9.3791
[DEBUG][MIA] Test Set Loss:   mean=6.7423, std=6.8140
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09411764705882353, 'auc': 0.4615478515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.8099, std=9.2781
[DEBUG][MIA] Test Set Loss:   mean=7.1832, std=8.3346
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.098, 'auc': 0.49107999999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=7.9287, std=7.4317
[DEBUG][MIA] Test Set Loss:   mean=9.5501, std=8.0623
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.56365966796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.4712, std=8.9468
[DEBUG][MIA] Test Set Loss:   mean=8.4665, std=8.1796
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10600000000000001, 'auc': 0.514992, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.9520, std=10.4445
[DEBUG][MIA] Test Set Loss:   mean=10.5388, std=9.6080
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.07058823529411765, 'auc': 0.53369140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.0546, std=10.0755
[DEBUG][MIA] Test Set Loss:   mean=10.7790, std=9.6249
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10800000000000001, 'auc': 0.538664, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.6913, std=4.8661
[DEBUG][MIA] Test Set Loss:   mean=4.9127, std=4.7755
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.08627450980392157, 'auc': 0.61236572265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.8148, std=4.9402
[DEBUG][MIA] Test Set Loss:   mean=4.9739, std=5.0025
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.122, 'auc': 0.51128, 'task': 8}
Total correct retain:  1407  Total retain:  2500
Total correct forget:  13187  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2416  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.556, 0.44, 0.446, 0.252, 0.344, 0.272, 0.236, 0.136, 0.27, 0.302, 0.264, 0.204, 0.168, 0.2, 0.31, 0.256, 0.194, 0.206, 0.186, 0.146]
Unlearning task: 3
Accuracy, Confidence: (0.60546875, 0.856035590171814)
broken out of loop
Accuracy, Confidence: (0.359375, 0.893528938293457)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6956, std=2.6042
[DEBUG][MIA] Test Set Loss:   mean=2.8046, std=2.9759
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.19607843137254902, 'auc': 0.6275634765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8016, std=3.5586
[DEBUG][MIA] Test Set Loss:   mean=3.0138, std=3.4429
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.118, 'auc': 0.525072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.3524, std=5.5210
[DEBUG][MIA] Test Set Loss:   mean=6.6638, std=7.4209
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.06666666666666667, 'auc': 0.58660888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.0018, std=6.0332
[DEBUG][MIA] Test Set Loss:   mean=6.7807, std=6.8153
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10400000000000001, 'auc': 0.5183760000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.1483, std=4.5445
[DEBUG][MIA] Test Set Loss:   mean=4.8516, std=5.4559
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.28627450980392155, 'auc': 0.619873046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.1265, std=5.5567
[DEBUG][MIA] Test Set Loss:   mean=5.5122, std=5.9547
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.092, 'auc': 0.5116320000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.9179, std=9.2869
[DEBUG][MIA] Test Set Loss:   mean=5.3569, std=8.8760
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.1215686274509804, 'auc': 0.56341552734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.9486, std=9.2641
[DEBUG][MIA] Test Set Loss:   mean=7.6924, std=11.7680
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.092, 'auc': 0.511096, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.4125, std=10.7724
[DEBUG][MIA] Test Set Loss:   mean=7.3462, std=8.0171
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.14509803921568626, 'auc': 0.4664306640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.6427, std=9.5852
[DEBUG][MIA] Test Set Loss:   mean=7.4786, std=8.7386
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.096, 'auc': 0.517856, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.0955, std=9.2147
[DEBUG][MIA] Test Set Loss:   mean=11.0715, std=10.1754
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.11764705882352941, 'auc': 0.4346923828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.3200, std=9.9646
[DEBUG][MIA] Test Set Loss:   mean=11.0713, std=10.1195
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.09, 'auc': 0.495416, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.5670, std=9.7218
[DEBUG][MIA] Test Set Loss:   mean=10.6570, std=10.2791
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.12941176470588237, 'auc': 0.421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.6600, std=10.1210
[DEBUG][MIA] Test Set Loss:   mean=9.5927, std=9.3429
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.098, 'auc': 0.513328, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.9062, std=6.4223
[DEBUG][MIA] Test Set Loss:   mean=7.3871, std=6.9458
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09411764705882353, 'auc': 0.57391357421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.7446, std=6.9113
[DEBUG][MIA] Test Set Loss:   mean=7.0676, std=6.2862
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.118, 'auc': 0.480576, 'task': 8}
Total correct retain:  1357  Total retain:  2500
Total correct forget:  12344  Total forget:  47500
Total correct test:  264  Total test:  500
Total correct forget test:  2280  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.528, 0.4, 0.26, 0.29, 0.338, 0.274, 0.21, 0.156, 0.23, 0.268, 0.24, 0.204, 0.17, 0.194, 0.314, 0.276, 0.2, 0.204, 0.178, 0.154]
Unlearning task: 2
Accuracy, Confidence: (0.5859375, 0.8480135798454285)
broken out of loop
Accuracy, Confidence: (0.40234375, 0.9088484048843384)
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 8, 6, 9, 6, 5, 5, 8, 6, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.4022, std=6.2932
[DEBUG][MIA] Test Set Loss:   mean=7.1299, std=6.5359
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.13333333333333333, 'auc': 0.593353271484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 7 7 8 5 9 6 9 9 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 5 6 7 5 5 8 5 5 7]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=7.6601, std=6.8331
[DEBUG][MIA] Test Set Loss:   mean=7.0541, std=6.6067
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.096, 'auc': 0.47460800000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 10, 11, 13, 12, 14, 14, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.5886, std=5.9685
[DEBUG][MIA] Test Set Loss:   mean=6.3970, std=8.0127
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.13333333333333333, 'auc': 0.5308837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [11 11 13 13 14 10 13 14 10 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [11 11 10 10 11 14 11 12 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.6085, std=7.1991
[DEBUG][MIA] Test Set Loss:   mean=6.6895, std=6.8730
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11200000000000002, 'auc': 0.5075919999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([15, 15, 18, 17, 19, 15, 17, 15, 19, 15], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.4258, std=3.9152
[DEBUG][MIA] Test Set Loss:   mean=3.7381, std=4.0225
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.23137254901960785, 'auc': 0.630645751953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 17 17 19 15 16 15 17 18 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 19 18 16 18 18 16 19 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0138, std=4.3687
[DEBUG][MIA] Test Set Loss:   mean=4.3545, std=4.5600
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10400000000000001, 'auc': 0.47847999999999996, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 24, 21, 24, 22, 22, 24, 20, 20, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.9250, std=10.9762
[DEBUG][MIA] Test Set Loss:   mean=11.6042, std=12.1319
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.12156862745098038, 'auc': 0.66595458984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [21 20 20 21 22 20 22 22 21 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 23 22 21 24 22 20 23 22 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.0721, std=9.2050
[DEBUG][MIA] Test Set Loss:   mean=8.6846, std=10.5101
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11400000000000002, 'auc': 0.518384, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([28, 28, 25, 26, 29, 25, 26, 29, 25, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.8454, std=10.8940
[DEBUG][MIA] Test Set Loss:   mean=10.2392, std=10.5016
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.0784313725490196, 'auc': 0.53179931640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [29 25 26 28 27 26 27 29 25 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 25 28 29 28 28 29 29 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.4673, std=11.1330
[DEBUG][MIA] Test Set Loss:   mean=9.7635, std=9.8419
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.47484800000000005, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([31, 33, 31, 34, 30, 33, 31, 30, 34, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.7714, std=6.0524
[DEBUG][MIA] Test Set Loss:   mean=5.6382, std=6.4331
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.14901960784313725, 'auc': 0.48101806640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 34 32 34 31 31 34 34 34 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 31 30 31 31 30 30 34 33 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3158, std=6.5762
[DEBUG][MIA] Test Set Loss:   mean=6.5872, std=6.5268
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.11400000000000002, 'auc': 0.568688, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([39, 35, 37, 37, 36, 36, 38, 39, 39, 36], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.0109, std=8.9198
[DEBUG][MIA] Test Set Loss:   mean=7.2368, std=7.3447
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.1411764705882353, 'auc': 0.5177001953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 38 37 37 38 37 35 39 37 36]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 39 38 37 39 39 36 36 35 39]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.2363, std=7.9597
[DEBUG][MIA] Test Set Loss:   mean=7.9056, std=7.4536
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.5545439999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([43, 41, 43, 43, 42, 44, 41, 44, 42, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.2798, std=4.5167
[DEBUG][MIA] Test Set Loss:   mean=5.3862, std=4.3714
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.09411764705882353, 'auc': 0.41033935546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 42 41 42 41 43 41 41 42 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 44 40 44 44 42 44 40 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.2268, std=4.5469
[DEBUG][MIA] Test Set Loss:   mean=4.9962, std=4.5033
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.48263200000000006, 'task': 8}
Total correct retain:  1430  Total retain:  2500
Total correct forget:  12154  Total forget:  47500
Total correct test:  256  Total test:  500
Total correct forget test:  2271  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.512, 0.282, 0.286, 0.32, 0.226, 0.242, 0.266, 0.174, 0.2, 0.364, 0.226, 0.232, 0.21, 0.196, 0.314, 0.278, 0.192, 0.206, 0.196, 0.132]
