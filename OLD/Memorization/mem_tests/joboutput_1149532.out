Requirement already satisfied: pyyaml in /usr/lib64/python3.12/site-packages (6.0.1)
Requirement already satisfied: setuptools in /usr/lib/python3.12/site-packages (68.2.2)
Requirement already satisfied: matplotlib in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.10.1)
Requirement already satisfied: contourpy>=1.0.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler>=0.10 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy>=1.23 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.2.4)
Requirement already satisfied: packaging>=20.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow>=8 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing>=2.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: quadprog in /dcs/21/u2110391/.local/lib/python3.12/site-packages (0.1.13)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from quadprog) (2.2.4)
Requirement already satisfied: pyparsing in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.2.3)
Requirement already satisfied: pandas in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.3)
Requirement already satisfied: numpy>=1.26.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.4)
Sat Apr 26 21:28:57 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 35%   67C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: neggem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 21:29:03 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 27%   66C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['bed', 'train', 'porcupine', 'plates', 'baby', 'cattle', 'castle', 'raccoon', 'camel', 'lizard', 'trout', 'maple', 'house', 'cockroach', 'telephone', 'skyscraper', 'woman', 'butterfly', 'lion', 'shark', 'leopard', 'beetle', 'tank', 'beaver', 'tractor', 'television', 'snake', 'lawn-mower', 'otter', 'snail', 'bee', 'elephant', 'mushrooms', 'turtle', 'pears', 'lobster', 'clock', 'lamp', 'table', 'tulips', 'crab', 'crocodile', 'dolphin', 'orchids', 'flatfish', 'sweet peppers', 'caterpillar', 'skunk', 'palm', 'wardrobe', 'seal', 'rocket', 'squirrel', 'sunflowers', 'rabbit', 'bowls', 'road', 'pine', 'computer keyboard', 'bridge', 'poppies', 'roses', 'forest', 'bus', 'pickup truck', 'couch', 'kangaroo', 'wolf', 'plain', 'ray', 'mouse', 'dinosaur', 'chimpanzee', 'possum', 'chair', 'tiger', 'girl', 'boy', 'fox', 'cups', 'oak', 'mountain', 'streetcar', 'bicycle', 'oranges', 'motorcycle', 'man', 'worm', 'shrew', 'bottles', 'bear', 'willow', 'spider', 'hamster', 'aquarium fish', 'apples', 'whale', 'sea', 'cans', 'cloud']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2106  Total retain:  2500
Total correct forget:  8925  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  1795  Total test forget:  9500
After learning task 1
Task accuracies: [0.674, 0.192, 0.222, 0.256, 0.142, 0.206, 0.192, 0.188, 0.138, 0.142, 0.192, 0.178, 0.21, 0.19, 0.134, 0.214, 0.224, 0.182, 0.2, 0.188]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2773, std=0.9522
[DEBUG][MIA] Test Set Loss:   mean=1.9641, std=2.9289
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.627450980392157, 'auc': 0.712921142578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1884, std=0.7659
[DEBUG][MIA] Test Set Loss:   mean=2.0806, std=3.4076
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.67, 'cv_acc': 0.5700000000000001, 'auc': 0.726048, 'task': 1}
2 1
Total correct retain:  1800  Total retain:  2500
Total correct forget:  10673  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  1942  Total test forget:  9500
After learning task 2
Task accuracies: [0.64, 0.578, 0.206, 0.172, 0.188, 0.182, 0.146, 0.192, 0.156, 0.158, 0.2, 0.194, 0.22, 0.174, 0.144, 0.176, 0.23, 0.214, 0.2, 0.154]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0094, std=0.0339
[DEBUG][MIA] Test Set Loss:   mean=2.3923, std=3.6683
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7294117647058824, 'auc': 0.834381103515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.7811, std=1.6399
[DEBUG][MIA] Test Set Loss:   mean=2.5496, std=3.6817
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.21200000000000002, 'auc': 0.641016, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0246, std=0.2436
[DEBUG][MIA] Test Set Loss:   mean=0.8413, std=2.2011
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.16862745098039217, 'auc': 0.690887451171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0473, std=0.4176
[DEBUG][MIA] Test Set Loss:   mean=0.6245, std=2.0700
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.21000000000000002, 'auc': 0.651632, 'task': 2}
3 2
Total correct retain:  1693  Total retain:  2500
Total correct forget:  12805  Total forget:  47500
Total correct test:  319  Total test:  500
Total correct forget test:  2366  Total test forget:  9500
After learning task 3
Task accuracies: [0.638, 0.568, 0.85, 0.232, 0.176, 0.14, 0.174, 0.198, 0.226, 0.134, 0.208, 0.208, 0.274, 0.202, 0.164, 0.178, 0.218, 0.208, 0.198, 0.176]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0064
[DEBUG][MIA] Test Set Loss:   mean=2.5896, std=4.2293
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7058823529411765, 'auc': 0.86187744140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9508, std=2.0115
[DEBUG][MIA] Test Set Loss:   mean=2.5727, std=3.7680
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.164, 'auc': 0.636584, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0469
[DEBUG][MIA] Test Set Loss:   mean=1.0022, std=2.6962
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2392156862745098, 'auc': 0.673370361328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4657, std=1.3176
[DEBUG][MIA] Test Set Loss:   mean=0.9874, std=2.4315
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.18, 'auc': 0.5715439999999999, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0311, std=0.1533
[DEBUG][MIA] Test Set Loss:   mean=0.9708, std=2.3122
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2235294117647059, 'auc': 0.6973876953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0205, std=0.1566
[DEBUG][MIA] Test Set Loss:   mean=0.9342, std=2.2211
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.20800000000000002, 'auc': 0.6989040000000001, 'task': 3}
4 3
Total correct retain:  1698  Total retain:  2500
Total correct forget:  14273  Total forget:  47500
Total correct test:  323  Total test:  500
Total correct forget test:  2600  Total test forget:  9500
After learning task 4
Task accuracies: [0.646, 0.562, 0.788, 0.792, 0.262, 0.132, 0.18, 0.21, 0.228, 0.216, 0.138, 0.2, 0.284, 0.154, 0.17, 0.156, 0.254, 0.174, 0.2, 0.1]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=2.7086, std=3.7763
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7607843137254902, 'auc': 0.8956298828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4552, std=2.8219
[DEBUG][MIA] Test Set Loss:   mean=2.5152, std=3.6668
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.17200000000000001, 'auc': 0.597008, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0150
[DEBUG][MIA] Test Set Loss:   mean=1.3782, std=2.8167
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2823529411764706, 'auc': 0.725616455078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7017, std=1.7614
[DEBUG][MIA] Test Set Loss:   mean=1.2886, std=2.7653
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.154, 'auc': 0.560968, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0075, std=0.0463
[DEBUG][MIA] Test Set Loss:   mean=1.1456, std=2.5501
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2745098039215686, 'auc': 0.778167724609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4257, std=1.2704
[DEBUG][MIA] Test Set Loss:   mean=1.1030, std=2.6002
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.192, 'auc': 0.62388, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0235, std=0.1452
[DEBUG][MIA] Test Set Loss:   mean=1.0205, std=2.3724
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2156862745098039, 'auc': 0.741119384765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0298, std=0.2090
[DEBUG][MIA] Test Set Loss:   mean=1.0559, std=2.3392
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.632, 'cv_acc': 0.24, 'auc': 0.74196, 'task': 4}
5 4
Total correct retain:  1638  Total retain:  2500
Total correct forget:  15490  Total forget:  47500
Total correct test:  311  Total test:  500
Total correct forget test:  2748  Total test forget:  9500
After learning task 5
Task accuracies: [0.622, 0.536, 0.748, 0.732, 0.74, 0.108, 0.138, 0.22, 0.19, 0.212, 0.166, 0.19, 0.3, 0.172, 0.124, 0.22, 0.212, 0.208, 0.2, 0.08]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.5212, std=3.8886
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7725490196078432, 'auc': 0.88470458984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6700, std=2.8373
[DEBUG][MIA] Test Set Loss:   mean=2.5564, std=3.8381
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.182, 'auc': 0.57984, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.3688, std=2.5524
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2784313725490196, 'auc': 0.7958984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6451, std=1.7623
[DEBUG][MIA] Test Set Loss:   mean=1.2245, std=2.4838
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.446, 'cv_acc': 0.092, 'auc': 0.403056, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0170
[DEBUG][MIA] Test Set Loss:   mean=1.8185, std=3.3054
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.4470588235294118, 'auc': 0.821563720703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6008, std=1.6741
[DEBUG][MIA] Test Set Loss:   mean=1.6443, std=3.3232
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.12400000000000003, 'auc': 0.58884, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=1.3275, std=2.2317
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.7568627450980392, 'auc': 0.7711181640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5785, std=1.5909
[DEBUG][MIA] Test Set Loss:   mean=1.7797, std=2.8572
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.22999999999999998, 'auc': 0.637016, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0550, std=0.3437
[DEBUG][MIA] Test Set Loss:   mean=1.5645, std=3.0351
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.27450980392156865, 'auc': 0.7423095703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0270, std=0.1233
[DEBUG][MIA] Test Set Loss:   mean=1.3662, std=2.8162
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.296, 'auc': 0.734472, 'task': 5}
6 5
Total correct retain:  1612  Total retain:  2500
Total correct forget:  17371  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  3053  Total test forget:  9500
After learning task 6
Task accuracies: [0.604, 0.538, 0.742, 0.69, 0.626, 0.702, 0.174, 0.2, 0.222, 0.258, 0.192, 0.224, 0.312, 0.192, 0.118, 0.184, 0.232, 0.18, 0.202, 0.118]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=2.4664, std=3.6221
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7607843137254902, 'auc': 0.8541259765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7917, std=3.0238
[DEBUG][MIA] Test Set Loss:   mean=2.6225, std=4.1562
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.174, 'auc': 0.5522879999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0179
[DEBUG][MIA] Test Set Loss:   mean=1.1334, std=2.8221
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.2431372549019608, 'auc': 0.74822998046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0991, std=2.6195
[DEBUG][MIA] Test Set Loss:   mean=1.4567, std=3.0412
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10400000000000001, 'auc': 0.46104, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0055
[DEBUG][MIA] Test Set Loss:   mean=1.6415, std=3.3548
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2980392156862745, 'auc': 0.81756591796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3446, std=2.6212
[DEBUG][MIA] Test Set Loss:   mean=1.6311, std=2.7585
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.1, 'auc': 0.54616, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=1.8927, std=2.8431
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7411764705882353, 'auc': 0.90631103515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6413, std=1.5946
[DEBUG][MIA] Test Set Loss:   mean=1.9016, std=3.0334
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.20800000000000002, 'auc': 0.666152, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=1.8161, std=3.1784
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7254901960784315, 'auc': 0.754425048828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3307, std=0.9302
[DEBUG][MIA] Test Set Loss:   mean=1.9310, std=3.2471
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.246, 'auc': 0.6599119999999999, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0173, std=0.0971
[DEBUG][MIA] Test Set Loss:   mean=1.1597, std=2.2066
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.27450980392156865, 'auc': 0.764129638671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0337, std=0.2171
[DEBUG][MIA] Test Set Loss:   mean=1.7882, std=3.1266
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.682, 'cv_acc': 0.244, 'auc': 0.77352, 'task': 6}
7 6
Total correct retain:  1583  Total retain:  2500
Total correct forget:  18401  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  3194  Total test forget:  9500
After learning task 7
Task accuracies: [0.6, 0.54, 0.744, 0.664, 0.58, 0.604, 0.688, 0.204, 0.208, 0.19, 0.192, 0.2, 0.268, 0.216, 0.128, 0.208, 0.234, 0.178, 0.198, 0.144]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=2.4592, std=3.7668
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7843137254901961, 'auc': 0.883697509765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0138, std=3.3409
[DEBUG][MIA] Test Set Loss:   mean=2.7823, std=3.9108
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11400000000000002, 'auc': 0.5684400000000001, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0406
[DEBUG][MIA] Test Set Loss:   mean=1.3188, std=2.5829
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2901960784313725, 'auc': 0.752899169921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1371, std=2.6217
[DEBUG][MIA] Test Set Loss:   mean=1.5123, std=3.0107
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.5451999999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=1.5758, std=2.9645
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.30196078431372547, 'auc': 0.80267333984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9947, std=2.2876
[DEBUG][MIA] Test Set Loss:   mean=1.5525, std=2.7122
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.15599999999999997, 'auc': 0.559304, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.8897, std=2.8259
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7529411764705882, 'auc': 0.880615234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0209, std=2.1764
[DEBUG][MIA] Test Set Loss:   mean=2.2167, std=3.0823
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.188, 'auc': 0.6473279999999999, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=2.2698, std=3.7201
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7254901960784312, 'auc': 0.794097900390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8713, std=1.9183
[DEBUG][MIA] Test Set Loss:   mean=2.3565, std=3.5669
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.16, 'auc': 0.611, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=2.5299, std=3.5332
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.2980392156862745, 'auc': 0.865692138671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6162, std=1.7063
[DEBUG][MIA] Test Set Loss:   mean=2.0060, std=3.2589
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.196, 'auc': 0.662032, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0718, std=0.4678
[DEBUG][MIA] Test Set Loss:   mean=1.9870, std=3.6923
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.28627450980392155, 'auc': 0.7703857421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0390, std=0.2490
[DEBUG][MIA] Test Set Loss:   mean=2.0210, std=3.4323
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.694, 'cv_acc': 0.256, 'auc': 0.758528, 'task': 7}
8 7
Total correct retain:  1591  Total retain:  2500
Total correct forget:  19391  Total forget:  47500
Total correct test:  299  Total test:  500
Total correct forget test:  3341  Total test forget:  9500
After learning task 8
Task accuracies: [0.598, 0.536, 0.716, 0.662, 0.566, 0.596, 0.614, 0.668, 0.196, 0.208, 0.212, 0.184, 0.176, 0.146, 0.142, 0.2, 0.3, 0.166, 0.2, 0.194]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.5008, std=3.5582
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7803921568627452, 'auc': 0.88848876953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1217, std=3.5761
[DEBUG][MIA] Test Set Loss:   mean=2.6620, std=3.9241
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.1, 'auc': 0.5505680000000001, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0202, std=0.1242
[DEBUG][MIA] Test Set Loss:   mean=1.4352, std=3.2918
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.23529411764705882, 'auc': 0.706146240234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1991, std=2.8265
[DEBUG][MIA] Test Set Loss:   mean=1.4826, std=3.4721
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.46591999999999995, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.6354, std=2.6874
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6705882352941177, 'auc': 0.830657958984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0704, std=2.1986
[DEBUG][MIA] Test Set Loss:   mean=1.8184, std=3.2026
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11399999999999999, 'auc': 0.5471360000000001, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.9475, std=2.8080
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.776470588235294, 'auc': 0.86865234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2206, std=2.3918
[DEBUG][MIA] Test Set Loss:   mean=1.9854, std=3.0593
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.2, 'auc': 0.5968, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=2.1234, std=3.2108
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7294117647058824, 'auc': 0.85162353515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9231, std=2.2613
[DEBUG][MIA] Test Set Loss:   mean=2.0389, std=3.4743
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.194, 'auc': 0.623136, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.2108, std=3.2404
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7450980392156863, 'auc': 0.838897705078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0457, std=2.2987
[DEBUG][MIA] Test Set Loss:   mean=2.1791, std=3.2900
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.21799999999999997, 'auc': 0.640608, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0060, std=0.0261
[DEBUG][MIA] Test Set Loss:   mean=2.1746, std=3.5219
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7450980392156863, 'auc': 0.767547607421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3577, std=1.3954
[DEBUG][MIA] Test Set Loss:   mean=1.9571, std=3.1668
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.25, 'auc': 0.687024, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0290, std=0.2395
[DEBUG][MIA] Test Set Loss:   mean=0.7970, std=2.0401
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.20784313725490197, 'auc': 0.70123291015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0272, std=0.2562
[DEBUG][MIA] Test Set Loss:   mean=0.9607, std=2.4719
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.21999999999999997, 'auc': 0.699208, 'task': 8}
Total correct retain:  1664  Total retain:  2500
Total correct forget:  20958  Total forget:  47500
Total correct test:  310  Total test:  500
Total correct forget test:  3599  Total test forget:  9500
After learning task 9
Task accuracies: [0.62, 0.516, 0.74, 0.652, 0.58, 0.61, 0.57, 0.622, 0.82, 0.192, 0.222, 0.178, 0.178, 0.138, 0.142, 0.206, 0.298, 0.158, 0.192, 0.184]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=3.0746, std=4.3924
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.7372549019607844, 'auc': 0.883453369140625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2229, std=3.5906
[DEBUG][MIA] Test Set Loss:   mean=2.9975, std=4.5425
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.5612, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0306, std=0.2239
[DEBUG][MIA] Test Set Loss:   mean=1.3676, std=2.9643
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.21960784313725493, 'auc': 0.728546142578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0833, std=2.7301
[DEBUG][MIA] Test Set Loss:   mean=1.3141, std=2.7642
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.10200000000000001, 'auc': 0.454024, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=1.7545, std=3.0878
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2941176470588235, 'auc': 0.802337646484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5070, std=2.9670
[DEBUG][MIA] Test Set Loss:   mean=1.5966, std=3.1693
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.136, 'auc': 0.5367679999999999, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.2351, std=3.4632
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7529411764705883, 'auc': 0.88226318359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3361, std=2.7750
[DEBUG][MIA] Test Set Loss:   mean=2.2216, std=3.2300
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.19, 'auc': 0.591984, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.8961, std=3.2503
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7176470588235293, 'auc': 0.86004638671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9263, std=2.1350
[DEBUG][MIA] Test Set Loss:   mean=2.2594, std=3.5059
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.21599999999999997, 'auc': 0.628592, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=2.7031, std=3.8152
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7372549019607844, 'auc': 0.88287353515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0507, std=2.1955
[DEBUG][MIA] Test Set Loss:   mean=2.4515, std=3.7510
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.144, 'auc': 0.6326639999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=1.6894, std=2.6624
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.6980392156862745, 'auc': 0.84735107421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2991, std=1.0167
[DEBUG][MIA] Test Set Loss:   mean=1.8367, std=3.0703
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.63, 'cv_acc': 0.22600000000000003, 'auc': 0.695736, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.1195, std=2.4007
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.25098039215686274, 'auc': 0.81689453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1364, std=0.5185
[DEBUG][MIA] Test Set Loss:   mean=1.2450, std=2.7500
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.2, 'auc': 0.67452, 'task': 8}
Total correct retain:  1614  Total retain:  2500
Total correct forget:  22140  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  3837  Total test forget:  9500
After learning task 10
Task accuracies: [0.64, 0.53, 0.742, 0.656, 0.56, 0.628, 0.566, 0.62, 0.762, 0.896, 0.196, 0.18, 0.186, 0.136, 0.124, 0.208, 0.302, 0.11, 0.19, 0.082]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=2.6383, std=4.2230
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7176470588235294, 'auc': 0.849639892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0448, std=3.7925
[DEBUG][MIA] Test Set Loss:   mean=2.8667, std=4.2488
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.12600000000000003, 'auc': 0.581144, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0137, std=0.0834
[DEBUG][MIA] Test Set Loss:   mean=1.8388, std=3.3312
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.26666666666666666, 'auc': 0.767059326171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3218, std=3.3030
[DEBUG][MIA] Test Set Loss:   mean=1.7415, std=3.5920
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.128, 'auc': 0.5562400000000001, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=2.1132, std=3.3982
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7254901960784313, 'auc': 0.840301513671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4385, std=2.8559
[DEBUG][MIA] Test Set Loss:   mean=2.2230, std=3.4741
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.132, 'auc': 0.5891040000000001, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=2.6402, std=3.2685
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7372549019607844, 'auc': 0.878814697265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3903, std=2.5370
[DEBUG][MIA] Test Set Loss:   mean=2.5894, std=3.5724
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.122, 'auc': 0.588584, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=2.1987, std=3.4971
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7098039215686275, 'auc': 0.88665771484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1349, std=2.5471
[DEBUG][MIA] Test Set Loss:   mean=2.2592, std=3.9597
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13999999999999999, 'auc': 0.55656, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=2.0438, std=2.9500
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7254901960784313, 'auc': 0.87091064453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4615, std=2.7576
[DEBUG][MIA] Test Set Loss:   mean=2.0827, std=3.0345
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.20800000000000002, 'auc': 0.5945760000000001, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=2.4868, std=3.7727
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7372549019607842, 'auc': 0.83660888671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6657, std=1.6668
[DEBUG][MIA] Test Set Loss:   mean=2.2947, std=3.3919
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.19, 'auc': 0.653328, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.3790, std=2.5529
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2941176470588235, 'auc': 0.817291259765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4907, std=1.3325
[DEBUG][MIA] Test Set Loss:   mean=1.2769, std=2.4069
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.21200000000000002, 'auc': 0.5923999999999999, 'task': 8}
Total correct retain:  1549  Total retain:  2500
Total correct forget:  23415  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  4078  Total test forget:  9500
After learning task 11
Task accuracies: [0.63, 0.538, 0.726, 0.62, 0.568, 0.618, 0.546, 0.586, 0.684, 0.818, 0.716, 0.198, 0.198, 0.148, 0.138, 0.23, 0.322, 0.164, 0.192, 0.146]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0571, std=0.2105
[DEBUG][MIA] Test Set Loss:   mean=2.2260, std=3.2914
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6705882352941176, 'auc': 0.772186279296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7052, std=2.9490
[DEBUG][MIA] Test Set Loss:   mean=2.4919, std=3.6107
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.10200000000000001, 'auc': 0.571984, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1465, std=0.5447
[DEBUG][MIA] Test Set Loss:   mean=1.6504, std=3.1333
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.23137254901960785, 'auc': 0.669097900390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3948, std=2.9650
[DEBUG][MIA] Test Set Loss:   mean=1.7051, std=3.1505
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.5420400000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0210, std=0.0686
[DEBUG][MIA] Test Set Loss:   mean=1.8832, std=2.7873
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6627450980392157, 'auc': 0.78448486328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6773, std=2.9105
[DEBUG][MIA] Test Set Loss:   mean=1.7245, std=2.6361
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.13599999999999998, 'auc': 0.5436719999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0758, std=0.1613
[DEBUG][MIA] Test Set Loss:   mean=2.0786, std=2.8443
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6941176470588235, 'auc': 0.79351806640625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1160, std=2.0389
[DEBUG][MIA] Test Set Loss:   mean=2.0967, std=2.7802
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.10800000000000001, 'auc': 0.6290639999999998, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0913, std=0.4041
[DEBUG][MIA] Test Set Loss:   mean=1.9635, std=3.1447
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6431372549019607, 'auc': 0.763427734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4953, std=2.6073
[DEBUG][MIA] Test Set Loss:   mean=1.8916, std=2.9074
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.14200000000000002, 'auc': 0.543952, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0830, std=0.3151
[DEBUG][MIA] Test Set Loss:   mean=1.7610, std=2.6291
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7137254901960783, 'auc': 0.79693603515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5281, std=2.6228
[DEBUG][MIA] Test Set Loss:   mean=1.9152, std=2.9802
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.196, 'auc': 0.557096, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0305, std=0.0847
[DEBUG][MIA] Test Set Loss:   mean=2.1589, std=3.1843
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7372549019607842, 'auc': 0.76983642578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6189, std=1.3251
[DEBUG][MIA] Test Set Loss:   mean=1.7875, std=2.6996
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.178, 'auc': 0.6406879999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0597, std=0.2184
[DEBUG][MIA] Test Set Loss:   mean=1.5346, std=2.4100
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6431372549019608, 'auc': 0.78314208984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7046, std=1.6115
[DEBUG][MIA] Test Set Loss:   mean=1.4498, std=2.2830
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.162, 'auc': 0.637056, 'task': 8}
Total correct retain:  1595  Total retain:  2500
Total correct forget:  20692  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  3701  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.63, 0.52, 0.678, 0.602, 0.494, 0.602, 0.524, 0.592, 0.638, 0.808, 0.24, 0.18, 0.184, 0.152, 0.152, 0.224, 0.308, 0.152, 0.196, 0.156]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0155, std=0.0369
[DEBUG][MIA] Test Set Loss:   mean=2.4768, std=3.2115
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7411764705882353, 'auc': 0.830841064453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8637, std=2.7915
[DEBUG][MIA] Test Set Loss:   mean=1.7930, std=2.6476
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.18, 'auc': 0.5111840000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0136, std=0.0402
[DEBUG][MIA] Test Set Loss:   mean=0.6325, std=1.4703
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2392156862745098, 'auc': 0.6866455078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8875, std=1.8508
[DEBUG][MIA] Test Set Loss:   mean=1.1106, std=2.2961
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.092, 'auc': 0.554056, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0180
[DEBUG][MIA] Test Set Loss:   mean=0.9090, std=1.5876
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7372549019607844, 'auc': 0.81243896484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9413, std=1.8287
[DEBUG][MIA] Test Set Loss:   mean=1.2831, std=1.9947
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.096, 'auc': 0.584688, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0243, std=0.0444
[DEBUG][MIA] Test Set Loss:   mean=1.5513, std=2.0193
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.7411764705882353, 'auc': 0.88201904296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1909, std=1.8404
[DEBUG][MIA] Test Set Loss:   mean=1.9519, std=2.4037
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.11200000000000002, 'auc': 0.6089119999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0238, std=0.0456
[DEBUG][MIA] Test Set Loss:   mean=2.0374, std=3.0771
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.27450980392156865, 'auc': 0.805572509765625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0185, std=1.8316
[DEBUG][MIA] Test Set Loss:   mean=1.5519, std=2.5450
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.144, 'auc': 0.575704, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0313, std=0.0595
[DEBUG][MIA] Test Set Loss:   mean=1.8224, std=2.3655
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7803921568627452, 'auc': 0.810699462890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1186, std=1.8413
[DEBUG][MIA] Test Set Loss:   mean=1.7142, std=2.3907
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.176, 'auc': 0.577216, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0488, std=0.1646
[DEBUG][MIA] Test Set Loss:   mean=1.9315, std=2.7955
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7176470588235294, 'auc': 0.842041015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8402, std=1.6011
[DEBUG][MIA] Test Set Loss:   mean=1.6408, std=2.6565
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.20600000000000002, 'auc': 0.600512, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0313, std=0.0509
[DEBUG][MIA] Test Set Loss:   mean=1.4931, std=2.1913
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6235294117647058, 'auc': 0.8065185546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5519, std=1.2155
[DEBUG][MIA] Test Set Loss:   mean=1.2055, std=1.7924
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.20600000000000002, 'auc': 0.6320319999999999, 'task': 8}
Total correct retain:  1569  Total retain:  2500
Total correct forget:  19819  Total forget:  47500
Total correct test:  316  Total test:  500
Total correct forget test:  3570  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.632, 0.566, 0.744, 0.646, 0.542, 0.606, 0.53, 0.574, 0.638, 0.252, 0.236, 0.204, 0.188, 0.198, 0.146, 0.236, 0.29, 0.194, 0.2, 0.15]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0145, std=0.0367
[DEBUG][MIA] Test Set Loss:   mean=1.7777, std=2.6998
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7568627450980392, 'auc': 0.8504638671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4080, std=2.1884
[DEBUG][MIA] Test Set Loss:   mean=1.9552, std=2.7726
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11200000000000002, 'auc': 0.561072, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0567, std=0.2739
[DEBUG][MIA] Test Set Loss:   mean=1.1199, std=2.2809
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.38823529411764707, 'auc': 0.73138427734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0792, std=2.2137
[DEBUG][MIA] Test Set Loss:   mean=1.2662, std=2.2756
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.094, 'auc': 0.543984, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0073, std=0.0163
[DEBUG][MIA] Test Set Loss:   mean=1.5036, std=2.3302
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.6941176470588235, 'auc': 0.844940185546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0633, std=2.0452
[DEBUG][MIA] Test Set Loss:   mean=1.2256, std=1.9838
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.12600000000000003, 'auc': 0.566192, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0168, std=0.0311
[DEBUG][MIA] Test Set Loss:   mean=1.7443, std=2.4440
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.6980392156862746, 'auc': 0.826812744140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3353, std=2.1035
[DEBUG][MIA] Test Set Loss:   mean=1.9005, std=2.4350
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.152, 'auc': 0.5891839999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0336, std=0.0748
[DEBUG][MIA] Test Set Loss:   mean=1.9781, std=2.8654
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.6745098039215687, 'auc': 0.79046630859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0238, std=1.8312
[DEBUG][MIA] Test Set Loss:   mean=1.5112, std=2.3825
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.13399999999999998, 'auc': 0.545904, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0758, std=0.2269
[DEBUG][MIA] Test Set Loss:   mean=2.0094, std=2.3411
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7333333333333332, 'auc': 0.82281494140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4079, std=2.1000
[DEBUG][MIA] Test Set Loss:   mean=1.8647, std=2.4503
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.152, 'auc': 0.547712, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1114, std=0.2789
[DEBUG][MIA] Test Set Loss:   mean=1.9871, std=2.8867
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.7098039215686274, 'auc': 0.78997802734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7672, std=1.4555
[DEBUG][MIA] Test Set Loss:   mean=1.9304, std=2.5354
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.202, 'auc': 0.6490079999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.2356, std=3.0659
[DEBUG][MIA] Test Set Loss:   mean=2.1205, std=2.0870
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10196078431372549, 'auc': 0.54998779296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.2606, std=2.5230
[DEBUG][MIA] Test Set Loss:   mean=2.3200, std=2.2576
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.13799999999999998, 'auc': 0.526144, 'task': 8}
Total correct retain:  1560  Total retain:  2500
Total correct forget:  18846  Total forget:  47500
Total correct test:  304  Total test:  500
Total correct forget test:  3412  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.608, 0.568, 0.72, 0.65, 0.546, 0.588, 0.494, 0.524, 0.294, 0.3, 0.256, 0.206, 0.226, 0.192, 0.14, 0.21, 0.336, 0.204, 0.204, 0.166]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0353, std=0.0657
[DEBUG][MIA] Test Set Loss:   mean=1.1554, std=1.8171
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7490196078431373, 'auc': 0.768280029296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3919, std=2.0594
[DEBUG][MIA] Test Set Loss:   mean=1.6622, std=2.3057
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10200000000000001, 'auc': 0.5256160000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0396, std=0.0949
[DEBUG][MIA] Test Set Loss:   mean=1.0288, std=1.8753
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.4, 'auc': 0.74456787109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0155, std=1.8043
[DEBUG][MIA] Test Set Loss:   mean=1.0050, std=1.8461
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.494032, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0238, std=0.0615
[DEBUG][MIA] Test Set Loss:   mean=1.1334, std=1.8123
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.5647058823529413, 'auc': 0.75836181640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8839, std=1.4699
[DEBUG][MIA] Test Set Loss:   mean=1.1937, std=1.7917
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10800000000000001, 'auc': 0.561408, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0358, std=0.0555
[DEBUG][MIA] Test Set Loss:   mean=1.4259, std=1.7277
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7372549019607844, 'auc': 0.8658447265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8072, std=1.3311
[DEBUG][MIA] Test Set Loss:   mean=1.4099, std=1.8363
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.202, 'auc': 0.608112, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0666, std=0.1759
[DEBUG][MIA] Test Set Loss:   mean=1.4725, std=2.0375
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6745098039215687, 'auc': 0.809326171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9419, std=1.5404
[DEBUG][MIA] Test Set Loss:   mean=1.5029, std=2.1039
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.13799999999999998, 'auc': 0.5650080000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0374, std=0.0416
[DEBUG][MIA] Test Set Loss:   mean=1.5383, std=1.7829
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7803921568627451, 'auc': 0.8685302734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0496, std=1.4894
[DEBUG][MIA] Test Set Loss:   mean=1.5821, std=1.8325
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.154, 'auc': 0.5991679999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8408, std=1.8279
[DEBUG][MIA] Test Set Loss:   mean=2.3761, std=1.8809
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.12941176470588234, 'auc': 0.6153564453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2197, std=1.7351
[DEBUG][MIA] Test Set Loss:   mean=2.3004, std=1.8619
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.134, 'auc': 0.5059199999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.4253, std=2.9356
[DEBUG][MIA] Test Set Loss:   mean=2.5041, std=2.1028
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.11372549019607843, 'auc': 0.57733154296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.4900, std=2.3988
[DEBUG][MIA] Test Set Loss:   mean=2.4313, std=2.2269
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10800000000000001, 'auc': 0.513408, 'task': 8}
Total correct retain:  1577  Total retain:  2500
Total correct forget:  17670  Total forget:  47500
Total correct test:  318  Total test:  500
Total correct forget test:  3266  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.636, 0.566, 0.73, 0.642, 0.554, 0.604, 0.514, 0.286, 0.272, 0.282, 0.272, 0.204, 0.216, 0.156, 0.132, 0.206, 0.278, 0.198, 0.21, 0.21]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0916, std=0.1843
[DEBUG][MIA] Test Set Loss:   mean=1.8045, std=2.0819
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7098039215686274, 'auc': 0.8046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3397, std=1.8703
[DEBUG][MIA] Test Set Loss:   mean=1.7557, std=2.0683
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.446, 'cv_acc': 0.10800000000000001, 'auc': 0.43612799999999996, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0769, std=0.2215
[DEBUG][MIA] Test Set Loss:   mean=1.0958, std=1.8447
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.39215686274509803, 'auc': 0.7586669921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0990, std=1.6784
[DEBUG][MIA] Test Set Loss:   mean=0.8966, std=1.4930
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.11200000000000002, 'auc': 0.47598399999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0613, std=0.1238
[DEBUG][MIA] Test Set Loss:   mean=1.0050, std=1.3941
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.580392156862745, 'auc': 0.79986572265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9863, std=1.5781
[DEBUG][MIA] Test Set Loss:   mean=1.0159, std=1.5683
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.5306879999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.1037, std=0.1526
[DEBUG][MIA] Test Set Loss:   mean=1.2816, std=1.6099
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7098039215686275, 'auc': 0.8082275390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1008, std=1.6054
[DEBUG][MIA] Test Set Loss:   mean=1.4384, std=1.6582
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.138, 'auc': 0.5881280000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0789, std=0.1146
[DEBUG][MIA] Test Set Loss:   mean=1.3003, std=1.7949
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.6588235294117648, 'auc': 0.7490234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0015, std=1.4033
[DEBUG][MIA] Test Set Loss:   mean=1.2321, std=1.7859
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.156, 'auc': 0.517952, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9432, std=1.9623
[DEBUG][MIA] Test Set Loss:   mean=2.3648, std=2.1221
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10196078431372549, 'auc': 0.56304931640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.2550, std=2.0941
[DEBUG][MIA] Test Set Loss:   mean=2.3500, std=1.9476
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.4622879999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.7088, std=1.3998
[DEBUG][MIA] Test Set Loss:   mean=1.9376, std=1.4481
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.09019607843137253, 'auc': 0.56707763671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8625, std=1.3190
[DEBUG][MIA] Test Set Loss:   mean=1.9177, std=1.3206
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.1, 'auc': 0.486256, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0513, std=2.1032
[DEBUG][MIA] Test Set Loss:   mean=2.0636, std=1.6829
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.13333333333333333, 'auc': 0.5477294921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0932, std=1.7321
[DEBUG][MIA] Test Set Loss:   mean=2.0586, std=1.6268
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.504784, 'task': 8}
Total correct retain:  1535  Total retain:  2500
Total correct forget:  16604  Total forget:  47500
Total correct test:  307  Total test:  500
Total correct forget test:  3081  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.614, 0.542, 0.676, 0.656, 0.544, 0.622, 0.216, 0.312, 0.242, 0.27, 0.276, 0.192, 0.24, 0.134, 0.146, 0.198, 0.298, 0.17, 0.226, 0.202]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0370, std=0.0456
[DEBUG][MIA] Test Set Loss:   mean=1.5137, std=1.7193
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8203125, 'cv_acc': 0.7725490196078432, 'auc': 0.8466796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0436, std=1.4264
[DEBUG][MIA] Test Set Loss:   mean=1.4419, std=1.8196
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.118, 'auc': 0.43384, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0604, std=0.1406
[DEBUG][MIA] Test Set Loss:   mean=0.8311, std=1.3512
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.37647058823529417, 'auc': 0.76611328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7584, std=1.2199
[DEBUG][MIA] Test Set Loss:   mean=0.8510, std=1.3341
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.12000000000000002, 'auc': 0.5059359999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0281, std=0.0385
[DEBUG][MIA] Test Set Loss:   mean=1.0121, std=1.3946
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7333333333333333, 'auc': 0.7816162109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9144, std=1.4856
[DEBUG][MIA] Test Set Loss:   mean=0.9735, std=1.2995
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.10600000000000001, 'auc': 0.561392, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0377, std=0.0400
[DEBUG][MIA] Test Set Loss:   mean=1.0936, std=1.2428
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84765625, 'cv_acc': 0.8156862745098039, 'auc': 0.916015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8152, std=1.1798
[DEBUG][MIA] Test Set Loss:   mean=1.2584, std=1.4131
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.158, 'auc': 0.6137440000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3969, std=1.9387
[DEBUG][MIA] Test Set Loss:   mean=2.5586, std=1.7005
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.09803921568627451, 'auc': 0.54766845703125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3504, std=1.7216
[DEBUG][MIA] Test Set Loss:   mean=2.4576, std=1.7897
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.088, 'auc': 0.48654400000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8981, std=1.4854
[DEBUG][MIA] Test Set Loss:   mean=2.3413, std=1.5898
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.14901960784313725, 'auc': 0.61187744140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9512, std=1.4412
[DEBUG][MIA] Test Set Loss:   mean=2.0365, std=1.4133
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11800000000000002, 'auc': 0.532784, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6104, std=1.0703
[DEBUG][MIA] Test Set Loss:   mean=1.8761, std=1.1823
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.13725490196078433, 'auc': 0.56500244140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8834, std=1.1544
[DEBUG][MIA] Test Set Loss:   mean=1.8784, std=1.2102
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.092, 'auc': 0.49638400000000005, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8073, std=1.6005
[DEBUG][MIA] Test Set Loss:   mean=1.9698, std=1.6061
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10980392156862744, 'auc': 0.5430908203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8784, std=1.4364
[DEBUG][MIA] Test Set Loss:   mean=1.9704, std=1.5036
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.48643200000000003, 'task': 8}
Total correct retain:  1608  Total retain:  2500
Total correct forget:  16116  Total forget:  47500
Total correct test:  314  Total test:  500
Total correct forget test:  3055  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.628, 0.57, 0.716, 0.636, 0.552, 0.26, 0.234, 0.312, 0.274, 0.378, 0.26, 0.234, 0.248, 0.21, 0.136, 0.2, 0.318, 0.188, 0.216, 0.168]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0688, std=0.0889
[DEBUG][MIA] Test Set Loss:   mean=1.2665, std=1.3733
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80859375, 'cv_acc': 0.7725490196078433, 'auc': 0.8365478515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0691, std=1.4448
[DEBUG][MIA] Test Set Loss:   mean=1.4163, std=1.6436
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.094, 'auc': 0.580416, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1061, std=0.2026
[DEBUG][MIA] Test Set Loss:   mean=0.9465, std=1.3525
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5960784313725489, 'auc': 0.76025390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6967, std=1.1068
[DEBUG][MIA] Test Set Loss:   mean=0.9474, std=1.3550
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.5482400000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0679, std=0.1171
[DEBUG][MIA] Test Set Loss:   mean=0.9141, std=1.2565
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7215686274509804, 'auc': 0.7877197265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9820, std=1.6057
[DEBUG][MIA] Test Set Loss:   mean=1.0373, std=1.3341
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11400000000000002, 'auc': 0.560672, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.9568, std=5.1433
[DEBUG][MIA] Test Set Loss:   mean=3.8812, std=4.6598
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10196078431372549, 'auc': 0.55072021484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5334, std=4.5714
[DEBUG][MIA] Test Set Loss:   mean=3.7614, std=4.6193
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.088, 'auc': 0.518784, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8475, std=1.3208
[DEBUG][MIA] Test Set Loss:   mean=1.9501, std=1.2624
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.11764705882352941, 'auc': 0.52557373046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9103, std=1.2327
[DEBUG][MIA] Test Set Loss:   mean=2.0638, std=1.3069
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11200000000000002, 'auc': 0.468832, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6809, std=1.1005
[DEBUG][MIA] Test Set Loss:   mean=1.7916, std=1.1617
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.17254901960784313, 'auc': 0.52630615234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9048, std=1.1840
[DEBUG][MIA] Test Set Loss:   mean=1.9131, std=1.1290
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.5151680000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6439, std=1.0696
[DEBUG][MIA] Test Set Loss:   mean=2.0227, std=1.1931
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.08235294117647059, 'auc': 0.59197998046875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9565, std=1.0846
[DEBUG][MIA] Test Set Loss:   mean=1.9083, std=1.1454
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.12200000000000003, 'auc': 0.48073600000000005, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6936, std=1.3691
[DEBUG][MIA] Test Set Loss:   mean=1.9011, std=1.4966
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.16862745098039214, 'auc': 0.55059814453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8173, std=1.3568
[DEBUG][MIA] Test Set Loss:   mean=1.8148, std=1.4049
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.094, 'auc': 0.5, 'task': 8}
Total correct retain:  1576  Total retain:  2500
Total correct forget:  14718  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  2768  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.616, 0.552, 0.68, 0.612, 0.232, 0.258, 0.214, 0.288, 0.3, 0.298, 0.322, 0.196, 0.22, 0.052, 0.168, 0.274, 0.22, 0.236, 0.194, 0.22]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1161, std=0.1528
[DEBUG][MIA] Test Set Loss:   mean=1.4808, std=1.6041
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7725490196078432, 'auc': 0.86920166015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2763, std=1.4734
[DEBUG][MIA] Test Set Loss:   mean=1.4779, std=1.7808
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.092, 'auc': 0.5187999999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0575, std=0.0861
[DEBUG][MIA] Test Set Loss:   mean=0.9906, std=1.3030
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.6627450980392157, 'auc': 0.83282470703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7050, std=1.2056
[DEBUG][MIA] Test Set Loss:   mean=0.8290, std=1.1457
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.5495199999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1973, std=0.8287
[DEBUG][MIA] Test Set Loss:   mean=1.7935, std=1.0805
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.2705882352941177, 'auc': 0.67578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7916, std=1.3285
[DEBUG][MIA] Test Set Loss:   mean=1.8568, std=1.2423
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.086, 'auc': 0.5269440000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.3107, std=4.5512
[DEBUG][MIA] Test Set Loss:   mean=3.4263, std=4.7858
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09803921568627451, 'auc': 0.5355224609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.4495, std=4.4617
[DEBUG][MIA] Test Set Loss:   mean=3.5840, std=4.6768
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.094, 'auc': 0.50824, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6811, std=1.0519
[DEBUG][MIA] Test Set Loss:   mean=1.9430, std=1.1393
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.1215686274509804, 'auc': 0.56817626953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8650, std=1.0851
[DEBUG][MIA] Test Set Loss:   mean=1.8399, std=1.0617
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08399999999999999, 'auc': 0.495936, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6732, std=0.9295
[DEBUG][MIA] Test Set Loss:   mean=1.7113, std=0.8799
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.24705882352941172, 'auc': 0.51141357421875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6962, std=0.9762
[DEBUG][MIA] Test Set Loss:   mean=1.8520, std=0.9485
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10800000000000001, 'auc': 0.43430399999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.5316, std=0.8583
[DEBUG][MIA] Test Set Loss:   mean=1.7190, std=0.8710
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.13333333333333333, 'auc': 0.56103515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6296, std=0.7976
[DEBUG][MIA] Test Set Loss:   mean=1.7799, std=0.8830
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.088, 'auc': 0.541536, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4350, std=0.9112
[DEBUG][MIA] Test Set Loss:   mean=1.7909, std=1.1265
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.12941176470588237, 'auc': 0.6085205078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6131, std=0.9407
[DEBUG][MIA] Test Set Loss:   mean=1.6891, std=0.9635
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.088, 'auc': 0.516464, 'task': 8}
Total correct retain:  1627  Total retain:  2500
Total correct forget:  13785  Total forget:  47500
Total correct test:  328  Total test:  500
Total correct forget test:  2631  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.656, 0.504, 0.704, 0.296, 0.326, 0.292, 0.214, 0.262, 0.282, 0.284, 0.338, 0.22, 0.228, 0.104, 0.192, 0.22, 0.234, 0.17, 0.232, 0.16]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2162, std=0.2918
[DEBUG][MIA] Test Set Loss:   mean=1.3466, std=1.2340
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7137254901960783, 'auc': 0.82208251953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2442, std=1.2908
[DEBUG][MIA] Test Set Loss:   mean=1.1863, std=1.2362
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11200000000000002, 'auc': 0.49542400000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2290, std=0.7471
[DEBUG][MIA] Test Set Loss:   mean=1.6893, std=0.7825
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.1803921568627451, 'auc': 0.6761474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5817, std=0.8382
[DEBUG][MIA] Test Set Loss:   mean=1.7368, std=0.8849
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.094, 'auc': 0.549872, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3673, std=0.6881
[DEBUG][MIA] Test Set Loss:   mean=1.6580, std=0.9366
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.31372549019607837, 'auc': 0.58123779296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6414, std=0.9609
[DEBUG][MIA] Test Set Loss:   mean=1.7019, std=1.0403
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.086, 'auc': 0.5215839999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8098, std=3.6505
[DEBUG][MIA] Test Set Loss:   mean=2.5928, std=2.7562
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.53802490234375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.7022, std=3.0452
[DEBUG][MIA] Test Set Loss:   mean=2.9220, std=3.1633
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.1, 'auc': 0.47356800000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6952, std=1.0362
[DEBUG][MIA] Test Set Loss:   mean=1.9159, std=1.1109
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10196078431372549, 'auc': 0.5552978515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9135, std=1.0463
[DEBUG][MIA] Test Set Loss:   mean=1.9036, std=1.0869
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11200000000000002, 'auc': 0.491328, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6033, std=0.8603
[DEBUG][MIA] Test Set Loss:   mean=1.7471, std=0.8373
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.2274509803921569, 'auc': 0.57147216796875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6918, std=0.9937
[DEBUG][MIA] Test Set Loss:   mean=1.7749, std=0.8649
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.088, 'auc': 0.451904, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4401, std=0.6020
[DEBUG][MIA] Test Set Loss:   mean=1.5911, std=0.6076
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09803921568627451, 'auc': 0.582763671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.5436, std=0.5734
[DEBUG][MIA] Test Set Loss:   mean=1.6042, std=0.6436
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10400000000000001, 'auc': 0.524464, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6011, std=1.0022
[DEBUG][MIA] Test Set Loss:   mean=1.5815, std=0.8501
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.14901960784313725, 'auc': 0.525634765625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.5012, std=0.8710
[DEBUG][MIA] Test Set Loss:   mean=1.6360, std=0.9281
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11599999999999999, 'auc': 0.54304, 'task': 8}
Total correct retain:  1641  Total retain:  2500
Total correct forget:  13166  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  2543  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.64, 0.524, 0.296, 0.292, 0.322, 0.218, 0.226, 0.288, 0.382, 0.364, 0.302, 0.16, 0.23, 0.066, 0.222, 0.234, 0.26, 0.214, 0.288, 0.198]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([9, 6, 8, 8, 9, 6, 9, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7580, std=1.3635
[DEBUG][MIA] Test Set Loss:   mean=2.0248, std=1.1798
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.11372549019607843, 'auc': 0.59228515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [5 6 6 8 7 8 7 5 7 9]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 8 7 6 5 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9972, std=1.2702
[DEBUG][MIA] Test Set Loss:   mean=1.9881, std=1.3167
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.08399999999999999, 'auc': 0.506016, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([13, 13, 13, 11, 14, 10, 12, 12, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5185, std=0.7499
[DEBUG][MIA] Test Set Loss:   mean=1.9195, std=0.7476
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.09019607843137255, 'auc': 0.64886474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 11 13 11 11 12 12 14 14 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 10 11 10 13 13 11 13 13 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9194, std=0.8511
[DEBUG][MIA] Test Set Loss:   mean=1.8750, std=0.8001
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.5143679999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 18, 17, 15, 15, 16, 16, 18, 17, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3247, std=0.5845
[DEBUG][MIA] Test Set Loss:   mean=1.6248, std=0.7358
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.13725490196078433, 'auc': 0.60992431640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 17 16 18 19 15 16 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 18 19 19 18 18 15 18 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5858, std=0.7706
[DEBUG][MIA] Test Set Loss:   mean=1.6239, std=0.7489
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.08, 'auc': 0.519504, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 22, 23, 21, 22, 20, 22, 21, 24, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.5130, std=2.6857
[DEBUG][MIA] Test Set Loss:   mean=2.4101, std=2.2212
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10588235294117647, 'auc': 0.55328369140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 24 24 24 20 20 23 23 23 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 20 21 24 22 23 23 23 21 24]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.3471, std=2.1737
[DEBUG][MIA] Test Set Loss:   mean=2.2031, std=2.0715
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.09, 'auc': 0.489856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([27, 28, 27, 29, 28, 26, 27, 25, 25, 26], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6228, std=0.7937
[DEBUG][MIA] Test Set Loss:   mean=1.7716, std=0.7475
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10588235294117647, 'auc': 0.5584716796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 26 26 25 28 29 28 25 25 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [27 27 29 29 26 26 29 25 25 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6832, std=0.7538
[DEBUG][MIA] Test Set Loss:   mean=1.7877, std=0.8668
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.094, 'auc': 0.47355200000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 31, 32, 33, 30, 31, 31, 31, 34], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4913, std=0.6478
[DEBUG][MIA] Test Set Loss:   mean=1.6512, std=0.7738
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.11372549019607843, 'auc': 0.5634765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 32 33 33 32 31 31 31 32 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 33 30 34 31 31 31 30 34 34]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6853, std=0.8271
[DEBUG][MIA] Test Set Loss:   mean=1.6662, std=0.7075
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.096, 'auc': 0.52752, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 39, 39, 39, 37, 38, 38, 38, 38, 38], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4949, std=0.5262
[DEBUG][MIA] Test Set Loss:   mean=1.5777, std=0.5125
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.16862745098039214, 'auc': 0.553466796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [38 36 38 35 39 38 37 35 35 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [39 37 39 36 39 36 36 39 35 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.4879, std=0.4393
[DEBUG][MIA] Test Set Loss:   mean=1.5937, std=0.5073
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.555456, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([44, 41, 44, 42, 42, 43, 40, 42, 43, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.5885, std=0.7270
[DEBUG][MIA] Test Set Loss:   mean=1.6621, std=0.6759
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09411764705882353, 'auc': 0.54534912109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 42 44 40 44 44 44 40 44 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 40 43 44 40 40 44 44 43 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6499, std=0.6581
[DEBUG][MIA] Test Set Loss:   mean=1.6469, std=0.7319
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.09, 'auc': 0.517216, 'task': 8}
Total correct retain:  1628  Total retain:  2500
Total correct forget:  11484  Total forget:  47500
Total correct test:  317  Total test:  500
Total correct forget test:  2326  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.634, 0.266, 0.224, 0.328, 0.308, 0.272, 0.314, 0.272, 0.282, 0.262, 0.306, 0.164, 0.224, 0.16, 0.2, 0.182, 0.218, 0.2, 0.208, 0.262]
Number of constraint violations:  4611
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: negagem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 23:30:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 37%   69C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['shark', 'tulips', 'lobster', 'table', 'skyscraper', 'turtle', 'crocodile', 'lion', 'mushrooms', 'wardrobe', 'trout', 'dinosaur', 'pickup truck', 'bicycle', 'cans', 'willow', 'cups', 'baby', 'lizard', 'man', 'road', 'rocket', 'chimpanzee', 'bridge', 'pears', 'rabbit', 'fox', 'bottles', 'mouse', 'plates', 'sweet peppers', 'raccoon', 'ray', 'elephant', 'beetle', 'lawn-mower', 'clock', 'boy', 'leopard', 'television', 'whale', 'poppies', 'cockroach', 'computer keyboard', 'possum', 'hamster', 'worm', 'motorcycle', 'roses', 'palm', 'cloud', 'forest', 'streetcar', 'seal', 'couch', 'tiger', 'skunk', 'kangaroo', 'bear', 'pine', 'dolphin', 'beaver', 'telephone', 'plain', 'wolf', 'crab', 'lamp', 'bed', 'snake', 'orchids', 'camel', 'squirrel', 'chair', 'oak', 'tank', 'bus', 'butterfly', 'snail', 'oranges', 'sea', 'shrew', 'sunflowers', 'cattle', 'maple', 'spider', 'porcupine', 'girl', 'castle', 'mountain', 'bee', 'bowls', 'caterpillar', 'train', 'tractor', 'aquarium fish', 'house', 'woman', 'otter', 'flatfish', 'apples']
Training task:  1
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2325  Total retain:  2500
Total correct forget:  9547  Total forget:  47500
Total correct test:  368  Total test:  500
Total correct forget test:  1955  Total test forget:  9500
After learning task 1
Task accuracies: [0.736, 0.286, 0.292, 0.194, 0.158, 0.154, 0.19, 0.216, 0.2, 0.214, 0.198, 0.31, 0.142, 0.206, 0.148, 0.186, 0.18, 0.238, 0.194, 0.204]
Training task:  2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=0.9523, std=1.8632
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.23333333333333334, 'auc': 0.86865234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0180
[DEBUG][MIA] Test Set Loss:   mean=0.6952, std=1.8829
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.22199999999999998, 'auc': 0.710072, 'task': 1}
2 1
Total correct retain:  1823  Total retain:  2500
Total correct forget:  11835  Total forget:  47500
Total correct test:  312  Total test:  500
Total correct forget test:  2274  Total test forget:  9500
After learning task 2
Task accuracies: [0.624, 0.806, 0.236, 0.23, 0.238, 0.156, 0.196, 0.204, 0.2, 0.2, 0.2, 0.282, 0.146, 0.228, 0.198, 0.174, 0.18, 0.24, 0.234, 0.2]
Training task:  3
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0849, std=0.2110
[DEBUG][MIA] Test Set Loss:   mean=2.0801, std=2.7660
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.3, 'auc': 0.8037109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.8364, std=1.7372
[DEBUG][MIA] Test Set Loss:   mean=1.6710, std=2.5699
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.144, 'auc': 0.5973360000000001, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0486, std=0.1794
[DEBUG][MIA] Test Set Loss:   mean=0.3960, std=1.0127
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.25, 'auc': 0.607421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0495
[DEBUG][MIA] Test Set Loss:   mean=0.7937, std=2.2479
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.192, 'auc': 0.669136, 'task': 2}
3 2
Total correct retain:  1492  Total retain:  2500
Total correct forget:  12905  Total forget:  47500
Total correct test:  264  Total test:  500
Total correct forget test:  2447  Total test forget:  9500
After learning task 3
Task accuracies: [0.528, 0.644, 0.836, 0.234, 0.144, 0.166, 0.204, 0.278, 0.2, 0.196, 0.2, 0.204, 0.152, 0.224, 0.196, 0.098, 0.144, 0.296, 0.274, 0.204]
Training task:  4
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0318, std=0.0659
[DEBUG][MIA] Test Set Loss:   mean=2.4658, std=2.3858
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.26666666666666666, 'auc': 0.8701171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5522, std=2.2103
[DEBUG][MIA] Test Set Loss:   mean=1.5977, std=2.2464
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.126, 'auc': 0.501072, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0120, std=0.0182
[DEBUG][MIA] Test Set Loss:   mean=1.1263, std=2.0823
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.75, 'auc': 0.84375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7763, std=1.3536
[DEBUG][MIA] Test Set Loss:   mean=1.4604, std=2.2407
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.13799999999999998, 'auc': 0.5739359999999999, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0150
[DEBUG][MIA] Test Set Loss:   mean=2.5287, std=3.8667
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.33333333333333337, 'auc': 0.7490234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0135, std=0.0586
[DEBUG][MIA] Test Set Loss:   mean=1.4390, std=2.5886
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.7, 'cv_acc': 0.252, 'auc': 0.7755360000000001, 'task': 3}
4 3
Total correct retain:  1389  Total retain:  2500
Total correct forget:  14265  Total forget:  47500
Total correct test:  254  Total test:  500
Total correct forget test:  2621  Total test forget:  9500
After learning task 4
Task accuracies: [0.508, 0.554, 0.614, 0.718, 0.2, 0.198, 0.192, 0.226, 0.2, 0.198, 0.202, 0.266, 0.226, 0.198, 0.194, 0.182, 0.198, 0.274, 0.208, 0.194]
Training task:  5
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0193, std=0.0491
[DEBUG][MIA] Test Set Loss:   mean=1.2259, std=1.7802
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7333333333333333, 'auc': 0.875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4274, std=2.1559
[DEBUG][MIA] Test Set Loss:   mean=1.5643, std=2.0934
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11200000000000002, 'auc': 0.541536, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0101, std=0.0278
[DEBUG][MIA] Test Set Loss:   mean=1.6249, std=2.5881
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2333333333333333, 'auc': 0.826171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5237, std=2.2933
[DEBUG][MIA] Test Set Loss:   mean=2.1175, std=3.1435
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10200000000000001, 'auc': 0.5291440000000001, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=1.5833, std=2.5644
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.75, 'auc': 0.90625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5804, std=1.2710
[DEBUG][MIA] Test Set Loss:   mean=1.7895, std=2.5537
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.622, 'cv_acc': 0.196, 'auc': 0.6586559999999999, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0105, std=0.0396
[DEBUG][MIA] Test Set Loss:   mean=0.3634, std=1.5320
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.2, 'auc': 0.5673828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0266, std=0.2008
[DEBUG][MIA] Test Set Loss:   mean=0.7111, std=1.8416
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.178, 'auc': 0.672928, 'task': 4}
5 4
Total correct retain:  1349  Total retain:  2500
Total correct forget:  15730  Total forget:  47500
Total correct test:  244  Total test:  500
Total correct forget test:  2886  Total test forget:  9500
After learning task 5
Task accuracies: [0.488, 0.564, 0.574, 0.59, 0.856, 0.244, 0.178, 0.244, 0.2, 0.194, 0.184, 0.252, 0.256, 0.218, 0.194, 0.154, 0.196, 0.238, 0.238, 0.198]
Training task:  6
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0102, std=0.0222
[DEBUG][MIA] Test Set Loss:   mean=1.4153, std=1.8380
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.3, 'auc': 0.888671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3190, std=1.8448
[DEBUG][MIA] Test Set Loss:   mean=1.6373, std=2.1830
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.10800000000000001, 'auc': 0.450176, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0093
[DEBUG][MIA] Test Set Loss:   mean=1.2730, std=1.9083
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.912109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6162, std=2.1581
[DEBUG][MIA] Test Set Loss:   mean=1.7327, std=2.3202
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.13399999999999998, 'auc': 0.515456, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0085, std=0.0268
[DEBUG][MIA] Test Set Loss:   mean=2.2679, std=2.8118
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8666666666666666, 'auc': 0.87890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0338, std=1.8026
[DEBUG][MIA] Test Set Loss:   mean=2.0108, std=2.7032
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.16799999999999998, 'auc': 0.611024, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0086
[DEBUG][MIA] Test Set Loss:   mean=1.1718, std=1.8477
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666666, 'auc': 0.7841796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6847, std=1.3137
[DEBUG][MIA] Test Set Loss:   mean=1.2664, std=1.9735
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.16799999999999998, 'auc': 0.558032, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0114, std=0.0431
[DEBUG][MIA] Test Set Loss:   mean=0.5423, std=1.3089
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.2833333333333333, 'auc': 0.724609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0257, std=0.2521
[DEBUG][MIA] Test Set Loss:   mean=1.1051, std=2.3420
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.692, 'cv_acc': 0.272, 'auc': 0.759248, 'task': 5}
6 5
Total correct retain:  1383  Total retain:  2500
Total correct forget:  16887  Total forget:  47500
Total correct test:  240  Total test:  500
Total correct forget test:  3101  Total test forget:  9500
After learning task 6
Task accuracies: [0.48, 0.588, 0.562, 0.512, 0.63, 0.736, 0.188, 0.282, 0.2, 0.2, 0.198, 0.256, 0.282, 0.232, 0.204, 0.206, 0.212, 0.26, 0.258, 0.196]
Training task:  7
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.3803, std=1.8221
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333333, 'auc': 0.95703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7204, std=2.2692
[DEBUG][MIA] Test Set Loss:   mean=1.7497, std=2.2101
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.098, 'auc': 0.5094319999999999, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.9758, std=2.2570
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.31666666666666665, 'auc': 0.91796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5911, std=2.2178
[DEBUG][MIA] Test Set Loss:   mean=1.9180, std=2.5690
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.088, 'auc': 0.527728, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=2.0749, std=2.7182
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.94140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4352, std=2.1147
[DEBUG][MIA] Test Set Loss:   mean=2.0154, std=2.5607
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.124, 'auc': 0.5638639999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.9554, std=2.5856
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.2833333333333333, 'auc': 0.927734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2136, std=1.9537
[DEBUG][MIA] Test Set Loss:   mean=1.4821, std=2.0881
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.550288, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.1130, std=2.3600
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.7666666666666667, 'auc': 0.853515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6884, std=1.3813
[DEBUG][MIA] Test Set Loss:   mean=1.7820, std=2.4849
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.22200000000000003, 'auc': 0.6419039999999999, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=0.1749, std=0.3558
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.13333333333333333, 'auc': 0.7548828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0200, std=0.1998
[DEBUG][MIA] Test Set Loss:   mean=0.9748, std=2.1331
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.674, 'cv_acc': 0.22799999999999998, 'auc': 0.726256, 'task': 6}
7 6
Total correct retain:  1388  Total retain:  2500
Total correct forget:  17512  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  3154  Total test forget:  9500
After learning task 7
Task accuracies: [0.532, 0.538, 0.52, 0.502, 0.582, 0.574, 0.784, 0.214, 0.2, 0.212, 0.196, 0.268, 0.282, 0.208, 0.204, 0.144, 0.234, 0.228, 0.228, 0.19]
Training task:  8
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.0773, std=1.8510
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.75, 'auc': 0.888671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3203, std=1.9704
[DEBUG][MIA] Test Set Loss:   mean=1.2795, std=1.8836
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10400000000000001, 'auc': 0.501104, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.1117, std=1.5331
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666667, 'auc': 0.92578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4693, std=2.1105
[DEBUG][MIA] Test Set Loss:   mean=1.7943, std=2.5719
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11600000000000002, 'auc': 0.5069279999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=1.8155, std=1.9965
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7666666666666667, 'auc': 0.9677734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0512, std=2.6937
[DEBUG][MIA] Test Set Loss:   mean=1.9573, std=2.5173
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.122, 'auc': 0.50664, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.6467, std=2.4067
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7833333333333333, 'auc': 0.9326171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2087, std=1.9089
[DEBUG][MIA] Test Set Loss:   mean=1.5634, std=2.2183
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.1, 'auc': 0.56224, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.0981, std=2.0814
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7, 'auc': 0.8359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0793, std=1.9506
[DEBUG][MIA] Test Set Loss:   mean=1.6635, std=2.7214
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.22200000000000003, 'auc': 0.554528, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.0342, std=1.9288
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.1, 'auc': 0.865234375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3203, std=0.9794
[DEBUG][MIA] Test Set Loss:   mean=1.2880, std=2.4116
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.182, 'auc': 0.662944, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0101, std=0.0517
[DEBUG][MIA] Test Set Loss:   mean=0.7402, std=1.4762
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.09999999999999999, 'auc': 0.69580078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0142
[DEBUG][MIA] Test Set Loss:   mean=0.9540, std=2.3590
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.23399999999999999, 'auc': 0.693912, 'task': 7}
8 7
Total correct retain:  1431  Total retain:  2500
Total correct forget:  19533  Total forget:  47500
Total correct test:  274  Total test:  500
Total correct forget test:  3542  Total test forget:  9500
After learning task 8
Task accuracies: [0.548, 0.624, 0.566, 0.512, 0.544, 0.592, 0.7, 0.784, 0.2, 0.206, 0.2, 0.3, 0.26, 0.238, 0.206, 0.23, 0.224, 0.29, 0.216, 0.192]
Training task:  9
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.3751, std=2.1161
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7166666666666667, 'auc': 0.9375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3004, std=1.9915
[DEBUG][MIA] Test Set Loss:   mean=1.4281, std=2.1907
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.13799999999999998, 'auc': 0.521232, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.3578, std=2.0776
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.31666666666666665, 'auc': 0.8779296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7796, std=2.6238
[DEBUG][MIA] Test Set Loss:   mean=1.9525, std=2.6205
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.122, 'auc': 0.522512, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=2.5015, std=2.5523
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7833333333333333, 'auc': 0.9580078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6386, std=2.2861
[DEBUG][MIA] Test Set Loss:   mean=2.0432, std=2.5815
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.138, 'auc': 0.5523119999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.3263, std=2.2602
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.75, 'auc': 0.94140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0790, std=1.6938
[DEBUG][MIA] Test Set Loss:   mean=1.7383, std=2.3037
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.098, 'auc': 0.5926880000000001, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=1.5909, std=2.2030
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8, 'auc': 0.9541015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0628, std=2.0345
[DEBUG][MIA] Test Set Loss:   mean=1.6043, std=2.6729
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.17200000000000001, 'auc': 0.55188, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=0.9535, std=1.6887
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2833333333333333, 'auc': 0.8662109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5982, std=1.3857
[DEBUG][MIA] Test Set Loss:   mean=1.2272, std=2.3438
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.168, 'auc': 0.600928, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=0.9404, std=1.7188
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2833333333333333, 'auc': 0.87109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2541, std=0.9855
[DEBUG][MIA] Test Set Loss:   mean=0.8905, std=1.7861
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.194, 'auc': 0.6256079999999999, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=0.2760, std=0.7039
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.11666666666666665, 'auc': 0.75048828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0533
[DEBUG][MIA] Test Set Loss:   mean=0.5177, std=1.5116
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.16799999999999998, 'auc': 0.64812, 'task': 8}
Total correct retain:  1620  Total retain:  2500
Total correct forget:  21255  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  3891  Total test forget:  9500
After learning task 9
Task accuracies: [0.64, 0.614, 0.572, 0.522, 0.58, 0.61, 0.692, 0.74, 0.868, 0.204, 0.206, 0.268, 0.306, 0.224, 0.194, 0.234, 0.28, 0.268, 0.21, 0.19]
Training task:  10
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0124
[DEBUG][MIA] Test Set Loss:   mean=2.6945, std=3.2433
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.6833333333333333, 'auc': 0.923828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0419, std=2.9987
[DEBUG][MIA] Test Set Loss:   mean=1.8804, std=2.6891
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.094, 'auc': 0.507152, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0049
[DEBUG][MIA] Test Set Loss:   mean=2.6259, std=3.6117
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8166666666666668, 'auc': 0.9052734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.1084, std=3.2259
[DEBUG][MIA] Test Set Loss:   mean=2.1983, std=3.2729
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10400000000000001, 'auc': 0.503536, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=1.8917, std=2.7855
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333333, 'auc': 0.927734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7224, std=2.5257
[DEBUG][MIA] Test Set Loss:   mean=1.9533, std=2.5568
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.118, 'auc': 0.532592, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0130
[DEBUG][MIA] Test Set Loss:   mean=1.7362, std=2.5741
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666667, 'auc': 0.9287109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6675, std=2.3066
[DEBUG][MIA] Test Set Loss:   mean=2.0000, std=2.6937
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.096, 'auc': 0.521448, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0091
[DEBUG][MIA] Test Set Loss:   mean=1.1957, std=2.2553
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7833333333333333, 'auc': 0.81640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5069, std=2.3730
[DEBUG][MIA] Test Set Loss:   mean=1.9708, std=2.8416
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.16599999999999998, 'auc': 0.544224, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8230, std=2.4581
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.2833333333333333, 'auc': 0.8828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8126, std=1.6000
[DEBUG][MIA] Test Set Loss:   mean=1.2320, std=2.1351
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.12000000000000002, 'auc': 0.5743520000000001, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.0274, std=2.0853
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.7666666666666666, 'auc': 0.8681640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4829, std=1.1465
[DEBUG][MIA] Test Set Loss:   mean=1.1680, std=1.8702
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.186, 'auc': 0.621424, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=0.1945, std=0.4571
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.25, 'auc': 0.6044921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2402, std=0.8416
[DEBUG][MIA] Test Set Loss:   mean=0.5923, std=1.4178
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.15, 'auc': 0.623488, 'task': 8}
Total correct retain:  1632  Total retain:  2500
Total correct forget:  21667  Total forget:  47500
Total correct test:  320  Total test:  500
Total correct forget test:  3961  Total test forget:  9500
After learning task 10
Task accuracies: [0.64, 0.558, 0.556, 0.496, 0.544, 0.546, 0.654, 0.674, 0.848, 0.884, 0.198, 0.258, 0.2, 0.23, 0.16, 0.162, 0.28, 0.294, 0.18, 0.2]
Training task:  11
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.4387, std=2.1868
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.33333333333333337, 'auc': 0.890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2845, std=2.3488
[DEBUG][MIA] Test Set Loss:   mean=1.6198, std=2.5700
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10200000000000001, 'auc': 0.546208, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.6615, std=4.1048
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7166666666666666, 'auc': 0.8583984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6263, std=2.7427
[DEBUG][MIA] Test Set Loss:   mean=1.6485, std=2.5485
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.524448, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.8024, std=2.5752
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7833333333333333, 'auc': 0.95703125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.7019, std=2.6022
[DEBUG][MIA] Test Set Loss:   mean=2.2427, std=3.0863
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10800000000000001, 'auc': 0.556144, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=2.2327, std=2.9008
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8333333333333334, 'auc': 0.8701171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7610, std=2.5704
[DEBUG][MIA] Test Set Loss:   mean=2.0895, std=2.8373
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.1, 'auc': 0.5454479999999999, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.2961, std=1.5698
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.9501953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3872, std=2.2245
[DEBUG][MIA] Test Set Loss:   mean=1.9725, std=2.8010
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.1, 'auc': 0.54732, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.5580, std=2.6850
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666666, 'auc': 0.8916015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9339, std=1.7797
[DEBUG][MIA] Test Set Loss:   mean=1.4181, std=2.3011
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11600000000000002, 'auc': 0.574232, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.3457, std=1.7840
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2833333333333333, 'auc': 0.8857421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8095, std=1.5821
[DEBUG][MIA] Test Set Loss:   mean=1.3856, std=2.2009
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.17200000000000001, 'auc': 0.552656, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.7293, std=1.6425
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.18333333333333332, 'auc': 0.7763671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3956, std=1.1711
[DEBUG][MIA] Test Set Loss:   mean=0.6345, std=1.4079
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.164, 'auc': 0.5385439999999999, 'task': 8}
Total correct retain:  1631  Total retain:  2500
Total correct forget:  23158  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  4258  Total test forget:  9500
After learning task 11
Task accuracies: [0.63, 0.598, 0.584, 0.502, 0.534, 0.576, 0.636, 0.638, 0.784, 0.776, 0.82, 0.258, 0.18, 0.226, 0.168, 0.196, 0.292, 0.352, 0.184, 0.212]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.5065, std=3.2077
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7666666666666667, 'auc': 0.86865234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7362, std=3.0421
[DEBUG][MIA] Test Set Loss:   mean=1.4603, std=2.4120
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.08, 'auc': 0.5036, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0002
[DEBUG][MIA] Test Set Loss:   mean=1.8355, std=2.3193
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.3333333333333333, 'auc': 0.958984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7520, std=2.7127
[DEBUG][MIA] Test Set Loss:   mean=1.7402, std=2.6723
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10800000000000001, 'auc': 0.5191520000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.9310, std=2.6137
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8, 'auc': 0.8779296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0339, std=3.0181
[DEBUG][MIA] Test Set Loss:   mean=2.5838, std=3.2042
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10600000000000001, 'auc': 0.5591200000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=2.4308, std=3.5571
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.837890625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.1921, std=3.0825
[DEBUG][MIA] Test Set Loss:   mean=2.3561, std=3.1847
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10200000000000001, 'auc': 0.490336, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.5210, std=3.7484
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7333333333333333, 'auc': 0.892578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4354, std=2.2921
[DEBUG][MIA] Test Set Loss:   mean=1.8560, std=2.7648
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.13599999999999998, 'auc': 0.53888, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.4686, std=2.5855
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7499999999999999, 'auc': 0.8701171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4263, std=2.6058
[DEBUG][MIA] Test Set Loss:   mean=1.6129, std=2.5480
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.15, 'auc': 0.552848, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.5272, std=2.5975
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7333333333333333, 'auc': 0.91064453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9666, std=1.9799
[DEBUG][MIA] Test Set Loss:   mean=1.4272, std=2.5110
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.14599999999999996, 'auc': 0.554144, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=0.8611, std=1.9159
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2833333333333333, 'auc': 0.82177734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5247, std=1.4870
[DEBUG][MIA] Test Set Loss:   mean=0.9848, std=2.2047
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.15, 'auc': 0.58048, 'task': 8}
Total correct retain:  1612  Total retain:  2500
Total correct forget:  21642  Total forget:  47500
Total correct test:  310  Total test:  500
Total correct forget test:  4028  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.62, 0.604, 0.596, 0.506, 0.526, 0.576, 0.626, 0.65, 0.774, 0.788, 0.328, 0.266, 0.184, 0.236, 0.17, 0.192, 0.284, 0.344, 0.192, 0.214]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=2.0452, std=2.6319
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.21666666666666665, 'auc': 0.9580078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8138, std=2.8541
[DEBUG][MIA] Test Set Loss:   mean=1.6456, std=2.6117
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11200000000000002, 'auc': 0.508904, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.5133, std=2.7796
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.75, 'auc': 0.91748046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8140, std=3.0049
[DEBUG][MIA] Test Set Loss:   mean=1.8828, std=2.9867
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.51824, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=2.4761, std=3.4713
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7166666666666666, 'auc': 0.9580078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.7276, std=3.7615
[DEBUG][MIA] Test Set Loss:   mean=2.3683, std=3.2252
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11200000000000002, 'auc': 0.49263199999999996, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.8581, std=2.9434
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666666, 'auc': 0.904296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2876, std=3.1572
[DEBUG][MIA] Test Set Loss:   mean=2.3419, std=3.1381
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.096, 'auc': 0.48824, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.4244, std=2.1537
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.2833333333333333, 'auc': 0.9619140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4206, std=2.5279
[DEBUG][MIA] Test Set Loss:   mean=2.1064, std=3.0472
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.1, 'auc': 0.58, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.3648, std=2.1486
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2833333333333333, 'auc': 0.935546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2250, std=2.2739
[DEBUG][MIA] Test Set Loss:   mean=1.4595, std=2.3910
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.15999999999999998, 'auc': 0.568776, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0001
[DEBUG][MIA] Test Set Loss:   mean=1.5629, std=2.4488
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.21666666666666665, 'auc': 0.947265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8893, std=1.6920
[DEBUG][MIA] Test Set Loss:   mean=1.6311, std=2.5997
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.174, 'auc': 0.596296, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.1443, std=1.8685
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.25, 'auc': 0.8408203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4961, std=1.5078
[DEBUG][MIA] Test Set Loss:   mean=0.8692, std=1.9672
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.164, 'auc': 0.561208, 'task': 8}
Total correct retain:  1622  Total retain:  2500
Total correct forget:  20095  Total forget:  47500
Total correct test:  305  Total test:  500
Total correct forget test:  3750  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.61, 0.602, 0.596, 0.496, 0.522, 0.564, 0.616, 0.66, 0.77, 0.288, 0.342, 0.272, 0.172, 0.23, 0.17, 0.18, 0.288, 0.342, 0.178, 0.212]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.5909, std=2.6877
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.33333333333333337, 'auc': 0.8955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7967, std=2.7260
[DEBUG][MIA] Test Set Loss:   mean=2.0235, std=3.0305
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.09, 'auc': 0.47100800000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.9598, std=2.9776
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.31666666666666665, 'auc': 0.892578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6553, std=2.9056
[DEBUG][MIA] Test Set Loss:   mean=1.8926, std=2.9092
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.5487519999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.7941, std=4.0338
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8, 'auc': 0.8916015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3518, std=3.2943
[DEBUG][MIA] Test Set Loss:   mean=2.5073, std=3.4075
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.14800000000000002, 'auc': 0.5166719999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=2.3449, std=3.0531
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8166666666666667, 'auc': 0.9169921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.7032, std=3.6869
[DEBUG][MIA] Test Set Loss:   mean=2.8259, std=3.5536
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.092, 'auc': 0.519776, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=2.3274, std=2.7787
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7666666666666666, 'auc': 0.8525390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3824, std=2.3227
[DEBUG][MIA] Test Set Loss:   mean=2.2645, std=3.3305
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12200000000000003, 'auc': 0.557288, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0001
[DEBUG][MIA] Test Set Loss:   mean=1.0185, std=1.6592
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666667, 'auc': 0.904296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2093, std=2.1957
[DEBUG][MIA] Test Set Loss:   mean=1.7883, std=3.1038
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.122, 'auc': 0.570488, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=1.8298, std=2.7175
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2833333333333333, 'auc': 0.9169921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6228, std=1.3773
[DEBUG][MIA] Test Set Loss:   mean=1.4241, std=2.3948
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.186, 'auc': 0.5971360000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8343, std=2.6057
[DEBUG][MIA] Test Set Loss:   mean=5.1561, std=5.2801
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25, 'auc': 0.6669921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.8262, std=4.8599
[DEBUG][MIA] Test Set Loss:   mean=5.4280, std=5.4927
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.15, 'auc': 0.531512, 'task': 8}
Total correct retain:  1610  Total retain:  2500
Total correct forget:  18319  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  3442  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.612, 0.606, 0.578, 0.48, 0.486, 0.562, 0.602, 0.624, 0.298, 0.264, 0.364, 0.27, 0.176, 0.222, 0.174, 0.178, 0.276, 0.312, 0.188, 0.224]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.9533, std=2.7204
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.3166666666666667, 'auc': 0.921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4976, std=2.5963
[DEBUG][MIA] Test Set Loss:   mean=1.6988, std=2.6384
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11000000000000001, 'auc': 0.518808, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.5996, std=2.6895
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7166666666666666, 'auc': 0.8798828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3272, std=3.6758
[DEBUG][MIA] Test Set Loss:   mean=2.2506, std=3.3995
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.09, 'auc': 0.5114240000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=2.1268, std=3.1884
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7833333333333333, 'auc': 0.8798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1155, std=3.1300
[DEBUG][MIA] Test Set Loss:   mean=2.9680, std=3.7407
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.432, 'cv_acc': 0.11599999999999999, 'auc': 0.43792, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=2.7364, std=3.3225
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666666, 'auc': 0.8857421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6072, std=3.3221
[DEBUG][MIA] Test Set Loss:   mean=2.3554, std=3.1259
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.098, 'auc': 0.49140799999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.9322, std=2.5394
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7333333333333334, 'auc': 0.9306640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4557, std=2.4182
[DEBUG][MIA] Test Set Loss:   mean=1.9152, std=2.8426
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11800000000000002, 'auc': 0.5569759999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=2.4770, std=3.4223
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7833333333333333, 'auc': 0.9580078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1765, std=2.0093
[DEBUG][MIA] Test Set Loss:   mean=1.9033, std=3.2030
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10600000000000001, 'auc': 0.559904, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9753, std=1.4624
[DEBUG][MIA] Test Set Loss:   mean=8.1634, std=5.4448
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7333333333333333, 'auc': 0.8955078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4208, std=5.1296
[DEBUG][MIA] Test Set Loss:   mean=5.7283, std=5.4804
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.10200000000000001, 'auc': 0.570112, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7851, std=2.7563
[DEBUG][MIA] Test Set Loss:   mean=4.2693, std=4.4278
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.55, 'auc': 0.5732421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.0410, std=4.7293
[DEBUG][MIA] Test Set Loss:   mean=6.2437, std=5.6100
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10800000000000001, 'auc': 0.55772, 'task': 8}
Total correct retain:  1543  Total retain:  2500
Total correct forget:  17542  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  3315  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.592, 0.578, 0.596, 0.504, 0.492, 0.57, 0.616, 0.3, 0.27, 0.294, 0.336, 0.276, 0.212, 0.222, 0.156, 0.152, 0.3, 0.356, 0.184, 0.216]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=2.8059, std=3.3824
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7500000000000001, 'auc': 0.955078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6688, std=2.7572
[DEBUG][MIA] Test Set Loss:   mean=1.5788, std=2.5309
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10600000000000001, 'auc': 0.50044, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=1.3651, std=2.6059
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666667, 'auc': 0.8447265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7033, std=2.7884
[DEBUG][MIA] Test Set Loss:   mean=2.2772, std=3.3365
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.096, 'auc': 0.43643999999999994, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=2.4322, std=2.7361
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8166666666666667, 'auc': 0.8466796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3804, std=3.2255
[DEBUG][MIA] Test Set Loss:   mean=2.8190, std=3.5635
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.541064, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0111, std=0.0230
[DEBUG][MIA] Test Set Loss:   mean=1.6957, std=2.3581
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7333333333333333, 'auc': 0.751953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1383, std=3.8165
[DEBUG][MIA] Test Set Loss:   mean=3.0470, std=3.8689
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10800000000000001, 'auc': 0.491064, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0080, std=0.0290
[DEBUG][MIA] Test Set Loss:   mean=1.4709, std=2.5514
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7666666666666666, 'auc': 0.8896484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8647, std=2.9605
[DEBUG][MIA] Test Set Loss:   mean=2.3884, std=3.3234
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.136, 'auc': 0.55864, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8901, std=1.3639
[DEBUG][MIA] Test Set Loss:   mean=3.3260, std=4.2427
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.65, 'auc': 0.65185546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.6380, std=4.4399
[DEBUG][MIA] Test Set Loss:   mean=4.6472, std=5.3112
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10600000000000001, 'auc': 0.551104, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1979, std=0.4164
[DEBUG][MIA] Test Set Loss:   mean=4.6524, std=4.6911
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.79296875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.2615, std=3.8925
[DEBUG][MIA] Test Set Loss:   mean=4.0534, std=4.5991
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.12400000000000003, 'auc': 0.5394559999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8817, std=2.4981
[DEBUG][MIA] Test Set Loss:   mean=7.5204, std=5.4870
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.25, 'auc': 0.78955078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.6617, std=5.0132
[DEBUG][MIA] Test Set Loss:   mean=6.0974, std=5.8477
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.10600000000000001, 'auc': 0.5750400000000001, 'task': 8}
Total correct retain:  1523  Total retain:  2500
Total correct forget:  16393  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  3091  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.564, 0.608, 0.568, 0.45, 0.464, 0.516, 0.344, 0.388, 0.292, 0.26, 0.32, 0.256, 0.172, 0.218, 0.18, 0.17, 0.262, 0.3, 0.194, 0.22]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.2875, std=2.3289
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666667, 'auc': 0.8759765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8421, std=2.7430
[DEBUG][MIA] Test Set Loss:   mean=1.6668, std=2.7319
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.092, 'auc': 0.497384, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=2.2703, std=3.9405
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.35, 'auc': 0.8935546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9644, std=3.0690
[DEBUG][MIA] Test Set Loss:   mean=2.0244, std=3.0089
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10600000000000001, 'auc': 0.524336, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=2.6832, std=3.5820
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8, 'auc': 0.91796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5867, std=3.6678
[DEBUG][MIA] Test Set Loss:   mean=3.2704, std=4.0288
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.078, 'auc': 0.53872, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0098, std=0.0245
[DEBUG][MIA] Test Set Loss:   mean=3.5096, std=3.8171
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.85, 'auc': 0.9482421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.1060, std=3.7231
[DEBUG][MIA] Test Set Loss:   mean=2.7928, std=3.5594
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.138, 'auc': 0.47470399999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.8987, std=2.9563
[DEBUG][MIA] Test Set Loss:   mean=9.8549, std=7.2592
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.55, 'auc': 0.796875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.1888, std=6.4464
[DEBUG][MIA] Test Set Loss:   mean=9.5532, std=7.1676
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11399999999999999, 'auc': 0.556832, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6387, std=1.0681
[DEBUG][MIA] Test Set Loss:   mean=5.0012, std=5.3210
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.5666666666666667, 'auc': 0.74951171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.4361, std=3.9402
[DEBUG][MIA] Test Set Loss:   mean=4.4415, std=4.7474
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.12, 'auc': 0.552368, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4583, std=0.8288
[DEBUG][MIA] Test Set Loss:   mean=5.2747, std=5.4602
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8, 'auc': 0.755859375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.8064, std=4.2271
[DEBUG][MIA] Test Set Loss:   mean=4.5900, std=4.4771
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.152, 'auc': 0.552304, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.7001, std=2.0803
[DEBUG][MIA] Test Set Loss:   mean=6.2476, std=6.2983
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.5833333333333334, 'auc': 0.78271484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8755, std=4.2926
[DEBUG][MIA] Test Set Loss:   mean=4.6437, std=4.9857
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.53952, 'task': 8}
Total correct retain:  1600  Total retain:  2500
Total correct forget:  15576  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  2983  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.612, 0.602, 0.58, 0.474, 0.474, 0.214, 0.342, 0.332, 0.324, 0.234, 0.32, 0.28, 0.162, 0.224, 0.176, 0.2, 0.316, 0.31, 0.18, 0.222]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=1.4081, std=2.5239
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7333333333333333, 'auc': 0.8779296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0611, std=3.1614
[DEBUG][MIA] Test Set Loss:   mean=1.9530, std=2.9990
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11200000000000002, 'auc': 0.5132, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0268
[DEBUG][MIA] Test Set Loss:   mean=3.1774, std=4.0942
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8333333333333333, 'auc': 0.84912109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3950, std=3.3805
[DEBUG][MIA] Test Set Loss:   mean=2.4131, std=3.1789
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.11000000000000001, 'auc': 0.517312, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0092
[DEBUG][MIA] Test Set Loss:   mean=2.9168, std=3.7742
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.8166666666666667, 'auc': 0.9521484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8356, std=4.0071
[DEBUG][MIA] Test Set Loss:   mean=3.3073, std=4.1756
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.1, 'auc': 0.5499999999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.9391, std=2.9259
[DEBUG][MIA] Test Set Loss:   mean=5.1465, std=5.4878
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.6333333333333334, 'auc': 0.669921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.9621, std=6.6066
[DEBUG][MIA] Test Set Loss:   mean=8.5899, std=7.0699
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.1, 'auc': 0.484176, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.3066, std=3.3706
[DEBUG][MIA] Test Set Loss:   mean=11.6578, std=8.4974
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.5333333333333333, 'auc': 0.8017578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=9.2854, std=6.8222
[DEBUG][MIA] Test Set Loss:   mean=10.1229, std=7.9056
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10400000000000001, 'auc': 0.522384, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2893, std=0.5180
[DEBUG][MIA] Test Set Loss:   mean=3.5583, std=3.9468
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7333333333333334, 'auc': 0.763671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.9769, std=3.6025
[DEBUG][MIA] Test Set Loss:   mean=3.5679, std=4.3787
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.156, 'auc': 0.531304, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9329, std=1.2456
[DEBUG][MIA] Test Set Loss:   mean=5.2458, std=4.6566
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.4833333333333333, 'auc': 0.775390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1098, std=4.4547
[DEBUG][MIA] Test Set Loss:   mean=5.7177, std=5.3942
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.11399999999999999, 'auc': 0.580592, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7930, std=3.2944
[DEBUG][MIA] Test Set Loss:   mean=4.4245, std=6.1987
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.5166666666666666, 'auc': 0.4697265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.8157, std=5.7226
[DEBUG][MIA] Test Set Loss:   mean=6.9594, std=6.3556
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10600000000000001, 'auc': 0.5540080000000001, 'task': 8}
Total correct retain:  1516  Total retain:  2500
Total correct forget:  14554  Total forget:  47500
Total correct test:  286  Total test:  500
Total correct forget test:  2785  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.572, 0.564, 0.528, 0.42, 0.244, 0.22, 0.402, 0.284, 0.256, 0.272, 0.346, 0.238, 0.15, 0.262, 0.198, 0.22, 0.258, 0.328, 0.178, 0.202]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0001
[DEBUG][MIA] Test Set Loss:   mean=1.5849, std=2.2941
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.8166666666666667, 'auc': 0.884765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6655, std=2.6349
[DEBUG][MIA] Test Set Loss:   mean=1.7282, std=2.6591
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.486032, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.8860, std=4.1006
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7500000000000001, 'auc': 0.888671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0885, std=3.0138
[DEBUG][MIA] Test Set Loss:   mean=2.3747, std=3.3977
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.09, 'auc': 0.516072, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3764, std=1.9039
[DEBUG][MIA] Test Set Loss:   mean=7.9042, std=7.4151
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7166666666666666, 'auc': 0.796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.7579, std=6.2963
[DEBUG][MIA] Test Set Loss:   mean=8.1393, std=6.5740
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10600000000000001, 'auc': 0.5160560000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.0474, std=3.1659
[DEBUG][MIA] Test Set Loss:   mean=12.4228, std=8.4420
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.5833333333333333, 'auc': 0.818359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.9833, std=7.8049
[DEBUG][MIA] Test Set Loss:   mean=10.3347, std=8.1424
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.096, 'auc': 0.51068, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.0368, std=2.8886
[DEBUG][MIA] Test Set Loss:   mean=11.1884, std=7.4133
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6166666666666667, 'auc': 0.8193359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.3240, std=7.1567
[DEBUG][MIA] Test Set Loss:   mean=9.6858, std=7.4620
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11000000000000001, 'auc': 0.555216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8103, std=1.4357
[DEBUG][MIA] Test Set Loss:   mean=4.8647, std=4.7982
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6, 'auc': 0.75244140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.2244, std=4.8171
[DEBUG][MIA] Test Set Loss:   mean=4.7091, std=5.2952
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.132, 'auc': 0.520328, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2296, std=1.8026
[DEBUG][MIA] Test Set Loss:   mean=4.6755, std=5.3711
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.41666666666666663, 'auc': 0.7021484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.0260, std=4.9474
[DEBUG][MIA] Test Set Loss:   mean=6.2493, std=5.8135
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.557624, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.1158, std=3.1882
[DEBUG][MIA] Test Set Loss:   mean=5.9650, std=5.3862
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.5666666666666667, 'auc': 0.6474609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.9281, std=4.8768
[DEBUG][MIA] Test Set Loss:   mean=5.7502, std=5.2942
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.542288, 'task': 8}
Total correct retain:  1546  Total retain:  2500
Total correct forget:  13865  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  2669  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.578, 0.598, 0.556, 0.22, 0.222, 0.228, 0.35, 0.282, 0.27, 0.236, 0.306, 0.258, 0.166, 0.214, 0.184, 0.2, 0.314, 0.324, 0.19, 0.22]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.6412, std=2.5567
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.33333333333333337, 'auc': 0.9169921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7230, std=2.7832
[DEBUG][MIA] Test Set Loss:   mean=1.6104, std=2.3785
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.128, 'auc': 0.47560800000000003, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.5804, std=6.0720
[DEBUG][MIA] Test Set Loss:   mean=13.2067, std=11.4227
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.41666666666666663, 'auc': 0.62109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=13.5493, std=9.3040
[DEBUG][MIA] Test Set Loss:   mean=12.9952, std=9.5619
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.09, 'auc': 0.48208799999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2861, std=2.8136
[DEBUG][MIA] Test Set Loss:   mean=7.9108, std=5.7273
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7499999999999999, 'auc': 0.7919921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.8784, std=6.4180
[DEBUG][MIA] Test Set Loss:   mean=7.9563, std=6.3415
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10200000000000001, 'auc': 0.49908, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0703, std=3.5920
[DEBUG][MIA] Test Set Loss:   mean=10.4372, std=7.0873
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.4833333333333333, 'auc': 0.765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.9087, std=7.0500
[DEBUG][MIA] Test Set Loss:   mean=9.8557, std=7.3843
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.098, 'auc': 0.5016, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.9767, std=3.2604
[DEBUG][MIA] Test Set Loss:   mean=10.0186, std=7.4597
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6333333333333334, 'auc': 0.73388671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=8.9488, std=6.8352
[DEBUG][MIA] Test Set Loss:   mean=10.6306, std=7.8969
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10600000000000001, 'auc': 0.5678320000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8782, std=1.3041
[DEBUG][MIA] Test Set Loss:   mean=6.7195, std=5.9317
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.5833333333333333, 'auc': 0.80908203125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.6702, std=4.7736
[DEBUG][MIA] Test Set Loss:   mean=5.4553, std=5.1594
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.10600000000000001, 'auc': 0.5479519999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.0940, std=2.5672
[DEBUG][MIA] Test Set Loss:   mean=6.9910, std=5.4912
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.55, 'auc': 0.76708984375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.8604, std=5.0598
[DEBUG][MIA] Test Set Loss:   mean=6.9655, std=5.5332
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10400000000000001, 'auc': 0.55364, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1592, std=3.6560
[DEBUG][MIA] Test Set Loss:   mean=7.0688, std=5.1816
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.6333333333333333, 'auc': 0.6611328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.0842, std=5.6513
[DEBUG][MIA] Test Set Loss:   mean=7.5127, std=6.4226
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.09, 'auc': 0.5640879999999999, 'task': 8}
Total correct retain:  1483  Total retain:  2500
Total correct forget:  12475  Total forget:  47500
Total correct test:  274  Total test:  500
Total correct forget test:  2428  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.548, 0.602, 0.2, 0.216, 0.216, 0.21, 0.298, 0.232, 0.258, 0.248, 0.308, 0.268, 0.16, 0.206, 0.192, 0.206, 0.324, 0.31, 0.192, 0.21]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 8, 8, 5, 6, 5, 9, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0867, std=1.7020
[DEBUG][MIA] Test Set Loss:   mean=5.5296, std=4.9764
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6, 'auc': 0.8037109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 7 8 5 5 8 9 6 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 7 5 7 7 7 8 8 6 6]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.3231, std=4.8295
[DEBUG][MIA] Test Set Loss:   mean=5.2746, std=5.2507
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10200000000000001, 'auc': 0.513, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([12, 11, 10, 14, 10, 11, 12, 11, 12, 13], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.9326, std=7.8821
[DEBUG][MIA] Test Set Loss:   mean=11.9674, std=10.4110
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.16666666666666669, 'auc': 0.5771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 13 13 11 11 13 13 10 11 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 13 13 12 12 10 13 14 10 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=15.5945, std=10.6182
[DEBUG][MIA] Test Set Loss:   mean=16.3945, std=10.5891
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.09, 'auc': 0.523712, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 15, 19, 19, 16, 15, 16, 15, 16, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=4.0226, std=3.9959
[DEBUG][MIA] Test Set Loss:   mean=9.5975, std=7.1233
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6, 'auc': 0.734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [16 15 19 19 19 15 16 19 18 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 17 16 19 18 17 18 15 18 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.3811, std=8.0126
[DEBUG][MIA] Test Set Loss:   mean=11.1041, std=8.0254
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.48964799999999997, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 23, 20, 21, 23, 20, 22, 24], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.8417, std=4.9421
[DEBUG][MIA] Test Set Loss:   mean=9.5529, std=8.7123
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.4833333333333334, 'auc': 0.6650390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [22 21 21 20 22 23 20 21 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 22 24 21 22 22 21 24 24 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.2365, std=8.3391
[DEBUG][MIA] Test Set Loss:   mean=11.8195, std=7.8699
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.51028, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([28, 27, 28, 25, 27, 29, 28, 28, 28, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.6669, std=4.6923
[DEBUG][MIA] Test Set Loss:   mean=11.0379, std=8.6810
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.6, 'auc': 0.68994140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [25 27 26 28 26 29 26 25 29 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 27 25 26 28 26 27 28 27 25]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=11.8277, std=7.9796
[DEBUG][MIA] Test Set Loss:   mean=12.9191, std=8.5967
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.541032, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([32, 33, 33, 33, 30, 34, 33, 33, 33, 33], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8250, std=2.4259
[DEBUG][MIA] Test Set Loss:   mean=5.6927, std=6.5794
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.6833333333333333, 'auc': 0.662109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 31 30 33 32 31 33 33 31 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [33 34 31 32 33 33 32 30 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.8482, std=4.8492
[DEBUG][MIA] Test Set Loss:   mean=6.4053, std=5.5420
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.11200000000000002, 'auc': 0.586256, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([35, 35, 38, 37, 36, 38, 38, 37, 37, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.8101, std=3.2369
[DEBUG][MIA] Test Set Loss:   mean=8.8732, std=5.7530
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6166666666666666, 'auc': 0.80078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [37 39 38 36 37 37 39 38 38 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 37 36 35 38 36 37 36 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.0743, std=5.5414
[DEBUG][MIA] Test Set Loss:   mean=7.5726, std=5.5999
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11599999999999999, 'auc': 0.526848, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([44, 41, 40, 40, 41, 44, 43, 41, 41, 43], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.1349, std=4.2955
[DEBUG][MIA] Test Set Loss:   mean=7.4063, std=5.0778
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.08333333333333333, 'auc': 0.68798828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 44 42 44 40 44 44 44 41 40]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 42 40 43 44 42 40 43 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.7027, std=6.3179
[DEBUG][MIA] Test Set Loss:   mean=8.1619, std=6.4310
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10800000000000001, 'auc': 0.523992, 'task': 8}
Total correct retain:  1389  Total retain:  2500
Total correct forget:  11097  Total forget:  47500
Total correct test:  256  Total test:  500
Total correct forget test:  2176  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.512, 0.31, 0.2, 0.202, 0.208, 0.204, 0.26, 0.214, 0.234, 0.236, 0.268, 0.242, 0.166, 0.21, 0.2, 0.236, 0.268, 0.31, 0.18, 0.204]
Number of constraint violations:  134
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: negagem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sat Apr 26 23:59:50 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 40%   69C    P0             51W /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['palm', 'rocket', 'pine', 'wardrobe', 'clock', 'turtle', 'camel', 'forest', 'couch', 'wolf', 'train', 'bus', 'possum', 'plain', 'bottles', 'girl', 'oak', 'elephant', 'porcupine', 'boy', 'bicycle', 'oranges', 'crab', 'dinosaur', 'fox', 'lizard', 'lion', 'shark', 'mountain', 'tank', 'baby', 'mouse', 'pears', 'chair', 'streetcar', 'seal', 'sea', 'flatfish', 'cockroach', 'dolphin', 'plates', 'cups', 'lawn-mower', 'mushrooms', 'crocodile', 'snail', 'beetle', 'table', 'man', 'sunflowers', 'cattle', 'skunk', 'computer keyboard', 'aquarium fish', 'kangaroo', 'whale', 'cans', 'telephone', 'tractor', 'sweet peppers', 'spider', 'bridge', 'willow', 'cloud', 'otter', 'woman', 'rabbit', 'motorcycle', 'beaver', 'orchids', 'ray', 'poppies', 'tulips', 'bowls', 'leopard', 'lamp', 'castle', 'raccoon', 'bee', 'roses', 'television', 'butterfly', 'hamster', 'shrew', 'house', 'bed', 'apples', 'tiger', 'snake', 'trout', 'chimpanzee', 'skyscraper', 'caterpillar', 'bear', 'lobster', 'worm', 'road', 'maple', 'squirrel', 'pickup truck']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2487  Total retain:  2500
Total correct forget:  9015  Total forget:  47500
Total correct test:  421  Total test:  500
Total correct forget test:  1771  Total test forget:  9500
After learning task 1
Task accuracies: [0.842, 0.208, 0.174, 0.182, 0.174, 0.208, 0.2, 0.2, 0.2, 0.18, 0.164, 0.188, 0.17, 0.192, 0.222, 0.138, 0.126, 0.26, 0.19, 0.166]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0146, std=0.0608
[DEBUG][MIA] Test Set Loss:   mean=1.3616, std=2.3494
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.65, 'auc': 0.7861328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0616, std=0.5843
[DEBUG][MIA] Test Set Loss:   mean=1.3396, std=2.3926
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.702, 'cv_acc': 0.6679999999999999, 'auc': 0.798768, 'task': 1}
2 1
Total correct retain:  1858  Total retain:  2500
Total correct forget:  11227  Total forget:  47500
Total correct test:  338  Total test:  500
Total correct forget test:  2076  Total test forget:  9500
After learning task 2
Task accuracies: [0.676, 0.692, 0.198, 0.206, 0.14, 0.204, 0.208, 0.22, 0.186, 0.26, 0.2, 0.192, 0.242, 0.186, 0.13, 0.126, 0.16, 0.186, 0.182, 0.234]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0736, std=0.2014
[DEBUG][MIA] Test Set Loss:   mean=2.9560, std=2.9723
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666667, 'auc': 0.9169921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.2962, std=2.2106
[DEBUG][MIA] Test Set Loss:   mean=2.4196, std=3.1565
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.202, 'auc': 0.606096, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0227
[DEBUG][MIA] Test Set Loss:   mean=0.8389, std=2.3867
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.18333333333333332, 'auc': 0.6328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0161
[DEBUG][MIA] Test Set Loss:   mean=0.6676, std=1.8493
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.632, 'cv_acc': 0.20800000000000002, 'auc': 0.705816, 'task': 2}
3 2
Total correct retain:  1836  Total retain:  2500
Total correct forget:  12529  Total forget:  47500
Total correct test:  332  Total test:  500
Total correct forget test:  2345  Total test forget:  9500
After learning task 3
Task accuracies: [0.664, 0.484, 0.832, 0.226, 0.232, 0.178, 0.246, 0.218, 0.176, 0.216, 0.184, 0.212, 0.28, 0.178, 0.142, 0.14, 0.156, 0.204, 0.2, 0.186]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0159, std=0.0227
[DEBUG][MIA] Test Set Loss:   mean=1.5253, std=1.7440
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.75, 'auc': 0.8828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3131, std=1.8640
[DEBUG][MIA] Test Set Loss:   mean=2.3566, std=2.6174
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.15999999999999998, 'auc': 0.6056, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0089
[DEBUG][MIA] Test Set Loss:   mean=1.1277, std=2.3456
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.3, 'auc': 0.837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5779, std=1.5113
[DEBUG][MIA] Test Set Loss:   mean=1.0670, std=1.9794
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.19, 'auc': 0.5680560000000001, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=0.4044, std=1.0516
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.21666666666666665, 'auc': 0.69775390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0085, std=0.0512
[DEBUG][MIA] Test Set Loss:   mean=0.8659, std=1.7754
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.674, 'cv_acc': 0.26799999999999996, 'auc': 0.710128, 'task': 3}
4 3
Total correct retain:  1685  Total retain:  2500
Total correct forget:  13946  Total forget:  47500
Total correct test:  312  Total test:  500
Total correct forget test:  2492  Total test forget:  9500
After learning task 4
Task accuracies: [0.624, 0.422, 0.7, 0.744, 0.248, 0.228, 0.22, 0.242, 0.204, 0.2, 0.148, 0.2, 0.288, 0.202, 0.158, 0.078, 0.128, 0.258, 0.17, 0.146]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0129, std=0.0271
[DEBUG][MIA] Test Set Loss:   mean=2.0397, std=1.8923
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.890625, 'cv_acc': 0.7666666666666667, 'auc': 0.9423828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5568, std=2.0241
[DEBUG][MIA] Test Set Loss:   mean=2.2010, std=2.3851
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.13600000000000004, 'auc': 0.5818399999999999, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=1.4438, std=2.2022
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.31666666666666665, 'auc': 0.884765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7955, std=1.4642
[DEBUG][MIA] Test Set Loss:   mean=1.1869, std=1.9417
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.16199999999999998, 'auc': 0.556496, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.2756, std=2.2326
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666666, 'auc': 0.8251953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4876, std=1.2768
[DEBUG][MIA] Test Set Loss:   mean=1.3442, std=2.8992
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.22400000000000003, 'auc': 0.5886, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0104, std=0.0428
[DEBUG][MIA] Test Set Loss:   mean=0.3265, std=0.7419
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.13333333333333333, 'auc': 0.7734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0162
[DEBUG][MIA] Test Set Loss:   mean=0.4369, std=1.4428
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.196, 'auc': 0.6368640000000001, 'task': 4}
5 4
Total correct retain:  1591  Total retain:  2500
Total correct forget:  15339  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  2837  Total test forget:  9500
After learning task 5
Task accuracies: [0.604, 0.412, 0.624, 0.672, 0.884, 0.26, 0.24, 0.238, 0.232, 0.14, 0.148, 0.222, 0.238, 0.202, 0.218, 0.178, 0.14, 0.286, 0.2, 0.14]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.6535, std=1.7545
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7833333333333333, 'auc': 0.9990234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9580, std=2.3601
[DEBUG][MIA] Test Set Loss:   mean=2.1121, std=2.4890
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.53736, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.1755, std=2.4729
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.75, 'auc': 0.8955078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1127, std=1.8110
[DEBUG][MIA] Test Set Loss:   mean=1.2425, std=1.9296
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.12200000000000003, 'auc': 0.53352, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.2338, std=1.8222
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.26666666666666666, 'auc': 0.82421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9296, std=1.8349
[DEBUG][MIA] Test Set Loss:   mean=1.5011, std=2.2447
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.19, 'auc': 0.56516, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=1.4252, std=2.6468
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2833333333333333, 'auc': 0.736328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3869, std=1.0866
[DEBUG][MIA] Test Set Loss:   mean=0.7779, std=1.7699
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.176, 'auc': 0.546024, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0087, std=0.0318
[DEBUG][MIA] Test Set Loss:   mean=0.7847, std=1.6747
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.21666666666666665, 'auc': 0.76611328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0268, std=0.1921
[DEBUG][MIA] Test Set Loss:   mean=0.6559, std=1.7293
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.22799999999999998, 'auc': 0.686368, 'task': 5}
6 5
Total correct retain:  1581  Total retain:  2500
Total correct forget:  16500  Total forget:  47500
Total correct test:  313  Total test:  500
Total correct forget test:  3019  Total test forget:  9500
After learning task 6
Task accuracies: [0.626, 0.438, 0.614, 0.592, 0.784, 0.826, 0.23, 0.23, 0.202, 0.172, 0.22, 0.23, 0.25, 0.222, 0.17, 0.166, 0.162, 0.25, 0.178, 0.102]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0040, std=0.0075
[DEBUG][MIA] Test Set Loss:   mean=1.7209, std=1.4996
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.890625, 'cv_acc': 0.8166666666666668, 'auc': 0.998046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1959, std=2.6498
[DEBUG][MIA] Test Set Loss:   mean=2.5731, std=2.7291
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11600000000000002, 'auc': 0.550176, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.9123, std=2.4732
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666667, 'auc': 0.880859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2362, std=2.0999
[DEBUG][MIA] Test Set Loss:   mean=1.7329, std=2.8294
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.13, 'auc': 0.556992, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.0916, std=1.7544
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.8, 'auc': 0.7685546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1868, std=2.2533
[DEBUG][MIA] Test Set Loss:   mean=1.7521, std=2.7488
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.15200000000000002, 'auc': 0.548376, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=0.4371, std=0.9180
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.3, 'auc': 0.9130859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6043, std=1.5082
[DEBUG][MIA] Test Set Loss:   mean=0.9587, std=1.8494
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.178, 'auc': 0.536896, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0134
[DEBUG][MIA] Test Set Loss:   mean=1.4085, std=2.1383
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.3166666666666667, 'auc': 0.8251953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4371, std=0.9803
[DEBUG][MIA] Test Set Loss:   mean=1.0690, std=1.9583
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.18, 'auc': 0.597456, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0125
[DEBUG][MIA] Test Set Loss:   mean=1.1189, std=2.6885
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.11666666666666665, 'auc': 0.79296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0062, std=0.0381
[DEBUG][MIA] Test Set Loss:   mean=0.7093, std=1.8235
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.642, 'cv_acc': 0.21400000000000002, 'auc': 0.708752, 'task': 6}
7 6
Total correct retain:  1557  Total retain:  2500
Total correct forget:  17437  Total forget:  47500
Total correct test:  285  Total test:  500
Total correct forget test:  3133  Total test forget:  9500
After learning task 7
Task accuracies: [0.57, 0.416, 0.612, 0.604, 0.708, 0.696, 0.804, 0.228, 0.2, 0.142, 0.192, 0.22, 0.226, 0.21, 0.126, 0.138, 0.182, 0.202, 0.22, 0.14]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=1.9172, std=2.1917
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8166666666666667, 'auc': 0.9765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3908, std=2.9055
[DEBUG][MIA] Test Set Loss:   mean=3.0997, std=3.3191
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11399999999999999, 'auc': 0.564672, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=0.6145, std=1.5437
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.7833333333333333, 'auc': 0.822265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9538, std=1.8334
[DEBUG][MIA] Test Set Loss:   mean=1.3698, std=2.3369
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11000000000000001, 'auc': 0.551104, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=2.1877, std=2.8269
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333333, 'auc': 0.8798828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6066, std=2.5389
[DEBUG][MIA] Test Set Loss:   mean=1.6272, std=2.5119
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11200000000000002, 'auc': 0.50988, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.3626, std=2.3145
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.2666666666666667, 'auc': 0.8857421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8094, std=1.7037
[DEBUG][MIA] Test Set Loss:   mean=1.1678, std=2.0669
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11400000000000002, 'auc': 0.543056, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.4237, std=2.2863
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.2833333333333333, 'auc': 0.861328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.7887, std=1.5114
[DEBUG][MIA] Test Set Loss:   mean=1.2726, std=2.1741
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.19, 'auc': 0.5809759999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0060
[DEBUG][MIA] Test Set Loss:   mean=0.7481, std=1.8790
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.33333333333333337, 'auc': 0.76220703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3015, std=0.9124
[DEBUG][MIA] Test Set Loss:   mean=1.1146, std=2.1998
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.21400000000000002, 'auc': 0.627992, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0095, std=0.0488
[DEBUG][MIA] Test Set Loss:   mean=1.2732, std=2.9156
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2666666666666667, 'auc': 0.79736328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0146, std=0.0924
[DEBUG][MIA] Test Set Loss:   mean=0.9840, std=2.3582
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.626, 'cv_acc': 0.196, 'auc': 0.683032, 'task': 7}
8 7
Total correct retain:  1638  Total retain:  2500
Total correct forget:  18879  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  3418  Total test forget:  9500
After learning task 8
Task accuracies: [0.606, 0.356, 0.638, 0.586, 0.666, 0.65, 0.73, 0.808, 0.2, 0.222, 0.198, 0.22, 0.28, 0.26, 0.176, 0.124, 0.168, 0.206, 0.22, 0.128]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0050
[DEBUG][MIA] Test Set Loss:   mean=3.6027, std=3.1526
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.921875, 'cv_acc': 0.8333333333333333, 'auc': 0.9931640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4390, std=2.7488
[DEBUG][MIA] Test Set Loss:   mean=2.8653, std=2.9163
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.4448, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=1.1631, std=2.1165
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.8837890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5686, std=2.4475
[DEBUG][MIA] Test Set Loss:   mean=1.4974, std=2.3516
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.5059520000000001, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=2.6216, std=3.0660
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.7833333333333334, 'auc': 0.958984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8263, std=2.4546
[DEBUG][MIA] Test Set Loss:   mean=2.0106, std=2.8307
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.13400000000000004, 'auc': 0.521648, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0032
[DEBUG][MIA] Test Set Loss:   mean=1.8029, std=2.0011
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.3, 'auc': 0.916015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2612, std=2.0733
[DEBUG][MIA] Test Set Loss:   mean=1.4897, std=2.2157
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.096, 'auc': 0.535328, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0197
[DEBUG][MIA] Test Set Loss:   mean=0.8991, std=1.5272
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7166666666666667, 'auc': 0.8671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9909, std=1.7425
[DEBUG][MIA] Test Set Loss:   mean=1.1535, std=1.7845
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.20400000000000001, 'auc': 0.55344, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.9697, std=2.5825
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.3333333333333333, 'auc': 0.8984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9165, std=1.7346
[DEBUG][MIA] Test Set Loss:   mean=1.4883, std=2.1530
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.202, 'auc': 0.6050639999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0061
[DEBUG][MIA] Test Set Loss:   mean=0.7461, std=1.9520
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2833333333333333, 'auc': 0.76171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4075, std=1.0901
[DEBUG][MIA] Test Set Loss:   mean=1.1172, std=2.1635
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.16399999999999998, 'auc': 0.58792, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=0.5966, std=1.1995
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25, 'auc': 0.7900390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0064, std=0.0563
[DEBUG][MIA] Test Set Loss:   mean=0.4554, std=1.2823
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.21400000000000002, 'auc': 0.6672639999999999, 'task': 8}
Total correct retain:  1547  Total retain:  2500
Total correct forget:  19383  Total forget:  47500
Total correct test:  282  Total test:  500
Total correct forget test:  3540  Total test forget:  9500
After learning task 9
Task accuracies: [0.564, 0.364, 0.596, 0.494, 0.622, 0.634, 0.598, 0.722, 0.84, 0.23, 0.214, 0.304, 0.266, 0.208, 0.172, 0.116, 0.136, 0.21, 0.22, 0.134]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0066
[DEBUG][MIA] Test Set Loss:   mean=2.4539, std=2.8620
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.7833333333333333, 'auc': 0.9482421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2947, std=2.9754
[DEBUG][MIA] Test Set Loss:   mean=2.8270, std=3.4751
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.5588479999999999, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0094
[DEBUG][MIA] Test Set Loss:   mean=1.2993, std=2.2497
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.75, 'auc': 0.841796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4083, std=2.3115
[DEBUG][MIA] Test Set Loss:   mean=1.7907, std=2.5304
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10400000000000001, 'auc': 0.5414720000000001, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=0.9704, std=1.5975
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7666666666666667, 'auc': 0.86328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4133, std=2.2952
[DEBUG][MIA] Test Set Loss:   mean=1.8938, std=2.6174
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.128, 'auc': 0.555264, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.6040, std=2.4995
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.25, 'auc': 0.82275390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9435, std=1.7173
[DEBUG][MIA] Test Set Loss:   mean=1.0844, std=1.9272
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.092, 'auc': 0.529712, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0081, std=0.0189
[DEBUG][MIA] Test Set Loss:   mean=1.2210, std=1.6961
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7666666666666666, 'auc': 0.904296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1667, std=1.9215
[DEBUG][MIA] Test Set Loss:   mean=1.3979, std=2.1092
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.545696, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.6640, std=2.0839
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.8720703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8463, std=1.5293
[DEBUG][MIA] Test Set Loss:   mean=1.4507, std=2.2904
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.14799999999999996, 'auc': 0.5923039999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0033
[DEBUG][MIA] Test Set Loss:   mean=1.2088, std=2.5267
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.7666666666666666, 'auc': 0.8466796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5548, std=1.2334
[DEBUG][MIA] Test Set Loss:   mean=1.2250, std=2.2978
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.168, 'auc': 0.5914400000000001, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0139
[DEBUG][MIA] Test Set Loss:   mean=1.2253, std=2.1030
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333334, 'auc': 0.73046875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7252, std=1.5252
[DEBUG][MIA] Test Set Loss:   mean=0.9481, std=1.8053
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.20800000000000002, 'auc': 0.5582079999999999, 'task': 8}
Total correct retain:  1549  Total retain:  2500
Total correct forget:  21266  Total forget:  47500
Total correct test:  298  Total test:  500
Total correct forget test:  3903  Total test forget:  9500
After learning task 10
Task accuracies: [0.596, 0.392, 0.61, 0.568, 0.706, 0.556, 0.644, 0.696, 0.676, 0.798, 0.274, 0.284, 0.232, 0.236, 0.192, 0.148, 0.146, 0.216, 0.19, 0.242]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=2.9375, std=2.9015
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.875, 'cv_acc': 0.85, 'auc': 0.958984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2182, std=2.6410
[DEBUG][MIA] Test Set Loss:   mean=2.7338, std=2.9946
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10600000000000001, 'auc': 0.55048, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.8094, std=2.2261
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.2833333333333333, 'auc': 0.9111328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3396, std=2.2581
[DEBUG][MIA] Test Set Loss:   mean=1.4743, std=2.1525
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.13799999999999998, 'auc': 0.5453920000000001, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0017
[DEBUG][MIA] Test Set Loss:   mean=1.5455, std=2.2992
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.912109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9314, std=2.5393
[DEBUG][MIA] Test Set Loss:   mean=2.2024, std=2.9181
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.118, 'auc': 0.51096, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0015
[DEBUG][MIA] Test Set Loss:   mean=0.5215, std=1.3921
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.26666666666666666, 'auc': 0.8779296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2313, std=2.0454
[DEBUG][MIA] Test Set Loss:   mean=1.0744, std=1.8682
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.11400000000000002, 'auc': 0.503232, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0246, std=0.1152
[DEBUG][MIA] Test Set Loss:   mean=2.5988, std=2.9825
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7333333333333334, 'auc': 0.921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0640, std=1.9517
[DEBUG][MIA] Test Set Loss:   mean=1.3244, std=2.0003
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.096, 'auc': 0.575344, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.1942, std=2.7017
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8166666666666667, 'auc': 0.955078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0873, std=1.7809
[DEBUG][MIA] Test Set Loss:   mean=1.6788, std=2.1859
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.122, 'auc': 0.594928, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=0.7653, std=1.6767
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.25, 'auc': 0.796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5841, std=1.3910
[DEBUG][MIA] Test Set Loss:   mean=1.1688, std=2.2150
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.15199999999999997, 'auc': 0.5657760000000001, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=0.7691, std=1.3714
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7166666666666666, 'auc': 0.93359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.8436, std=1.4628
[DEBUG][MIA] Test Set Loss:   mean=1.2125, std=1.9541
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.174, 'auc': 0.53644, 'task': 8}
Total correct retain:  1554  Total retain:  2500
Total correct forget:  22279  Total forget:  47500
Total correct test:  304  Total test:  500
Total correct forget test:  4047  Total test forget:  9500
After learning task 11
Task accuracies: [0.608, 0.41, 0.6, 0.544, 0.686, 0.634, 0.568, 0.712, 0.652, 0.716, 0.81, 0.272, 0.264, 0.188, 0.158, 0.128, 0.158, 0.206, 0.2, 0.188]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=3.1667, std=3.3218
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.8333333333333334, 'auc': 0.99609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0939, std=2.6166
[DEBUG][MIA] Test Set Loss:   mean=2.8778, std=3.2582
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.098, 'auc': 0.571376, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.9888, std=2.6452
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7500000000000001, 'auc': 0.8876953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7882, std=2.8571
[DEBUG][MIA] Test Set Loss:   mean=1.6416, std=2.6100
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.11000000000000001, 'auc': 0.497968, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.2032, std=3.1623
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8, 'auc': 0.849609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8899, std=2.8289
[DEBUG][MIA] Test Set Loss:   mean=2.2876, std=3.2423
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11000000000000001, 'auc': 0.532952, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.1091, std=1.4950
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2833333333333333, 'auc': 0.8818359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2496, std=2.1598
[DEBUG][MIA] Test Set Loss:   mean=1.3033, std=2.2114
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.098, 'auc': 0.47472799999999993, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1314, std=0.4066
[DEBUG][MIA] Test Set Loss:   mean=2.3147, std=3.4457
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6666666666666666, 'auc': 0.8623046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5528, std=2.6253
[DEBUG][MIA] Test Set Loss:   mean=1.6112, std=2.4492
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.118, 'auc': 0.55692, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.4847, std=2.1413
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7833333333333333, 'auc': 0.84375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5458, std=2.4450
[DEBUG][MIA] Test Set Loss:   mean=1.7722, std=2.5642
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.16, 'auc': 0.523216, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0623, std=0.2797
[DEBUG][MIA] Test Set Loss:   mean=1.4108, std=2.8440
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.6666666666666667, 'auc': 0.66015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0110, std=2.0900
[DEBUG][MIA] Test Set Loss:   mean=1.6578, std=2.9164
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.13399999999999998, 'auc': 0.5555680000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0020
[DEBUG][MIA] Test Set Loss:   mean=1.6442, std=2.6063
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7999999999999999, 'auc': 0.931640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1055, std=2.1568
[DEBUG][MIA] Test Set Loss:   mean=1.3821, std=2.3951
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.14799999999999996, 'auc': 0.545456, 'task': 8}
Total correct retain:  1448  Total retain:  2500
Total correct forget:  19977  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  3663  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.552, 0.39, 0.576, 0.544, 0.676, 0.594, 0.55, 0.668, 0.638, 0.702, 0.258, 0.254, 0.254, 0.196, 0.14, 0.134, 0.15, 0.21, 0.196, 0.196]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.6951, std=3.3356
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8, 'auc': 0.982421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4440, std=3.1133
[DEBUG][MIA] Test Set Loss:   mean=3.1141, std=3.4107
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.09, 'auc': 0.565968, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=0.8625, std=1.1397
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7500000000000001, 'auc': 0.951171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5838, std=2.5513
[DEBUG][MIA] Test Set Loss:   mean=1.9466, std=2.7129
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.096, 'auc': 0.5447839999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.7129, std=3.3840
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7833333333333334, 'auc': 0.861328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9239, std=2.9320
[DEBUG][MIA] Test Set Loss:   mean=2.0736, std=3.1081
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.118, 'auc': 0.5166879999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.0489, std=1.7519
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.33333333333333337, 'auc': 0.91796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3022, std=2.3055
[DEBUG][MIA] Test Set Loss:   mean=1.0656, std=1.8808
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.14799999999999996, 'auc': 0.511856, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0799, std=0.3095
[DEBUG][MIA] Test Set Loss:   mean=2.2755, std=2.9661
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.65, 'auc': 0.875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4266, std=2.2308
[DEBUG][MIA] Test Set Loss:   mean=1.8304, std=2.8091
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.1, 'auc': 0.45032, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.3399, std=2.4233
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7666666666666667, 'auc': 0.900390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3481, std=2.2113
[DEBUG][MIA] Test Set Loss:   mean=1.6584, std=2.3288
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.186, 'auc': 0.556064, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0075
[DEBUG][MIA] Test Set Loss:   mean=1.6230, std=2.7853
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2833333333333333, 'auc': 0.7314453125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9408, std=1.9697
[DEBUG][MIA] Test Set Loss:   mean=1.2091, std=2.3385
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.182, 'auc': 0.523312, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.1154, std=2.0261
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.31666666666666665, 'auc': 0.86328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.9240, std=1.9014
[DEBUG][MIA] Test Set Loss:   mean=1.5528, std=2.7525
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12400000000000003, 'auc': 0.551056, 'task': 8}
Total correct retain:  1535  Total retain:  2500
Total correct forget:  18552  Total forget:  47500
Total correct test:  301  Total test:  500
Total correct forget test:  3439  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.602, 0.388, 0.582, 0.532, 0.682, 0.602, 0.552, 0.682, 0.656, 0.202, 0.294, 0.248, 0.26, 0.188, 0.148, 0.132, 0.134, 0.228, 0.198, 0.17]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.7764, std=2.4484
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.875, 'cv_acc': 0.7499999999999999, 'auc': 0.990234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6353, std=3.5155
[DEBUG][MIA] Test Set Loss:   mean=3.1383, std=3.6693
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.13999999999999999, 'auc': 0.551088, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=2.1332, std=2.9995
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.3166666666666667, 'auc': 0.9072265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6602, std=2.6844
[DEBUG][MIA] Test Set Loss:   mean=1.7868, std=2.7753
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.118, 'auc': 0.510312, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0080
[DEBUG][MIA] Test Set Loss:   mean=3.2670, std=3.8505
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.75, 'auc': 0.921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9330, std=3.0028
[DEBUG][MIA] Test Set Loss:   mean=2.3795, std=3.1684
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11000000000000001, 'auc': 0.535416, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.1311, std=2.9903
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.21666666666666665, 'auc': 0.9814453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1131, std=2.1129
[DEBUG][MIA] Test Set Loss:   mean=1.2756, std=2.3942
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10800000000000001, 'auc': 0.53288, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0565, std=0.2583
[DEBUG][MIA] Test Set Loss:   mean=1.2589, std=2.5198
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6499999999999999, 'auc': 0.853515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4528, std=2.3117
[DEBUG][MIA] Test Set Loss:   mean=1.7301, std=2.6234
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.11000000000000001, 'auc': 0.453392, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8103, std=2.4076
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7333333333333333, 'auc': 0.9765625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2780, std=1.9765
[DEBUG][MIA] Test Set Loss:   mean=1.8997, std=2.6529
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.128, 'auc': 0.578488, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=1.7274, std=2.9080
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2666666666666667, 'auc': 0.8291015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6025, std=1.4696
[DEBUG][MIA] Test Set Loss:   mean=1.2911, std=2.3500
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.134, 'auc': 0.572792, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.4494, std=1.4989
[DEBUG][MIA] Test Set Loss:   mean=5.2105, std=3.4917
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6, 'auc': 0.84375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.8786, std=4.9949
[DEBUG][MIA] Test Set Loss:   mean=5.7276, std=4.9117
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.086, 'auc': 0.490672, 'task': 8}
Total correct retain:  1539  Total retain:  2500
Total correct forget:  17375  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  3278  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.6, 0.424, 0.586, 0.508, 0.678, 0.59, 0.568, 0.694, 0.25, 0.204, 0.28, 0.276, 0.24, 0.194, 0.164, 0.134, 0.156, 0.228, 0.196, 0.186]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0079
[DEBUG][MIA] Test Set Loss:   mean=3.3953, std=3.0806
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.8, 'auc': 0.9775390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4251, std=3.2624
[DEBUG][MIA] Test Set Loss:   mean=2.9764, std=3.2437
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.10200000000000001, 'auc': 0.567376, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.2754, std=1.9874
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.3, 'auc': 0.853515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3056, std=2.0934
[DEBUG][MIA] Test Set Loss:   mean=1.8286, std=2.6505
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11400000000000002, 'auc': 0.548864, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0213, std=0.0894
[DEBUG][MIA] Test Set Loss:   mean=2.3725, std=2.4459
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.8, 'auc': 0.9248046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8035, std=2.5131
[DEBUG][MIA] Test Set Loss:   mean=2.1793, std=2.7295
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.530776, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.7392, std=2.5598
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.2833333333333333, 'auc': 0.947265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4267, std=2.3597
[DEBUG][MIA] Test Set Loss:   mean=1.5636, std=2.3368
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10600000000000001, 'auc': 0.535496, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0150, std=0.0536
[DEBUG][MIA] Test Set Loss:   mean=1.6484, std=2.6722
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666666, 'auc': 0.8857421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7895, std=2.6603
[DEBUG][MIA] Test Set Loss:   mean=1.6976, std=2.5452
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.094, 'auc': 0.5219119999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0065
[DEBUG][MIA] Test Set Loss:   mean=1.6885, std=2.7274
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7166666666666667, 'auc': 0.931640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2736, std=2.1602
[DEBUG][MIA] Test Set Loss:   mean=1.8892, std=2.8156
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.136, 'auc': 0.565728, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.5612, std=2.7250
[DEBUG][MIA] Test Set Loss:   mean=7.6622, std=5.6340
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.55, 'auc': 0.69921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.6518, std=5.7034
[DEBUG][MIA] Test Set Loss:   mean=7.8297, std=6.1428
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.13799999999999998, 'auc': 0.557016, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.8157, std=2.7615
[DEBUG][MIA] Test Set Loss:   mean=7.3546, std=5.3444
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4833333333333334, 'auc': 0.7412109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9784, std=5.6426
[DEBUG][MIA] Test Set Loss:   mean=7.6803, std=6.0286
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.1, 'auc': 0.467728, 'task': 8}
Total correct retain:  1579  Total retain:  2500
Total correct forget:  15660  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  2936  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.592, 0.378, 0.58, 0.476, 0.624, 0.554, 0.526, 0.204, 0.222, 0.2, 0.354, 0.288, 0.222, 0.19, 0.168, 0.114, 0.174, 0.24, 0.188, 0.17]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0147
[DEBUG][MIA] Test Set Loss:   mean=2.5334, std=3.4373
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.75, 'auc': 0.978515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0766, std=3.6474
[DEBUG][MIA] Test Set Loss:   mean=3.3767, std=3.6835
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.098, 'auc': 0.530512, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=2.1340, std=2.9290
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7666666666666667, 'auc': 0.9228515625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9070, std=2.8903
[DEBUG][MIA] Test Set Loss:   mean=1.9767, std=2.9373
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10200000000000001, 'auc': 0.5080640000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.0843, std=2.5468
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.75, 'auc': 0.96875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.3835, std=3.3755
[DEBUG][MIA] Test Set Loss:   mean=2.6872, std=3.5904
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.1, 'auc': 0.526456, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=1.5964, std=2.9818
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2833333333333333, 'auc': 0.8759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.4153, std=2.7346
[DEBUG][MIA] Test Set Loss:   mean=1.2055, std=2.1411
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.12000000000000002, 'auc': 0.5367200000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0230, std=0.0841
[DEBUG][MIA] Test Set Loss:   mean=1.1281, std=1.5894
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6, 'auc': 0.8994140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4152, std=2.2538
[DEBUG][MIA] Test Set Loss:   mean=1.6680, std=2.4306
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11400000000000002, 'auc': 0.5411039999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0641, std=1.6163
[DEBUG][MIA] Test Set Loss:   mean=5.3544, std=6.0579
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6166666666666667, 'auc': 0.68310546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.4372, std=4.5116
[DEBUG][MIA] Test Set Loss:   mean=5.3147, std=5.6830
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10600000000000001, 'auc': 0.524032, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.7345, std=2.7912
[DEBUG][MIA] Test Set Loss:   mean=6.8427, std=6.4815
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.4999999999999999, 'auc': 0.650390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.8263, std=5.6971
[DEBUG][MIA] Test Set Loss:   mean=7.5788, std=5.6354
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.54396, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.9160, std=2.2226
[DEBUG][MIA] Test Set Loss:   mean=7.3489, std=5.6035
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.55, 'auc': 0.8232421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.9224, std=5.5115
[DEBUG][MIA] Test Set Loss:   mean=6.6024, std=5.4213
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.12600000000000003, 'auc': 0.48932, 'task': 8}
Total correct retain:  1528  Total retain:  2500
Total correct forget:  14680  Total forget:  47500
Total correct test:  296  Total test:  500
Total correct forget test:  2825  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.592, 0.394, 0.588, 0.51, 0.662, 0.606, 0.306, 0.212, 0.212, 0.204, 0.252, 0.26, 0.242, 0.186, 0.168, 0.11, 0.124, 0.228, 0.204, 0.182]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0049
[DEBUG][MIA] Test Set Loss:   mean=3.0440, std=2.9319
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.890625, 'cv_acc': 0.8333333333333333, 'auc': 0.990234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6028, std=3.1040
[DEBUG][MIA] Test Set Loss:   mean=3.3425, std=3.3889
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10400000000000001, 'auc': 0.57352, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=1.4733, std=2.1244
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7166666666666667, 'auc': 0.923828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4943, std=2.3301
[DEBUG][MIA] Test Set Loss:   mean=1.6348, std=2.3939
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.15, 'auc': 0.51064, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0087, std=0.0283
[DEBUG][MIA] Test Set Loss:   mean=3.0144, std=3.1943
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7333333333333333, 'auc': 0.919921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9088, std=2.6720
[DEBUG][MIA] Test Set Loss:   mean=2.5056, std=3.2018
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10400000000000001, 'auc': 0.557744, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.7230, std=2.7573
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6666666666666667, 'auc': 0.80078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1423, std=2.1706
[DEBUG][MIA] Test Set Loss:   mean=1.4463, std=2.4193
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.08399999999999999, 'auc': 0.473736, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5206, std=0.8448
[DEBUG][MIA] Test Set Loss:   mean=4.8319, std=4.0954
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.6666666666666667, 'auc': 0.85498046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.8887, std=4.7300
[DEBUG][MIA] Test Set Loss:   mean=5.0270, std=4.7494
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10200000000000001, 'auc': 0.5103759999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4081, std=0.9600
[DEBUG][MIA] Test Set Loss:   mean=3.9454, std=4.6013
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6833333333333333, 'auc': 0.70068359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.8236, std=3.5604
[DEBUG][MIA] Test Set Loss:   mean=4.2223, std=4.8078
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.08399999999999999, 'auc': 0.5669280000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0587, std=2.5786
[DEBUG][MIA] Test Set Loss:   mean=6.1812, std=4.7278
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.3833333333333333, 'auc': 0.71533203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=6.1025, std=5.0251
[DEBUG][MIA] Test Set Loss:   mean=6.6161, std=5.2803
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11000000000000001, 'auc': 0.526128, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.0365, std=2.3829
[DEBUG][MIA] Test Set Loss:   mean=5.6791, std=4.0384
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7, 'auc': 0.77734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.1334, std=4.7483
[DEBUG][MIA] Test Set Loss:   mean=5.7346, std=5.0462
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.088, 'auc': 0.5342959999999999, 'task': 8}
Total correct retain:  1494  Total retain:  2500
Total correct forget:  14424  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  2732  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.594, 0.388, 0.58, 0.482, 0.646, 0.266, 0.392, 0.216, 0.248, 0.202, 0.276, 0.252, 0.234, 0.196, 0.156, 0.108, 0.174, 0.234, 0.202, 0.212]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0170, std=0.0584
[DEBUG][MIA] Test Set Loss:   mean=2.8704, std=2.9726
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.85, 'auc': 0.951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6192, std=2.9397
[DEBUG][MIA] Test Set Loss:   mean=3.3199, std=3.5933
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.078, 'auc': 0.537968, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.9718, std=2.5845
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666667, 'auc': 0.92578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1420, std=2.1045
[DEBUG][MIA] Test Set Loss:   mean=1.7638, std=2.5291
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.1, 'auc': 0.579392, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=2.6456, std=2.9546
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.8, 'auc': 0.8837890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5586, std=3.2753
[DEBUG][MIA] Test Set Loss:   mean=2.7866, std=3.3714
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.468, 'cv_acc': 0.1, 'auc': 0.4671040000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.6944, std=5.0208
[DEBUG][MIA] Test Set Loss:   mean=10.3202, std=8.3641
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.16666666666666666, 'auc': 0.6513671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.8029, std=7.4676
[DEBUG][MIA] Test Set Loss:   mean=9.4972, std=7.6740
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.088, 'auc': 0.529488, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5367, std=0.8493
[DEBUG][MIA] Test Set Loss:   mean=6.5513, std=4.9062
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.6833333333333333, 'auc': 0.8173828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.3801, std=4.4236
[DEBUG][MIA] Test Set Loss:   mean=5.0594, std=4.4341
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.11800000000000002, 'auc': 0.54584, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5675, std=2.1217
[DEBUG][MIA] Test Set Loss:   mean=3.6316, std=4.5030
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.6333333333333334, 'auc': 0.61181640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.9056, std=4.5197
[DEBUG][MIA] Test Set Loss:   mean=5.2291, std=5.4317
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.10400000000000001, 'auc': 0.5691679999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2329, std=3.0787
[DEBUG][MIA] Test Set Loss:   mean=7.6512, std=5.0784
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.5333333333333334, 'auc': 0.7001953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.0212, std=5.3634
[DEBUG][MIA] Test Set Loss:   mean=7.5689, std=5.9619
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.118, 'auc': 0.522936, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.2032, std=2.2915
[DEBUG][MIA] Test Set Loss:   mean=7.7386, std=6.4182
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.4833333333333333, 'auc': 0.77880859375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.0685, std=4.9346
[DEBUG][MIA] Test Set Loss:   mean=6.5926, std=5.4277
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.11200000000000002, 'auc': 0.524184, 'task': 8}
Total correct retain:  1483  Total retain:  2500
Total correct forget:  12768  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  2438  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.588, 0.384, 0.562, 0.432, 0.224, 0.274, 0.334, 0.204, 0.224, 0.202, 0.278, 0.244, 0.228, 0.204, 0.166, 0.124, 0.156, 0.236, 0.202, 0.198]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0176
[DEBUG][MIA] Test Set Loss:   mean=1.6352, std=2.1694
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.8666666666666666, 'auc': 0.8642578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4634, std=2.8207
[DEBUG][MIA] Test Set Loss:   mean=2.9193, std=3.1766
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10200000000000001, 'auc': 0.533896, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=1.4614, std=2.5714
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.6666666666666667, 'auc': 0.8662109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7800, std=2.7525
[DEBUG][MIA] Test Set Loss:   mean=1.7692, std=2.6416
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.11200000000000002, 'auc': 0.509688, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2635, std=2.1022
[DEBUG][MIA] Test Set Loss:   mean=7.7248, std=4.8700
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.5333333333333333, 'auc': 0.87841796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.9474, std=5.6078
[DEBUG][MIA] Test Set Loss:   mean=6.9170, std=5.7175
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.098, 'auc': 0.551864, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.9122, std=4.2755
[DEBUG][MIA] Test Set Loss:   mean=9.9987, std=7.6740
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.2333333333333333, 'auc': 0.69140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.1602, std=7.5971
[DEBUG][MIA] Test Set Loss:   mean=8.3145, std=7.0059
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10200000000000001, 'auc': 0.520544, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8547, std=1.4830
[DEBUG][MIA] Test Set Loss:   mean=5.5861, std=4.3539
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6666666666666666, 'auc': 0.83349609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.0979, std=4.7399
[DEBUG][MIA] Test Set Loss:   mean=5.6857, std=4.8813
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.11399999999999999, 'auc': 0.538136, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9283, std=1.5084
[DEBUG][MIA] Test Set Loss:   mean=5.3823, std=4.8652
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.25, 'auc': 0.7958984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.4272, std=4.6487
[DEBUG][MIA] Test Set Loss:   mean=5.3081, std=5.3984
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.092, 'auc': 0.540168, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.9384, std=3.9587
[DEBUG][MIA] Test Set Loss:   mean=9.0400, std=5.6677
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.4833333333333333, 'auc': 0.6728515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.4998, std=5.3401
[DEBUG][MIA] Test Set Loss:   mean=9.1003, std=6.1540
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10200000000000001, 'auc': 0.536552, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.8160, std=3.4014
[DEBUG][MIA] Test Set Loss:   mean=9.6269, std=5.8210
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.5, 'auc': 0.791015625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9768, std=5.8888
[DEBUG][MIA] Test Set Loss:   mean=7.4620, std=6.0433
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.124, 'auc': 0.472384, 'task': 8}
Total correct retain:  1512  Total retain:  2500
Total correct forget:  12279  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  2369  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.594, 0.388, 0.574, 0.256, 0.244, 0.248, 0.318, 0.204, 0.206, 0.2, 0.298, 0.25, 0.242, 0.202, 0.172, 0.122, 0.17, 0.248, 0.208, 0.188]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0794, std=0.1983
[DEBUG][MIA] Test Set Loss:   mean=3.1894, std=3.4989
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.75, 'auc': 0.919921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0719, std=3.2322
[DEBUG][MIA] Test Set Loss:   mean=3.3969, std=3.4079
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.529504, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.9792, std=5.3340
[DEBUG][MIA] Test Set Loss:   mean=11.7473, std=9.7083
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.41666666666666663, 'auc': 0.6796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.2706, std=8.0805
[DEBUG][MIA] Test Set Loss:   mean=10.3834, std=8.4449
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11200000000000002, 'auc': 0.501568, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1074, std=3.1461
[DEBUG][MIA] Test Set Loss:   mean=7.5865, std=4.7280
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.6666666666666667, 'auc': 0.81640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1338, std=5.2262
[DEBUG][MIA] Test Set Loss:   mean=6.7140, std=5.5024
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.094, 'auc': 0.47077600000000003, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.0088, std=3.4392
[DEBUG][MIA] Test Set Loss:   mean=8.7004, std=7.4394
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.4166666666666667, 'auc': 0.6416015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.1065, std=7.4767
[DEBUG][MIA] Test Set Loss:   mean=8.3642, std=6.7742
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.4787600000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2456, std=2.6295
[DEBUG][MIA] Test Set Loss:   mean=7.6418, std=5.2791
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.6166666666666666, 'auc': 0.7890625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.3357, std=4.9594
[DEBUG][MIA] Test Set Loss:   mean=6.2086, std=4.8546
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.076, 'auc': 0.55884, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3115, std=1.9589
[DEBUG][MIA] Test Set Loss:   mean=4.7332, std=5.2315
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.5333333333333333, 'auc': 0.6826171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.1950, std=4.3000
[DEBUG][MIA] Test Set Loss:   mean=4.8006, std=4.8176
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11599999999999999, 'auc': 0.530976, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.5123, std=3.2918
[DEBUG][MIA] Test Set Loss:   mean=9.9981, std=6.4528
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.4333333333333334, 'auc': 0.6640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.8617, std=5.7057
[DEBUG][MIA] Test Set Loss:   mean=9.8174, std=6.2451
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.098, 'auc': 0.4507359999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.5994, std=3.7468
[DEBUG][MIA] Test Set Loss:   mean=8.3657, std=5.6628
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.4666666666666667, 'auc': 0.70849609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=9.0337, std=5.3800
[DEBUG][MIA] Test Set Loss:   mean=9.0494, std=6.1934
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10600000000000001, 'auc': 0.49754399999999993, 'task': 8}
Total correct retain:  1532  Total retain:  2500
Total correct forget:  10765  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  2097  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.606, 0.334, 0.252, 0.224, 0.23, 0.234, 0.28, 0.2, 0.202, 0.2, 0.262, 0.256, 0.224, 0.2, 0.172, 0.128, 0.176, 0.258, 0.2, 0.162]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([9, 6, 5, 8, 9, 8, 6, 5, 8, 8], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.8920, std=5.1316
[DEBUG][MIA] Test Set Loss:   mean=10.4911, std=7.0781
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.25, 'auc': 0.69384765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [9 9 6 6 5 9 5 7 8 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [6 9 5 6 8 5 9 7 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.7942, std=7.3139
[DEBUG][MIA] Test Set Loss:   mean=9.7135, std=7.3647
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.49956800000000007, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([11, 11, 14, 11, 13, 12, 11, 11, 13, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=5.5976, std=5.3053
[DEBUG][MIA] Test Set Loss:   mean=8.6751, std=8.2293
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.4, 'auc': 0.60009765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [10 12 12 10 14 12 12 12 12 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 11 14 13 12 14 12 11 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.0775, std=8.3415
[DEBUG][MIA] Test Set Loss:   mean=9.8343, std=8.6303
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.11399999999999999, 'auc': 0.49564800000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([15, 16, 17, 17, 17, 18, 17, 19, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9965, std=2.4693
[DEBUG][MIA] Test Set Loss:   mean=7.0717, std=5.0301
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.65, 'auc': 0.79150390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [19 16 19 19 15 15 19 17 16 18]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [19 18 17 16 18 17 17 19 19 16]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.8894, std=5.2968
[DEBUG][MIA] Test Set Loss:   mean=6.2974, std=5.2821
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.094, 'auc': 0.5303519999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([24, 22, 23, 20, 21, 22, 21, 24, 24, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.7442, std=5.5253
[DEBUG][MIA] Test Set Loss:   mean=12.8985, std=8.1355
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.24999999999999994, 'auc': 0.71630859375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 22 21 24 21 21 20 23]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [21 20 20 22 24 22 24 22 20 20]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=10.6125, std=7.9754
[DEBUG][MIA] Test Set Loss:   mean=9.8608, std=7.6226
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.1, 'auc': 0.476504, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([26, 25, 27, 28, 27, 29, 26, 28, 26, 27], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6540, std=1.8772
[DEBUG][MIA] Test Set Loss:   mean=5.2461, std=3.8214
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.65, 'auc': 0.7900390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 27 26 28 27 29 25 26 27 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [28 26 28 27 28 27 26 26 26 29]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.0564, std=4.2706
[DEBUG][MIA] Test Set Loss:   mean=5.4461, std=4.3072
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10400000000000001, 'auc': 0.525352, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([31, 34, 33, 31, 31, 32, 32, 30, 30, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.3561, std=3.0295
[DEBUG][MIA] Test Set Loss:   mean=6.6394, std=5.4606
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.4666666666666667, 'auc': 0.755859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [34 33 31 33 33 34 34 30 34 30]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [34 33 32 30 31 32 33 32 33 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.5263, std=5.1975
[DEBUG][MIA] Test Set Loss:   mean=5.6807, std=5.5148
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11800000000000002, 'auc': 0.50448, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 36, 38, 35, 38, 37, 38, 36, 36, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.8440, std=4.1575
[DEBUG][MIA] Test Set Loss:   mean=7.8361, std=5.5981
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.4, 'auc': 0.62451171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 36 38 36 35 37 37 37 37]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [37 35 36 36 38 36 36 37 36 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.8473, std=5.5686
[DEBUG][MIA] Test Set Loss:   mean=8.7740, std=5.8360
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.088, 'auc': 0.551216, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 43, 43, 42, 44, 41, 41, 40, 40, 40], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.7428, std=3.2154
[DEBUG][MIA] Test Set Loss:   mean=7.2877, std=5.8927
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.4333333333333334, 'auc': 0.6962890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 44 43 40 43 41 44 44 40 42]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [43 41 40 42 42 41 43 43 44 44]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.9537, std=6.0897
[DEBUG][MIA] Test Set Loss:   mean=8.2359, std=5.8103
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.08399999999999999, 'auc': 0.513616, 'task': 8}
Total correct retain:  1417  Total retain:  2500
Total correct forget:  10412  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  2065  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.532, 0.23, 0.28, 0.262, 0.216, 0.238, 0.27, 0.2, 0.206, 0.2, 0.234, 0.264, 0.252, 0.196, 0.182, 0.16, 0.134, 0.23, 0.206, 0.17]
Number of constraint violations:  116
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: negagem
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sun Apr 27 00:28:40 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 39%   69C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['lion', 'bridge', 'cockroach', 'bear', 'lizard', 'baby', 'telephone', 'bee', 'shark', 'oranges', 'tiger', 'hamster', 'bed', 'cups', 'wolf', 'pickup truck', 'pears', 'worm', 'dolphin', 'oak', 'couch', 'spider', 'plain', 'wardrobe', 'bottles', 'forest', 'snake', 'apples', 'cans', 'orchids', 'palm', 'streetcar', 'plates', 'tulips', 'shrew', 'maple', 'squirrel', 'beetle', 'otter', 'raccoon', 'lawn-mower', 'flatfish', 'sweet peppers', 'man', 'turtle', 'skyscraper', 'fox', 'house', 'mouse', 'skunk', 'porcupine', 'sea', 'television', 'butterfly', 'woman', 'lamp', 'castle', 'trout', 'mushrooms', 'ray', 'pine', 'poppies', 'aquarium fish', 'motorcycle', 'tank', 'train', 'possum', 'lobster', 'cattle', 'clock', 'chair', 'crab', 'boy', 'crocodile', 'elephant', 'beaver', 'rabbit', 'cloud', 'whale', 'bowls', 'seal', 'willow', 'road', 'dinosaur', 'camel', 'roses', 'chimpanzee', 'snail', 'bus', 'kangaroo', 'mountain', 'computer keyboard', 'caterpillar', 'rocket', 'sunflowers', 'tractor', 'girl', 'leopard', 'table', 'bicycle']
Training task:  1
