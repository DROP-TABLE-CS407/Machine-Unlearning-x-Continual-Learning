Requirement already satisfied: pyyaml in /usr/lib64/python3.12/site-packages (6.0.1)
Requirement already satisfied: setuptools in /usr/lib/python3.12/site-packages (68.2.2)
Requirement already satisfied: matplotlib in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.10.1)
Requirement already satisfied: contourpy>=1.0.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.3.1)
Requirement already satisfied: cycler>=0.10 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (4.56.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (1.4.8)
Requirement already satisfied: numpy>=1.23 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.2.4)
Requirement already satisfied: packaging>=20.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (24.2)
Requirement already satisfied: pillow>=8 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (11.1.0)
Requirement already satisfied: pyparsing>=2.3.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (3.2.3)
Requirement already satisfied: python-dateutil>=2.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from matplotlib) (2.9.0.post0)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)
Requirement already satisfied: quadprog in /dcs/21/u2110391/.local/lib/python3.12/site-packages (0.1.13)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from quadprog) (2.2.4)
Requirement already satisfied: pyparsing in /dcs/21/u2110391/.local/lib/python3.12/site-packages (3.2.3)
Requirement already satisfied: pandas in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.3)
Requirement already satisfied: numpy>=1.26.0 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.2.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in /dcs/21/u2110391/.local/lib/python3.12/site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)
Requirement already satisfied: numpy in /dcs/21/u2110391/.local/lib/python3.12/site-packages (2.2.4)
Sun Apr 27 00:29:21 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 13%   63C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: RL-AGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 1
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sun Apr 27 00:29:39 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 13%   63C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  1
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['woman', 'spider', 'otter', 'computer keyboard', 'maple', 'flatfish', 'skyscraper', 'ray', 'mushrooms', 'bridge', 'willow', 'tractor', 'wolf', 'tiger', 'boy', 'lobster', 'skunk', 'clock', 'tulips', 'butterfly', 'bed', 'bear', 'sea', 'oak', 'sunflowers', 'shark', 'kangaroo', 'poppies', 'bee', 'seal', 'orchids', 'bicycle', 'snake', 'baby', 'tank', 'mouse', 'castle', 'caterpillar', 'camel', 'bus', 'palm', 'roses', 'rocket', 'possum', 'trout', 'snail', 'house', 'mountain', 'whale', 'cockroach', 'apples', 'lawn-mower', 'streetcar', 'cans', 'girl', 'elephant', 'pine', 'cups', 'table', 'beaver', 'man', 'pickup truck', 'crab', 'dinosaur', 'rabbit', 'leopard', 'couch', 'forest', 'bowls', 'cloud', 'pears', 'television', 'motorcycle', 'lizard', 'crocodile', 'road', 'aquarium fish', 'worm', 'porcupine', 'squirrel', 'turtle', 'cattle', 'chimpanzee', 'sweet peppers', 'fox', 'dolphin', 'oranges', 'telephone', 'train', 'lion', 'wardrobe', 'plates', 'chair', 'hamster', 'beetle', 'bottles', 'plain', 'raccoon', 'shrew', 'lamp']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2314  Total retain:  2500
Total correct forget:  9829  Total forget:  47500
Total correct test:  337  Total test:  500
Total correct forget test:  1924  Total test forget:  9500
After learning task 1
Task accuracies: [0.674, 0.18, 0.256, 0.184, 0.2, 0.25, 0.212, 0.194, 0.21, 0.2, 0.192, 0.222, 0.198, 0.166, 0.184, 0.226, 0.158, 0.244, 0.208, 0.164]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0052
[DEBUG][MIA] Test Set Loss:   mean=0.8135, std=1.7889
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.26666666666666666, 'auc': 0.814453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0084, std=0.0742
[DEBUG][MIA] Test Set Loss:   mean=0.9401, std=2.5714
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.64, 'cv_acc': 0.242, 'auc': 0.7219279999999999, 'task': 1}
2 1
Total correct retain:  1722  Total retain:  2500
Total correct forget:  12109  Total forget:  47500
Total correct test:  273  Total test:  500
Total correct forget test:  2301  Total test forget:  9500
After learning task 2
Task accuracies: [0.546, 0.804, 0.234, 0.228, 0.2, 0.224, 0.156, 0.206, 0.212, 0.234, 0.136, 0.21, 0.2, 0.246, 0.2, 0.19, 0.236, 0.308, 0.202, 0.176]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0475, std=0.0881
[DEBUG][MIA] Test Set Loss:   mean=1.3386, std=2.5046
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.38333333333333336, 'auc': 0.6435546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9200, std=1.4571
[DEBUG][MIA] Test Set Loss:   mean=1.6327, std=2.6129
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.092, 'auc': 0.553232, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0061, std=0.0174
[DEBUG][MIA] Test Set Loss:   mean=1.6502, std=3.1393
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.11666666666666665, 'auc': 0.8359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0400, std=0.3126
[DEBUG][MIA] Test Set Loss:   mean=1.0740, std=2.3308
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.664, 'cv_acc': 0.26, 'auc': 0.725752, 'task': 2}
3 2
Total correct retain:  1649  Total retain:  2500
Total correct forget:  13010  Total forget:  47500
Total correct test:  280  Total test:  500
Total correct forget test:  2444  Total test forget:  9500
After learning task 3
Task accuracies: [0.56, 0.604, 0.752, 0.178, 0.202, 0.248, 0.194, 0.162, 0.218, 0.242, 0.198, 0.16, 0.19, 0.28, 0.2, 0.152, 0.214, 0.254, 0.21, 0.23]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1353, std=0.2325
[DEBUG][MIA] Test Set Loss:   mean=1.9063, std=2.6007
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333333, 'auc': 0.7646484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6038, std=2.4227
[DEBUG][MIA] Test Set Loss:   mean=1.9184, std=2.5540
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.09, 'auc': 0.534832, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0193, std=0.0356
[DEBUG][MIA] Test Set Loss:   mean=2.1603, std=3.1789
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7333333333333333, 'auc': 0.8291015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8526, std=1.5294
[DEBUG][MIA] Test Set Loss:   mean=1.8320, std=2.7687
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.16799999999999998, 'auc': 0.59816, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0043
[DEBUG][MIA] Test Set Loss:   mean=1.9313, std=2.9606
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.3, 'auc': 0.80517578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0284, std=0.2126
[DEBUG][MIA] Test Set Loss:   mean=1.0524, std=2.2680
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.662, 'cv_acc': 0.252, 'auc': 0.751088, 'task': 3}
4 3
Total correct retain:  1468  Total retain:  2500
Total correct forget:  14063  Total forget:  47500
Total correct test:  270  Total test:  500
Total correct forget test:  2553  Total test forget:  9500
After learning task 4
Task accuracies: [0.54, 0.514, 0.592, 0.754, 0.21, 0.186, 0.152, 0.15, 0.224, 0.214, 0.124, 0.202, 0.194, 0.184, 0.202, 0.24, 0.22, 0.312, 0.206, 0.226]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0166, std=0.0280
[DEBUG][MIA] Test Set Loss:   mean=1.3647, std=1.9441
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7500000000000001, 'auc': 0.9453125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7498, std=2.2393
[DEBUG][MIA] Test Set Loss:   mean=2.0145, std=2.5110
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.13, 'auc': 0.537264, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0126, std=0.0210
[DEBUG][MIA] Test Set Loss:   mean=1.3545, std=2.3220
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9793, std=1.6272
[DEBUG][MIA] Test Set Loss:   mean=1.6588, std=2.3889
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.12000000000000002, 'auc': 0.584536, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0386, std=0.1324
[DEBUG][MIA] Test Set Loss:   mean=1.4908, std=3.0979
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.30000000000000004, 'auc': 0.8056640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.5908, std=1.3504
[DEBUG][MIA] Test Set Loss:   mean=1.7354, std=3.0514
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.148, 'auc': 0.640144, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=0.3520, std=1.2179
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.09999999999999999, 'auc': 0.48388671875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0371
[DEBUG][MIA] Test Set Loss:   mean=0.4154, std=1.4420
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.158, 'auc': 0.559832, 'task': 4}
5 4
Total correct retain:  1479  Total retain:  2500
Total correct forget:  15961  Total forget:  47500
Total correct test:  279  Total test:  500
Total correct forget test:  2953  Total test forget:  9500
After learning task 5
Task accuracies: [0.558, 0.482, 0.586, 0.678, 0.89, 0.232, 0.17, 0.144, 0.22, 0.238, 0.182, 0.286, 0.2, 0.268, 0.2, 0.226, 0.226, 0.28, 0.178, 0.22]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0305, std=0.0872
[DEBUG][MIA] Test Set Loss:   mean=2.1990, std=2.8689
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7666666666666666, 'auc': 0.9287109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8782, std=2.1719
[DEBUG][MIA] Test Set Loss:   mean=2.0963, std=2.6078
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.098, 'auc': 0.520848, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0064
[DEBUG][MIA] Test Set Loss:   mean=1.7322, std=2.1614
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.75, 'auc': 0.94140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3134, std=1.9934
[DEBUG][MIA] Test Set Loss:   mean=1.7663, std=2.3792
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.096, 'auc': 0.5601919999999999, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0047, std=0.0087
[DEBUG][MIA] Test Set Loss:   mean=3.2121, std=4.4828
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.75, 'auc': 0.9365234375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1305, std=2.2144
[DEBUG][MIA] Test Set Loss:   mean=2.5865, std=3.7760
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.144, 'auc': 0.629504, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=0.5094, std=1.3280
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.11666666666666667, 'auc': 0.8779296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5016, std=1.2626
[DEBUG][MIA] Test Set Loss:   mean=0.6404, std=1.4737
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.13999999999999999, 'auc': 0.504816, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0072, std=0.0262
[DEBUG][MIA] Test Set Loss:   mean=0.9902, std=2.1883
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.26666666666666666, 'auc': 0.740234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0162, std=0.1216
[DEBUG][MIA] Test Set Loss:   mean=1.2873, std=2.7864
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.64, 'cv_acc': 0.2, 'auc': 0.74184, 'task': 5}
6 5
Total correct retain:  1461  Total retain:  2500
Total correct forget:  16520  Total forget:  47500
Total correct test:  269  Total test:  500
Total correct forget test:  3043  Total test forget:  9500
After learning task 6
Task accuracies: [0.538, 0.468, 0.544, 0.552, 0.81, 0.788, 0.164, 0.164, 0.206, 0.246, 0.154, 0.27, 0.218, 0.208, 0.176, 0.168, 0.238, 0.324, 0.174, 0.214]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0122, std=0.0256
[DEBUG][MIA] Test Set Loss:   mean=2.3605, std=3.0294
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7666666666666667, 'auc': 0.896484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9134, std=2.2007
[DEBUG][MIA] Test Set Loss:   mean=2.0090, std=2.4762
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.13, 'auc': 0.50112, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0076
[DEBUG][MIA] Test Set Loss:   mean=1.8006, std=2.4569
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7666666666666667, 'auc': 0.9189453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7355, std=2.6142
[DEBUG][MIA] Test Set Loss:   mean=1.6137, std=2.2198
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.092, 'auc': 0.5230239999999999, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0032, std=0.0072
[DEBUG][MIA] Test Set Loss:   mean=2.1256, std=3.0716
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7833333333333334, 'auc': 0.828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5972, std=2.2863
[DEBUG][MIA] Test Set Loss:   mean=2.3468, std=3.1372
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.138, 'auc': 0.577504, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=0.6953, std=1.5083
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.3, 'auc': 0.8447265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6062, std=1.4517
[DEBUG][MIA] Test Set Loss:   mean=0.9136, std=1.7940
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.092, 'auc': 0.524368, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=1.1524, std=1.7758
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7, 'auc': 0.9501953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3870, std=0.9378
[DEBUG][MIA] Test Set Loss:   mean=0.9875, std=1.6588
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.192, 'auc': 0.6428240000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.1746, std=0.9334
[DEBUG][MIA] Test Set Loss:   mean=0.3468, std=1.0904
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.26666666666666666, 'auc': 0.65625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0261
[DEBUG][MIA] Test Set Loss:   mean=0.8875, std=2.0207
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.248, 'auc': 0.7360479999999999, 'task': 6}
7 6
Total correct retain:  1442  Total retain:  2500
Total correct forget:  17804  Total forget:  47500
Total correct test:  273  Total test:  500
Total correct forget test:  3238  Total test forget:  9500
After learning task 7
Task accuracies: [0.546, 0.482, 0.532, 0.52, 0.75, 0.68, 0.772, 0.234, 0.19, 0.186, 0.148, 0.254, 0.214, 0.234, 0.188, 0.178, 0.216, 0.318, 0.17, 0.21]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0101, std=0.0189
[DEBUG][MIA] Test Set Loss:   mean=1.6125, std=2.5575
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8166666666666668, 'auc': 0.83203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5990, std=2.0194
[DEBUG][MIA] Test Set Loss:   mean=1.8909, std=2.4204
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10400000000000001, 'auc': 0.523056, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=1.2026, std=1.5640
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8333333333333334, 'auc': 0.947265625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4057, std=2.1760
[DEBUG][MIA] Test Set Loss:   mean=1.8454, std=2.3491
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11000000000000001, 'auc': 0.5612079999999999, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=2.6121, std=3.2094
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7333333333333333, 'auc': 0.8642578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6522, std=2.3776
[DEBUG][MIA] Test Set Loss:   mean=2.6207, std=3.3365
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.136, 'auc': 0.5689280000000001, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0039, std=0.0065
[DEBUG][MIA] Test Set Loss:   mean=0.8454, std=1.5046
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7166666666666666, 'auc': 0.822265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9562, std=1.7247
[DEBUG][MIA] Test Set Loss:   mean=0.9949, std=1.7211
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10400000000000001, 'auc': 0.489184, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0028
[DEBUG][MIA] Test Set Loss:   mean=1.7053, std=2.1447
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7833333333333333, 'auc': 0.9140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1693, std=1.8697
[DEBUG][MIA] Test Set Loss:   mean=1.5167, std=2.2535
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.188, 'auc': 0.5496080000000001, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0051, std=0.0137
[DEBUG][MIA] Test Set Loss:   mean=1.6680, std=2.3832
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.2833333333333333, 'auc': 0.8544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7554, std=1.6755
[DEBUG][MIA] Test Set Loss:   mean=1.5035, std=2.4923
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.15999999999999998, 'auc': 0.615752, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0095
[DEBUG][MIA] Test Set Loss:   mean=0.8813, std=1.9258
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.08333333333333333, 'auc': 0.7509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0254, std=0.1800
[DEBUG][MIA] Test Set Loss:   mean=1.2463, std=2.6185
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.678, 'cv_acc': 0.244, 'auc': 0.757312, 'task': 7}
8 7
Total correct retain:  1449  Total retain:  2500
Total correct forget:  18611  Total forget:  47500
Total correct test:  295  Total test:  500
Total correct forget test:  3406  Total test forget:  9500
After learning task 8
Task accuracies: [0.59, 0.484, 0.554, 0.494, 0.722, 0.606, 0.638, 0.776, 0.198, 0.182, 0.078, 0.244, 0.238, 0.282, 0.196, 0.196, 0.198, 0.356, 0.166, 0.204]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0067
[DEBUG][MIA] Test Set Loss:   mean=1.1871, std=1.9927
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7833333333333333, 'auc': 0.9423828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8127, std=2.3110
[DEBUG][MIA] Test Set Loss:   mean=1.8980, std=2.4248
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10600000000000001, 'auc': 0.4836, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=2.3653, std=3.0220
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333334, 'auc': 0.9208984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.5857, std=2.5051
[DEBUG][MIA] Test Set Loss:   mean=1.8564, std=2.4172
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.10400000000000001, 'auc': 0.549744, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=2.4373, std=3.5496
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.85, 'auc': 0.767578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2360, std=3.3098
[DEBUG][MIA] Test Set Loss:   mean=2.5640, std=3.3592
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.12400000000000003, 'auc': 0.539296, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=0.3796, std=0.8147
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.3166666666666667, 'auc': 0.830078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7307, std=1.6968
[DEBUG][MIA] Test Set Loss:   mean=0.9315, std=1.8227
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.10600000000000001, 'auc': 0.440712, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0104
[DEBUG][MIA] Test Set Loss:   mean=1.2971, std=2.4507
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7333333333333333, 'auc': 0.74609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0552, std=1.8538
[DEBUG][MIA] Test Set Loss:   mean=1.6721, std=2.7329
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.124, 'auc': 0.553848, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0171
[DEBUG][MIA] Test Set Loss:   mean=2.0294, std=3.0387
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7333333333333332, 'auc': 0.86669921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1414, std=2.0420
[DEBUG][MIA] Test Set Loss:   mean=2.2019, std=2.9859
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.57, 'cv_acc': 0.13999999999999999, 'auc': 0.6222239999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0034
[DEBUG][MIA] Test Set Loss:   mean=2.4709, std=3.0633
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.3166666666666667, 'auc': 0.935546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5729, std=1.3991
[DEBUG][MIA] Test Set Loss:   mean=1.2223, std=2.2397
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.25, 'auc': 0.6275200000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=0.5867, std=1.7622
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.2333333333333333, 'auc': 0.548828125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0077, std=0.0482
[DEBUG][MIA] Test Set Loss:   mean=0.4616, std=1.5118
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.18, 'auc': 0.638128, 'task': 8}
Total correct retain:  1463  Total retain:  2500
Total correct forget:  19936  Total forget:  47500
Total correct test:  279  Total test:  500
Total correct forget test:  3595  Total test forget:  9500
After learning task 9
Task accuracies: [0.558, 0.534, 0.538, 0.462, 0.758, 0.586, 0.55, 0.614, 0.866, 0.174, 0.144, 0.246, 0.226, 0.31, 0.174, 0.162, 0.152, 0.252, 0.156, 0.286]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=2.1263, std=3.2728
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8, 'auc': 0.861328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8607, std=2.7135
[DEBUG][MIA] Test Set Loss:   mean=1.9660, std=2.4776
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.09, 'auc': 0.455872, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0025
[DEBUG][MIA] Test Set Loss:   mean=1.5996, std=2.9237
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.935546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7643, std=2.6792
[DEBUG][MIA] Test Set Loss:   mean=1.9636, std=2.7277
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11000000000000001, 'auc': 0.549328, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0108, std=0.0412
[DEBUG][MIA] Test Set Loss:   mean=1.6205, std=1.9746
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8166666666666667, 'auc': 0.9326171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2576, std=3.1544
[DEBUG][MIA] Test Set Loss:   mean=3.0619, std=3.8364
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.1, 'auc': 0.5698080000000001, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0057, std=0.0162
[DEBUG][MIA] Test Set Loss:   mean=0.5378, std=1.1237
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.75, 'auc': 0.7099609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0014, std=1.8677
[DEBUG][MIA] Test Set Loss:   mean=1.1740, std=2.1629
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.498504, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=1.2303, std=1.5960
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.3, 'auc': 0.8798828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2604, std=2.4363
[DEBUG][MIA] Test Set Loss:   mean=1.4108, std=2.3730
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.15199999999999997, 'auc': 0.53464, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=2.1952, std=2.5589
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.75, 'auc': 0.890625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.0151, std=2.0448
[DEBUG][MIA] Test Set Loss:   mean=1.8178, std=2.5847
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.164, 'auc': 0.6133280000000001, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=1.9525, std=2.9937
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7833333333333334, 'auc': 0.9599609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.6771, std=1.3957
[DEBUG][MIA] Test Set Loss:   mean=1.7624, std=2.5923
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.184, 'auc': 0.653664, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.4625, std=2.6662
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2833333333333333, 'auc': 0.8310546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4492, std=1.0620
[DEBUG][MIA] Test Set Loss:   mean=1.0719, std=2.2507
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.158, 'auc': 0.5694319999999999, 'task': 8}
Total correct retain:  1420  Total retain:  2500
Total correct forget:  21438  Total forget:  47500
Total correct test:  288  Total test:  500
Total correct forget test:  3877  Total test forget:  9500
After learning task 10
Task accuracies: [0.576, 0.514, 0.546, 0.438, 0.718, 0.608, 0.528, 0.572, 0.756, 0.83, 0.142, 0.192, 0.226, 0.318, 0.172, 0.23, 0.194, 0.304, 0.17, 0.296]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0082, std=0.0178
[DEBUG][MIA] Test Set Loss:   mean=2.1808, std=2.7364
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.7166666666666666, 'auc': 0.9853515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9612, std=2.3396
[DEBUG][MIA] Test Set Loss:   mean=2.0316, std=2.6999
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.49208, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=2.9982, std=2.9308
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7166666666666666, 'auc': 0.9150390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7204, std=2.3791
[DEBUG][MIA] Test Set Loss:   mean=2.2934, std=3.0824
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.126, 'auc': 0.540224, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0049
[DEBUG][MIA] Test Set Loss:   mean=1.2325, std=2.2185
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.640625, 'cv_acc': 0.85, 'auc': 0.93017578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.5312, std=3.5637
[DEBUG][MIA] Test Set Loss:   mean=2.9577, std=3.4451
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.1, 'auc': 0.555768, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0049
[DEBUG][MIA] Test Set Loss:   mean=1.0742, std=1.9789
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.23333333333333334, 'auc': 0.8310546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9408, std=1.8704
[DEBUG][MIA] Test Set Loss:   mean=1.1471, std=2.0546
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.088, 'auc': 0.550192, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=0.9849, std=1.8137
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.7333333333333333, 'auc': 0.9453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6696, std=2.6712
[DEBUG][MIA] Test Set Loss:   mean=1.4404, std=2.2261
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.10200000000000001, 'auc': 0.491056, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.9983, std=2.6500
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.8662109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.7911, std=2.7026
[DEBUG][MIA] Test Set Loss:   mean=2.3744, std=3.2329
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.18, 'auc': 0.557472, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=2.1162, std=2.9087
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7666666666666667, 'auc': 0.9033203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7934, std=1.5713
[DEBUG][MIA] Test Set Loss:   mean=1.6370, std=2.7869
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.15399999999999997, 'auc': 0.5785919999999999, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=0.8778, std=1.8666
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2333333333333333, 'auc': 0.8779296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6824, std=1.5332
[DEBUG][MIA] Test Set Loss:   mean=0.9261, std=1.9763
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.16199999999999998, 'auc': 0.52748, 'task': 8}
Total correct retain:  1422  Total retain:  2500
Total correct forget:  21996  Total forget:  47500
Total correct test:  275  Total test:  500
Total correct forget test:  4096  Total test forget:  9500
After learning task 11
Task accuracies: [0.55, 0.504, 0.484, 0.446, 0.714, 0.598, 0.516, 0.646, 0.738, 0.724, 0.87, 0.188, 0.174, 0.324, 0.17, 0.23, 0.12, 0.348, 0.146, 0.252]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0062, std=0.0178
[DEBUG][MIA] Test Set Loss:   mean=2.0047, std=2.2196
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7666666666666666, 'auc': 0.9580078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1272, std=2.8486
[DEBUG][MIA] Test Set Loss:   mean=2.0182, std=2.6332
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08199999999999999, 'auc': 0.48940799999999995, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0176, std=0.0923
[DEBUG][MIA] Test Set Loss:   mean=1.8736, std=2.6389
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.8333333333333333, 'auc': 0.845703125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0156, std=3.1557
[DEBUG][MIA] Test Set Loss:   mean=2.8027, std=3.5903
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.148, 'auc': 0.5635680000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0070, std=0.0243
[DEBUG][MIA] Test Set Loss:   mean=4.9942, std=4.8992
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.859375, 'cv_acc': 0.7, 'auc': 0.935546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.4595, std=4.1920
[DEBUG][MIA] Test Set Loss:   mean=3.4333, std=4.1864
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11000000000000001, 'auc': 0.504496, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0045, std=0.0177
[DEBUG][MIA] Test Set Loss:   mean=1.0416, std=2.0801
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.3, 'auc': 0.873046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9179, std=1.8637
[DEBUG][MIA] Test Set Loss:   mean=1.1974, std=2.3185
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10600000000000001, 'auc': 0.539288, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.4675, std=2.3688
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.35, 'auc': 0.951171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5193, std=2.5628
[DEBUG][MIA] Test Set Loss:   mean=1.6066, std=2.5308
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.1, 'auc': 0.527408, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0059
[DEBUG][MIA] Test Set Loss:   mean=2.5081, std=3.3056
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.75, 'auc': 0.94677734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8377, std=2.8131
[DEBUG][MIA] Test Set Loss:   mean=2.9042, std=3.8136
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.15799999999999997, 'auc': 0.596448, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8514, std=2.7908
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7833333333333333, 'auc': 0.8857421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.1673, std=2.3575
[DEBUG][MIA] Test Set Loss:   mean=1.9288, std=3.2306
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.15, 'auc': 0.59664, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.6551, std=2.7205
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.2833333333333333, 'auc': 0.89208984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.6140, std=1.4700
[DEBUG][MIA] Test Set Loss:   mean=1.2914, std=2.4042
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.134, 'auc': 0.560992, 'task': 8}
Total correct retain:  1429  Total retain:  2500
Total correct forget:  20181  Total forget:  47500
Total correct test:  266  Total test:  500
Total correct forget test:  3778  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.532, 0.528, 0.482, 0.436, 0.734, 0.604, 0.504, 0.638, 0.73, 0.722, 0.244, 0.184, 0.178, 0.31, 0.178, 0.214, 0.126, 0.336, 0.154, 0.254]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=0.9586, std=1.2941
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666667, 'auc': 0.9892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2597, std=2.6175
[DEBUG][MIA] Test Set Loss:   mean=2.1138, std=2.7192
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.096, 'auc': 0.520384, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=2.6818, std=3.6431
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.85, 'auc': 0.9443359375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.9336, std=2.6695
[DEBUG][MIA] Test Set Loss:   mean=2.5696, std=3.4512
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.15399999999999997, 'auc': 0.540256, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.2544, std=1.0323
[DEBUG][MIA] Test Set Loss:   mean=3.7623, std=4.3864
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7666666666666667, 'auc': 0.8203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.9999, std=4.0291
[DEBUG][MIA] Test Set Loss:   mean=4.2329, std=5.0201
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.452, 'cv_acc': 0.092, 'auc': 0.422904, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0038
[DEBUG][MIA] Test Set Loss:   mean=1.7774, std=2.7505
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2833333333333333, 'auc': 0.8359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1053, std=2.2005
[DEBUG][MIA] Test Set Loss:   mean=1.4080, std=2.6792
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.096, 'auc': 0.5145839999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0007
[DEBUG][MIA] Test Set Loss:   mean=1.8365, std=2.4462
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.75, 'auc': 0.9501953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.7609, std=2.9295
[DEBUG][MIA] Test Set Loss:   mean=1.9530, std=2.7569
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11200000000000002, 'auc': 0.46004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=2.5686, std=3.1252
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.8166666666666667, 'auc': 0.9375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8446, std=3.1055
[DEBUG][MIA] Test Set Loss:   mean=2.4291, std=3.3907
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.138, 'auc': 0.5590080000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.5746, std=3.0723
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7166666666666667, 'auc': 0.93359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9812, std=2.2222
[DEBUG][MIA] Test Set Loss:   mean=1.8767, std=3.2467
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.16199999999999998, 'auc': 0.592208, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=0.8888, std=1.8188
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.75, 'auc': 0.8408203125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7686, std=1.5958
[DEBUG][MIA] Test Set Loss:   mean=1.3083, std=2.5868
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.12200000000000003, 'auc': 0.536824, 'task': 8}
Total correct retain:  1437  Total retain:  2500
Total correct forget:  18560  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  3470  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.556, 0.51, 0.488, 0.408, 0.714, 0.584, 0.502, 0.65, 0.734, 0.284, 0.23, 0.17, 0.174, 0.304, 0.162, 0.2, 0.11, 0.318, 0.138, 0.26]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0092, std=0.0260
[DEBUG][MIA] Test Set Loss:   mean=1.7663, std=2.0812
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7333333333333333, 'auc': 0.9287109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1688, std=2.7700
[DEBUG][MIA] Test Set Loss:   mean=2.2317, std=3.0263
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10200000000000001, 'auc': 0.4852559999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0105, std=0.0298
[DEBUG][MIA] Test Set Loss:   mean=3.1063, std=3.2266
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.84375, 'cv_acc': 0.7499999999999999, 'auc': 0.8896484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4027, std=3.0270
[DEBUG][MIA] Test Set Loss:   mean=2.6888, std=3.4779
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10200000000000001, 'auc': 0.506296, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0025, std=0.0054
[DEBUG][MIA] Test Set Loss:   mean=3.4115, std=4.0891
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333334, 'auc': 0.9453125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8878, std=3.9246
[DEBUG][MIA] Test Set Loss:   mean=3.7244, std=4.4153
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.1, 'auc': 0.579984, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0121, std=0.0566
[DEBUG][MIA] Test Set Loss:   mean=1.2227, std=1.9329
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.26666666666666666, 'auc': 0.81396484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0230, std=1.9909
[DEBUG][MIA] Test Set Loss:   mean=1.3642, std=2.6279
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10800000000000001, 'auc': 0.48124, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.6407, std=3.7152
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.3, 'auc': 0.9443359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8362, std=2.7114
[DEBUG][MIA] Test Set Loss:   mean=1.6734, std=2.6169
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.12, 'auc': 0.4942639999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=3.2380, std=4.3598
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7499999999999999, 'auc': 0.9814453125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.5694, std=2.7808
[DEBUG][MIA] Test Set Loss:   mean=2.6307, std=3.5034
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.11600000000000002, 'auc': 0.616112, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0047
[DEBUG][MIA] Test Set Loss:   mean=2.1368, std=2.7662
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7000000000000001, 'auc': 0.908203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3601, std=2.4657
[DEBUG][MIA] Test Set Loss:   mean=1.6475, std=2.7760
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.168, 'auc': 0.5400320000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8905, std=1.7305
[DEBUG][MIA] Test Set Loss:   mean=6.8993, std=6.0542
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.5666666666666667, 'auc': 0.775390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.2805, std=5.1213
[DEBUG][MIA] Test Set Loss:   mean=5.7694, std=5.3525
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.14199999999999996, 'auc': 0.5271600000000001, 'task': 8}
Total correct retain:  1396  Total retain:  2500
Total correct forget:  17591  Total forget:  47500
Total correct test:  268  Total test:  500
Total correct forget test:  3313  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.536, 0.49, 0.5, 0.424, 0.722, 0.588, 0.516, 0.63, 0.244, 0.306, 0.244, 0.186, 0.184, 0.312, 0.162, 0.228, 0.132, 0.354, 0.156, 0.248]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0027
[DEBUG][MIA] Test Set Loss:   mean=1.8115, std=2.5021
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8666666666666668, 'auc': 0.9658203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4016, std=3.0943
[DEBUG][MIA] Test Set Loss:   mean=1.8622, std=2.6666
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.11200000000000002, 'auc': 0.45952000000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.8987, std=2.4824
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7500000000000001, 'auc': 0.9453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0682, std=3.2476
[DEBUG][MIA] Test Set Loss:   mean=2.5631, std=3.3370
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11000000000000001, 'auc': 0.564616, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0295, std=0.1358
[DEBUG][MIA] Test Set Loss:   mean=3.7019, std=4.8846
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8333333333333334, 'auc': 0.8779296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.0160, std=4.0353
[DEBUG][MIA] Test Set Loss:   mean=3.6004, std=4.5974
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.10200000000000001, 'auc': 0.5333680000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0205
[DEBUG][MIA] Test Set Loss:   mean=2.0340, std=3.4580
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2166666666666667, 'auc': 0.8916015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2881, std=2.6439
[DEBUG][MIA] Test Set Loss:   mean=1.2181, std=2.2931
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10400000000000001, 'auc': 0.503952, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=1.8307, std=2.4792
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7666666666666667, 'auc': 0.9375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8508, std=2.8321
[DEBUG][MIA] Test Set Loss:   mean=1.9576, std=2.9259
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10200000000000001, 'auc': 0.52144, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0018
[DEBUG][MIA] Test Set Loss:   mean=2.3903, std=3.0305
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.8166666666666667, 'auc': 0.9560546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4614, std=2.6206
[DEBUG][MIA] Test Set Loss:   mean=2.2965, std=3.2425
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.192, 'auc': 0.576736, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4718, std=3.1796
[DEBUG][MIA] Test Set Loss:   mean=12.6561, std=9.9838
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.5833333333333333, 'auc': 0.7568359375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.4972, std=7.1830
[DEBUG][MIA] Test Set Loss:   mean=9.8504, std=7.4116
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.136, 'auc': 0.5590799999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7279, std=2.5493
[DEBUG][MIA] Test Set Loss:   mean=5.7071, std=4.4951
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.4166666666666667, 'auc': 0.708984375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.7428, std=5.9484
[DEBUG][MIA] Test Set Loss:   mean=7.1808, std=6.2969
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11000000000000001, 'auc': 0.520544, 'task': 8}
Total correct retain:  1406  Total retain:  2500
Total correct forget:  16206  Total forget:  47500
Total correct test:  271  Total test:  500
Total correct forget test:  3081  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.542, 0.508, 0.5, 0.442, 0.706, 0.578, 0.532, 0.206, 0.218, 0.288, 0.23, 0.188, 0.174, 0.314, 0.172, 0.226, 0.108, 0.35, 0.152, 0.27]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0053, std=0.0148
[DEBUG][MIA] Test Set Loss:   mean=2.4943, std=2.5780
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.8333333333333334, 'auc': 0.9375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2573, std=3.0500
[DEBUG][MIA] Test Set Loss:   mean=2.3362, std=3.0726
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.47872, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=2.6970, std=3.2556
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7333333333333333, 'auc': 0.90576171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7483, std=2.6386
[DEBUG][MIA] Test Set Loss:   mean=2.5061, std=3.4951
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.138, 'auc': 0.5688559999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=2.9319, std=3.8600
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7, 'auc': 0.951171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.6109, std=4.5746
[DEBUG][MIA] Test Set Loss:   mean=4.2692, std=5.0902
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.09, 'auc': 0.522032, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0083, std=0.0286
[DEBUG][MIA] Test Set Loss:   mean=1.7935, std=3.5737
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.25, 'auc': 0.7705078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2944, std=2.3259
[DEBUG][MIA] Test Set Loss:   mean=1.4406, std=2.5688
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.10600000000000001, 'auc': 0.502144, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=2.2676, std=3.4355
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7166666666666667, 'auc': 0.876953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3439, std=3.2365
[DEBUG][MIA] Test Set Loss:   mean=2.0917, std=2.8473
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.092, 'auc': 0.510088, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.8670, std=3.8817
[DEBUG][MIA] Test Set Loss:   mean=10.6335, std=6.7245
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5333333333333333, 'auc': 0.76708984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.3532, std=7.0471
[DEBUG][MIA] Test Set Loss:   mean=11.0093, std=7.2781
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.14, 'auc': 0.573728, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2057, std=3.0306
[DEBUG][MIA] Test Set Loss:   mean=7.9443, std=8.2768
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.45, 'auc': 0.59912109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=7.9967, std=6.4685
[DEBUG][MIA] Test Set Loss:   mean=9.7201, std=7.2125
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.11200000000000002, 'auc': 0.571248, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.3875, std=2.0601
[DEBUG][MIA] Test Set Loss:   mean=8.7906, std=6.5329
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.5666666666666667, 'auc': 0.78857421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=6.5301, std=5.8740
[DEBUG][MIA] Test Set Loss:   mean=6.3190, std=5.7708
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10600000000000001, 'auc': 0.49279999999999996, 'task': 8}
Total correct retain:  1428  Total retain:  2500
Total correct forget:  14841  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  2863  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.552, 0.478, 0.516, 0.428, 0.666, 0.56, 0.2, 0.204, 0.226, 0.292, 0.23, 0.174, 0.178, 0.314, 0.17, 0.226, 0.12, 0.342, 0.158, 0.244]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=3.1752, std=3.4832
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.8333333333333334, 'auc': 0.9248046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.7676, std=3.7817
[DEBUG][MIA] Test Set Loss:   mean=2.4447, std=3.1252
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11000000000000001, 'auc': 0.500448, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=3.1541, std=3.9199
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.85, 'auc': 0.9296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.8849, std=2.7205
[DEBUG][MIA] Test Set Loss:   mean=2.4301, std=3.2367
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.146, 'auc': 0.5442959999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=4.7369, std=5.7046
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7333333333333333, 'auc': 0.9794921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.1995, std=4.2024
[DEBUG][MIA] Test Set Loss:   mean=3.5746, std=4.4430
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10400000000000001, 'auc': 0.527976, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0046
[DEBUG][MIA] Test Set Loss:   mean=0.9280, std=2.6499
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.2833333333333333, 'auc': 0.78515625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2476, std=2.2201
[DEBUG][MIA] Test Set Loss:   mean=1.2310, std=2.5048
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.10800000000000001, 'auc': 0.479664, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4199, std=1.3948
[DEBUG][MIA] Test Set Loss:   mean=4.5072, std=5.2955
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.75, 'auc': 0.615234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0564, std=5.7547
[DEBUG][MIA] Test Set Loss:   mean=6.2584, std=5.6892
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.094, 'auc': 0.4887040000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3637, std=4.9868
[DEBUG][MIA] Test Set Loss:   mean=13.7460, std=9.0518
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.18333333333333332, 'auc': 0.802734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.9856, std=8.0238
[DEBUG][MIA] Test Set Loss:   mean=11.5986, std=8.4719
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.10800000000000001, 'auc': 0.517544, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.1033, std=3.7361
[DEBUG][MIA] Test Set Loss:   mean=10.9093, std=10.4813
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.4166666666666667, 'auc': 0.72265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.8740, std=7.9787
[DEBUG][MIA] Test Set Loss:   mean=10.7600, std=8.3781
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10800000000000001, 'auc': 0.52992, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6562, std=1.9102
[DEBUG][MIA] Test Set Loss:   mean=5.4098, std=5.1284
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.5666666666666667, 'auc': 0.71875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.0634, std=4.8587
[DEBUG][MIA] Test Set Loss:   mean=5.7967, std=5.7682
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.094, 'auc': 0.52216, 'task': 8}
Total correct retain:  1443  Total retain:  2500
Total correct forget:  14220  Total forget:  47500
Total correct test:  276  Total test:  500
Total correct forget test:  2762  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.552, 0.492, 0.496, 0.428, 0.706, 0.258, 0.2, 0.204, 0.29, 0.31, 0.232, 0.17, 0.184, 0.326, 0.172, 0.206, 0.112, 0.344, 0.148, 0.246]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0001, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.3803, std=1.9325
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.85, 'auc': 0.9892578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0728, std=3.2066
[DEBUG][MIA] Test Set Loss:   mean=1.8096, std=2.8143
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11200000000000002, 'auc': 0.504912, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=3.2527, std=5.5387
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.8166666666666667, 'auc': 0.9501953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2732, std=3.4300
[DEBUG][MIA] Test Set Loss:   mean=2.9344, std=4.1513
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.552016, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0196
[DEBUG][MIA] Test Set Loss:   mean=4.6524, std=4.7816
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.7, 'auc': 0.92626953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.1169, std=4.0980
[DEBUG][MIA] Test Set Loss:   mean=3.7525, std=4.6970
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.5511759999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.8541, std=4.3633
[DEBUG][MIA] Test Set Loss:   mean=8.2373, std=6.8973
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.4166666666666667, 'auc': 0.583984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.3536, std=7.9257
[DEBUG][MIA] Test Set Loss:   mean=9.4619, std=7.7311
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.446, 'cv_acc': 0.11399999999999999, 'auc': 0.4535199999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0358, std=1.5722
[DEBUG][MIA] Test Set Loss:   mean=5.2092, std=5.4278
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.41666666666666663, 'auc': 0.73779296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.1372, std=5.1255
[DEBUG][MIA] Test Set Loss:   mean=5.9481, std=5.3617
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.452, 'cv_acc': 0.096, 'auc': 0.45192, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.3194, std=4.9708
[DEBUG][MIA] Test Set Loss:   mean=16.2492, std=6.9429
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.3833333333333333, 'auc': 0.89501953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.6038, std=8.5331
[DEBUG][MIA] Test Set Loss:   mean=14.3106, std=9.7361
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11000000000000001, 'auc': 0.5496800000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.2818, std=4.1808
[DEBUG][MIA] Test Set Loss:   mean=8.3084, std=7.7597
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.18333333333333335, 'auc': 0.59765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.8149, std=8.1954
[DEBUG][MIA] Test Set Loss:   mean=10.3759, std=8.1861
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.096, 'auc': 0.526736, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.1712, std=2.5881
[DEBUG][MIA] Test Set Loss:   mean=5.7511, std=6.4708
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.5333333333333334, 'auc': 0.62646484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.8561, std=5.7601
[DEBUG][MIA] Test Set Loss:   mean=7.0010, std=6.5331
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.10800000000000001, 'auc': 0.454072, 'task': 8}
Total correct retain:  1451  Total retain:  2500
Total correct forget:  12985  Total forget:  47500
Total correct test:  283  Total test:  500
Total correct forget test:  2506  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.566, 0.546, 0.482, 0.436, 0.218, 0.282, 0.2, 0.206, 0.268, 0.26, 0.22, 0.194, 0.154, 0.322, 0.17, 0.234, 0.11, 0.316, 0.136, 0.258]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1180, std=0.5226
[DEBUG][MIA] Test Set Loss:   mean=2.3409, std=2.8368
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.8166666666666667, 'auc': 0.8837890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8343, std=3.7797
[DEBUG][MIA] Test Set Loss:   mean=2.7078, std=3.4316
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.5204960000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0029, std=0.0136
[DEBUG][MIA] Test Set Loss:   mean=2.4790, std=3.0653
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.75, 'auc': 0.8876953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5573, std=3.5644
[DEBUG][MIA] Test Set Loss:   mean=2.9720, std=3.9420
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.13799999999999998, 'auc': 0.531968, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4280, std=1.6187
[DEBUG][MIA] Test Set Loss:   mean=8.2890, std=8.3113
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.6666666666666667, 'auc': 0.6923828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.1545, std=7.5542
[DEBUG][MIA] Test Set Loss:   mean=8.8707, std=7.4588
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.086, 'auc': 0.539952, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.3009, std=4.8559
[DEBUG][MIA] Test Set Loss:   mean=9.5981, std=7.0720
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.21666666666666665, 'auc': 0.693359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.0631, std=7.9723
[DEBUG][MIA] Test Set Loss:   mean=8.8805, std=7.8570
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.50964, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7742, std=2.6667
[DEBUG][MIA] Test Set Loss:   mean=8.9693, std=7.0291
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.4333333333333334, 'auc': 0.7783203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.2444, std=6.2735
[DEBUG][MIA] Test Set Loss:   mean=6.7430, std=5.7590
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11400000000000002, 'auc': 0.48019999999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.5405, std=4.2135
[DEBUG][MIA] Test Set Loss:   mean=13.6020, std=7.6113
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5166666666666667, 'auc': 0.818359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.4912, std=7.8484
[DEBUG][MIA] Test Set Loss:   mean=12.3829, std=8.2724
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.096, 'auc': 0.56624, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=5.7417, std=4.0809
[DEBUG][MIA] Test Set Loss:   mean=9.5054, std=7.2976
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.4666666666666667, 'auc': 0.6474609375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.8969, std=6.7945
[DEBUG][MIA] Test Set Loss:   mean=9.9946, std=7.5253
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10800000000000001, 'auc': 0.5391520000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.5604, std=2.3727
[DEBUG][MIA] Test Set Loss:   mean=10.2582, std=6.1567
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.4666666666666667, 'auc': 0.86279296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.1265, std=5.8428
[DEBUG][MIA] Test Set Loss:   mean=7.1923, std=6.0682
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.503552, 'task': 8}
Total correct retain:  1403  Total retain:  2500
Total correct forget:  12508  Total forget:  47500
Total correct test:  255  Total test:  500
Total correct forget test:  2434  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.51, 0.474, 0.48, 0.22, 0.244, 0.232, 0.2, 0.202, 0.214, 0.324, 0.24, 0.206, 0.188, 0.328, 0.174, 0.238, 0.13, 0.356, 0.184, 0.234]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0068, std=0.0212
[DEBUG][MIA] Test Set Loss:   mean=1.3521, std=1.8731
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.75, 'auc': 0.9111328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.6801, std=3.5776
[DEBUG][MIA] Test Set Loss:   mean=2.5061, std=3.2716
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.098, 'auc': 0.504336, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0757, std=1.6281
[DEBUG][MIA] Test Set Loss:   mean=9.2553, std=8.1794
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.6166666666666666, 'auc': 0.833984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.4382, std=6.6589
[DEBUG][MIA] Test Set Loss:   mean=7.7380, std=7.1886
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.088, 'auc': 0.51052, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0774, std=2.3373
[DEBUG][MIA] Test Set Loss:   mean=7.3964, std=8.5518
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6666666666666667, 'auc': 0.712890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.8150, std=7.3494
[DEBUG][MIA] Test Set Loss:   mean=8.9747, std=7.5918
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.098, 'auc': 0.4998719999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.2038, std=4.2423
[DEBUG][MIA] Test Set Loss:   mean=5.5207, std=7.3365
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.05, 'auc': 0.5341796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.6506, std=7.5695
[DEBUG][MIA] Test Set Loss:   mean=7.9158, std=7.4759
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.1, 'auc': 0.4703440000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3693, std=1.6461
[DEBUG][MIA] Test Set Loss:   mean=5.5752, std=5.0557
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.4833333333333333, 'auc': 0.74755859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7178, std=4.6939
[DEBUG][MIA] Test Set Loss:   mean=5.3272, std=5.3071
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.1, 'auc': 0.528536, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.0103, std=4.6148
[DEBUG][MIA] Test Set Loss:   mean=11.0456, std=8.3483
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.5333333333333334, 'auc': 0.77880859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=10.7898, std=7.4861
[DEBUG][MIA] Test Set Loss:   mean=11.6850, std=7.8889
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.098, 'auc': 0.5360959999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.4934, std=2.7127
[DEBUG][MIA] Test Set Loss:   mean=7.9644, std=6.5521
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.5166666666666667, 'auc': 0.7021484375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.2046, std=6.5745
[DEBUG][MIA] Test Set Loss:   mean=9.8736, std=7.5283
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.078, 'auc': 0.43557599999999996, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.6653, std=2.6003
[DEBUG][MIA] Test Set Loss:   mean=7.1136, std=6.0667
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.4333333333333334, 'auc': 0.7060546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=7.2623, std=5.6640
[DEBUG][MIA] Test Set Loss:   mean=6.9828, std=6.2391
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10600000000000001, 'auc': 0.477784, 'task': 8}
Total correct retain:  1453  Total retain:  2500
Total correct forget:  11779  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2295  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.556, 0.502, 0.274, 0.224, 0.232, 0.27, 0.2, 0.21, 0.226, 0.272, 0.232, 0.192, 0.178, 0.31, 0.176, 0.224, 0.124, 0.334, 0.162, 0.248]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([6, 9, 7, 9, 9, 8, 7, 5, 5, 9], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9684, std=1.7562
[DEBUG][MIA] Test Set Loss:   mean=8.6173, std=5.7298
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8125, 'cv_acc': 0.55, 'auc': 0.7998046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [6 8 5 5 8 5 5 7 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [5 8 7 5 7 6 5 5 8 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.1817, std=7.3258
[DEBUG][MIA] Test Set Loss:   mean=8.6157, std=6.8691
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10600000000000001, 'auc': 0.47512, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([10, 12, 10, 12, 11, 11, 11, 13, 10, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.9357, std=1.1883
[DEBUG][MIA] Test Set Loss:   mean=6.5033, std=6.8014
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.6833333333333333, 'auc': 0.7138671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 10 12 14 12 14 11 11 11 12]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 14 11 14 14 14 12 11 14 12]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.6573, std=6.6713
[DEBUG][MIA] Test Set Loss:   mean=8.3604, std=7.6027
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.09, 'auc': 0.567184, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([19, 15, 17, 15, 19, 16, 17, 16, 19, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=3.8386, std=4.1909
[DEBUG][MIA] Test Set Loss:   mean=13.7116, std=8.8967
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.5833333333333334, 'auc': 0.828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 15 19 18 16 16 15 19 15 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 19 16 18 16 17 16 18 17 17]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=11.1994, std=8.8823
[DEBUG][MIA] Test Set Loss:   mean=11.2715, std=9.5515
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.09, 'auc': 0.49709600000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([20, 22, 21, 20, 21, 22, 24, 22, 21, 22], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7463, std=4.7492
[DEBUG][MIA] Test Set Loss:   mean=10.3723, std=9.0874
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.25, 'auc': 0.6650390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 22 23 22 23 24 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [22 22 22 23 24 24 22 22 23 23]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.5896, std=7.5164
[DEBUG][MIA] Test Set Loss:   mean=8.9310, std=7.7386
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.1, 'auc': 0.5330159999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([27, 25, 25, 27, 29, 27, 29, 25, 29, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.3080, std=1.8076
[DEBUG][MIA] Test Set Loss:   mean=5.4994, std=5.3900
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.6666666666666667, 'auc': 0.76708984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [26 26 25 28 29 26 25 26 27 26]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [29 26 25 25 28 28 26 25 26 28]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.6421, std=5.2983
[DEBUG][MIA] Test Set Loss:   mean=5.0464, std=5.0453
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10400000000000001, 'auc': 0.533712, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([34, 34, 32, 34, 30, 34, 31, 31, 31, 31], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.2519, std=5.3587
[DEBUG][MIA] Test Set Loss:   mean=16.1651, std=9.5612
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.38333333333333336, 'auc': 0.8291015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 31 32 32 31 34 32 30 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [31 31 33 32 30 32 31 34 31 30]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.3892, std=8.6131
[DEBUG][MIA] Test Set Loss:   mean=13.4686, std=9.0956
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10800000000000001, 'auc': 0.53976, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([37, 39, 35, 37, 39, 35, 35, 36, 39, 35], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.2117, std=3.3063
[DEBUG][MIA] Test Set Loss:   mean=7.5699, std=8.1661
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6333333333333333, 'auc': 0.5947265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [36 36 35 38 37 37 38 39 37 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [38 36 38 37 39 35 36 35 37 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.0861, std=6.7890
[DEBUG][MIA] Test Set Loss:   mean=10.5049, std=8.0772
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.1, 'auc': 0.549024, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([65])
[DEBUG] forget_labels first 10: tensor([43, 42, 44, 43, 40, 44, 40, 41, 41, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6574, std=1.9968
[DEBUG][MIA] Test Set Loss:   mean=7.1695, std=6.9585
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.4166666666666667, 'auc': 0.70703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 43 43 40 43 42 42 40 43 41]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [42 41 41 41 40 40 42 44 42 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=5.6729, std=5.1368
[DEBUG][MIA] Test Set Loss:   mean=5.7228, std=5.9690
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10600000000000001, 'auc': 0.47682399999999997, 'task': 8}
Total correct retain:  1429  Total retain:  2500
Total correct forget:  11192  Total forget:  47500
Total correct test:  278  Total test:  500
Total correct forget test:  2189  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.556, 0.206, 0.294, 0.216, 0.22, 0.312, 0.2, 0.214, 0.298, 0.258, 0.242, 0.192, 0.164, 0.326, 0.174, 0.23, 0.11, 0.31, 0.16, 0.252]
Number of constraint violations:  0
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: RL-GEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sun Apr 27 00:58:35 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 40%   70C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['lamp', 'shrew', 'chair', 'crab', 'sea', 'tractor', 'girl', 'wolf', 'hamster', 'snail', 'mouse', 'couch', 'fox', 'leopard', 'bear', 'telephone', 'otter', 'bowls', 'computer keyboard', 'lobster', 'orchids', 'bottles', 'maple', 'turtle', 'pine', 'television', 'chimpanzee', 'oak', 'kangaroo', 'snake', 'seal', 'elephant', 'whale', 'crocodile', 'raccoon', 'rabbit', 'sweet peppers', 'tiger', 'house', 'spider', 'tank', 'porcupine', 'pears', 'dinosaur', 'aquarium fish', 'cockroach', 'pickup truck', 'motorcycle', 'plates', 'caterpillar', 'camel', 'lizard', 'plain', 'lawn-mower', 'cups', 'willow', 'worm', 'bus', 'wardrobe', 'road', 'skunk', 'rocket', 'poppies', 'flatfish', 'apples', 'bridge', 'skyscraper', 'mountain', 'cloud', 'cans', 'bed', 'baby', 'oranges', 'woman', 'clock', 'ray', 'possum', 'cattle', 'streetcar', 'squirrel', 'roses', 'forest', 'sunflowers', 'train', 'beaver', 'beetle', 'palm', 'bee', 'trout', 'table', 'boy', 'shark', 'lion', 'man', 'mushrooms', 'castle', 'dolphin', 'tulips', 'bicycle', 'butterfly']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2222  Total retain:  2500
Total correct forget:  9483  Total forget:  47500
Total correct test:  359  Total test:  500
Total correct forget test:  1934  Total test forget:  9500
After learning task 1
Task accuracies: [0.718, 0.194, 0.156, 0.32, 0.198, 0.19, 0.192, 0.224, 0.2, 0.204, 0.19, 0.22, 0.138, 0.232, 0.204, 0.19, 0.284, 0.182, 0.194, 0.156]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0202, std=0.0644
[DEBUG][MIA] Test Set Loss:   mean=1.3978, std=2.3430
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.2823529411764706, 'auc': 0.76318359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0529, std=0.2849
[DEBUG][MIA] Test Set Loss:   mean=1.7257, std=3.2324
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.682, 'cv_acc': 0.266, 'auc': 0.763, 'task': 1}
2 1
Total correct retain:  1975  Total retain:  2500
Total correct forget:  11469  Total forget:  47500
Total correct test:  331  Total test:  500
Total correct forget test:  2150  Total test forget:  9500
After learning task 2
Task accuracies: [0.662, 0.682, 0.214, 0.292, 0.236, 0.224, 0.192, 0.214, 0.216, 0.216, 0.23, 0.11, 0.126, 0.198, 0.194, 0.184, 0.212, 0.226, 0.192, 0.142]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=2.1261, std=2.9115
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7686274509803921, 'auc': 0.9039306640625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5664, std=1.2470
[DEBUG][MIA] Test Set Loss:   mean=2.0840, std=3.0622
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.65, 'cv_acc': 0.22000000000000003, 'auc': 0.6939839999999999, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1410, std=0.8067
[DEBUG][MIA] Test Set Loss:   mean=1.9294, std=3.0968
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7098039215686274, 'auc': 0.809417724609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0293, std=0.1655
[DEBUG][MIA] Test Set Loss:   mean=2.0307, std=3.1425
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.712, 'cv_acc': 0.45600000000000007, 'auc': 0.820056, 'task': 2}
3 2
Total correct retain:  1843  Total retain:  2500
Total correct forget:  12592  Total forget:  47500
Total correct test:  327  Total test:  500
Total correct forget test:  2234  Total test forget:  9500
After learning task 3
Task accuracies: [0.654, 0.562, 0.62, 0.26, 0.22, 0.174, 0.166, 0.216, 0.244, 0.162, 0.282, 0.146, 0.158, 0.178, 0.21, 0.19, 0.164, 0.202, 0.204, 0.11]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0195
[DEBUG][MIA] Test Set Loss:   mean=2.4531, std=3.2920
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.803921568627451, 'auc': 0.889801025390625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5336, std=2.7729
[DEBUG][MIA] Test Set Loss:   mean=2.2235, std=3.1316
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.23200000000000004, 'auc': 0.613776, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0052, std=0.0211
[DEBUG][MIA] Test Set Loss:   mean=2.3218, std=3.4412
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7647058823529412, 'auc': 0.90777587890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5729, std=1.4445
[DEBUG][MIA] Test Set Loss:   mean=2.0606, std=3.1193
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.628, 'cv_acc': 0.246, 'auc': 0.71096, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0274, std=0.1868
[DEBUG][MIA] Test Set Loss:   mean=1.8977, std=3.1376
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.2823529411764706, 'auc': 0.800048828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0100, std=0.0461
[DEBUG][MIA] Test Set Loss:   mean=1.7828, std=3.2451
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.702, 'cv_acc': 0.274, 'auc': 0.776936, 'task': 3}
4 3
Total correct retain:  1815  Total retain:  2500
Total correct forget:  13927  Total forget:  47500
Total correct test:  322  Total test:  500
Total correct forget test:  2373  Total test forget:  9500
After learning task 4
Task accuracies: [0.644, 0.492, 0.538, 0.66, 0.19, 0.192, 0.174, 0.194, 0.228, 0.204, 0.242, 0.14, 0.158, 0.24, 0.174, 0.2, 0.144, 0.218, 0.212, 0.146]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=2.2780, std=3.1916
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7890625, 'cv_acc': 0.7450980392156863, 'auc': 0.9329833984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3239, std=2.4654
[DEBUG][MIA] Test Set Loss:   mean=2.1743, std=3.4281
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.21600000000000003, 'auc': 0.594376, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=2.5996, std=3.8358
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7843137254901961, 'auc': 0.882171630859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1956, std=2.3485
[DEBUG][MIA] Test Set Loss:   mean=2.7318, std=3.7930
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.198, 'auc': 0.6451359999999999, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0037
[DEBUG][MIA] Test Set Loss:   mean=2.2040, std=3.3364
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7607843137254902, 'auc': 0.851470947265625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4890, std=1.4717
[DEBUG][MIA] Test Set Loss:   mean=2.2071, std=3.6550
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.26, 'auc': 0.7026960000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0113, std=0.0784
[DEBUG][MIA] Test Set Loss:   mean=0.9234, std=2.0035
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.24313725490196075, 'auc': 0.707733154296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0140, std=0.0571
[DEBUG][MIA] Test Set Loss:   mean=1.1539, std=2.4217
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.66, 'cv_acc': 0.242, 'auc': 0.721648, 'task': 4}
5 4
Total correct retain:  1773  Total retain:  2500
Total correct forget:  15125  Total forget:  47500
Total correct test:  317  Total test:  500
Total correct forget test:  2587  Total test forget:  9500
After learning task 5
Task accuracies: [0.634, 0.536, 0.506, 0.578, 0.756, 0.186, 0.172, 0.178, 0.2, 0.202, 0.232, 0.132, 0.156, 0.21, 0.204, 0.192, 0.138, 0.224, 0.216, 0.156]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0011
[DEBUG][MIA] Test Set Loss:   mean=2.9311, std=3.9627
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.828125, 'cv_acc': 0.7686274509803921, 'auc': 0.921142578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7429, std=3.1280
[DEBUG][MIA] Test Set Loss:   mean=2.6015, std=3.6552
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.16399999999999998, 'auc': 0.616256, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=2.8299, std=3.9806
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7647058823529411, 'auc': 0.90338134765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4338, std=2.7573
[DEBUG][MIA] Test Set Loss:   mean=2.9788, std=3.9768
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.20800000000000002, 'auc': 0.648784, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0071, std=0.0653
[DEBUG][MIA] Test Set Loss:   mean=2.6866, std=3.8273
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7725490196078431, 'auc': 0.87347412109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9279, std=1.9106
[DEBUG][MIA] Test Set Loss:   mean=2.4524, std=3.4957
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.20400000000000001, 'auc': 0.673936, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0021
[DEBUG][MIA] Test Set Loss:   mean=1.4085, std=3.0712
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2901960784313725, 'auc': 0.823028564453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.2966, std=0.8617
[DEBUG][MIA] Test Set Loss:   mean=1.2792, std=2.4272
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.196, 'auc': 0.6401840000000001, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0266, std=0.2537
[DEBUG][MIA] Test Set Loss:   mean=0.6576, std=1.8447
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.60546875, 'cv_acc': 0.2156862745098039, 'auc': 0.643341064453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0158, std=0.0886
[DEBUG][MIA] Test Set Loss:   mean=0.8764, std=2.4231
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.202, 'auc': 0.65192, 'task': 5}
6 5
Total correct retain:  1767  Total retain:  2500
Total correct forget:  16634  Total forget:  47500
Total correct test:  327  Total test:  500
Total correct forget test:  2876  Total test forget:  9500
After learning task 6
Task accuracies: [0.654, 0.508, 0.486, 0.552, 0.71, 0.83, 0.162, 0.19, 0.248, 0.176, 0.238, 0.156, 0.136, 0.224, 0.196, 0.164, 0.144, 0.224, 0.254, 0.154]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0030, std=0.0103
[DEBUG][MIA] Test Set Loss:   mean=2.6202, std=3.8770
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7686274509803921, 'auc': 0.900146484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9036, std=3.4540
[DEBUG][MIA] Test Set Loss:   mean=3.0693, std=4.1692
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.12600000000000003, 'auc': 0.606952, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0063, std=0.0407
[DEBUG][MIA] Test Set Loss:   mean=3.3978, std=4.5573
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7647058823529411, 'auc': 0.9261474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0309, std=3.4202
[DEBUG][MIA] Test Set Loss:   mean=3.1834, std=4.4634
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.16399999999999998, 'auc': 0.601528, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=2.6499, std=4.0176
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.79296875, 'cv_acc': 0.7176470588235293, 'auc': 0.85516357421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0013, std=2.1973
[DEBUG][MIA] Test Set Loss:   mean=2.4349, std=3.6460
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.192, 'auc': 0.6482559999999999, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0086, std=0.0561
[DEBUG][MIA] Test Set Loss:   mean=1.6270, std=2.9336
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.6941176470588235, 'auc': 0.793853759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7149, std=1.8236
[DEBUG][MIA] Test Set Loss:   mean=1.9748, std=3.4583
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.14999999999999997, 'auc': 0.65824, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0105
[DEBUG][MIA] Test Set Loss:   mean=1.6477, std=2.8431
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.2392156862745098, 'auc': 0.758087158203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2345, std=0.7548
[DEBUG][MIA] Test Set Loss:   mean=1.3064, std=3.0765
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.6, 'cv_acc': 0.17600000000000002, 'auc': 0.625024, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0426, std=0.1587
[DEBUG][MIA] Test Set Loss:   mean=1.8228, std=3.3024
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2392156862745098, 'auc': 0.761016845703125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0231, std=0.1494
[DEBUG][MIA] Test Set Loss:   mean=1.5691, std=3.2316
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.674, 'cv_acc': 0.274, 'auc': 0.7880959999999999, 'task': 6}
7 6
Total correct retain:  1778  Total retain:  2500
Total correct forget:  17978  Total forget:  47500
Total correct test:  333  Total test:  500
Total correct forget test:  3078  Total test forget:  9500
After learning task 7
Task accuracies: [0.666, 0.536, 0.488, 0.538, 0.654, 0.73, 0.684, 0.216, 0.204, 0.252, 0.23, 0.154, 0.156, 0.192, 0.202, 0.164, 0.216, 0.186, 0.234, 0.12]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0022
[DEBUG][MIA] Test Set Loss:   mean=2.5696, std=4.0293
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7411764705882352, 'auc': 0.914215087890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0057, std=3.2783
[DEBUG][MIA] Test Set Loss:   mean=2.7981, std=3.9154
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11800000000000002, 'auc': 0.569848, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.9958, std=4.0532
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.8235294117647058, 'auc': 0.916046142578125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7848, std=2.7962
[DEBUG][MIA] Test Set Loss:   mean=2.7127, std=3.7575
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.154, 'auc': 0.582816, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0187
[DEBUG][MIA] Test Set Loss:   mean=2.6850, std=3.9566
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.7254901960784313, 'auc': 0.92205810546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5719, std=2.7024
[DEBUG][MIA] Test Set Loss:   mean=2.1260, std=3.1966
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.162, 'auc': 0.573912, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0049, std=0.0278
[DEBUG][MIA] Test Set Loss:   mean=2.1746, std=3.2276
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7254901960784315, 'auc': 0.8614501953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0649, std=2.2071
[DEBUG][MIA] Test Set Loss:   mean=2.1303, std=4.2024
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.15, 'auc': 0.625656, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0027, std=0.0081
[DEBUG][MIA] Test Set Loss:   mean=1.6683, std=2.6749
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.28627450980392155, 'auc': 0.7742919921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0034, std=1.7663
[DEBUG][MIA] Test Set Loss:   mean=1.5769, std=2.7972
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.148, 'auc': 0.5502720000000001, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0636, std=0.2836
[DEBUG][MIA] Test Set Loss:   mean=2.0559, std=3.5363
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.7098039215686274, 'auc': 0.786468505859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7359, std=1.6700
[DEBUG][MIA] Test Set Loss:   mean=2.4396, std=3.7961
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.22999999999999998, 'auc': 0.6582239999999999, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0290, std=0.2311
[DEBUG][MIA] Test Set Loss:   mean=1.5364, std=2.7841
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2823529411764706, 'auc': 0.77569580078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0250, std=0.1812
[DEBUG][MIA] Test Set Loss:   mean=1.4635, std=2.7897
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.702, 'cv_acc': 0.67, 'auc': 0.788224, 'task': 7}
8 7
Total correct retain:  1682  Total retain:  2500
Total correct forget:  19259  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  3263  Total test forget:  9500
After learning task 8
Task accuracies: [0.616, 0.504, 0.482, 0.522, 0.598, 0.676, 0.568, 0.646, 0.24, 0.242, 0.248, 0.158, 0.224, 0.218, 0.208, 0.236, 0.136, 0.234, 0.206, 0.18]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0108
[DEBUG][MIA] Test Set Loss:   mean=2.1405, std=3.4409
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.788235294117647, 'auc': 0.8455810546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0232, std=3.6221
[DEBUG][MIA] Test Set Loss:   mean=3.2517, std=4.6294
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.10200000000000001, 'auc': 0.592976, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0091
[DEBUG][MIA] Test Set Loss:   mean=3.7267, std=4.9032
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.796875, 'cv_acc': 0.7725490196078431, 'auc': 0.902435302734375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2024, std=3.4793
[DEBUG][MIA] Test Set Loss:   mean=3.6252, std=4.8400
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.138, 'auc': 0.607208, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0036
[DEBUG][MIA] Test Set Loss:   mean=2.9241, std=3.9518
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.7764705882352942, 'auc': 0.900177001953125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.6913, std=3.1345
[DEBUG][MIA] Test Set Loss:   mean=2.5265, std=3.7716
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.154, 'auc': 0.578976, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.7548, std=3.2337
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.29411764705882354, 'auc': 0.86956787109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0176, std=2.3258
[DEBUG][MIA] Test Set Loss:   mean=1.5356, std=2.7249
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.14400000000000002, 'auc': 0.5965520000000001, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0224
[DEBUG][MIA] Test Set Loss:   mean=1.5961, std=3.3118
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.5254901960784314, 'auc': 0.793914794921875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.9616, std=2.0474
[DEBUG][MIA] Test Set Loss:   mean=1.6034, std=2.9702
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.15999999999999998, 'auc': 0.550008, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0059, std=0.0171
[DEBUG][MIA] Test Set Loss:   mean=2.1558, std=3.1135
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7019607843137254, 'auc': 0.826873779296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9757, std=2.3265
[DEBUG][MIA] Test Set Loss:   mean=2.1925, std=3.1550
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.178, 'auc': 0.6385839999999998, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0213
[DEBUG][MIA] Test Set Loss:   mean=1.7729, std=2.7859
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.2901960784313725, 'auc': 0.84454345703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3061, std=1.0529
[DEBUG][MIA] Test Set Loss:   mean=1.9009, std=3.0307
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.22400000000000003, 'auc': 0.7200000000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0427, std=0.3583
[DEBUG][MIA] Test Set Loss:   mean=0.7195, std=2.0153
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.21176470588235294, 'auc': 0.6497802734375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0168, std=0.1019
[DEBUG][MIA] Test Set Loss:   mean=0.5365, std=1.6797
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.21600000000000003, 'auc': 0.652976, 'task': 8}
Total correct retain:  1694  Total retain:  2500
Total correct forget:  20617  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  3558  Total test forget:  9500
After learning task 9
Task accuracies: [0.63, 0.514, 0.502, 0.542, 0.622, 0.672, 0.592, 0.632, 0.854, 0.188, 0.264, 0.18, 0.174, 0.202, 0.192, 0.218, 0.192, 0.2, 0.208, 0.168]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0103
[DEBUG][MIA] Test Set Loss:   mean=2.9501, std=4.0641
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78125, 'cv_acc': 0.7725490196078432, 'auc': 0.93243408203125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9623, std=3.4623
[DEBUG][MIA] Test Set Loss:   mean=3.0677, std=4.5756
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.12200000000000003, 'auc': 0.59132, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0044
[DEBUG][MIA] Test Set Loss:   mean=2.9692, std=4.2826
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.765625, 'cv_acc': 0.7803921568627451, 'auc': 0.9166259765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2576, std=3.5432
[DEBUG][MIA] Test Set Loss:   mean=3.1994, std=4.6438
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.2, 'auc': 0.567888, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=2.4849, std=4.0154
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7490196078431373, 'auc': 0.915557861328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4473, std=2.7510
[DEBUG][MIA] Test Set Loss:   mean=2.5368, std=3.8309
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.132, 'auc': 0.603784, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0163
[DEBUG][MIA] Test Set Loss:   mean=1.7918, std=3.2418
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7098039215686274, 'auc': 0.80828857421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2770, std=2.7340
[DEBUG][MIA] Test Set Loss:   mean=2.0943, std=3.4981
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.10600000000000001, 'auc': 0.60212, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0424
[DEBUG][MIA] Test Set Loss:   mean=1.6631, std=2.5569
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7215686274509805, 'auc': 0.78582763671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0244, std=2.2115
[DEBUG][MIA] Test Set Loss:   mean=1.6647, std=3.2936
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.174, 'auc': 0.560504, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0043, std=0.0136
[DEBUG][MIA] Test Set Loss:   mean=2.4644, std=3.2404
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.8046875, 'cv_acc': 0.7294117647058823, 'auc': 0.829925537109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8027, std=1.8964
[DEBUG][MIA] Test Set Loss:   mean=2.0897, std=3.0409
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.18, 'auc': 0.6503359999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0048, std=0.0158
[DEBUG][MIA] Test Set Loss:   mean=1.9920, std=3.1399
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7568627450980393, 'auc': 0.844207763671875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4927, std=1.3833
[DEBUG][MIA] Test Set Loss:   mean=1.9076, std=3.0491
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.634, 'cv_acc': 0.274, 'auc': 0.6888, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0007, std=0.0019
[DEBUG][MIA] Test Set Loss:   mean=0.7622, std=1.9792
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2156862745098039, 'auc': 0.765106201171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1546, std=0.6686
[DEBUG][MIA] Test Set Loss:   mean=0.9108, std=2.2816
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.174, 'auc': 0.646752, 'task': 8}
Total correct retain:  1646  Total retain:  2500
Total correct forget:  22329  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  3821  Total test forget:  9500
After learning task 10
Task accuracies: [0.604, 0.536, 0.486, 0.576, 0.612, 0.63, 0.548, 0.578, 0.822, 0.854, 0.258, 0.186, 0.16, 0.202, 0.176, 0.236, 0.19, 0.222, 0.202, 0.168]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=2.8168, std=4.0176
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.78515625, 'cv_acc': 0.7450980392156863, 'auc': 0.924224853515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0593, std=3.5256
[DEBUG][MIA] Test Set Loss:   mean=2.8442, std=4.1659
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10600000000000001, 'auc': 0.567016, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0039
[DEBUG][MIA] Test Set Loss:   mean=4.2355, std=4.9848
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.82421875, 'cv_acc': 0.803921568627451, 'auc': 0.95208740234375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.2042, std=3.2996
[DEBUG][MIA] Test Set Loss:   mean=3.3222, std=4.3566
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.128, 'auc': 0.60068, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=2.4347, std=3.8608
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.77734375, 'cv_acc': 0.776470588235294, 'auc': 0.887542724609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8251, std=3.3091
[DEBUG][MIA] Test Set Loss:   mean=2.5063, std=3.8143
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.094, 'auc': 0.5655040000000001, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0013
[DEBUG][MIA] Test Set Loss:   mean=2.1127, std=4.5012
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7215686274509804, 'auc': 0.82275390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3486, std=2.8905
[DEBUG][MIA] Test Set Loss:   mean=2.0616, std=4.1763
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.15599999999999997, 'auc': 0.576304, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0035
[DEBUG][MIA] Test Set Loss:   mean=1.5632, std=2.9418
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.7215686274509803, 'auc': 0.84906005859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0737, std=2.1986
[DEBUG][MIA] Test Set Loss:   mean=1.8259, std=3.3293
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.134, 'auc': 0.569736, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0033, std=0.0118
[DEBUG][MIA] Test Set Loss:   mean=2.1469, std=3.1659
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7294117647058823, 'auc': 0.87713623046875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2851, std=2.5263
[DEBUG][MIA] Test Set Loss:   mean=2.2426, std=3.5905
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.182, 'auc': 0.61044, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0144
[DEBUG][MIA] Test Set Loss:   mean=2.2183, std=3.3047
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.7490196078431374, 'auc': 0.829193115234375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5884, std=1.3491
[DEBUG][MIA] Test Set Loss:   mean=1.9184, std=3.0218
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.21400000000000002, 'auc': 0.647912, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=0.9518, std=2.0610
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.27450980392156865, 'auc': 0.826995849609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3025, std=0.8768
[DEBUG][MIA] Test Set Loss:   mean=0.8204, std=1.8591
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.176, 'auc': 0.6077440000000001, 'task': 8}
Total correct retain:  1722  Total retain:  2500
Total correct forget:  23703  Total forget:  47500
Total correct test:  318  Total test:  500
Total correct forget test:  4052  Total test forget:  9500
After learning task 11
Task accuracies: [0.636, 0.536, 0.466, 0.552, 0.634, 0.66, 0.56, 0.582, 0.782, 0.798, 0.754, 0.158, 0.138, 0.222, 0.172, 0.242, 0.226, 0.232, 0.22, 0.17]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0618, std=0.3217
[DEBUG][MIA] Test Set Loss:   mean=2.8157, std=3.9912
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6941176470588235, 'auc': 0.846038818359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4692, std=3.7515
[DEBUG][MIA] Test Set Loss:   mean=3.0571, std=4.5428
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.15, 'auc': 0.53144, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1527, std=0.6722
[DEBUG][MIA] Test Set Loss:   mean=4.3265, std=4.9994
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76953125, 'cv_acc': 0.7372549019607844, 'auc': 0.87310791015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.4487, std=3.7082
[DEBUG][MIA] Test Set Loss:   mean=4.1408, std=5.1420
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.15599999999999997, 'auc': 0.597544, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0409, std=0.2894
[DEBUG][MIA] Test Set Loss:   mean=2.4347, std=4.1594
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.7686274509803922, 'auc': 0.798858642578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8171, std=3.2041
[DEBUG][MIA] Test Set Loss:   mean=2.7063, std=3.8802
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11600000000000002, 'auc': 0.567896, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0409, std=0.2174
[DEBUG][MIA] Test Set Loss:   mean=2.4486, std=4.8986
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.7215686274509803, 'auc': 0.7989501953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6897, std=3.5563
[DEBUG][MIA] Test Set Loss:   mean=2.1919, std=3.5562
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12400000000000003, 'auc': 0.5754319999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1791, std=0.7564
[DEBUG][MIA] Test Set Loss:   mean=2.7295, std=4.3174
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25882352941176473, 'auc': 0.751953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5295, std=3.0421
[DEBUG][MIA] Test Set Loss:   mean=2.5499, std=4.0472
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.1, 'auc': 0.584848, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0473, std=0.1675
[DEBUG][MIA] Test Set Loss:   mean=2.7686, std=3.8075
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.6705882352941176, 'auc': 0.837982177734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.4337, std=2.6160
[DEBUG][MIA] Test Set Loss:   mean=3.0574, std=4.0724
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.12999999999999998, 'auc': 0.6202160000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0576, std=0.2044
[DEBUG][MIA] Test Set Loss:   mean=2.3093, std=3.1411
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7254901960784313, 'auc': 0.8179931640625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8104, std=1.9065
[DEBUG][MIA] Test Set Loss:   mean=2.0214, std=2.9603
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.61, 'cv_acc': 0.21000000000000002, 'auc': 0.637232, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0152, std=0.0826
[DEBUG][MIA] Test Set Loss:   mean=0.9504, std=1.9932
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2549019607843137, 'auc': 0.753082275390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3379, std=1.0458
[DEBUG][MIA] Test Set Loss:   mean=0.8317, std=1.8670
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.14799999999999996, 'auc': 0.57948, 'task': 8}
Total correct retain:  1677  Total retain:  2500
Total correct forget:  21162  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  3700  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.612, 0.524, 0.436, 0.552, 0.62, 0.618, 0.504, 0.558, 0.732, 0.776, 0.22, 0.164, 0.166, 0.266, 0.174, 0.238, 0.202, 0.206, 0.252, 0.192]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1349, std=0.9361
[DEBUG][MIA] Test Set Loss:   mean=3.2917, std=5.0482
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6745098039215686, 'auc': 0.8255615234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.1802, std=3.6749
[DEBUG][MIA] Test Set Loss:   mean=2.7943, std=4.7474
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.148, 'auc': 0.524568, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3029, std=1.1177
[DEBUG][MIA] Test Set Loss:   mean=4.8821, std=6.4446
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7215686274509805, 'auc': 0.79095458984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.4242, std=4.7866
[DEBUG][MIA] Test Set Loss:   mean=4.7038, std=5.6890
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.152, 'auc': 0.571504, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0968, std=0.4352
[DEBUG][MIA] Test Set Loss:   mean=3.2519, std=5.2159
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.6705882352941176, 'auc': 0.74725341796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.2428, std=3.6053
[DEBUG][MIA] Test Set Loss:   mean=3.1395, std=5.2078
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.14400000000000002, 'auc': 0.530728, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0402, std=0.2137
[DEBUG][MIA] Test Set Loss:   mean=2.7913, std=4.7677
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.25098039215686274, 'auc': 0.82464599609375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.8419, std=3.6491
[DEBUG][MIA] Test Set Loss:   mean=2.7842, std=5.0544
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.126, 'auc': 0.5749839999999999, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.2577, std=0.8898
[DEBUG][MIA] Test Set Loss:   mean=2.3896, std=4.1880
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.27058823529411763, 'auc': 0.716827392578125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9645, std=3.9028
[DEBUG][MIA] Test Set Loss:   mean=2.4936, std=4.4590
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10600000000000001, 'auc': 0.546304, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.3989, std=1.0830
[DEBUG][MIA] Test Set Loss:   mean=3.0190, std=3.9820
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.6470588235294118, 'auc': 0.747100830078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4923, std=4.0174
[DEBUG][MIA] Test Set Loss:   mean=3.5045, std=4.8255
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11400000000000002, 'auc': 0.566, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2197, std=0.9230
[DEBUG][MIA] Test Set Loss:   mean=3.6537, std=5.1515
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.4470588235294118, 'auc': 0.74517822265625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3390, std=2.8404
[DEBUG][MIA] Test Set Loss:   mean=3.1434, std=4.5534
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.604, 'cv_acc': 0.194, 'auc': 0.6231760000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0232, std=0.0827
[DEBUG][MIA] Test Set Loss:   mean=1.1683, std=2.3547
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.28627450980392155, 'auc': 0.723724365234375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4918, std=1.7686
[DEBUG][MIA] Test Set Loss:   mean=1.3665, std=2.4354
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.144, 'auc': 0.6361359999999999, 'task': 8}
Total correct retain:  1671  Total retain:  2500
Total correct forget:  19005  Total forget:  47500
Total correct test:  302  Total test:  500
Total correct forget test:  3350  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.604, 0.554, 0.426, 0.55, 0.614, 0.638, 0.494, 0.532, 0.722, 0.212, 0.21, 0.172, 0.152, 0.226, 0.184, 0.226, 0.192, 0.174, 0.26, 0.162]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.2997, std=1.0464
[DEBUG][MIA] Test Set Loss:   mean=3.3190, std=5.7125
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.6666666666666666, 'auc': 0.7601318359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.2583, std=3.7937
[DEBUG][MIA] Test Set Loss:   mean=4.1222, std=6.0396
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.088, 'auc': 0.582488, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.3219, std=1.1459
[DEBUG][MIA] Test Set Loss:   mean=4.2063, std=5.9911
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.7254901960784313, 'auc': 0.766632080078125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.7522, std=5.6151
[DEBUG][MIA] Test Set Loss:   mean=4.2550, std=5.2518
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.16399999999999998, 'auc': 0.547112, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4875, std=1.5139
[DEBUG][MIA] Test Set Loss:   mean=3.8215, std=5.1752
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26666666666666666, 'auc': 0.75537109375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.7283, std=4.6264
[DEBUG][MIA] Test Set Loss:   mean=3.8809, std=5.8105
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.10600000000000001, 'auc': 0.569336, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3099, std=1.3211
[DEBUG][MIA] Test Set Loss:   mean=2.8979, std=4.6138
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.24705882352941178, 'auc': 0.724578857421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2121, std=4.3425
[DEBUG][MIA] Test Set Loss:   mean=2.9165, std=4.9936
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.11400000000000002, 'auc': 0.5680320000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4865, std=1.4505
[DEBUG][MIA] Test Set Loss:   mean=2.8146, std=4.3556
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.2549019607843137, 'auc': 0.68927001953125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.8673, std=3.3050
[DEBUG][MIA] Test Set Loss:   mean=3.0447, std=4.9628
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10200000000000001, 'auc': 0.576288, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8344, std=1.9516
[DEBUG][MIA] Test Set Loss:   mean=3.7029, std=4.8676
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.403921568627451, 'auc': 0.731048583984375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.5461, std=4.7025
[DEBUG][MIA] Test Set Loss:   mean=4.1177, std=5.3974
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.13, 'auc': 0.601528, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.5305, std=1.3996
[DEBUG][MIA] Test Set Loss:   mean=3.2550, std=4.9975
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.7254901960784313, 'auc': 0.685272216796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9375, std=3.5085
[DEBUG][MIA] Test Set Loss:   mean=3.8889, std=5.4003
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.18, 'auc': 0.613864, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.0548, std=10.9402
[DEBUG][MIA] Test Set Loss:   mean=15.4317, std=13.5059
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.10588235294117647, 'auc': 0.5660400390625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.1567, std=11.2134
[DEBUG][MIA] Test Set Loss:   mean=15.5570, std=13.0431
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.088, 'auc': 0.5670160000000001, 'task': 8}
Total correct retain:  1576  Total retain:  2500
Total correct forget:  16782  Total forget:  47500
Total correct test:  295  Total test:  500
Total correct forget test:  3068  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.59, 0.532, 0.418, 0.544, 0.592, 0.616, 0.478, 0.478, 0.256, 0.204, 0.204, 0.18, 0.174, 0.242, 0.188, 0.224, 0.186, 0.228, 0.262, 0.13]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=21.9238, std=23.3655
[DEBUG][MIA] Test Set Loss:   mean=19.3887, std=23.2619
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.1647058823529412, 'auc': 0.461944580078125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=22.0258, std=21.1705
[DEBUG][MIA] Test Set Loss:   mean=23.0545, std=25.5368
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.098, 'auc': 0.509984, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=20.9083, std=22.3141
[DEBUG][MIA] Test Set Loss:   mean=25.9763, std=26.4089
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10588235294117647, 'auc': 0.45745849609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=26.1115, std=24.7775
[DEBUG][MIA] Test Set Loss:   mean=25.3544, std=25.6413
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.12, 'auc': 0.479, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=17.5565, std=23.7724
[DEBUG][MIA] Test Set Loss:   mean=18.6453, std=23.0501
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10588235294117647, 'auc': 0.534210205078125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=16.7856, std=22.1179
[DEBUG][MIA] Test Set Loss:   mean=17.6237, std=25.5315
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.092, 'auc': 0.49608800000000003, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.7230, std=28.0219
[DEBUG][MIA] Test Set Loss:   mean=29.0715, std=32.7611
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.14901960784313725, 'auc': 0.55987548828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=24.2465, std=28.3783
[DEBUG][MIA] Test Set Loss:   mean=24.4844, std=31.7433
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10600000000000001, 'auc': 0.48188, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=20.5021, std=20.6750
[DEBUG][MIA] Test Set Loss:   mean=23.0295, std=18.7216
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.08235294117647059, 'auc': 0.550140380859375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=21.4574, std=21.0241
[DEBUG][MIA] Test Set Loss:   mean=20.8913, std=19.5600
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.11000000000000001, 'auc': 0.49893599999999994, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=14.5477, std=20.7002
[DEBUG][MIA] Test Set Loss:   mean=12.3847, std=15.3978
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.08235294117647059, 'auc': 0.502349853515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=13.0246, std=17.5840
[DEBUG][MIA] Test Set Loss:   mean=12.4458, std=15.0299
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10200000000000001, 'auc': 0.48775999999999997, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=143.1294, std=134.3254
[DEBUG][MIA] Test Set Loss:   mean=162.9718, std=144.1951
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.10196078431372549, 'auc': 0.5416259765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=128.9678, std=118.6480
[DEBUG][MIA] Test Set Loss:   mean=152.4618, std=142.1869
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.5370320000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=73.6229, std=56.6696
[DEBUG][MIA] Test Set Loss:   mean=56.2023, std=53.4395
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.0784313725490196, 'auc': 0.593017578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=61.7095, std=54.9301
[DEBUG][MIA] Test Set Loss:   mean=61.9878, std=54.0057
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.09, 'auc': 0.498616, 'task': 8}
Total correct retain:  672  Total retain:  2500
Total correct forget:  10905  Total forget:  47500
Total correct test:  121  Total test:  500
Total correct forget test:  2179  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.242, 0.23, 0.256, 0.276, 0.328, 0.19, 0.32, 0.226, 0.204, 0.2, 0.2, 0.212, 0.25, 0.244, 0.188, 0.184, 0.224, 0.172, 0.228, 0.226]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.9808, std=8.0055
[DEBUG][MIA] Test Set Loss:   mean=8.3567, std=8.8732
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.0784313725490196, 'auc': 0.60626220703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.6159, std=8.4008
[DEBUG][MIA] Test Set Loss:   mean=8.5616, std=9.4162
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.10400000000000001, 'auc': 0.5681839999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.1376, std=8.8360
[DEBUG][MIA] Test Set Loss:   mean=8.2066, std=8.4297
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.12549019607843137, 'auc': 0.55029296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.6624, std=9.0907
[DEBUG][MIA] Test Set Loss:   mean=7.5297, std=8.5937
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11000000000000001, 'auc': 0.5336799999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7655, std=8.7626
[DEBUG][MIA] Test Set Loss:   mean=7.8663, std=10.6599
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.09411764705882353, 'auc': 0.4385986328125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1093, std=9.2766
[DEBUG][MIA] Test Set Loss:   mean=6.8663, std=9.6772
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.098, 'auc': 0.535592, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.4873, std=11.2618
[DEBUG][MIA] Test Set Loss:   mean=9.7794, std=12.6568
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.08235294117647059, 'auc': 0.529510498046875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=9.7253, std=12.5701
[DEBUG][MIA] Test Set Loss:   mean=9.2958, std=12.2646
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.08399999999999999, 'auc': 0.5158, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.8124, std=5.2263
[DEBUG][MIA] Test Set Loss:   mean=4.8409, std=5.6648
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.49517822265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.7646, std=5.0822
[DEBUG][MIA] Test Set Loss:   mean=4.9509, std=5.3639
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.10400000000000001, 'auc': 0.492464, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=27.6142, std=26.5145
[DEBUG][MIA] Test Set Loss:   mean=26.8589, std=25.6455
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.13725490196078433, 'auc': 0.49609375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=29.1708, std=25.8275
[DEBUG][MIA] Test Set Loss:   mean=25.4287, std=22.4764
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.098, 'auc': 0.4673280000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=77.2238, std=62.9567
[DEBUG][MIA] Test Set Loss:   mean=67.2477, std=61.8825
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.11372549019607843, 'auc': 0.449737548828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=64.1340, std=59.6810
[DEBUG][MIA] Test Set Loss:   mean=74.9155, std=72.3966
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.1, 'auc': 0.538208, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=36.3969, std=37.6486
[DEBUG][MIA] Test Set Loss:   mean=38.5682, std=37.9370
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.11372549019607844, 'auc': 0.48504638671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=39.8389, std=39.3823
[DEBUG][MIA] Test Set Loss:   mean=42.0799, std=39.5675
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.480768, 'task': 8}
Total correct retain:  869  Total retain:  2500
Total correct forget:  11452  Total forget:  47500
Total correct test:  168  Total test:  500
Total correct forget test:  2276  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.336, 0.296, 0.254, 0.352, 0.378, 0.314, 0.198, 0.276, 0.214, 0.2, 0.2, 0.168, 0.24, 0.186, 0.204, 0.202, 0.214, 0.242, 0.2, 0.214]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.8173, std=9.1851
[DEBUG][MIA] Test Set Loss:   mean=7.6169, std=9.0819
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.19607843137254902, 'auc': 0.55029296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=6.6431, std=8.3823
[DEBUG][MIA] Test Set Loss:   mean=8.4531, std=9.4182
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.088, 'auc': 0.5749519999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.2738, std=8.2343
[DEBUG][MIA] Test Set Loss:   mean=7.7498, std=7.8675
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10588235294117647, 'auc': 0.53448486328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.2371, std=9.3426
[DEBUG][MIA] Test Set Loss:   mean=7.3038, std=7.5553
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.10600000000000001, 'auc': 0.50856, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.1415, std=7.8068
[DEBUG][MIA] Test Set Loss:   mean=7.2505, std=9.3241
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09803921568627451, 'auc': 0.456298828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1632, std=9.0338
[DEBUG][MIA] Test Set Loss:   mean=7.1117, std=9.4975
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.118, 'auc': 0.484856, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=8.0521, std=11.0650
[DEBUG][MIA] Test Set Loss:   mean=9.0880, std=10.2370
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.1372549019607843, 'auc': 0.553741455078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=7.4530, std=9.7168
[DEBUG][MIA] Test Set Loss:   mean=7.6689, std=10.2868
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.508272, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.8465, std=5.4152
[DEBUG][MIA] Test Set Loss:   mean=4.7269, std=4.6599
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.10980392156862744, 'auc': 0.5113525390625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.9733, std=5.1554
[DEBUG][MIA] Test Set Loss:   mean=4.6998, std=5.2057
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.11600000000000002, 'auc': 0.48044000000000003, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=29.9263, std=25.6174
[DEBUG][MIA] Test Set Loss:   mean=29.8630, std=24.9045
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.13725490196078433, 'auc': 0.508758544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=27.8721, std=24.0323
[DEBUG][MIA] Test Set Loss:   mean=26.4330, std=22.9690
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.088, 'auc': 0.48838400000000004, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=72.1969, std=62.8610
[DEBUG][MIA] Test Set Loss:   mean=79.2650, std=61.7577
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.09803921568627451, 'auc': 0.466644287109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=67.9958, std=56.2974
[DEBUG][MIA] Test Set Loss:   mean=70.7151, std=68.9405
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10600000000000001, 'auc': 0.492248, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=40.0188, std=34.2290
[DEBUG][MIA] Test Set Loss:   mean=33.9535, std=31.9006
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09019607843137255, 'auc': 0.4534912109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=37.2600, std=36.2344
[DEBUG][MIA] Test Set Loss:   mean=41.0969, std=38.1508
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11000000000000001, 'auc': 0.47420000000000007, 'task': 8}
Total correct retain:  880  Total retain:  2500
Total correct forget:  11435  Total forget:  47500
Total correct test:  171  Total test:  500
Total correct forget test:  2273  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.342, 0.296, 0.262, 0.362, 0.382, 0.298, 0.208, 0.274, 0.218, 0.2, 0.2, 0.172, 0.228, 0.182, 0.204, 0.208, 0.216, 0.236, 0.19, 0.21]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=8.2574, std=11.4899
[DEBUG][MIA] Test Set Loss:   mean=10.5738, std=12.4968
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.1176470588235294, 'auc': 0.57452392578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.3174, std=12.2503
[DEBUG][MIA] Test Set Loss:   mean=9.6154, std=12.1879
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.092, 'auc': 0.5123200000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.0324, std=8.8765
[DEBUG][MIA] Test Set Loss:   mean=9.5553, std=9.3249
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.12549019607843137, 'auc': 0.56622314453125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.9673, std=10.3943
[DEBUG][MIA] Test Set Loss:   mean=9.9775, std=9.3439
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10600000000000001, 'auc': 0.47974399999999995, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.9333, std=9.6852
[DEBUG][MIA] Test Set Loss:   mean=11.1584, std=13.0811
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.550048828125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=9.6915, std=11.5330
[DEBUG][MIA] Test Set Loss:   mean=9.8401, std=11.2781
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.092, 'auc': 0.488472, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=17.5124, std=18.8110
[DEBUG][MIA] Test Set Loss:   mean=15.9827, std=18.3527
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.1254901960784314, 'auc': 0.490753173828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=16.5585, std=18.8330
[DEBUG][MIA] Test Set Loss:   mean=16.8156, std=20.5215
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.510632, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.0610, std=6.7391
[DEBUG][MIA] Test Set Loss:   mean=6.0554, std=6.5333
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11372549019607843, 'auc': 0.516021728515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.5249, std=6.7873
[DEBUG][MIA] Test Set Loss:   mean=6.8741, std=7.3321
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.49493600000000004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=28.4491, std=23.1116
[DEBUG][MIA] Test Set Loss:   mean=31.6932, std=25.6015
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.11764705882352941, 'auc': 0.463287353515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=33.6164, std=25.4510
[DEBUG][MIA] Test Set Loss:   mean=31.1210, std=24.9914
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.094, 'auc': 0.534648, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=85.8446, std=59.1867
[DEBUG][MIA] Test Set Loss:   mean=78.5872, std=65.0584
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.10196078431372549, 'auc': 0.451568603515625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=82.2276, std=58.0748
[DEBUG][MIA] Test Set Loss:   mean=84.8182, std=63.1727
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.08, 'auc': 0.5079359999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=31.5484, std=31.4368
[DEBUG][MIA] Test Set Loss:   mean=31.1391, std=28.3885
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.10588235294117647, 'auc': 0.51483154296875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=32.3009, std=29.1931
[DEBUG][MIA] Test Set Loss:   mean=31.5983, std=30.4553
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.1, 'auc': 0.5126080000000001, 'task': 8}
Total correct retain:  819  Total retain:  2500
Total correct forget:  10415  Total forget:  47500
Total correct test:  154  Total test:  500
Total correct forget test:  2067  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.308, 0.286, 0.204, 0.33, 0.252, 0.286, 0.18, 0.228, 0.212, 0.2, 0.2, 0.202, 0.224, 0.184, 0.168, 0.206, 0.222, 0.182, 0.176, 0.192]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.3002, std=14.4050
[DEBUG][MIA] Test Set Loss:   mean=13.1210, std=15.8313
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.1568627450980392, 'auc': 0.53753662109375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.7167, std=16.1164
[DEBUG][MIA] Test Set Loss:   mean=13.5223, std=14.2946
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10600000000000001, 'auc': 0.507064, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.7529, std=9.2559
[DEBUG][MIA] Test Set Loss:   mean=11.7831, std=9.6227
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.10588235294117647, 'auc': 0.4339599609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=12.4256, std=11.0518
[DEBUG][MIA] Test Set Loss:   mean=10.8560, std=9.7154
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.09, 'auc': 0.53828, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=18.3262, std=23.3296
[DEBUG][MIA] Test Set Loss:   mean=25.7467, std=35.8581
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.09019607843137255, 'auc': 0.560821533203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=23.6188, std=27.5974
[DEBUG][MIA] Test Set Loss:   mean=22.8189, std=26.9561
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10200000000000001, 'auc': 0.48960000000000004, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=13.2431, std=16.2024
[DEBUG][MIA] Test Set Loss:   mean=20.1451, std=24.8034
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.09803921568627451, 'auc': 0.57757568359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=19.8813, std=23.2213
[DEBUG][MIA] Test Set Loss:   mean=19.1449, std=22.9964
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.505344, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.6570, std=6.7575
[DEBUG][MIA] Test Set Loss:   mean=6.4055, std=6.8513
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51171875, 'cv_acc': 0.12941176470588234, 'auc': 0.5372314453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=7.0569, std=8.1675
[DEBUG][MIA] Test Set Loss:   mean=7.2681, std=7.0282
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.11599999999999999, 'auc': 0.46860000000000007, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.9242, std=18.9803
[DEBUG][MIA] Test Set Loss:   mean=24.3603, std=20.0391
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10588235294117647, 'auc': 0.51507568359375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=21.4231, std=18.5298
[DEBUG][MIA] Test Set Loss:   mean=21.9211, std=19.6642
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.096, 'auc': 0.5045040000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=84.2615, std=63.5318
[DEBUG][MIA] Test Set Loss:   mean=89.9046, std=73.2219
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.09411764705882353, 'auc': 0.519500732421875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=93.1311, std=78.4189
[DEBUG][MIA] Test Set Loss:   mean=87.2730, std=80.8751
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10600000000000001, 'auc': 0.47051200000000004, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=33.3121, std=30.9111
[DEBUG][MIA] Test Set Loss:   mean=30.5748, std=29.0705
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.52734375, 'cv_acc': 0.16862745098039217, 'auc': 0.521148681640625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=32.9428, std=34.1362
[DEBUG][MIA] Test Set Loss:   mean=33.3607, std=32.6959
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.11200000000000002, 'auc': 0.48931199999999997, 'task': 8}
Total correct retain:  769  Total retain:  2500
Total correct forget:  10616  Total forget:  47500
Total correct test:  140  Total test:  500
Total correct forget test:  2121  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.28, 0.296, 0.242, 0.294, 0.27, 0.332, 0.234, 0.208, 0.24, 0.2, 0.2, 0.14, 0.232, 0.222, 0.158, 0.202, 0.19, 0.224, 0.162, 0.196]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=9.7078, std=13.9457
[DEBUG][MIA] Test Set Loss:   mean=11.5438, std=12.7997
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.14901960784313723, 'auc': 0.59228515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=11.8206, std=14.2091
[DEBUG][MIA] Test Set Loss:   mean=13.7693, std=15.4788
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.076, 'auc': 0.470152, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=10.4117, std=9.5509
[DEBUG][MIA] Test Set Loss:   mean=10.5746, std=9.0609
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.453125, 'cv_acc': 0.09803921568627451, 'auc': 0.4854736328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=11.6339, std=11.2696
[DEBUG][MIA] Test Set Loss:   mean=10.3894, std=9.2549
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10200000000000001, 'auc': 0.484048, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=20.9280, std=31.0199
[DEBUG][MIA] Test Set Loss:   mean=18.1168, std=23.3451
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10980392156862746, 'auc': 0.498779296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=25.1896, std=32.3870
[DEBUG][MIA] Test Set Loss:   mean=23.2313, std=28.8354
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.08, 'auc': 0.505528, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=12.7765, std=13.8519
[DEBUG][MIA] Test Set Loss:   mean=15.1224, std=18.4175
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.12549019607843137, 'auc': 0.53057861328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=18.6373, std=24.1724
[DEBUG][MIA] Test Set Loss:   mean=18.1632, std=23.2185
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10800000000000001, 'auc': 0.491392, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=5.4895, std=6.2398
[DEBUG][MIA] Test Set Loss:   mean=8.0816, std=8.2045
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.13333333333333336, 'auc': 0.590240478515625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=6.3058, std=7.6488
[DEBUG][MIA] Test Set Loss:   mean=6.9555, std=7.2623
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.074, 'auc': 0.457336, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.1631, std=18.5253
[DEBUG][MIA] Test Set Loss:   mean=21.3346, std=18.1622
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.0784313725490196, 'auc': 0.48114013671875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=22.8691, std=18.5808
[DEBUG][MIA] Test Set Loss:   mean=20.9478, std=19.1858
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.11000000000000001, 'auc': 0.465688, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=82.4212, std=66.8463
[DEBUG][MIA] Test Set Loss:   mean=91.2353, std=73.6841
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53125, 'cv_acc': 0.10196078431372549, 'auc': 0.5364990234375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=85.3978, std=78.8464
[DEBUG][MIA] Test Set Loss:   mean=88.3779, std=76.5975
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10200000000000001, 'auc': 0.515312, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=32.5997, std=31.8296
[DEBUG][MIA] Test Set Loss:   mean=27.2881, std=27.4806
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.08235294117647059, 'auc': 0.46038818359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=33.9201, std=31.3591
[DEBUG][MIA] Test Set Loss:   mean=32.4914, std=32.6894
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10800000000000001, 'auc': 0.522176, 'task': 8}
Total correct retain:  763  Total retain:  2500
Total correct forget:  10664  Total forget:  47500
Total correct test:  141  Total test:  500
Total correct forget test:  2149  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.282, 0.296, 0.26, 0.3, 0.278, 0.34, 0.238, 0.208, 0.238, 0.2, 0.2, 0.136, 0.236, 0.22, 0.16, 0.204, 0.192, 0.232, 0.164, 0.196]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([7, 6, 8, 6, 9, 8, 8, 6, 7, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=93.5020, std=111.7811
[DEBUG][MIA] Test Set Loss:   mean=99.9986, std=118.5364
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.11764705882352941, 'auc': 0.4793701171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 5 6 5 6 5 9 7 8]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 8 9 9 5 8 8 9 6 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=97.1392, std=117.0047
[DEBUG][MIA] Test Set Loss:   mean=92.2831, std=112.9463
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.11399999999999999, 'auc': 0.48392, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 12, 10, 14, 11, 13, 13, 14, 14], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=30.1237, std=34.2936
[DEBUG][MIA] Test Set Loss:   mean=28.3976, std=34.0592
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.10196078431372549, 'auc': 0.519317626953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 12 10 13 13 12 12 11 13 10]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [13 12 10 12 11 10 10 13 13 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=25.4055, std=28.5160
[DEBUG][MIA] Test Set Loss:   mean=27.4348, std=30.9119
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.1, 'auc': 0.486112, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([19, 15, 16, 16, 19, 17, 18, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=35.9794, std=55.4486
[DEBUG][MIA] Test Set Loss:   mean=44.4235, std=59.7550
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09019607843137255, 'auc': 0.4354248046875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [15 19 16 16 19 15 19 15 18 17]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [18 17 18 17 18 19 17 19 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=41.1643, std=63.0124
[DEBUG][MIA] Test Set Loss:   mean=40.3827, std=59.9673
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.086, 'auc': 0.501264, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([20, 24, 20, 22, 23, 22, 22, 22, 23, 20], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=33.2757, std=45.2764
[DEBUG][MIA] Test Set Loss:   mean=30.5481, std=44.5472
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.12156862745098038, 'auc': 0.484222412109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 24 22 21 22 22 23 23 24 20]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 22 24 21 24 22 20 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=38.7944, std=51.8748
[DEBUG][MIA] Test Set Loss:   mean=32.9637, std=49.9469
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.1, 'auc': 0.46216, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([25, 28, 26, 29, 27, 28, 28, 25, 26, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=11.9061, std=13.8748
[DEBUG][MIA] Test Set Loss:   mean=10.8663, std=12.3100
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09803921568627451, 'auc': 0.491851806640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [28 28 25 27 26 29 29 25 28 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 28 27 29 29 26 26 26 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=13.1977, std=15.6226
[DEBUG][MIA] Test Set Loss:   mean=12.9584, std=14.7453
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.092, 'auc': 0.487304, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 34, 31, 32, 32, 31, 32, 34, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=45.5952, std=47.0649
[DEBUG][MIA] Test Set Loss:   mean=38.2979, std=37.3526
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11372549019607844, 'auc': 0.46331787109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [33 30 34 32 31 34 32 31 33 31]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 31 34 31 31 32 32 34 32 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=43.9022, std=41.8296
[DEBUG][MIA] Test Set Loss:   mean=38.7078, std=37.5781
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.10200000000000001, 'auc': 0.4671519999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([36, 35, 38, 35, 36, 37, 36, 38, 39, 39], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=184.3690, std=208.5802
[DEBUG][MIA] Test Set Loss:   mean=164.6255, std=200.2039
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.47265625, 'cv_acc': 0.09411764705882353, 'auc': 0.45361328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 36 38 36 38 37 39 35 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 36 36 36 36 36 39 35 36 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=179.3876, std=192.7965
[DEBUG][MIA] Test Set Loss:   mean=199.6190, std=222.7196
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.086, 'auc': 0.5108, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([41, 44, 41, 44, 43, 41, 40, 41, 44, 41], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=85.5946, std=85.5417
[DEBUG][MIA] Test Set Loss:   mean=67.5335, std=79.1831
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.10980392156862746, 'auc': 0.430419921875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [44 43 43 41 41 40 41 42 44 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 42 41 42 42 40 44 43 41 42]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=79.2248, std=87.3590
[DEBUG][MIA] Test Set Loss:   mean=79.7439, std=87.5008
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.094, 'auc': 0.4993519999999999, 'task': 8}
Total correct retain:  716  Total retain:  2500
Total correct forget:  10118  Total forget:  47500
Total correct test:  149  Total test:  500
Total correct forget test:  2014  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.298, 0.222, 0.188, 0.252, 0.248, 0.32, 0.202, 0.188, 0.232, 0.2, 0.2, 0.104, 0.238, 0.25, 0.168, 0.194, 0.19, 0.212, 0.164, 0.256]
Number of constraint violations:  52
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: ALT-NEGGEM
alpha: 0
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 2
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sun Apr 27 02:40:07 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 23%   65C    P0             76W /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  2
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['aquarium fish', 'bottles', 'turtle', 'leopard', 'skyscraper', 'poppies', 'raccoon', 'bicycle', 'couch', 'wardrobe', 'snail', 'worm', 'house', 'girl', 'oranges', 'bee', 'ray', 'roses', 'lawn-mower', 'palm', 'trout', 'beetle', 'dolphin', 'baby', 'telephone', 'tulips', 'sweet peppers', 'squirrel', 'possum', 'shark', 'kangaroo', 'woman', 'butterfly', 'wolf', 'lion', 'mountain', 'lobster', 'beaver', 'plates', 'television', 'road', 'sea', 'lizard', 'plain', 'bear', 'otter', 'chair', 'mushrooms', 'cloud', 'table', 'whale', 'elephant', 'pickup truck', 'cups', 'cans', 'oak', 'shrew', 'tank', 'clock', 'tiger', 'fox', 'rocket', 'streetcar', 'maple', 'man', 'rabbit', 'bus', 'flatfish', 'boy', 'bowls', 'caterpillar', 'chimpanzee', 'crocodile', 'sunflowers', 'bridge', 'castle', 'bed', 'tractor', 'motorcycle', 'orchids', 'lamp', 'forest', 'crab', 'dinosaur', 'cockroach', 'porcupine', 'mouse', 'train', 'camel', 'snake', 'pears', 'pine', 'skunk', 'seal', 'spider', 'hamster', 'willow', 'apples', 'computer keyboard', 'cattle']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2079  Total retain:  2500
Total correct forget:  9564  Total forget:  47500
Total correct test:  379  Total test:  500
Total correct forget test:  1910  Total test forget:  9500
After learning task 1
Task accuracies: [0.758, 0.112, 0.298, 0.196, 0.278, 0.338, 0.138, 0.21, 0.18, 0.174, 0.182, 0.204, 0.134, 0.186, 0.184, 0.228, 0.186, 0.18, 0.23, 0.182]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1459, std=0.6095
[DEBUG][MIA] Test Set Loss:   mean=0.6804, std=1.6238
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.2, 'auc': 0.59881591796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1046, std=0.4805
[DEBUG][MIA] Test Set Loss:   mean=1.0121, std=2.3348
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.178, 'auc': 0.6329199999999999, 'task': 1}
2 1
Total correct retain:  1810  Total retain:  2500
Total correct forget:  11593  Total forget:  47500
Total correct test:  348  Total test:  500
Total correct forget test:  2227  Total test forget:  9500
After learning task 2
Task accuracies: [0.696, 0.788, 0.198, 0.212, 0.276, 0.31, 0.148, 0.138, 0.174, 0.2, 0.202, 0.148, 0.184, 0.178, 0.236, 0.262, 0.22, 0.228, 0.162, 0.19]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0132, std=0.0503
[DEBUG][MIA] Test Set Loss:   mean=1.2701, std=2.2475
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.26274509803921564, 'auc': 0.741729736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5680, std=1.4911
[DEBUG][MIA] Test Set Loss:   mean=1.3330, std=2.6009
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.142, 'auc': 0.579312, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.2516, std=1.2546
[DEBUG][MIA] Test Set Loss:   mean=1.4637, std=2.7684
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.16862745098039217, 'auc': 0.708404541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.4103, std=1.5708
[DEBUG][MIA] Test Set Loss:   mean=1.3609, std=2.6365
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.22999999999999998, 'auc': 0.6809280000000001, 'task': 2}
3 2
Total correct retain:  1671  Total retain:  2500
Total correct forget:  13231  Total forget:  47500
Total correct test:  321  Total test:  500
Total correct forget test:  2479  Total test forget:  9500
After learning task 3
Task accuracies: [0.642, 0.72, 0.712, 0.284, 0.3, 0.34, 0.132, 0.15, 0.184, 0.194, 0.19, 0.176, 0.174, 0.222, 0.186, 0.238, 0.19, 0.244, 0.162, 0.16]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0127, std=0.0476
[DEBUG][MIA] Test Set Loss:   mean=1.4790, std=2.8438
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.27450980392156865, 'auc': 0.760498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1172, std=2.4530
[DEBUG][MIA] Test Set Loss:   mean=1.2714, std=2.7165
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.14, 'auc': 0.5392319999999999, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0079, std=0.0313
[DEBUG][MIA] Test Set Loss:   mean=1.7169, std=2.9707
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.27450980392156865, 'auc': 0.7391357421875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.5433, std=1.4242
[DEBUG][MIA] Test Set Loss:   mean=1.3488, std=2.5022
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.196, 'auc': 0.59412, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0091, std=0.0505
[DEBUG][MIA] Test Set Loss:   mean=0.3881, std=1.4266
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.16862745098039214, 'auc': 0.600738525390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0210, std=0.2380
[DEBUG][MIA] Test Set Loss:   mean=0.5600, std=1.9348
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.588, 'cv_acc': 0.16999999999999998, 'auc': 0.613208, 'task': 3}
4 3
Total correct retain:  1752  Total retain:  2500
Total correct forget:  14885  Total forget:  47500
Total correct test:  335  Total test:  500
Total correct forget test:  2781  Total test forget:  9500
After learning task 4
Task accuracies: [0.67, 0.708, 0.69, 0.88, 0.282, 0.334, 0.19, 0.132, 0.204, 0.238, 0.132, 0.216, 0.19, 0.2, 0.256, 0.244, 0.196, 0.204, 0.144, 0.122]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0300, std=0.1588
[DEBUG][MIA] Test Set Loss:   mean=2.0159, std=3.5782
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.27450980392156865, 'auc': 0.6986083984375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9066, std=1.8932
[DEBUG][MIA] Test Set Loss:   mean=1.5693, std=2.9180
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.15999999999999998, 'auc': 0.534952, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0299, std=0.2974
[DEBUG][MIA] Test Set Loss:   mean=1.5181, std=2.7389
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.28627450980392155, 'auc': 0.760894775390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6139, std=1.6679
[DEBUG][MIA] Test Set Loss:   mean=1.6658, std=2.8812
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.612, 'cv_acc': 0.138, 'auc': 0.631408, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0616, std=0.3607
[DEBUG][MIA] Test Set Loss:   mean=0.8285, std=1.6896
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.25098039215686274, 'auc': 0.688812255859375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7049, std=1.7850
[DEBUG][MIA] Test Set Loss:   mean=1.1534, std=2.4573
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.13600000000000004, 'auc': 0.5785440000000001, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0765, std=0.4438
[DEBUG][MIA] Test Set Loss:   mean=0.8507, std=2.0723
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.20784313725490197, 'auc': 0.689697265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0350, std=0.2593
[DEBUG][MIA] Test Set Loss:   mean=0.8663, std=2.3762
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.602, 'cv_acc': 0.192, 'auc': 0.703104, 'task': 4}
5 4
Total correct retain:  1709  Total retain:  2500
Total correct forget:  16270  Total forget:  47500
Total correct test:  322  Total test:  500
Total correct forget test:  2984  Total test forget:  9500
After learning task 5
Task accuracies: [0.644, 0.662, 0.658, 0.744, 0.804, 0.398, 0.172, 0.116, 0.17, 0.218, 0.16, 0.186, 0.212, 0.194, 0.318, 0.256, 0.214, 0.204, 0.158, 0.124]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0344, std=0.1651
[DEBUG][MIA] Test Set Loss:   mean=2.1244, std=3.5222
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.6549019607843137, 'auc': 0.77496337890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3375, std=2.8324
[DEBUG][MIA] Test Set Loss:   mean=1.6666, std=2.8851
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.096, 'auc': 0.503632, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0076, std=0.0360
[DEBUG][MIA] Test Set Loss:   mean=1.6242, std=2.7833
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2784313725490196, 'auc': 0.7977294921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0046, std=2.4128
[DEBUG][MIA] Test Set Loss:   mean=1.5822, std=2.9850
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.14200000000000002, 'auc': 0.579552, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0016, std=0.0048
[DEBUG][MIA] Test Set Loss:   mean=0.8723, std=1.7189
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.22745098039215686, 'auc': 0.78387451171875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.6603, std=1.6404
[DEBUG][MIA] Test Set Loss:   mean=1.0127, std=2.2790
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.11200000000000002, 'auc': 0.5034799999999999, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0507, std=0.3871
[DEBUG][MIA] Test Set Loss:   mean=1.6897, std=3.1158
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2431372549019608, 'auc': 0.740936279296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3788, std=1.1184
[DEBUG][MIA] Test Set Loss:   mean=1.0480, std=2.4357
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.186, 'auc': 0.5962799999999999, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0300, std=0.1266
[DEBUG][MIA] Test Set Loss:   mean=1.2524, std=2.8468
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.25098039215686274, 'auc': 0.678253173828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0508, std=0.2860
[DEBUG][MIA] Test Set Loss:   mean=0.9852, std=2.3166
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.624, 'cv_acc': 0.21600000000000003, 'auc': 0.689184, 'task': 5}
6 5
Total correct retain:  1761  Total retain:  2500
Total correct forget:  17167  Total forget:  47500
Total correct test:  340  Total test:  500
Total correct forget test:  3103  Total test forget:  9500
After learning task 6
Task accuracies: [0.68, 0.656, 0.674, 0.762, 0.714, 0.75, 0.142, 0.116, 0.174, 0.23, 0.172, 0.176, 0.166, 0.19, 0.274, 0.248, 0.202, 0.184, 0.222, 0.154]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0217, std=0.1851
[DEBUG][MIA] Test Set Loss:   mean=1.7643, std=2.9953
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.2588235294117647, 'auc': 0.777313232421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9921, std=2.2491
[DEBUG][MIA] Test Set Loss:   mean=1.6337, std=3.1659
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.10800000000000001, 'auc': 0.430464, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0082
[DEBUG][MIA] Test Set Loss:   mean=1.5970, std=3.6179
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.6941176470588235, 'auc': 0.805572509765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.8576, std=2.1232
[DEBUG][MIA] Test Set Loss:   mean=1.6839, std=3.0418
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.14999999999999997, 'auc': 0.6008, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0069
[DEBUG][MIA] Test Set Loss:   mean=1.2780, std=2.5998
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.21960784313725487, 'auc': 0.78558349609375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.7309, std=2.0964
[DEBUG][MIA] Test Set Loss:   mean=1.1591, std=2.4341
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.092, 'auc': 0.550096, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0105, std=0.0698
[DEBUG][MIA] Test Set Loss:   mean=1.4101, std=2.4795
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.28627450980392155, 'auc': 0.762725830078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7413, std=1.8692
[DEBUG][MIA] Test Set Loss:   mean=1.6341, std=2.9435
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.17, 'auc': 0.614928, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0077, std=0.0430
[DEBUG][MIA] Test Set Loss:   mean=1.1865, std=2.3681
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.6941176470588235, 'auc': 0.72265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3652, std=1.1666
[DEBUG][MIA] Test Set Loss:   mean=1.3572, std=2.3895
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.606, 'cv_acc': 0.184, 'auc': 0.6710320000000001, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0392, std=0.2718
[DEBUG][MIA] Test Set Loss:   mean=1.2462, std=2.8779
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.25882352941176473, 'auc': 0.701019287109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0426, std=0.2735
[DEBUG][MIA] Test Set Loss:   mean=1.3941, std=2.8077
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.664, 'cv_acc': 0.23400000000000004, 'auc': 0.744184, 'task': 6}
7 6
Total correct retain:  1729  Total retain:  2500
Total correct forget:  19066  Total forget:  47500
Total correct test:  334  Total test:  500
Total correct forget test:  3419  Total test forget:  9500
After learning task 7
Task accuracies: [0.668, 0.706, 0.674, 0.752, 0.682, 0.682, 0.73, 0.122, 0.194, 0.202, 0.17, 0.194, 0.192, 0.174, 0.306, 0.262, 0.198, 0.23, 0.208, 0.16]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0290, std=0.1683
[DEBUG][MIA] Test Set Loss:   mean=1.8960, std=3.2933
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2862745098039216, 'auc': 0.75433349609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1942, std=2.5572
[DEBUG][MIA] Test Set Loss:   mean=1.6602, std=3.1295
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.10200000000000001, 'auc': 0.5317919999999999, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0347
[DEBUG][MIA] Test Set Loss:   mean=1.5442, std=3.3711
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.27450980392156865, 'auc': 0.73779296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0116, std=2.4131
[DEBUG][MIA] Test Set Loss:   mean=1.6497, std=3.1469
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.12600000000000003, 'auc': 0.581824, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0153
[DEBUG][MIA] Test Set Loss:   mean=1.5992, std=3.4303
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.2431372549019608, 'auc': 0.7376708984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8047, std=1.8981
[DEBUG][MIA] Test Set Loss:   mean=1.1602, std=2.5448
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.146, 'auc': 0.5220480000000001, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0045
[DEBUG][MIA] Test Set Loss:   mean=1.1981, std=2.3159
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.25882352941176473, 'auc': 0.755401611328125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.7694, std=2.0177
[DEBUG][MIA] Test Set Loss:   mean=1.1766, std=2.2546
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.156, 'auc': 0.573936, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0113, std=0.0692
[DEBUG][MIA] Test Set Loss:   mean=1.1306, std=2.5123
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30588235294117644, 'auc': 0.7779541015625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.5594, std=1.4613
[DEBUG][MIA] Test Set Loss:   mean=1.2415, std=2.4781
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.20800000000000002, 'auc': 0.6195759999999999, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0065, std=0.0284
[DEBUG][MIA] Test Set Loss:   mean=2.1962, std=3.9851
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.3019607843137254, 'auc': 0.8052978515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4253, std=1.2211
[DEBUG][MIA] Test Set Loss:   mean=2.2283, std=3.6627
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.202, 'auc': 0.6868, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0270, std=0.2162
[DEBUG][MIA] Test Set Loss:   mean=1.1517, std=2.7295
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.2, 'auc': 0.685333251953125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0612, std=0.3746
[DEBUG][MIA] Test Set Loss:   mean=0.9026, std=2.2718
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.614, 'cv_acc': 0.20800000000000002, 'auc': 0.6465920000000001, 'task': 7}
8 7
Total correct retain:  1738  Total retain:  2500
Total correct forget:  20573  Total forget:  47500
Total correct test:  332  Total test:  500
Total correct forget test:  3631  Total test forget:  9500
After learning task 8
Task accuracies: [0.664, 0.644, 0.678, 0.742, 0.716, 0.662, 0.642, 0.8, 0.228, 0.218, 0.124, 0.222, 0.146, 0.17, 0.28, 0.238, 0.184, 0.23, 0.168, 0.17]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0624, std=0.2801
[DEBUG][MIA] Test Set Loss:   mean=2.2469, std=3.4201
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.4431372549019608, 'auc': 0.701568603515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8853, std=3.7817
[DEBUG][MIA] Test Set Loss:   mean=2.0000, std=3.3923
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.11200000000000002, 'auc': 0.526232, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0595, std=0.4235
[DEBUG][MIA] Test Set Loss:   mean=1.9914, std=3.3599
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2784313725490196, 'auc': 0.791961669921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6407, std=3.1665
[DEBUG][MIA] Test Set Loss:   mean=1.8089, std=3.3317
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.128, 'auc': 0.518296, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0022, std=0.0073
[DEBUG][MIA] Test Set Loss:   mean=1.2651, std=2.7322
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.24705882352941178, 'auc': 0.704681396484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0107, std=2.3047
[DEBUG][MIA] Test Set Loss:   mean=1.5044, std=3.1241
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.1, 'auc': 0.5281279999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0070, std=0.0468
[DEBUG][MIA] Test Set Loss:   mean=1.4101, std=2.7897
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2901960784313725, 'auc': 0.759552001953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5870, std=1.5672
[DEBUG][MIA] Test Set Loss:   mean=1.3166, std=3.0245
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.12000000000000002, 'auc': 0.540528, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0310, std=0.2217
[DEBUG][MIA] Test Set Loss:   mean=1.6956, std=3.0106
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2705882352941177, 'auc': 0.78045654296875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6152, std=1.8330
[DEBUG][MIA] Test Set Loss:   mean=1.4676, std=2.6096
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.138, 'auc': 0.6224559999999999, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0152, std=0.0708
[DEBUG][MIA] Test Set Loss:   mean=2.0450, std=3.8919
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6823529411764706, 'auc': 0.80206298828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.5876, std=1.4920
[DEBUG][MIA] Test Set Loss:   mean=1.9926, std=3.4246
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.20800000000000002, 'auc': 0.6521279999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0010, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=1.7547, std=3.1345
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.25882352941176473, 'auc': 0.84185791015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3791, std=1.2443
[DEBUG][MIA] Test Set Loss:   mean=1.5640, std=3.0894
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.198, 'auc': 0.62344, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0726, std=0.4754
[DEBUG][MIA] Test Set Loss:   mean=1.0124, std=2.9079
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.1843137254901961, 'auc': 0.645721435546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1092, std=0.5568
[DEBUG][MIA] Test Set Loss:   mean=1.0224, std=2.7146
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.176, 'auc': 0.6490400000000001, 'task': 8}
Total correct retain:  1753  Total retain:  2500
Total correct forget:  21841  Total forget:  47500
Total correct test:  348  Total test:  500
Total correct forget test:  3915  Total test forget:  9500
After learning task 9
Task accuracies: [0.696, 0.64, 0.638, 0.732, 0.734, 0.676, 0.596, 0.722, 0.824, 0.24, 0.16, 0.222, 0.184, 0.224, 0.314, 0.234, 0.186, 0.174, 0.19, 0.14]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0409, std=0.2508
[DEBUG][MIA] Test Set Loss:   mean=2.0338, std=3.6018
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2901960784313725, 'auc': 0.77081298828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9096, std=3.4022
[DEBUG][MIA] Test Set Loss:   mean=1.9773, std=3.4225
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11800000000000002, 'auc': 0.515816, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0121, std=0.0605
[DEBUG][MIA] Test Set Loss:   mean=1.6402, std=3.1295
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.28627450980392155, 'auc': 0.717742919921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4676, std=3.0741
[DEBUG][MIA] Test Set Loss:   mean=2.3139, std=3.8717
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.10200000000000001, 'auc': 0.58196, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0041, std=0.0222
[DEBUG][MIA] Test Set Loss:   mean=1.3482, std=2.9278
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.22745098039215686, 'auc': 0.684478759765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1247, std=2.7507
[DEBUG][MIA] Test Set Loss:   mean=1.3808, std=2.8271
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10600000000000001, 'auc': 0.5124799999999999, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0012, std=0.0031
[DEBUG][MIA] Test Set Loss:   mean=2.1202, std=3.9294
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.28627450980392155, 'auc': 0.78851318359375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.3605, std=2.7813
[DEBUG][MIA] Test Set Loss:   mean=1.6878, std=3.1968
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.12600000000000003, 'auc': 0.55444, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0265, std=0.1647
[DEBUG][MIA] Test Set Loss:   mean=2.0722, std=3.1733
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.30196078431372547, 'auc': 0.774078369140625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1395, std=2.2650
[DEBUG][MIA] Test Set Loss:   mean=1.7514, std=3.0596
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.12200000000000003, 'auc': 0.56024, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0150, std=0.0580
[DEBUG][MIA] Test Set Loss:   mean=2.4477, std=3.9561
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7333333333333334, 'auc': 0.814300537109375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9715, std=2.3066
[DEBUG][MIA] Test Set Loss:   mean=2.1621, std=3.5466
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.20400000000000001, 'auc': 0.6231919999999999, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0010
[DEBUG][MIA] Test Set Loss:   mean=1.8135, std=3.2728
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.2431372549019608, 'auc': 0.8017578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4317, std=1.3167
[DEBUG][MIA] Test Set Loss:   mean=1.4867, std=3.1500
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.142, 'auc': 0.606416, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0365, std=0.2232
[DEBUG][MIA] Test Set Loss:   mean=0.8377, std=2.0583
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.2235294117647059, 'auc': 0.663543701171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4143, std=1.3221
[DEBUG][MIA] Test Set Loss:   mean=0.8652, std=2.3842
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.15799999999999997, 'auc': 0.5696479999999999, 'task': 8}
Total correct retain:  1789  Total retain:  2500
Total correct forget:  22934  Total forget:  47500
Total correct test:  345  Total test:  500
Total correct forget test:  4113  Total test forget:  9500
After learning task 10
Task accuracies: [0.69, 0.636, 0.666, 0.732, 0.686, 0.652, 0.592, 0.738, 0.78, 0.772, 0.172, 0.198, 0.18, 0.21, 0.292, 0.22, 0.158, 0.21, 0.184, 0.148]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0198, std=0.0984
[DEBUG][MIA] Test Set Loss:   mean=1.7694, std=3.6610
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.26666666666666666, 'auc': 0.71270751953125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6463, std=3.4742
[DEBUG][MIA] Test Set Loss:   mean=2.1343, std=3.7877
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.094, 'auc': 0.45083999999999996, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0526, std=0.2364
[DEBUG][MIA] Test Set Loss:   mean=2.4467, std=4.0393
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.24313725490196075, 'auc': 0.734954833984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7132, std=3.2415
[DEBUG][MIA] Test Set Loss:   mean=2.1971, std=3.6170
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10600000000000001, 'auc': 0.537592, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0088
[DEBUG][MIA] Test Set Loss:   mean=1.3782, std=3.0041
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.22745098039215686, 'auc': 0.757965087890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9544, std=2.2918
[DEBUG][MIA] Test Set Loss:   mean=1.2238, std=2.7102
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.094, 'auc': 0.511136, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=1.5141, std=2.7945
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.30196078431372547, 'auc': 0.800018310546875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0399, std=2.4895
[DEBUG][MIA] Test Set Loss:   mean=1.4869, std=2.8812
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10800000000000001, 'auc': 0.552272, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0055, std=0.0299
[DEBUG][MIA] Test Set Loss:   mean=1.6260, std=2.9223
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7137254901960784, 'auc': 0.772552490234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8336, std=2.0085
[DEBUG][MIA] Test Set Loss:   mean=1.3116, std=2.6330
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.174, 'auc': 0.5875520000000001, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0460, std=0.2394
[DEBUG][MIA] Test Set Loss:   mean=2.5340, std=4.0091
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7098039215686274, 'auc': 0.804290771484375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2264, std=2.8314
[DEBUG][MIA] Test Set Loss:   mean=2.2819, std=3.4760
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.2, 'auc': 0.620584, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.3554, std=2.7533
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.27450980392156865, 'auc': 0.755096435546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4397, std=1.5789
[DEBUG][MIA] Test Set Loss:   mean=1.2404, std=2.7011
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.148, 'auc': 0.5943360000000001, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0253, std=0.1335
[DEBUG][MIA] Test Set Loss:   mean=1.1752, std=2.9176
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2588235294117647, 'auc': 0.75543212890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4756, std=1.3976
[DEBUG][MIA] Test Set Loss:   mean=1.4172, std=3.1271
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.12, 'auc': 0.609304, 'task': 8}
Total correct retain:  1775  Total retain:  2500
Total correct forget:  24280  Total forget:  47500
Total correct test:  345  Total test:  500
Total correct forget test:  4314  Total test forget:  9500
After learning task 11
Task accuracies: [0.69, 0.662, 0.656, 0.752, 0.68, 0.652, 0.55, 0.748, 0.75, 0.718, 0.804, 0.154, 0.114, 0.194, 0.274, 0.242, 0.188, 0.188, 0.154, 0.148]
Unlearning task: 11
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.4301, std=4.3413
[DEBUG][MIA] Test Set Loss:   mean=4.1803, std=4.7011
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.51953125, 'cv_acc': 0.11764705882352941, 'auc': 0.54229736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3858, std=5.1638
[DEBUG][MIA] Test Set Loss:   mean=4.9985, std=5.5347
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.1, 'auc': 0.46780800000000006, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=6.8433, std=7.7565
[DEBUG][MIA] Test Set Loss:   mean=9.4450, std=8.2408
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.11764705882352941, 'auc': 0.599029541015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.9406, std=8.4911
[DEBUG][MIA] Test Set Loss:   mean=8.1960, std=8.1771
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.086, 'auc': 0.48786399999999996, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.2599, std=6.0953
[DEBUG][MIA] Test Set Loss:   mean=5.3135, std=6.8426
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.08235294117647059, 'auc': 0.5152587890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=5.7536, std=6.6540
[DEBUG][MIA] Test Set Loss:   mean=5.9974, std=6.5369
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.10800000000000001, 'auc': 0.48364000000000007, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.1016, std=7.3509
[DEBUG][MIA] Test Set Loss:   mean=4.4502, std=6.7111
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10196078431372549, 'auc': 0.47491455078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.2454, std=7.6872
[DEBUG][MIA] Test Set Loss:   mean=4.9179, std=7.3243
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.098, 'auc': 0.50576, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.0549, std=6.0656
[DEBUG][MIA] Test Set Loss:   mean=4.9533, std=7.3372
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.49609375, 'cv_acc': 0.09019607843137255, 'auc': 0.451934814453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.1470, std=7.2356
[DEBUG][MIA] Test Set Loss:   mean=5.7735, std=8.3901
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.10200000000000001, 'auc': 0.560224, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.8149, std=7.4945
[DEBUG][MIA] Test Set Loss:   mean=6.1854, std=8.7516
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.54296875, 'cv_acc': 0.10588235294117647, 'auc': 0.55169677734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.6724, std=8.5221
[DEBUG][MIA] Test Set Loss:   mean=5.9139, std=8.7624
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.12200000000000003, 'auc': 0.516888, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.4625, std=4.1270
[DEBUG][MIA] Test Set Loss:   mean=3.1151, std=4.7447
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.13725490196078433, 'auc': 0.54156494140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.2736, std=3.6018
[DEBUG][MIA] Test Set Loss:   mean=2.8543, std=4.6523
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10600000000000001, 'auc': 0.519184, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.4663, std=8.3636
[DEBUG][MIA] Test Set Loss:   mean=5.9614, std=10.0028
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.09019607843137255, 'auc': 0.47607421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=4.7577, std=8.1060
[DEBUG][MIA] Test Set Loss:   mean=5.8315, std=9.3435
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.464, 'cv_acc': 0.086, 'auc': 0.476192, 'task': 8}
Total correct retain:  1289  Total retain:  2500
Total correct forget:  15062  Total forget:  47500
Total correct test:  259  Total test:  500
Total correct forget test:  2945  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.518, 0.384, 0.334, 0.388, 0.436, 0.486, 0.362, 0.482, 0.456, 0.412, 0.296, 0.226, 0.192, 0.214, 0.234, 0.278, 0.172, 0.192, 0.194, 0.152]
Unlearning task: 10
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5225, std=2.2109
[DEBUG][MIA] Test Set Loss:   mean=2.5870, std=3.4155
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.16862745098039214, 'auc': 0.58416748046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0353, std=2.9772
[DEBUG][MIA] Test Set Loss:   mean=2.4812, std=3.2407
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.094, 'auc': 0.450448, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7043, std=3.2461
[DEBUG][MIA] Test Set Loss:   mean=2.9306, std=4.3281
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.10196078431372549, 'auc': 0.613128662109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.0149, std=5.5990
[DEBUG][MIA] Test Set Loss:   mean=2.8803, std=4.4404
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.5014080000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9047, std=1.9663
[DEBUG][MIA] Test Set Loss:   mean=2.2760, std=3.4455
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.09803921568627451, 'auc': 0.61431884765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.9926, std=3.5223
[DEBUG][MIA] Test Set Loss:   mean=2.6739, std=4.1555
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.456, 'cv_acc': 0.1, 'auc': 0.45964799999999995, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.0434, std=3.2834
[DEBUG][MIA] Test Set Loss:   mean=2.9950, std=3.8928
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.13333333333333333, 'auc': 0.56353759765625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.8388, std=4.0345
[DEBUG][MIA] Test Set Loss:   mean=3.4257, std=4.5113
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.126, 'auc': 0.47943199999999997, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.2464, std=3.3007
[DEBUG][MIA] Test Set Loss:   mean=3.6320, std=4.2213
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.07450980392156863, 'auc': 0.6070556640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.7874, std=4.1729
[DEBUG][MIA] Test Set Loss:   mean=3.0803, std=3.9629
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.466, 'cv_acc': 0.10400000000000001, 'auc': 0.46923200000000004, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.6440, std=2.4494
[DEBUG][MIA] Test Set Loss:   mean=3.7332, std=5.3708
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.12549019607843137, 'auc': 0.6248779296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.6850, std=3.6679
[DEBUG][MIA] Test Set Loss:   mean=3.2943, std=4.6434
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.126, 'auc': 0.50576, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.5480, std=4.4454
[DEBUG][MIA] Test Set Loss:   mean=3.3440, std=4.5820
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.21960784313725493, 'auc': 0.57275390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.1340, std=4.3914
[DEBUG][MIA] Test Set Loss:   mean=3.4357, std=4.6691
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.10400000000000001, 'auc': 0.5091840000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.7520, std=4.9811
[DEBUG][MIA] Test Set Loss:   mean=4.1632, std=5.5267
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5625, 'cv_acc': 0.11372549019607843, 'auc': 0.59521484375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.5586, std=5.0469
[DEBUG][MIA] Test Set Loss:   mean=3.5316, std=5.1645
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.49968, 'task': 8}
Total correct retain:  1077  Total retain:  2500
Total correct forget:  16017  Total forget:  47500
Total correct test:  222  Total test:  500
Total correct forget test:  3109  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.444, 0.544, 0.534, 0.578, 0.472, 0.458, 0.432, 0.458, 0.512, 0.242, 0.128, 0.212, 0.198, 0.226, 0.202, 0.198, 0.228, 0.188, 0.202, 0.206]
Unlearning task: 9
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.9651, std=2.9100
[DEBUG][MIA] Test Set Loss:   mean=1.9039, std=2.9113
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.15686274509803919, 'auc': 0.614166259765625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8382, std=3.5574
[DEBUG][MIA] Test Set Loss:   mean=1.9150, std=3.0899
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.118, 'auc': 0.5146, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.3358, std=3.7222
[DEBUG][MIA] Test Set Loss:   mean=3.5295, std=4.5911
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.57421875, 'cv_acc': 0.10588235294117647, 'auc': 0.561920166015625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5900, std=4.7770
[DEBUG][MIA] Test Set Loss:   mean=3.7695, std=5.4065
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.49464, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.4673, std=3.0117
[DEBUG][MIA] Test Set Loss:   mean=2.1533, std=3.4730
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.10588235294117647, 'auc': 0.5806884765625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.7065, std=4.7428
[DEBUG][MIA] Test Set Loss:   mean=2.3756, std=4.0857
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.094, 'auc': 0.4929680000000001, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.5350, std=2.5932
[DEBUG][MIA] Test Set Loss:   mean=2.8834, std=4.1637
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.10196078431372549, 'auc': 0.58465576171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.6110, std=3.6020
[DEBUG][MIA] Test Set Loss:   mean=2.3866, std=3.5339
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.12000000000000002, 'auc': 0.47531999999999996, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.1951, std=2.8844
[DEBUG][MIA] Test Set Loss:   mean=2.3795, std=4.3021
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5546875, 'cv_acc': 0.1411764705882353, 'auc': 0.58465576171875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.3149, std=3.7106
[DEBUG][MIA] Test Set Loss:   mean=2.2602, std=3.0667
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11200000000000002, 'auc': 0.521528, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.8668, std=1.7141
[DEBUG][MIA] Test Set Loss:   mean=2.1915, std=4.4385
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.19215686274509805, 'auc': 0.66156005859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.8572, std=3.0057
[DEBUG][MIA] Test Set Loss:   mean=2.3094, std=3.7858
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.088, 'auc': 0.540528, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3903, std=2.6722
[DEBUG][MIA] Test Set Loss:   mean=1.7701, std=3.2928
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.19215686274509805, 'auc': 0.52850341796875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.8512, std=3.1198
[DEBUG][MIA] Test Set Loss:   mean=2.4908, std=3.7794
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.132, 'auc': 0.5394559999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.9797, std=20.2683
[DEBUG][MIA] Test Set Loss:   mean=14.7675, std=29.4585
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.50390625, 'cv_acc': 0.10196078431372549, 'auc': 0.49371337890625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=12.8318, std=21.2961
[DEBUG][MIA] Test Set Loss:   mean=14.0169, std=24.3548
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.11000000000000001, 'auc': 0.49712, 'task': 8}
Total correct retain:  1451  Total retain:  2500
Total correct forget:  16439  Total forget:  47500
Total correct test:  275  Total test:  500
Total correct forget test:  3186  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.55, 0.538, 0.484, 0.586, 0.53, 0.56, 0.492, 0.544, 0.274, 0.272, 0.252, 0.144, 0.196, 0.228, 0.246, 0.206, 0.23, 0.212, 0.158, 0.22]
Unlearning task: 8
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5896, std=2.7909
[DEBUG][MIA] Test Set Loss:   mean=2.9010, std=4.2655
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59765625, 'cv_acc': 0.16470588235294117, 'auc': 0.57623291015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5041, std=4.3260
[DEBUG][MIA] Test Set Loss:   mean=2.7538, std=4.1848
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.11400000000000002, 'auc': 0.5340560000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5100, std=4.2456
[DEBUG][MIA] Test Set Loss:   mean=3.6630, std=5.0729
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.13333333333333333, 'auc': 0.581024169921875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.5266, std=5.1073
[DEBUG][MIA] Test Set Loss:   mean=3.5663, std=6.1678
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10800000000000001, 'auc': 0.46106400000000003, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5430, std=3.3084
[DEBUG][MIA] Test Set Loss:   mean=2.8083, std=4.0872
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.11764705882352941, 'auc': 0.62176513671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1769, std=3.6569
[DEBUG][MIA] Test Set Loss:   mean=2.5413, std=4.2011
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.495032, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2899, std=3.8302
[DEBUG][MIA] Test Set Loss:   mean=1.6549, std=2.6702
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.2235294117647059, 'auc': 0.59521484375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.6866, std=2.7182
[DEBUG][MIA] Test Set Loss:   mean=1.7807, std=2.6437
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.502864, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2172, std=2.9773
[DEBUG][MIA] Test Set Loss:   mean=3.0018, std=4.3671
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.12549019607843137, 'auc': 0.640594482421875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.9040, std=3.9745
[DEBUG][MIA] Test Set Loss:   mean=2.1346, std=4.0822
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10400000000000001, 'auc': 0.5407279999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.1363, std=1.6886
[DEBUG][MIA] Test Set Loss:   mean=3.0917, std=4.2599
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.21960784313725493, 'auc': 0.62420654296875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.9664, std=2.8265
[DEBUG][MIA] Test Set Loss:   mean=2.8678, std=3.9014
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.11600000000000002, 'auc': 0.573152, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=9.3132, std=13.5796
[DEBUG][MIA] Test Set Loss:   mean=8.9098, std=11.2291
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.16470588235294117, 'auc': 0.504180908203125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.8580, std=12.0732
[DEBUG][MIA] Test Set Loss:   mean=9.3547, std=12.2545
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.10200000000000001, 'auc': 0.5194, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=10.7560, std=20.0576
[DEBUG][MIA] Test Set Loss:   mean=11.6837, std=21.7181
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46484375, 'cv_acc': 0.10980392156862744, 'auc': 0.504730224609375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.7315, std=17.9359
[DEBUG][MIA] Test Set Loss:   mean=13.1012, std=21.9491
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11399999999999999, 'auc': 0.485696, 'task': 8}
Total correct retain:  1534  Total retain:  2500
Total correct forget:  16255  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  3110  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.588, 0.518, 0.468, 0.594, 0.59, 0.54, 0.45, 0.252, 0.318, 0.272, 0.266, 0.164, 0.19, 0.242, 0.278, 0.262, 0.234, 0.222, 0.13, 0.23]
Unlearning task: 7
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.5887, std=1.4512
[DEBUG][MIA] Test Set Loss:   mean=1.8490, std=3.1370
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.20784313725490194, 'auc': 0.63958740234375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.9441, std=3.0724
[DEBUG][MIA] Test Set Loss:   mean=2.3947, std=4.2822
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09, 'auc': 0.497296, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.4155, std=3.1620
[DEBUG][MIA] Test Set Loss:   mean=2.2555, std=3.8035
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.17254901960784313, 'auc': 0.6043701171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5446, std=4.5639
[DEBUG][MIA] Test Set Loss:   mean=2.4826, std=4.5548
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.096, 'auc': 0.505112, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.9846, std=2.2665
[DEBUG][MIA] Test Set Loss:   mean=1.5560, std=2.8783
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.16078431372549018, 'auc': 0.539093017578125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0787, std=3.5383
[DEBUG][MIA] Test Set Loss:   mean=1.6081, std=2.9651
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.478, 'cv_acc': 0.094, 'auc': 0.460232, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9981, std=2.4761
[DEBUG][MIA] Test Set Loss:   mean=1.5534, std=2.5323
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.18823529411764706, 'auc': 0.57989501953125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.7420, std=2.8083
[DEBUG][MIA] Test Set Loss:   mean=1.6036, std=2.6248
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.12000000000000002, 'auc': 0.49748800000000004, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.8239, std=2.4252
[DEBUG][MIA] Test Set Loss:   mean=1.9425, std=3.8277
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.19215686274509805, 'auc': 0.60498046875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6654, std=2.8503
[DEBUG][MIA] Test Set Loss:   mean=1.8263, std=3.6414
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.11000000000000001, 'auc': 0.489576, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=11.4921, std=15.2367
[DEBUG][MIA] Test Set Loss:   mean=12.2004, std=15.5538
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.13333333333333336, 'auc': 0.5225830078125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=12.7602, std=16.1768
[DEBUG][MIA] Test Set Loss:   mean=13.7822, std=18.6859
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.096, 'auc': 0.513256, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.3591, std=9.0822
[DEBUG][MIA] Test Set Loss:   mean=7.4376, std=6.8873
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.12941176470588237, 'auc': 0.483856201171875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=8.3294, std=9.6514
[DEBUG][MIA] Test Set Loss:   mean=8.9120, std=12.0562
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.472, 'cv_acc': 0.098, 'auc': 0.477328, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.8521, std=19.6859
[DEBUG][MIA] Test Set Loss:   mean=10.1017, std=14.1727
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.10588235294117647, 'auc': 0.4752197265625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=11.9772, std=15.1272
[DEBUG][MIA] Test Set Loss:   mean=12.1995, std=18.5604
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.10800000000000001, 'auc': 0.5205040000000001, 'task': 8}
Total correct retain:  1535  Total retain:  2500
Total correct forget:  16105  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  3122  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.594, 0.582, 0.568, 0.626, 0.6, 0.606, 0.282, 0.284, 0.306, 0.286, 0.268, 0.154, 0.224, 0.238, 0.276, 0.174, 0.218, 0.206, 0.124, 0.222]
Unlearning task: 6
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3059, std=4.4935
[DEBUG][MIA] Test Set Loss:   mean=2.9378, std=4.7223
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.45703125, 'cv_acc': 0.08235294117647059, 'auc': 0.4229736328125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.7108, std=5.6186
[DEBUG][MIA] Test Set Loss:   mean=3.0452, std=4.2284
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.49, 'cv_acc': 0.10400000000000001, 'auc': 0.49582399999999993, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=8.5895, std=10.1778
[DEBUG][MIA] Test Set Loss:   mean=9.2038, std=9.5473
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10196078431372549, 'auc': 0.454437255859375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.9063, std=10.9252
[DEBUG][MIA] Test Set Loss:   mean=8.7781, std=9.5279
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.08399999999999999, 'auc': 0.47956, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.0705, std=9.8136
[DEBUG][MIA] Test Set Loss:   mean=6.9317, std=9.5897
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10196078431372549, 'auc': 0.49139404296875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.2895, std=8.2555
[DEBUG][MIA] Test Set Loss:   mean=5.9086, std=7.7683
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.486, 'cv_acc': 0.124, 'auc': 0.492416, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.3880, std=7.4653
[DEBUG][MIA] Test Set Loss:   mean=6.4372, std=6.9207
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.47607421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=6.6396, std=7.3864
[DEBUG][MIA] Test Set Loss:   mean=6.3149, std=7.1013
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.494, 'cv_acc': 0.098, 'auc': 0.48961599999999994, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=136.7075, std=170.9298
[DEBUG][MIA] Test Set Loss:   mean=143.7859, std=184.3118
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10588235294117647, 'auc': 0.50128173828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=166.7288, std=211.6243
[DEBUG][MIA] Test Set Loss:   mean=151.1508, std=196.5180
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.1, 'auc': 0.49172799999999994, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=30.1126, std=29.9304
[DEBUG][MIA] Test Set Loss:   mean=32.5010, std=35.8140
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10196078431372549, 'auc': 0.506805419921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=34.3616, std=41.9054
[DEBUG][MIA] Test Set Loss:   mean=32.4756, std=34.2438
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.12000000000000002, 'auc': 0.518256, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=23.9992, std=21.5930
[DEBUG][MIA] Test Set Loss:   mean=26.0960, std=25.7943
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.10980392156862746, 'auc': 0.500640869140625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=26.4467, std=24.2035
[DEBUG][MIA] Test Set Loss:   mean=25.0258, std=22.6483
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.094, 'auc': 0.510384, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=57.6202, std=58.3796
[DEBUG][MIA] Test Set Loss:   mean=55.9835, std=51.8175
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09019607843137255, 'auc': 0.49932861328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=56.9926, std=56.0187
[DEBUG][MIA] Test Set Loss:   mean=59.7909, std=57.5185
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.078, 'auc': 0.486768, 'task': 8}
Total correct retain:  825  Total retain:  2500
Total correct forget:  11555  Total forget:  47500
Total correct test:  158  Total test:  500
Total correct forget test:  2311  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.316, 0.456, 0.294, 0.374, 0.328, 0.256, 0.188, 0.21, 0.192, 0.25, 0.236, 0.24, 0.19, 0.218, 0.208, 0.204, 0.14, 0.224, 0.194, 0.22]
Unlearning task: 5
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5491, std=2.8746
[DEBUG][MIA] Test Set Loss:   mean=1.9168, std=2.8126
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.16862745098039217, 'auc': 0.549163818359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3211, std=3.4555
[DEBUG][MIA] Test Set Loss:   mean=2.2227, std=2.9344
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.1, 'auc': 0.504144, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.5643, std=4.0979
[DEBUG][MIA] Test Set Loss:   mean=3.0880, std=4.7122
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.1764705882352941, 'auc': 0.54901123046875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.9490, std=4.1648
[DEBUG][MIA] Test Set Loss:   mean=2.9540, std=4.1618
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.10400000000000001, 'auc': 0.507824, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.8414, std=4.4716
[DEBUG][MIA] Test Set Loss:   mean=2.7087, std=4.1266
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.11372549019607843, 'auc': 0.513946533203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.9095, std=4.1186
[DEBUG][MIA] Test Set Loss:   mean=3.6144, std=5.0282
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.11000000000000001, 'auc': 0.47508, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=16.4823, std=20.3799
[DEBUG][MIA] Test Set Loss:   mean=16.1507, std=18.4212
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4609375, 'cv_acc': 0.08235294117647059, 'auc': 0.483001708984375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=19.8145, std=21.8911
[DEBUG][MIA] Test Set Loss:   mean=16.7139, std=20.9960
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.474, 'cv_acc': 0.118, 'auc': 0.45384, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=59.5424, std=54.1684
[DEBUG][MIA] Test Set Loss:   mean=80.4839, std=118.4785
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.1215686274509804, 'auc': 0.48956298828125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=62.5267, std=67.1232
[DEBUG][MIA] Test Set Loss:   mean=67.9123, std=96.4079
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.1, 'auc': 0.506216, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=19.2662, std=24.4527
[DEBUG][MIA] Test Set Loss:   mean=14.4726, std=19.7562
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.10588235294117647, 'auc': 0.45330810546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.6930, std=25.8030
[DEBUG][MIA] Test Set Loss:   mean=16.8774, std=20.8928
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.1, 'auc': 0.507672, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=10.5582, std=13.3956
[DEBUG][MIA] Test Set Loss:   mean=11.8635, std=14.0951
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.1215686274509804, 'auc': 0.46173095703125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=13.1847, std=16.2079
[DEBUG][MIA] Test Set Loss:   mean=11.1816, std=13.7469
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.514448, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=22.2815, std=21.0282
[DEBUG][MIA] Test Set Loss:   mean=20.5469, std=23.1939
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.13725490196078433, 'auc': 0.546112060546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=23.7118, std=24.6588
[DEBUG][MIA] Test Set Loss:   mean=23.8201, std=26.7249
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.5197280000000001, 'task': 8}
Total correct retain:  1160  Total retain:  2500
Total correct forget:  11957  Total forget:  47500
Total correct test:  234  Total test:  500
Total correct forget test:  2390  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.468, 0.474, 0.418, 0.51, 0.228, 0.242, 0.232, 0.26, 0.244, 0.232, 0.246, 0.286, 0.212, 0.144, 0.206, 0.172, 0.124, 0.22, 0.16, 0.17]
Unlearning task: 4
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.3513, std=7.5660
[DEBUG][MIA] Test Set Loss:   mean=4.9356, std=7.7755
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.546875, 'cv_acc': 0.1607843137254902, 'auc': 0.55224609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=4.0020, std=7.0641
[DEBUG][MIA] Test Set Loss:   mean=4.1559, std=7.2426
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.10800000000000001, 'auc': 0.504784, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.1956, std=6.4095
[DEBUG][MIA] Test Set Loss:   mean=5.0531, std=6.1726
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.43359375, 'cv_acc': 0.11372549019607844, 'auc': 0.4290771484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.0884, std=5.7171
[DEBUG][MIA] Test Set Loss:   mean=4.5404, std=6.2584
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.51, 'cv_acc': 0.126, 'auc': 0.51616, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=21.6552, std=29.3677
[DEBUG][MIA] Test Set Loss:   mean=21.3649, std=27.1560
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.11372549019607843, 'auc': 0.498626708984375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=22.3932, std=30.1831
[DEBUG][MIA] Test Set Loss:   mean=20.4219, std=27.0446
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.10600000000000001, 'auc': 0.490464, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=42.4933, std=50.0418
[DEBUG][MIA] Test Set Loss:   mean=40.6047, std=48.1770
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.09803921568627451, 'auc': 0.49700927734375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=42.5387, std=50.8892
[DEBUG][MIA] Test Set Loss:   mean=45.6096, std=52.1032
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.094, 'auc': 0.5129520000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=144.3918, std=180.7094
[DEBUG][MIA] Test Set Loss:   mean=167.1505, std=219.3960
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5390625, 'cv_acc': 0.11372549019607843, 'auc': 0.5211181640625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=142.5148, std=178.6185
[DEBUG][MIA] Test Set Loss:   mean=189.1256, std=255.4120
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.47, 'cv_acc': 0.11399999999999999, 'auc': 0.46286399999999994, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=42.5597, std=50.5881
[DEBUG][MIA] Test Set Loss:   mean=34.2172, std=47.4326
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.53515625, 'cv_acc': 0.09019607843137255, 'auc': 0.543701171875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=45.8565, std=54.4005
[DEBUG][MIA] Test Set Loss:   mean=39.5353, std=48.2523
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.470464, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=32.5302, std=34.9835
[DEBUG][MIA] Test Set Loss:   mean=30.4795, std=32.2879
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.0823529411764706, 'auc': 0.49322509765625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=32.7788, std=32.9372
[DEBUG][MIA] Test Set Loss:   mean=31.6582, std=33.4022
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.076, 'auc': 0.5204880000000001, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=54.5978, std=50.9714
[DEBUG][MIA] Test Set Loss:   mean=45.9768, std=44.0843
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.1411764705882353, 'auc': 0.458221435546875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=44.0876, std=48.2957
[DEBUG][MIA] Test Set Loss:   mean=51.2613, std=48.7614
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.10600000000000001, 'auc': 0.54712, 'task': 8}
Total correct retain:  1055  Total retain:  2500
Total correct forget:  11268  Total forget:  47500
Total correct test:  208  Total test:  500
Total correct forget test:  2252  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.416, 0.458, 0.43, 0.26, 0.198, 0.25, 0.18, 0.226, 0.194, 0.236, 0.252, 0.262, 0.196, 0.172, 0.204, 0.184, 0.156, 0.254, 0.186, 0.206]
Unlearning task: 3
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.4153, std=3.3744
[DEBUG][MIA] Test Set Loss:   mean=2.4352, std=2.9108
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5078125, 'cv_acc': 0.10196078431372549, 'auc': 0.52740478515625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.3279, std=2.6288
[DEBUG][MIA] Test Set Loss:   mean=2.3105, std=3.0634
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.094, 'auc': 0.5236959999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=14.7737, std=23.2230
[DEBUG][MIA] Test Set Loss:   mean=19.1845, std=26.0019
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.07058823529411765, 'auc': 0.5909423828125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=13.7817, std=19.2618
[DEBUG][MIA] Test Set Loss:   mean=15.4514, std=21.9761
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.10800000000000001, 'auc': 0.5138240000000001, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.7013, std=16.9685
[DEBUG][MIA] Test Set Loss:   mean=13.0423, std=15.6876
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.09411764705882353, 'auc': 0.503082275390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=12.5737, std=15.3451
[DEBUG][MIA] Test Set Loss:   mean=13.3886, std=16.2042
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.10800000000000001, 'auc': 0.500016, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.5979, std=31.4537
[DEBUG][MIA] Test Set Loss:   mean=16.6296, std=21.3842
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.1803921568627451, 'auc': 0.484893798828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.8419, std=26.3111
[DEBUG][MIA] Test Set Loss:   mean=19.8074, std=25.8328
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.504, 'cv_acc': 0.098, 'auc': 0.48256, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=65.5055, std=74.6262
[DEBUG][MIA] Test Set Loss:   mean=64.3551, std=71.6852
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5234375, 'cv_acc': 0.1215686274509804, 'auc': 0.518646240234375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=70.5015, std=74.4099
[DEBUG][MIA] Test Set Loss:   mean=72.8383, std=104.5224
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.11200000000000002, 'auc': 0.48247999999999996, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=18.7470, std=24.2134
[DEBUG][MIA] Test Set Loss:   mean=18.7372, std=24.5099
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10980392156862744, 'auc': 0.4937744140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.6778, std=27.4285
[DEBUG][MIA] Test Set Loss:   mean=18.0495, std=23.9477
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.094, 'auc': 0.528976, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=16.4842, std=24.8798
[DEBUG][MIA] Test Set Loss:   mean=9.5927, std=14.8498
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.44140625, 'cv_acc': 0.12549019607843137, 'auc': 0.45794677734375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.6394, std=23.0897
[DEBUG][MIA] Test Set Loss:   mean=13.2654, std=20.4030
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.118, 'auc': 0.556432, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=21.3730, std=24.0031
[DEBUG][MIA] Test Set Loss:   mean=23.1024, std=25.3489
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5, 'cv_acc': 0.09803921568627451, 'auc': 0.475341796875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=20.5964, std=24.2083
[DEBUG][MIA] Test Set Loss:   mean=24.2004, std=25.8907
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.1, 'auc': 0.459848, 'task': 8}
Total correct retain:  970  Total retain:  2500
Total correct forget:  10649  Total forget:  47500
Total correct test:  180  Total test:  500
Total correct forget test:  2145  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.36, 0.426, 0.202, 0.25, 0.2, 0.256, 0.196, 0.262, 0.24, 0.246, 0.244, 0.268, 0.178, 0.18, 0.196, 0.206, 0.126, 0.218, 0.17, 0.226]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([8, 6, 9, 7, 5, 6, 9, 6, 8, 6], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=13.0147, std=16.3721
[DEBUG][MIA] Test Set Loss:   mean=15.2758, std=22.5644
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.12941176470588237, 'auc': 0.50213623046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 7 6 9 7 6 5 8 6 5]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [7 7 6 8 7 6 7 9 9 5]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=12.9727, std=18.8733
[DEBUG][MIA] Test Set Loss:   mean=12.5080, std=17.0861
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.48649600000000004, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([11, 12, 10, 11, 13, 14, 12, 10, 14, 11], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=18.2039, std=22.4319
[DEBUG][MIA] Test Set Loss:   mean=18.8760, std=27.5753
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.09803921568627451, 'auc': 0.47772216796875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [13 14 13 12 10 11 12 14 14 11]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [14 10 10 10 13 11 10 13 14 13]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=16.9380, std=22.6528
[DEBUG][MIA] Test Set Loss:   mean=20.0736, std=30.4749
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.502, 'cv_acc': 0.10800000000000001, 'auc': 0.509024, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([18, 19, 15, 17, 15, 16, 18, 16, 16, 18], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=13.4103, std=16.7758
[DEBUG][MIA] Test Set Loss:   mean=14.8163, std=15.5389
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4765625, 'cv_acc': 0.16862745098039214, 'auc': 0.4447021484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [17 19 15 19 16 17 16 18 19 19]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [17 17 17 18 19 19 18 15 16 15]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=14.9705, std=16.8278
[DEBUG][MIA] Test Set Loss:   mean=12.4182, std=14.2405
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.462, 'cv_acc': 0.13000000000000003, 'auc': 0.465704, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([24, 20, 20, 23, 20, 24, 22, 20, 22, 23], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=20.7461, std=27.5907
[DEBUG][MIA] Test Set Loss:   mean=19.9315, std=25.1880
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48828125, 'cv_acc': 0.09019607843137255, 'auc': 0.49725341796875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [24 22 21 22 24 23 24 23 24 21]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 21 20 20 21 22 23 22 20 22]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=22.2235, std=28.0085
[DEBUG][MIA] Test Set Loss:   mean=21.4541, std=28.7724
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.098, 'auc': 0.517832, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([29, 27, 27, 27, 28, 26, 25, 26, 25, 29], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=64.1263, std=63.6116
[DEBUG][MIA] Test Set Loss:   mean=79.8785, std=130.9968
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.4921875, 'cv_acc': 0.10588235294117647, 'auc': 0.4759521484375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 28 28 29 26 25 28 26 29 28]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [25 25 29 29 25 26 25 28 26 26]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=80.8815, std=122.1780
[DEBUG][MIA] Test Set Loss:   mean=74.9185, std=103.6228
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.11000000000000001, 'auc': 0.5047200000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 33, 32, 31, 34, 31, 30, 33, 33, 30], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=20.7776, std=26.4006
[DEBUG][MIA] Test Set Loss:   mean=20.2434, std=23.2018
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.48046875, 'cv_acc': 0.10588235294117647, 'auc': 0.493499755859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [30 30 33 33 32 31 34 30 30 33]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [32 34 33 30 34 34 34 30 30 31]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=23.9114, std=35.1357
[DEBUG][MIA] Test Set Loss:   mean=20.3615, std=30.7555
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.482, 'cv_acc': 0.092, 'auc': 0.46771199999999996, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 37, 36, 35, 36, 39, 37, 36, 36, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.3250, std=23.9580
[DEBUG][MIA] Test Set Loss:   mean=15.3281, std=20.1057
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.484375, 'cv_acc': 0.11372549019607843, 'auc': 0.48077392578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [39 36 35 39 35 37 38 37 39 39]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [35 35 38 35 37 37 36 37 39 37]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=17.5355, std=22.2831
[DEBUG][MIA] Test Set Loss:   mean=17.7247, std=22.4121
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.496, 'cv_acc': 0.10400000000000001, 'auc': 0.506024, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([42, 44, 40, 44, 41, 44, 43, 44, 43, 42], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=24.4359, std=31.2070
[DEBUG][MIA] Test Set Loss:   mean=26.1528, std=31.0887
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.46875, 'cv_acc': 0.09803921568627451, 'auc': 0.484344482421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [41 41 41 40 42 40 40 42 40 43]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [41 41 41 41 41 43 40 43 42 41]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=24.4200, std=31.0096
[DEBUG][MIA] Test Set Loss:   mean=23.6386, std=29.9941
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.492, 'cv_acc': 0.11200000000000002, 'auc': 0.47849600000000003, 'task': 8}
Total correct retain:  1034  Total retain:  2500
Total correct forget:  10194  Total forget:  47500
Total correct test:  180  Total test:  500
Total correct forget test:  2047  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.36, 0.232, 0.18, 0.234, 0.206, 0.236, 0.186, 0.252, 0.234, 0.238, 0.232, 0.266, 0.172, 0.176, 0.21, 0.242, 0.132, 0.21, 0.244, 0.212]
Number of constraint violations:  0
Command line arguments:
task_sequence: MIA
number_of_gpus: 1
algorithm: neggrad
alpha: 0.95
learn_mem_strength: 0.5
learn_batch_size: 10
unlearn_mem_strength: 0.5
unlearn_batch_size: 4
average_over_n_runs: 1
salun: 1
salun_strength: 0.05
Python 3.12.8
./cifar-100-python/train
./cifar-100-python/test
Number of GPUs visible:  1
Available GPUs:  1
Sun Apr 27 04:21:11 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     Off |   00000000:01:00.0 Off |                  N/A |
| 40%   69C    P0             N/A /  250W |       1MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Running on device:  NVIDIA GeForce RTX 2080 Ti
Unlearn Batch Size:  4
Unlearn MEM Strength:  0.5
cifar-100-python/train
cifar-100-python/test
new ordering of classes:  ['wardrobe', 'bowls', 'cups', 'streetcar', 'raccoon', 'dolphin', 'shrew', 'telephone', 'tractor', 'bed', 'crab', 'sweet peppers', 'turtle', 'oak', 'crocodile', 'pears', 'lawn-mower', 'bridge', 'lobster', 'hamster', 'pine', 'bottles', 'chair', 'rocket', 'shark', 'whale', 'seal', 'wolf', 'fox', 'tiger', 'clock', 'table', 'orchids', 'road', 'snail', 'kangaroo', 'mountain', 'spider', 'cockroach', 'porcupine', 'bicycle', 'tulips', 'plain', 'boy', 'flatfish', 'couch', 'sea', 'oranges', 'dinosaur', 'poppies', 'beaver', 'girl', 'beetle', 'trout', 'mouse', 'train', 'roses', 'bear', 'man', 'possum', 'castle', 'house', 'chimpanzee', 'willow', 'sunflowers', 'motorcycle', 'lizard', 'cloud', 'bee', 'worm', 'forest', 'lamp', 'computer keyboard', 'palm', 'baby', 'lion', 'caterpillar', 'ray', 'pickup truck', 'woman', 'aquarium fish', 'cattle', 'skyscraper', 'squirrel', 'apples', 'rabbit', 'snake', 'television', 'otter', 'cans', 'elephant', 'bus', 'camel', 'tank', 'skunk', 'butterfly', 'leopard', 'mushrooms', 'plates', 'maple']
Training task:  1
[Learn Buffer] Updating memory for task 1 using least memorization.
[Memory Update] Task 0, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 1 using most memorization.
[Memory Update] Task 0, Buffer: unlearn, Type: most, Split: 0.99
1 0
Total correct retain:  2245  Total retain:  2500
Total correct forget:  9110  Total forget:  47500
Total correct test:  361  Total test:  500
Total correct forget test:  1818  Total test forget:  9500
After learning task 1
Task accuracies: [0.722, 0.148, 0.222, 0.242, 0.238, 0.166, 0.23, 0.232, 0.162, 0.198, 0.174, 0.174, 0.144, 0.242, 0.216, 0.216, 0.138, 0.22, 0.154, 0.12]
Training task:  2
[Learn Buffer] Updating memory for task 2 using least memorization.
[Memory Update] Task 1, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 2 using most memorization.
[Memory Update] Task 1, Buffer: unlearn, Type: most, Split: 0.99
1 1
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0278, std=0.1075
[DEBUG][MIA] Test Set Loss:   mean=1.0978, std=2.4619
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62109375, 'cv_acc': 0.22745098039215686, 'auc': 0.680938720703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0343, std=0.2048
[DEBUG][MIA] Test Set Loss:   mean=1.1886, std=2.6710
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.236, 'auc': 0.716104, 'task': 1}
2 1
Total correct retain:  1976  Total retain:  2500
Total correct forget:  11423  Total forget:  47500
Total correct test:  357  Total test:  500
Total correct forget test:  2171  Total test forget:  9500
After learning task 2
Task accuracies: [0.714, 0.746, 0.264, 0.174, 0.25, 0.148, 0.24, 0.24, 0.162, 0.29, 0.168, 0.144, 0.206, 0.204, 0.226, 0.218, 0.138, 0.216, 0.14, 0.168]
Training task:  3
[Learn Buffer] Updating memory for task 3 using least memorization.
[Memory Update] Task 2, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 3 using most memorization.
[Memory Update] Task 2, Buffer: unlearn, Type: most, Split: 0.99
1 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0083
[DEBUG][MIA] Test Set Loss:   mean=1.2462, std=2.2209
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.403921568627451, 'auc': 0.773773193359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.4318, std=1.2745
[DEBUG][MIA] Test Set Loss:   mean=1.5541, std=2.9302
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.20600000000000002, 'auc': 0.626224, 'task': 1}
2 2
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0330, std=0.2094
[DEBUG][MIA] Test Set Loss:   mean=0.8887, std=2.0560
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.18823529411764706, 'auc': 0.699859619140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0260, std=0.1661
[DEBUG][MIA] Test Set Loss:   mean=1.0456, std=2.7055
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.62, 'cv_acc': 0.172, 'auc': 0.6692800000000001, 'task': 2}
3 2
Total correct retain:  1914  Total retain:  2500
Total correct forget:  13101  Total forget:  47500
Total correct test:  334  Total test:  500
Total correct forget test:  2438  Total test forget:  9500
After learning task 3
Task accuracies: [0.668, 0.678, 0.83, 0.186, 0.234, 0.208, 0.284, 0.192, 0.172, 0.308, 0.178, 0.128, 0.21, 0.174, 0.248, 0.222, 0.176, 0.2, 0.18, 0.068]
Training task:  4
[Learn Buffer] Updating memory for task 4 using least memorization.
[Memory Update] Task 3, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 4 using most memorization.
[Memory Update] Task 3, Buffer: unlearn, Type: most, Split: 0.99
1 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0056
[DEBUG][MIA] Test Set Loss:   mean=1.5856, std=2.6565
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.29411764705882354, 'auc': 0.834197998046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.0982, std=2.1661
[DEBUG][MIA] Test Set Loss:   mean=1.6567, std=3.0290
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.12000000000000002, 'auc': 0.541928, 'task': 1}
2 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=0.6922, std=1.8714
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.27450980392156865, 'auc': 0.69708251953125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.2766, std=0.7928
[DEBUG][MIA] Test Set Loss:   mean=0.9083, std=2.2459
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.15, 'auc': 0.570224, 'task': 2}
3 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0091, std=0.0570
[DEBUG][MIA] Test Set Loss:   mean=1.1492, std=2.7317
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.25098039215686274, 'auc': 0.743316650390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0261, std=0.1797
[DEBUG][MIA] Test Set Loss:   mean=1.0710, std=2.4182
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.652, 'cv_acc': 0.23200000000000004, 'auc': 0.715488, 'task': 3}
4 3
Total correct retain:  1807  Total retain:  2500
Total correct forget:  14551  Total forget:  47500
Total correct test:  324  Total test:  500
Total correct forget test:  2689  Total test forget:  9500
After learning task 4
Task accuracies: [0.648, 0.62, 0.77, 0.758, 0.186, 0.202, 0.282, 0.226, 0.164, 0.252, 0.19, 0.132, 0.18, 0.192, 0.23, 0.24, 0.186, 0.242, 0.222, 0.104]
Training task:  5
[Learn Buffer] Updating memory for task 5 using least memorization.
[Memory Update] Task 4, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 5 using most memorization.
[Memory Update] Task 4, Buffer: unlearn, Type: most, Split: 0.99
1 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0021, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=1.4765, std=2.5045
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.6862745098039216, 'auc': 0.825164794921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1300, std=2.3365
[DEBUG][MIA] Test Set Loss:   mean=1.5985, std=2.6977
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.142, 'auc': 0.5707760000000001, 'task': 1}
2 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0070
[DEBUG][MIA] Test Set Loss:   mean=1.6182, std=2.9994
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.24705882352941178, 'auc': 0.780487060546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6520, std=1.7185
[DEBUG][MIA] Test Set Loss:   mean=1.2536, std=2.5732
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.12799999999999997, 'auc': 0.549376, 'task': 2}
3 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0059
[DEBUG][MIA] Test Set Loss:   mean=1.2531, std=2.6050
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2784313725490196, 'auc': 0.723388671875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.4596, std=1.3931
[DEBUG][MIA] Test Set Loss:   mean=1.5381, std=3.1249
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.172, 'auc': 0.602416, 'task': 3}
4 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0245, std=0.1628
[DEBUG][MIA] Test Set Loss:   mean=0.6888, std=1.8671
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.19607843137254904, 'auc': 0.663970947265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0684, std=0.5305
[DEBUG][MIA] Test Set Loss:   mean=0.6215, std=1.7991
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.16999999999999998, 'auc': 0.628128, 'task': 4}
5 4
Total correct retain:  1753  Total retain:  2500
Total correct forget:  15406  Total forget:  47500
Total correct test:  314  Total test:  500
Total correct forget test:  2863  Total test forget:  9500
After learning task 5
Task accuracies: [0.628, 0.648, 0.764, 0.708, 0.872, 0.198, 0.272, 0.182, 0.134, 0.162, 0.142, 0.132, 0.202, 0.202, 0.226, 0.22, 0.148, 0.24, 0.162, 0.112]
Training task:  6
[Learn Buffer] Updating memory for task 6 using least memorization.
[Memory Update] Task 5, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 6 using most memorization.
[Memory Update] Task 5, Buffer: unlearn, Type: most, Split: 0.99
1 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0004
[DEBUG][MIA] Test Set Loss:   mean=2.0872, std=3.4890
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2823529411764706, 'auc': 0.879638671875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.1667, std=2.4309
[DEBUG][MIA] Test Set Loss:   mean=1.8487, std=3.0605
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.148, 'auc': 0.580792, 'task': 1}
2 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0017, std=0.0051
[DEBUG][MIA] Test Set Loss:   mean=1.2070, std=2.6160
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.2784313725490196, 'auc': 0.67498779296875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7572, std=2.2177
[DEBUG][MIA] Test Set Loss:   mean=1.4991, std=2.8992
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.15399999999999997, 'auc': 0.5709520000000001, 'task': 2}
3 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.3907, std=3.9668
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.2627450980392157, 'auc': 0.831024169921875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8448, std=1.9537
[DEBUG][MIA] Test Set Loss:   mean=1.6114, std=3.1403
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.176, 'auc': 0.5842160000000001, 'task': 3}
4 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0128, std=0.0757
[DEBUG][MIA] Test Set Loss:   mean=1.2547, std=2.9604
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.21568627450980396, 'auc': 0.654144287109375, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3638, std=1.1666
[DEBUG][MIA] Test Set Loss:   mean=0.8200, std=2.2121
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.15, 'auc': 0.54648, 'task': 4}
5 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0595, std=0.3018
[DEBUG][MIA] Test Set Loss:   mean=1.1140, std=2.0905
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.2549019607843137, 'auc': 0.7752685546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0175, std=0.0984
[DEBUG][MIA] Test Set Loss:   mean=1.2782, std=2.5392
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.668, 'cv_acc': 0.24800000000000005, 'auc': 0.7646799999999999, 'task': 5}
6 5
Total correct retain:  1719  Total retain:  2500
Total correct forget:  16725  Total forget:  47500
Total correct test:  308  Total test:  500
Total correct forget test:  3039  Total test forget:  9500
After learning task 6
Task accuracies: [0.616, 0.606, 0.706, 0.676, 0.776, 0.706, 0.312, 0.208, 0.18, 0.17, 0.168, 0.132, 0.196, 0.18, 0.236, 0.2, 0.116, 0.254, 0.16, 0.096]
Training task:  7
[Learn Buffer] Updating memory for task 7 using least memorization.
[Memory Update] Task 6, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 7 using most memorization.
[Memory Update] Task 6, Buffer: unlearn, Type: most, Split: 0.99
1 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.5797, std=2.8203
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.7176470588235293, 'auc': 0.84686279296875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.4587, std=3.0419
[DEBUG][MIA] Test Set Loss:   mean=1.8471, std=3.2452
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.1, 'auc': 0.54504, 'task': 1}
2 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0119
[DEBUG][MIA] Test Set Loss:   mean=1.4504, std=3.1359
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.23529411764705882, 'auc': 0.718353271484375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.7032, std=1.8699
[DEBUG][MIA] Test Set Loss:   mean=1.3479, std=3.0057
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.14, 'auc': 0.558896, 'task': 2}
3 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0005
[DEBUG][MIA] Test Set Loss:   mean=1.8241, std=3.2426
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.7333333333333333, 'auc': 0.825408935546875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.8084, std=1.9904
[DEBUG][MIA] Test Set Loss:   mean=1.7918, std=2.9217
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.594, 'cv_acc': 0.17600000000000002, 'auc': 0.601232, 'task': 3}
4 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0115
[DEBUG][MIA] Test Set Loss:   mean=0.9502, std=2.3373
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.23529411764705882, 'auc': 0.673248291015625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.5604, std=1.5376
[DEBUG][MIA] Test Set Loss:   mean=0.9893, std=2.5379
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.164, 'auc': 0.586808, 'task': 4}
5 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0035, std=0.0090
[DEBUG][MIA] Test Set Loss:   mean=1.7658, std=2.9143
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7098039215686275, 'auc': 0.838226318359375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4095, std=1.2477
[DEBUG][MIA] Test Set Loss:   mean=1.7797, std=2.8536
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.636, 'cv_acc': 0.25, 'auc': 0.71628, 'task': 5}
6 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0128, std=0.0878
[DEBUG][MIA] Test Set Loss:   mean=1.4710, std=2.8248
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.21960784313725493, 'auc': 0.71624755859375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0058, std=0.0297
[DEBUG][MIA] Test Set Loss:   mean=1.3567, std=2.6881
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.648, 'cv_acc': 0.242, 'auc': 0.719408, 'task': 6}
7 6
Total correct retain:  1670  Total retain:  2500
Total correct forget:  18436  Total forget:  47500
Total correct test:  315  Total test:  500
Total correct forget test:  3313  Total test forget:  9500
After learning task 7
Task accuracies: [0.63, 0.656, 0.744, 0.626, 0.79, 0.644, 0.762, 0.21, 0.136, 0.194, 0.182, 0.122, 0.228, 0.19, 0.222, 0.222, 0.132, 0.258, 0.188, 0.12]
Training task:  8
[Learn Buffer] Updating memory for task 8 using least memorization.
[Memory Update] Task 7, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 8 using most memorization.
[Memory Update] Task 7, Buffer: unlearn, Type: most, Split: 0.99
1 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.6376, std=3.0641
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.7215686274509805, 'auc': 0.89227294921875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.3945, std=2.8908
[DEBUG][MIA] Test Set Loss:   mean=1.5869, std=2.9459
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.152, 'auc': 0.548184, 'task': 1}
2 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0023, std=0.0130
[DEBUG][MIA] Test Set Loss:   mean=1.4916, std=2.6259
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.2588235294117647, 'auc': 0.77587890625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0088, std=2.1243
[DEBUG][MIA] Test Set Loss:   mean=1.2808, std=2.3963
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.13400000000000004, 'auc': 0.538888, 'task': 2}
3 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0097
[DEBUG][MIA] Test Set Loss:   mean=2.4380, std=3.6853
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7058823529411764, 'auc': 0.804779052734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.0500, std=2.2398
[DEBUG][MIA] Test Set Loss:   mean=1.9516, std=3.4556
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.188, 'auc': 0.5898319999999999, 'task': 3}
4 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0014, std=0.0057
[DEBUG][MIA] Test Set Loss:   mean=0.8129, std=1.7816
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.23137254901960783, 'auc': 0.717803955078125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.4303, std=1.6339
[DEBUG][MIA] Test Set Loss:   mean=1.0133, std=2.2318
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.118, 'auc': 0.581272, 'task': 4}
5 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0013, std=0.0029
[DEBUG][MIA] Test Set Loss:   mean=2.0429, std=3.2060
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7734375, 'cv_acc': 0.6941176470588235, 'auc': 0.8731689453125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.4222, std=1.0717
[DEBUG][MIA] Test Set Loss:   mean=1.8898, std=2.9285
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.638, 'cv_acc': 0.21200000000000002, 'auc': 0.690744, 'task': 5}
6 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.6449, std=2.9954
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2627450980392157, 'auc': 0.760955810546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2872, std=1.0071
[DEBUG][MIA] Test Set Loss:   mean=1.5802, std=2.9738
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.616, 'cv_acc': 0.21800000000000003, 'auc': 0.635992, 'task': 6}
7 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0036, std=0.0128
[DEBUG][MIA] Test Set Loss:   mean=0.9211, std=2.1474
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.16862745098039217, 'auc': 0.68988037109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0585, std=0.4387
[DEBUG][MIA] Test Set Loss:   mean=0.6906, std=1.8576
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.18, 'auc': 0.668936, 'task': 7}
8 7
Total correct retain:  1657  Total retain:  2500
Total correct forget:  19584  Total forget:  47500
Total correct test:  297  Total test:  500
Total correct forget test:  3442  Total test forget:  9500
After learning task 8
Task accuracies: [0.594, 0.66, 0.7, 0.618, 0.774, 0.604, 0.71, 0.838, 0.132, 0.178, 0.166, 0.122, 0.172, 0.188, 0.232, 0.218, 0.126, 0.16, 0.174, 0.112]
Training task:  9
[Learn Buffer] Updating memory for task 9 using least memorization.
[Memory Update] Task 8, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 9 using most memorization.
[Memory Update] Task 8, Buffer: unlearn, Type: most, Split: 0.99
1 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0016
[DEBUG][MIA] Test Set Loss:   mean=1.6390, std=2.9879
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.3058823529411765, 'auc': 0.820465087890625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6059, std=2.8940
[DEBUG][MIA] Test Set Loss:   mean=2.0925, std=3.5953
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.094, 'auc': 0.541096, 'task': 1}
2 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0005, std=0.0030
[DEBUG][MIA] Test Set Loss:   mean=1.3482, std=2.8618
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2705882352941177, 'auc': 0.792236328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.6574, std=1.8038
[DEBUG][MIA] Test Set Loss:   mean=1.6109, std=3.1884
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.10400000000000001, 'auc': 0.612824, 'task': 2}
3 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=1.5043, std=2.7967
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.7215686274509804, 'auc': 0.835113525390625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.2884, std=2.4220
[DEBUG][MIA] Test Set Loss:   mean=2.1862, std=3.5715
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.17200000000000001, 'auc': 0.5535359999999999, 'task': 3}
4 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0037, std=0.0127
[DEBUG][MIA] Test Set Loss:   mean=1.0900, std=2.7032
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.21176470588235294, 'auc': 0.709625244140625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.3733, std=1.2805
[DEBUG][MIA] Test Set Loss:   mean=0.8070, std=2.0982
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.16, 'auc': 0.563168, 'task': 4}
5 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0028, std=0.0081
[DEBUG][MIA] Test Set Loss:   mean=1.6952, std=2.8005
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7490196078431373, 'auc': 0.861083984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.6322, std=1.5125
[DEBUG][MIA] Test Set Loss:   mean=1.6224, std=2.6679
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.598, 'cv_acc': 0.2, 'auc': 0.6367120000000001, 'task': 5}
6 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0003
[DEBUG][MIA] Test Set Loss:   mean=1.3492, std=2.7908
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.24705882352941178, 'auc': 0.77508544921875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.2840, std=1.0348
[DEBUG][MIA] Test Set Loss:   mean=1.2586, std=2.4589
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.21200000000000002, 'auc': 0.6273759999999999, 'task': 6}
7 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0011, std=0.0040
[DEBUG][MIA] Test Set Loss:   mean=0.5456, std=1.3924
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2901960784313725, 'auc': 0.6964111328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2301, std=0.8613
[DEBUG][MIA] Test Set Loss:   mean=0.7854, std=1.8357
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.582, 'cv_acc': 0.172, 'auc': 0.6672720000000001, 'task': 7}
8 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0105, std=0.0850
[DEBUG][MIA] Test Set Loss:   mean=0.6305, std=1.9613
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.609375, 'cv_acc': 0.15294117647058825, 'auc': 0.585418701171875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0482, std=0.3175
[DEBUG][MIA] Test Set Loss:   mean=0.6864, std=2.0435
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.184, 'auc': 0.6306639999999999, 'task': 8}
Total correct retain:  1661  Total retain:  2500
Total correct forget:  21700  Total forget:  47500
Total correct test:  306  Total test:  500
Total correct forget test:  3882  Total test forget:  9500
After learning task 9
Task accuracies: [0.612, 0.656, 0.718, 0.634, 0.786, 0.616, 0.716, 0.788, 0.862, 0.218, 0.174, 0.12, 0.18, 0.188, 0.238, 0.22, 0.108, 0.186, 0.232, 0.124]
Training task:  10
[Learn Buffer] Updating memory for task 10 using least memorization.
[Memory Update] Task 9, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 10 using most memorization.
[Memory Update] Task 9, Buffer: unlearn, Type: most, Split: 0.99
1 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0038, std=0.0270
[DEBUG][MIA] Test Set Loss:   mean=1.7465, std=3.0726
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75, 'cv_acc': 0.7215686274509804, 'auc': 0.835357666015625, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.6312, std=3.2050
[DEBUG][MIA] Test Set Loss:   mean=1.8836, std=3.3854
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.098, 'auc': 0.535616, 'task': 1}
2 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0020, std=0.0092
[DEBUG][MIA] Test Set Loss:   mean=1.1864, std=2.4134
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6875, 'cv_acc': 0.2901960784313725, 'auc': 0.721435546875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1002, std=2.2841
[DEBUG][MIA] Test Set Loss:   mean=1.2723, std=2.4483
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.118, 'auc': 0.535072, 'task': 2}
3 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0003, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=2.3174, std=3.8298
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.7098039215686274, 'auc': 0.8555908203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1348, std=2.5360
[DEBUG][MIA] Test Set Loss:   mean=2.4182, std=3.9576
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.576, 'cv_acc': 0.16999999999999998, 'auc': 0.602776, 'task': 3}
4 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0551
[DEBUG][MIA] Test Set Loss:   mean=0.7097, std=1.9650
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.24705882352941178, 'auc': 0.646759033203125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.6179, std=1.6613
[DEBUG][MIA] Test Set Loss:   mean=1.0852, std=2.5553
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.146, 'auc': 0.529864, 'task': 4}
5 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0530, std=0.2102
[DEBUG][MIA] Test Set Loss:   mean=2.9077, std=4.4353
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.7137254901960784, 'auc': 0.795745849609375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2271, std=2.7655
[DEBUG][MIA] Test Set Loss:   mean=2.4863, std=4.0468
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.59, 'cv_acc': 0.17400000000000002, 'auc': 0.596832, 'task': 5}
6 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0014
[DEBUG][MIA] Test Set Loss:   mean=1.4591, std=3.2877
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.25490196078431376, 'auc': 0.786773681640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.4811, std=1.5638
[DEBUG][MIA] Test Set Loss:   mean=1.5808, std=3.1623
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.584, 'cv_acc': 0.182, 'auc': 0.620152, 'task': 6}
7 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0042, std=0.0192
[DEBUG][MIA] Test Set Loss:   mean=1.2228, std=2.4601
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.2588235294117647, 'auc': 0.753448486328125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4721, std=1.5064
[DEBUG][MIA] Test Set Loss:   mean=1.1105, std=2.3551
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.578, 'cv_acc': 0.17800000000000002, 'auc': 0.611016, 'task': 7}
8 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0008, std=0.0023
[DEBUG][MIA] Test Set Loss:   mean=0.8332, std=2.1550
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.19607843137254902, 'auc': 0.69146728515625, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0795, std=0.3467
[DEBUG][MIA] Test Set Loss:   mean=1.0898, std=2.6891
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.608, 'cv_acc': 0.17, 'auc': 0.615016, 'task': 8}
Total correct retain:  1670  Total retain:  2500
Total correct forget:  23053  Total forget:  47500
Total correct test:  300  Total test:  500
Total correct forget test:  4108  Total test forget:  9500
After learning task 10
Task accuracies: [0.6, 0.652, 0.714, 0.62, 0.77, 0.542, 0.718, 0.738, 0.818, 0.866, 0.17, 0.124, 0.19, 0.186, 0.228, 0.244, 0.126, 0.226, 0.16, 0.124]
Training task:  11
[Learn Buffer] Updating memory for task 11 using least memorization.
[Memory Update] Task 10, Buffer: learn, Type: least, Split: 0.2
[Unlearn Buffer] Updating memory for task 11 using most memorization.
[Memory Update] Task 10, Buffer: unlearn, Type: most, Split: 0.99
1 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0002, std=0.0006
[DEBUG][MIA] Test Set Loss:   mean=1.7521, std=3.3487
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.2901960784313726, 'auc': 0.804656982421875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7307, std=3.3218
[DEBUG][MIA] Test Set Loss:   mean=2.0472, std=3.6696
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.10400000000000001, 'auc': 0.546096, 'task': 1}
2 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0026
[DEBUG][MIA] Test Set Loss:   mean=1.6259, std=3.0704
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.2784313725490196, 'auc': 0.758636474609375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2735, std=2.9160
[DEBUG][MIA] Test Set Loss:   mean=1.2979, std=2.5470
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.15, 'auc': 0.558864, 'task': 2}
3 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0009
[DEBUG][MIA] Test Set Loss:   mean=3.0139, std=4.8403
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.75390625, 'cv_acc': 0.2901960784313726, 'auc': 0.843994140625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.3192, std=2.8253
[DEBUG][MIA] Test Set Loss:   mean=2.2098, std=4.0813
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.156, 'auc': 0.5626720000000001, 'task': 3}
4 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0044, std=0.0270
[DEBUG][MIA] Test Set Loss:   mean=1.1217, std=2.4342
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.67578125, 'cv_acc': 0.21960784313725487, 'auc': 0.676483154296875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8340, std=2.4045
[DEBUG][MIA] Test Set Loss:   mean=0.9207, std=2.2299
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.518, 'cv_acc': 0.152, 'auc': 0.520248, 'task': 4}
5 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0031, std=0.0122
[DEBUG][MIA] Test Set Loss:   mean=1.4891, std=2.7319
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.7450980392156863, 'auc': 0.868408203125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0887, std=2.2049
[DEBUG][MIA] Test Set Loss:   mean=1.6684, std=2.7850
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.18, 'auc': 0.611048, 'task': 5}
6 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0008
[DEBUG][MIA] Test Set Loss:   mean=1.2780, std=2.3547
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69140625, 'cv_acc': 0.2823529411764706, 'auc': 0.7979736328125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.7379, std=1.5728
[DEBUG][MIA] Test Set Loss:   mean=1.6132, std=2.8564
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.184, 'auc': 0.575752, 'task': 6}
7 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0009, std=0.0042
[DEBUG][MIA] Test Set Loss:   mean=1.0283, std=1.9759
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2901960784313726, 'auc': 0.769775390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.4992, std=1.4442
[DEBUG][MIA] Test Set Loss:   mean=1.3302, std=2.4209
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.11400000000000002, 'auc': 0.6302479999999999, 'task': 7}
8 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0082
[DEBUG][MIA] Test Set Loss:   mean=1.3204, std=2.6928
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.23529411764705882, 'auc': 0.7325439453125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.4229, std=1.3603
[DEBUG][MIA] Test Set Loss:   mean=1.0338, std=2.2335
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.186, 'auc': 0.584648, 'task': 8}
Total correct retain:  1693  Total retain:  2500
Total correct forget:  24376  Total forget:  47500
Total correct test:  304  Total test:  500
Total correct forget test:  4309  Total test forget:  9500
After learning task 11
Task accuracies: [0.608, 0.626, 0.71, 0.624, 0.772, 0.6, 0.676, 0.706, 0.756, 0.8, 0.732, 0.126, 0.188, 0.194, 0.22, 0.238, 0.142, 0.232, 0.168, 0.108]
Unlearning task: 11
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0006, std=0.0024
[DEBUG][MIA] Test Set Loss:   mean=2.0771, std=3.3639
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73828125, 'cv_acc': 0.7019607843137255, 'auc': 0.857635498046875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5042, std=2.8540
[DEBUG][MIA] Test Set Loss:   mean=2.3950, std=4.1594
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.096, 'auc': 0.567056, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0026, std=0.0233
[DEBUG][MIA] Test Set Loss:   mean=1.7142, std=3.0923
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.26274509803921575, 'auc': 0.759307861328125, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.0089, std=2.4686
[DEBUG][MIA] Test Set Loss:   mean=1.6553, std=3.0216
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12200000000000003, 'auc': 0.58136, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0018, std=0.0131
[DEBUG][MIA] Test Set Loss:   mean=1.9810, std=3.6797
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.6941176470588235, 'auc': 0.711181640625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.1510, std=2.7766
[DEBUG][MIA] Test Set Loss:   mean=2.1550, std=3.9855
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.144, 'auc': 0.604272, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0338, std=0.2172
[DEBUG][MIA] Test Set Loss:   mean=1.5483, std=3.2049
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.63671875, 'cv_acc': 0.19607843137254902, 'auc': 0.6571044921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.8777, std=2.4713
[DEBUG][MIA] Test Set Loss:   mean=1.0240, std=2.4767
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.12000000000000002, 'auc': 0.510416, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0078, std=0.0488
[DEBUG][MIA] Test Set Loss:   mean=2.0076, std=3.1876
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7098039215686275, 'auc': 0.882049560546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.2228, std=2.5608
[DEBUG][MIA] Test Set Loss:   mean=2.2069, std=3.4334
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.574, 'cv_acc': 0.10400000000000001, 'auc': 0.613472, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0024, std=0.0197
[DEBUG][MIA] Test Set Loss:   mean=1.5410, std=2.7323
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.6941176470588235, 'auc': 0.77008056640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.6834, std=1.7263
[DEBUG][MIA] Test Set Loss:   mean=1.8619, std=3.2453
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.586, 'cv_acc': 0.18000000000000002, 'auc': 0.624352, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0015, std=0.0041
[DEBUG][MIA] Test Set Loss:   mean=1.3963, std=2.4989
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.30196078431372547, 'auc': 0.7548828125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.9337, std=2.3194
[DEBUG][MIA] Test Set Loss:   mean=1.2290, std=2.3786
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.166, 'auc': 0.602784, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0100
[DEBUG][MIA] Test Set Loss:   mean=1.0425, std=2.0990
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.23921568627450984, 'auc': 0.64892578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.5110, std=1.4626
[DEBUG][MIA] Test Set Loss:   mean=1.4254, std=3.1529
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.562, 'cv_acc': 0.11600000000000002, 'auc': 0.5667840000000001, 'task': 8}
Total correct retain:  1648  Total retain:  2500
Total correct forget:  24181  Total forget:  47500
Total correct test:  294  Total test:  500
Total correct forget test:  4254  Total test forget:  9500
After unlearning task 11
Task accuracies: [0.588, 0.596, 0.698, 0.618, 0.776, 0.586, 0.662, 0.69, 0.752, 0.766, 0.728, 0.13, 0.186, 0.202, 0.23, 0.23, 0.14, 0.22, 0.17, 0.128]
Unlearning task: 10
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0134, std=0.0668
[DEBUG][MIA] Test Set Loss:   mean=2.3862, std=4.6046
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.7098039215686274, 'auc': 0.7449951171875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7664, std=3.2264
[DEBUG][MIA] Test Set Loss:   mean=2.3483, std=4.0980
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.52, 'cv_acc': 0.10200000000000001, 'auc': 0.533432, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0060, std=0.0393
[DEBUG][MIA] Test Set Loss:   mean=1.8909, std=4.2532
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.2784313725490196, 'auc': 0.7593994140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1785, std=2.6929
[DEBUG][MIA] Test Set Loss:   mean=1.8159, std=3.6904
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11800000000000002, 'auc': 0.5776479999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0347, std=0.2795
[DEBUG][MIA] Test Set Loss:   mean=3.0490, std=5.2143
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6745098039215687, 'auc': 0.797149658203125, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.0178, std=3.8410
[DEBUG][MIA] Test Set Loss:   mean=2.4756, std=4.4943
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10400000000000001, 'auc': 0.523776, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0733, std=0.4054
[DEBUG][MIA] Test Set Loss:   mean=1.6473, std=3.2533
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2235294117647059, 'auc': 0.6571044921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0613, std=2.5704
[DEBUG][MIA] Test Set Loss:   mean=1.6632, std=3.4707
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.10600000000000001, 'auc': 0.5228400000000001, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1729, std=0.7406
[DEBUG][MIA] Test Set Loss:   mean=3.0708, std=4.0309
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6745098039215687, 'auc': 0.820159912109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4770, std=2.7984
[DEBUG][MIA] Test Set Loss:   mean=2.6532, std=3.9069
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.12400000000000003, 'auc': 0.607696, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0135, std=0.0576
[DEBUG][MIA] Test Set Loss:   mean=1.7592, std=3.0547
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7109375, 'cv_acc': 0.6705882352941177, 'auc': 0.763427734375, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.3346, std=2.5014
[DEBUG][MIA] Test Set Loss:   mean=1.7600, std=2.8899
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.18, 'auc': 0.5604480000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0284, std=0.1247
[DEBUG][MIA] Test Set Loss:   mean=0.9979, std=2.1144
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.6588235294117647, 'auc': 0.71258544921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.8233, std=1.9569
[DEBUG][MIA] Test Set Loss:   mean=1.5098, std=2.8613
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.554, 'cv_acc': 0.15, 'auc': 0.619184, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0223
[DEBUG][MIA] Test Set Loss:   mean=0.9656, std=2.3921
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.2627450980392157, 'auc': 0.6632080078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7061, std=1.6875
[DEBUG][MIA] Test Set Loss:   mean=1.4126, std=2.9632
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.13399999999999998, 'auc': 0.557424, 'task': 8}
Total correct retain:  1676  Total retain:  2500
Total correct forget:  23181  Total forget:  47500
Total correct test:  303  Total test:  500
Total correct forget test:  4080  Total test forget:  9500
After unlearning task 10
Task accuracies: [0.606, 0.596, 0.686, 0.592, 0.736, 0.516, 0.624, 0.686, 0.742, 0.596, 0.7, 0.116, 0.19, 0.188, 0.228, 0.232, 0.164, 0.254, 0.18, 0.134]
Unlearning task: 9
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0004, std=0.0012
[DEBUG][MIA] Test Set Loss:   mean=2.3906, std=4.2932
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.3137254901960784, 'auc': 0.843475341796875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.7468, std=3.4142
[DEBUG][MIA] Test Set Loss:   mean=2.4608, std=4.3429
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11400000000000002, 'auc': 0.5454239999999999, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0034, std=0.0201
[DEBUG][MIA] Test Set Loss:   mean=1.5009, std=3.1149
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.27450980392156865, 'auc': 0.708160400390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.1771, std=3.0051
[DEBUG][MIA] Test Set Loss:   mean=1.7414, std=3.6497
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.534, 'cv_acc': 0.11000000000000001, 'auc': 0.5601039999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0054, std=0.0438
[DEBUG][MIA] Test Set Loss:   mean=2.3933, std=4.9649
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.7058823529411764, 'auc': 0.775482177734375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1343, std=3.9704
[DEBUG][MIA] Test Set Loss:   mean=2.5969, std=4.7038
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.11599999999999999, 'auc': 0.557208, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0925, std=0.6682
[DEBUG][MIA] Test Set Loss:   mean=1.9367, std=3.3247
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66796875, 'cv_acc': 0.21176470588235294, 'auc': 0.750732421875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.2434, std=3.0213
[DEBUG][MIA] Test Set Loss:   mean=1.6527, std=3.2625
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.132, 'auc': 0.535408, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0421, std=0.1746
[DEBUG][MIA] Test Set Loss:   mean=2.1938, std=3.7194
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7421875, 'cv_acc': 0.7294117647058824, 'auc': 0.8388671875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.4969, std=3.1233
[DEBUG][MIA] Test Set Loss:   mean=2.2602, std=3.5793
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.12200000000000003, 'auc': 0.590032, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0058
[DEBUG][MIA] Test Set Loss:   mean=1.8228, std=2.9911
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.74609375, 'cv_acc': 0.30980392156862746, 'auc': 0.82208251953125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9269, std=2.0959
[DEBUG][MIA] Test Set Loss:   mean=2.3708, std=3.7461
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.596, 'cv_acc': 0.16599999999999998, 'auc': 0.6128560000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0327, std=0.2266
[DEBUG][MIA] Test Set Loss:   mean=1.8201, std=3.2918
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.72265625, 'cv_acc': 0.27450980392156865, 'auc': 0.80889892578125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.0253, std=2.5003
[DEBUG][MIA] Test Set Loss:   mean=1.3839, std=2.8879
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.172, 'auc': 0.57104, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1260, std=0.5078
[DEBUG][MIA] Test Set Loss:   mean=1.3437, std=2.7950
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.23137254901960785, 'auc': 0.671905517578125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.7350, std=1.9520
[DEBUG][MIA] Test Set Loss:   mean=1.7711, std=3.2849
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.558, 'cv_acc': 0.12200000000000003, 'auc': 0.5809599999999999, 'task': 8}
Total correct retain:  1619  Total retain:  2500
Total correct forget:  23257  Total forget:  47500
Total correct test:  293  Total test:  500
Total correct forget test:  4119  Total test forget:  9500
After unlearning task 9
Task accuracies: [0.586, 0.626, 0.716, 0.628, 0.734, 0.568, 0.63, 0.688, 0.706, 0.576, 0.69, 0.116, 0.202, 0.196, 0.226, 0.254, 0.144, 0.24, 0.186, 0.112]
Unlearning task: 8
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0094, std=0.0347
[DEBUG][MIA] Test Set Loss:   mean=3.3189, std=5.4810
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6980392156862745, 'auc': 0.77423095703125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.5202, std=3.0930
[DEBUG][MIA] Test Set Loss:   mean=2.4225, std=4.4667
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11600000000000002, 'auc': 0.543688, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0056, std=0.0378
[DEBUG][MIA] Test Set Loss:   mean=1.9690, std=3.7589
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.27450980392156865, 'auc': 0.7138671875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.3120, std=3.3082
[DEBUG][MIA] Test Set Loss:   mean=1.9708, std=3.7191
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.548, 'cv_acc': 0.10200000000000001, 'auc': 0.557304, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0238, std=0.1351
[DEBUG][MIA] Test Set Loss:   mean=2.1477, std=3.4349
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.2901960784313725, 'auc': 0.802337646484375, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.5355, std=3.3973
[DEBUG][MIA] Test Set Loss:   mean=2.5147, std=4.2436
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.10200000000000001, 'auc': 0.6002959999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0300
[DEBUG][MIA] Test Set Loss:   mean=1.4026, std=2.9032
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.2352941176470588, 'auc': 0.71514892578125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.0930, std=2.7543
[DEBUG][MIA] Test Set Loss:   mean=1.3634, std=2.8264
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.122, 'auc': 0.53888, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0246, std=0.1958
[DEBUG][MIA] Test Set Loss:   mean=2.2865, std=3.6404
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7578125, 'cv_acc': 0.7294117647058824, 'auc': 0.863128662109375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.0902, std=2.4186
[DEBUG][MIA] Test Set Loss:   mean=2.1025, std=3.5317
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.566, 'cv_acc': 0.13, 'auc': 0.623072, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.0273, std=0.1275
[DEBUG][MIA] Test Set Loss:   mean=1.6058, std=3.1832
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.29411764705882354, 'auc': 0.75018310546875, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9504, std=2.2978
[DEBUG][MIA] Test Set Loss:   mean=1.9763, std=3.5126
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.568, 'cv_acc': 0.184, 'auc': 0.591592, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.0479, std=0.3179
[DEBUG][MIA] Test Set Loss:   mean=2.1311, std=3.7178
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6953125, 'cv_acc': 0.28627450980392155, 'auc': 0.749176025390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.2780, std=2.7684
[DEBUG][MIA] Test Set Loss:   mean=2.1957, std=3.7520
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.11600000000000002, 'auc': 0.602928, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.1182, std=0.4325
[DEBUG][MIA] Test Set Loss:   mean=1.4736, std=3.3515
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6015625, 'cv_acc': 0.24705882352941178, 'auc': 0.673095703125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.9114, std=2.5308
[DEBUG][MIA] Test Set Loss:   mean=1.5651, std=3.1921
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.546, 'cv_acc': 0.178, 'auc': 0.55804, 'task': 8}
Total correct retain:  1608  Total retain:  2500
Total correct forget:  23027  Total forget:  47500
Total correct test:  293  Total test:  500
Total correct forget test:  4078  Total test forget:  9500
After unlearning task 8
Task accuracies: [0.586, 0.608, 0.696, 0.62, 0.734, 0.566, 0.646, 0.638, 0.69, 0.552, 0.696, 0.126, 0.19, 0.198, 0.238, 0.256, 0.13, 0.254, 0.192, 0.126]
Unlearning task: 7
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0187, std=0.0753
[DEBUG][MIA] Test Set Loss:   mean=3.0483, std=4.2732
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.80078125, 'cv_acc': 0.6784313725490196, 'auc': 0.817596435546875, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.0578, std=4.0610
[DEBUG][MIA] Test Set Loss:   mean=3.1349, std=5.0821
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.564, 'cv_acc': 0.10800000000000001, 'auc': 0.56308, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0072, std=0.0267
[DEBUG][MIA] Test Set Loss:   mean=1.8621, std=3.8727
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.68359375, 'cv_acc': 0.2823529411764706, 'auc': 0.746826171875, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.2744, std=3.0840
[DEBUG][MIA] Test Set Loss:   mean=1.7201, std=3.4764
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.146, 'auc': 0.531312, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0386, std=0.1755
[DEBUG][MIA] Test Set Loss:   mean=2.2024, std=3.7498
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.703125, 'cv_acc': 0.2980392156862745, 'auc': 0.780975341796875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8572, std=3.7454
[DEBUG][MIA] Test Set Loss:   mean=2.4565, std=4.5962
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.12, 'auc': 0.549328, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0324, std=0.2539
[DEBUG][MIA] Test Set Loss:   mean=1.8444, std=3.5398
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.2705882352941177, 'auc': 0.66961669921875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=1.1349, std=2.8014
[DEBUG][MIA] Test Set Loss:   mean=1.3564, std=2.8592
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.516, 'cv_acc': 0.12400000000000003, 'auc': 0.521992, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.0182, std=0.0976
[DEBUG][MIA] Test Set Loss:   mean=2.0097, std=3.0800
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.6745098039215687, 'auc': 0.845458984375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.5206, std=3.3812
[DEBUG][MIA] Test Set Loss:   mean=2.1296, std=3.5079
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.58, 'cv_acc': 0.13999999999999999, 'auc': 0.6049439999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=1.2481, std=2.8800
[DEBUG][MIA] Test Set Loss:   mean=4.6030, std=5.6799
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.66015625, 'cv_acc': 0.27450980392156865, 'auc': 0.730133056640625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.1153, std=4.8946
[DEBUG][MIA] Test Set Loss:   mean=4.5668, std=5.9971
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.11800000000000002, 'auc': 0.5606720000000001, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.3288, std=1.2804
[DEBUG][MIA] Test Set Loss:   mean=2.7969, std=4.1801
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.6392156862745099, 'auc': 0.760772705078125, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.3689, std=4.1838
[DEBUG][MIA] Test Set Loss:   mean=2.6667, std=4.2772
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.13599999999999998, 'auc': 0.5421119999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.2095, std=0.8159
[DEBUG][MIA] Test Set Loss:   mean=2.0158, std=3.1103
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.20784313725490197, 'auc': 0.73504638671875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1314, std=2.5998
[DEBUG][MIA] Test Set Loss:   mean=1.6356, std=3.1548
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.136, 'auc': 0.561152, 'task': 8}
Total correct retain:  1573  Total retain:  2500
Total correct forget:  21892  Total forget:  47500
Total correct test:  289  Total test:  500
Total correct forget test:  3880  Total test forget:  9500
After unlearning task 7
Task accuracies: [0.578, 0.566, 0.692, 0.616, 0.728, 0.566, 0.438, 0.594, 0.684, 0.546, 0.672, 0.106, 0.19, 0.19, 0.232, 0.258, 0.112, 0.274, 0.174, 0.122]
Unlearning task: 6
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0019, std=0.0074
[DEBUG][MIA] Test Set Loss:   mean=2.6625, std=4.8043
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71875, 'cv_acc': 0.6745098039215687, 'auc': 0.785491943359375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=1.8764, std=3.5538
[DEBUG][MIA] Test Set Loss:   mean=2.6490, std=4.5674
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.528, 'cv_acc': 0.148, 'auc': 0.538064, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0189, std=0.1239
[DEBUG][MIA] Test Set Loss:   mean=2.3662, std=4.5796
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.27058823529411763, 'auc': 0.73150634765625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.6445, std=3.7613
[DEBUG][MIA] Test Set Loss:   mean=1.7671, std=3.4611
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11600000000000002, 'auc': 0.5254719999999999, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0123, std=0.0620
[DEBUG][MIA] Test Set Loss:   mean=2.1690, std=3.5940
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.7265625, 'cv_acc': 0.29411764705882354, 'auc': 0.800201416015625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=1.8799, std=3.5697
[DEBUG][MIA] Test Set Loss:   mean=2.3571, std=4.1376
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.526, 'cv_acc': 0.148, 'auc': 0.543944, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.0653, std=0.3655
[DEBUG][MIA] Test Set Loss:   mean=1.6132, std=3.3753
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.64453125, 'cv_acc': 0.2823529411764706, 'auc': 0.665496826171875, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=0.9903, std=2.5556
[DEBUG][MIA] Test Set Loss:   mean=1.6614, std=3.2119
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.55, 'cv_acc': 0.10600000000000001, 'auc': 0.55912, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.1999, std=0.8212
[DEBUG][MIA] Test Set Loss:   mean=3.2043, std=4.0676
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.734375, 'cv_acc': 0.4470588235294118, 'auc': 0.765167236328125, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.1835, std=3.9479
[DEBUG][MIA] Test Set Loss:   mean=3.3493, std=4.5229
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.572, 'cv_acc': 0.10200000000000001, 'auc': 0.59192, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=0.9637, std=2.9279
[DEBUG][MIA] Test Set Loss:   mean=4.6818, std=5.6575
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.69921875, 'cv_acc': 0.5725490196078431, 'auc': 0.7427978515625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.1784, std=4.7083
[DEBUG][MIA] Test Set Loss:   mean=4.1896, std=5.7738
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.198, 'auc': 0.555312, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.1969, std=0.7093
[DEBUG][MIA] Test Set Loss:   mean=3.1650, std=4.2841
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.70703125, 'cv_acc': 0.25098039215686274, 'auc': 0.790008544921875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.6194, std=3.2539
[DEBUG][MIA] Test Set Loss:   mean=2.5701, std=3.9322
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.56, 'cv_acc': 0.11800000000000002, 'auc': 0.595872, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=0.3555, std=1.1398
[DEBUG][MIA] Test Set Loss:   mean=2.1868, std=3.2625
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65234375, 'cv_acc': 0.16862745098039214, 'auc': 0.685516357421875, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.1993, std=2.5425
[DEBUG][MIA] Test Set Loss:   mean=1.6983, std=3.0998
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.13200000000000003, 'auc': 0.5345440000000001, 'task': 8}
Total correct retain:  1556  Total retain:  2500
Total correct forget:  21683  Total forget:  47500
Total correct test:  277  Total test:  500
Total correct forget test:  3869  Total test forget:  9500
After unlearning task 6
Task accuracies: [0.554, 0.596, 0.686, 0.614, 0.734, 0.516, 0.45, 0.592, 0.654, 0.544, 0.662, 0.12, 0.194, 0.184, 0.236, 0.27, 0.126, 0.26, 0.17, 0.13]
Unlearning task: 5
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.1053, std=0.5235
[DEBUG][MIA] Test Set Loss:   mean=3.1175, std=4.9037
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.71484375, 'cv_acc': 0.6901960784313725, 'auc': 0.762237548828125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.5574, std=4.1532
[DEBUG][MIA] Test Set Loss:   mean=2.9148, std=4.6383
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.508, 'cv_acc': 0.096, 'auc': 0.5288, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.1250, std=0.5770
[DEBUG][MIA] Test Set Loss:   mean=2.4436, std=4.3920
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2941176470588235, 'auc': 0.705718994140625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=1.7837, std=3.8028
[DEBUG][MIA] Test Set Loss:   mean=2.4077, std=4.0095
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.448, 'cv_acc': 0.1, 'auc': 0.428744, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=0.0514, std=0.4546
[DEBUG][MIA] Test Set Loss:   mean=2.3021, std=4.5153
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6796875, 'cv_acc': 0.6980392156862746, 'auc': 0.766021728515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=2.1262, std=3.9699
[DEBUG][MIA] Test Set Loss:   mean=2.9526, std=4.8637
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.538, 'cv_acc': 0.11200000000000002, 'auc': 0.562496, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.2617, std=5.6075
[DEBUG][MIA] Test Set Loss:   mean=6.3956, std=10.3769
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.625, 'cv_acc': 0.13333333333333333, 'auc': 0.647003173828125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.7035, std=9.7253
[DEBUG][MIA] Test Set Loss:   mean=4.9102, std=8.4297
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.544, 'cv_acc': 0.094, 'auc': 0.556392, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=0.3509, std=1.1177
[DEBUG][MIA] Test Set Loss:   mean=2.7752, std=4.0915
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6640625, 'cv_acc': 0.6509803921568629, 'auc': 0.751190185546875, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.6503, std=5.0904
[DEBUG][MIA] Test Set Loss:   mean=2.9121, std=4.5606
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.12000000000000002, 'auc': 0.5625200000000001, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=2.4518, std=4.0808
[DEBUG][MIA] Test Set Loss:   mean=5.5412, std=6.0652
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6328125, 'cv_acc': 0.22745098039215686, 'auc': 0.66650390625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=3.2746, std=4.7093
[DEBUG][MIA] Test Set Loss:   mean=5.9654, std=6.8532
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.592, 'cv_acc': 0.13799999999999998, 'auc': 0.613864, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.2707, std=0.9493
[DEBUG][MIA] Test Set Loss:   mean=2.8790, std=4.5515
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.25098039215686274, 'auc': 0.741607666015625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.9890, std=3.3697
[DEBUG][MIA] Test Set Loss:   mean=2.6739, std=4.2126
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.53, 'cv_acc': 0.128, 'auc': 0.545528, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8305, std=3.7204
[DEBUG][MIA] Test Set Loss:   mean=2.9193, std=4.5520
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55859375, 'cv_acc': 0.15294117647058825, 'auc': 0.594085693359375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.4378, std=4.7816
[DEBUG][MIA] Test Set Loss:   mean=3.0027, std=4.7707
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.54, 'cv_acc': 0.11599999999999999, 'auc': 0.548008, 'task': 8}
Total correct retain:  1510  Total retain:  2500
Total correct forget:  20085  Total forget:  47500
Total correct test:  268  Total test:  500
Total correct forget test:  3607  Total test forget:  9500
After unlearning task 5
Task accuracies: [0.536, 0.568, 0.63, 0.636, 0.554, 0.522, 0.392, 0.55, 0.57, 0.466, 0.644, 0.124, 0.188, 0.154, 0.24, 0.306, 0.12, 0.26, 0.18, 0.11]
Unlearning task: 4
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0648, std=0.3191
[DEBUG][MIA] Test Set Loss:   mean=4.7386, std=6.6717
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.76171875, 'cv_acc': 0.7215686274509804, 'auc': 0.833587646484375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=3.0403, std=5.0163
[DEBUG][MIA] Test Set Loss:   mean=3.4081, std=5.0588
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.10800000000000001, 'auc': 0.5405120000000001, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=0.0825, std=0.3064
[DEBUG][MIA] Test Set Loss:   mean=1.9834, std=3.8363
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2823529411764706, 'auc': 0.714691162109375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=2.0298, std=3.9262
[DEBUG][MIA] Test Set Loss:   mean=2.4105, std=4.1126
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.524, 'cv_acc': 0.096, 'auc': 0.5582, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=6.3228, std=11.8841
[DEBUG][MIA] Test Set Loss:   mean=10.8284, std=13.9249
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.23529411764705882, 'auc': 0.61480712890625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.4294, std=11.7293
[DEBUG][MIA] Test Set Loss:   mean=8.5856, std=10.7252
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.498, 'cv_acc': 0.094, 'auc': 0.5130159999999999, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=2.4689, std=6.2711
[DEBUG][MIA] Test Set Loss:   mean=6.4730, std=10.0509
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.62890625, 'cv_acc': 0.13333333333333336, 'auc': 0.628814697265625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.9761, std=9.0193
[DEBUG][MIA] Test Set Loss:   mean=4.4667, std=6.9793
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.1, 'auc': 0.497224, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=1.6082, std=3.4032
[DEBUG][MIA] Test Set Loss:   mean=5.2496, std=6.8696
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.65625, 'cv_acc': 0.2941176470588235, 'auc': 0.687408447265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.4073, std=5.3900
[DEBUG][MIA] Test Set Loss:   mean=4.2331, std=5.8458
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.556, 'cv_acc': 0.12000000000000002, 'auc': 0.532008, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.1248, std=6.8354
[DEBUG][MIA] Test Set Loss:   mean=7.5209, std=8.2832
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.61328125, 'cv_acc': 0.2, 'auc': 0.63873291015625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=6.3902, std=8.5690
[DEBUG][MIA] Test Set Loss:   mean=7.0680, std=7.9150
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.536, 'cv_acc': 0.11000000000000001, 'auc': 0.542192, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=1.3588, std=3.0052
[DEBUG][MIA] Test Set Loss:   mean=3.4358, std=4.4803
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6484375, 'cv_acc': 0.24313725490196075, 'auc': 0.6658935546875, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.3701, std=4.4142
[DEBUG][MIA] Test Set Loss:   mean=3.6461, std=4.7475
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.532, 'cv_acc': 0.122, 'auc': 0.5382399999999999, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.6109, std=3.3158
[DEBUG][MIA] Test Set Loss:   mean=2.9612, std=4.2640
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58984375, 'cv_acc': 0.1215686274509804, 'auc': 0.61175537109375, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.6551, std=4.2183
[DEBUG][MIA] Test Set Loss:   mean=2.9466, std=4.4334
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.088, 'auc': 0.529608, 'task': 8}
Total correct retain:  1396  Total retain:  2500
Total correct forget:  18702  Total forget:  47500
Total correct test:  243  Total test:  500
Total correct forget test:  3370  Total test forget:  9500
After unlearning task 4
Task accuracies: [0.486, 0.524, 0.604, 0.362, 0.542, 0.468, 0.356, 0.45, 0.576, 0.524, 0.604, 0.142, 0.174, 0.176, 0.252, 0.28, 0.168, 0.224, 0.198, 0.116]
Unlearning task: 3
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=0.0050, std=0.0169
[DEBUG][MIA] Test Set Loss:   mean=2.9448, std=4.9034
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.73046875, 'cv_acc': 0.7764705882352941, 'auc': 0.82464599609375, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=2.8264, std=4.7134
[DEBUG][MIA] Test Set Loss:   mean=3.5607, std=5.2376
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.552, 'cv_acc': 0.094, 'auc': 0.54876, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=3.7413, std=7.4247
[DEBUG][MIA] Test Set Loss:   mean=6.4187, std=10.0843
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.13725490196078433, 'auc': 0.582275390625, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=4.9175, std=8.7692
[DEBUG][MIA] Test Set Loss:   mean=6.7872, std=10.1417
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.45, 'cv_acc': 0.118, 'auc': 0.424512, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.1287, std=14.6645
[DEBUG][MIA] Test Set Loss:   mean=9.1657, std=12.8015
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5703125, 'cv_acc': 0.1411764705882353, 'auc': 0.595672607421875, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.6667, std=13.5106
[DEBUG][MIA] Test Set Loss:   mean=7.7511, std=13.2176
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.506, 'cv_acc': 0.09, 'auc': 0.516256, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=3.5428, std=10.1058
[DEBUG][MIA] Test Set Loss:   mean=5.6214, std=11.4901
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.12549019607843137, 'auc': 0.569122314453125, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.4621, std=12.3236
[DEBUG][MIA] Test Set Loss:   mean=5.8328, std=11.6542
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.086, 'auc': 0.468392, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=2.0033, std=3.7708
[DEBUG][MIA] Test Set Loss:   mean=3.9808, std=5.8932
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.16470588235294117, 'auc': 0.609466552734375, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.6509, std=6.1597
[DEBUG][MIA] Test Set Loss:   mean=4.4204, std=6.6914
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.542, 'cv_acc': 0.11200000000000002, 'auc': 0.5501199999999999, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=4.5494, std=6.9512
[DEBUG][MIA] Test Set Loss:   mean=8.0802, std=8.9063
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.578125, 'cv_acc': 0.10196078431372549, 'auc': 0.639312744140625, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=5.7211, std=6.9834
[DEBUG][MIA] Test Set Loss:   mean=7.2325, std=8.4443
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.14, 'auc': 0.554968, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=0.7382, std=1.8223
[DEBUG][MIA] Test Set Loss:   mean=3.2159, std=3.9234
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.671875, 'cv_acc': 0.16862745098039217, 'auc': 0.69775390625, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=2.4769, std=3.5261
[DEBUG][MIA] Test Set Loss:   mean=2.7445, std=3.8230
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.488, 'cv_acc': 0.10400000000000001, 'auc': 0.51596, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=1.8756, std=4.5838
[DEBUG][MIA] Test Set Loss:   mean=4.1773, std=6.3926
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.59375, 'cv_acc': 0.0784313725490196, 'auc': 0.593292236328125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.5992, std=6.1928
[DEBUG][MIA] Test Set Loss:   mean=3.6461, std=5.5707
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.48, 'cv_acc': 0.086, 'auc': 0.49429599999999996, 'task': 8}
Total correct retain:  1509  Total retain:  2500
Total correct forget:  17897  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  3291  Total test forget:  9500
After unlearning task 3
Task accuracies: [0.516, 0.534, 0.456, 0.43, 0.494, 0.472, 0.346, 0.478, 0.514, 0.53, 0.568, 0.158, 0.154, 0.148, 0.236, 0.32, 0.178, 0.252, 0.188, 0.126]
Unlearning task: 2
broken out of loop
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([5, 6, 5, 9, 7, 7, 6, 6, 9, 7], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=5.5333, std=9.7915
[DEBUG][MIA] Test Set Loss:   mean=11.1366, std=15.0636
[Task 1] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.58203125, 'cv_acc': 0.14509803921568626, 'auc': 0.626983642578125, 'task': 1}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [7 5 6 8 8 8 6 5 6 7]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [8 6 5 8 5 5 8 8 7 8]
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG] Task idx: 1
[DEBUG][MIA] Forget Set Loss: mean=10.3682, std=13.9722
[DEBUG][MIA] Test Set Loss:   mean=11.8156, std=15.1839
[Task 1] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.522, 'cv_acc': 0.098, 'auc': 0.537032, 'task': 1}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([10, 13, 10, 13, 10, 12, 10, 13, 14, 10], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=7.7165, std=9.4246
[DEBUG][MIA] Test Set Loss:   mean=10.8303, std=10.6040
[Task 2] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.2980392156862745, 'auc': 0.576751708984375, 'task': 2}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [14 13 11 10 11 12 12 13 10 14]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [12 13 10 10 11 10 13 13 11 11]
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG] Task idx: 2
[DEBUG][MIA] Forget Set Loss: mean=9.3604, std=10.9370
[DEBUG][MIA] Test Set Loss:   mean=10.9418, std=11.0514
[Task 2] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.094, 'auc': 0.459944, 'task': 2}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([17, 16, 19, 19, 15, 19, 17, 19, 17, 16], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=7.4910, std=10.0691
[DEBUG][MIA] Test Set Loss:   mean=10.1236, std=12.5955
[Task 3] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.10980392156862744, 'auc': 0.549224853515625, 'task': 3}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [18 17 18 16 19 18 19 15 15 16]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [16 19 16 15 19 15 15 19 18 19]
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG] Task idx: 3
[DEBUG][MIA] Forget Set Loss: mean=8.5700, std=10.6324
[DEBUG][MIA] Test Set Loss:   mean=10.5431, std=12.1623
[Task 3] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.452, 'cv_acc': 0.10600000000000001, 'auc': 0.45770400000000006, 'task': 3}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([21, 20, 22, 24, 24, 21, 23, 23, 23, 21], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=4.0795, std=9.6971
[DEBUG][MIA] Test Set Loss:   mean=4.8295, std=9.3789
[Task 4] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.515625, 'cv_acc': 0.13725490196078433, 'auc': 0.51910400390625, 'task': 4}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [20 20 24 21 22 23 24 23 20 22]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [23 22 24 24 21 23 23 20 22 21]
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG] Task idx: 4
[DEBUG][MIA] Forget Set Loss: mean=5.7013, std=11.1487
[DEBUG][MIA] Test Set Loss:   mean=5.8825, std=11.1447
[Task 4] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.484, 'cv_acc': 0.088, 'auc': 0.508296, 'task': 4}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([26, 25, 26, 25, 29, 26, 28, 26, 27, 25], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=3.8213, std=5.6161
[DEBUG][MIA] Test Set Loss:   mean=5.3030, std=6.4259
[Task 5] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.5859375, 'cv_acc': 0.17254901960784313, 'auc': 0.59283447265625, 'task': 5}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [27 27 26 28 28 25 27 29 28 25]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [26 27 28 28 25 25 25 25 27 27]
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG] Task idx: 5
[DEBUG][MIA] Forget Set Loss: mean=4.9368, std=6.4659
[DEBUG][MIA] Test Set Loss:   mean=5.6050, std=7.5237
[Task 5] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.476, 'cv_acc': 0.094, 'auc': 0.47863199999999995, 'task': 5}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([34, 31, 30, 34, 34, 34, 34, 30, 32, 32], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=8.5818, std=10.4087
[DEBUG][MIA] Test Set Loss:   mean=11.5964, std=10.8688
[Task 6] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.56640625, 'cv_acc': 0.13725490196078433, 'auc': 0.590362548828125, 'task': 6}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [31 30 31 34 31 33 32 33 33 34]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [30 34 34 30 32 30 34 32 30 33]
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG] Task idx: 6
[DEBUG][MIA] Forget Set Loss: mean=9.6655, std=10.1423
[DEBUG][MIA] Test Set Loss:   mean=9.7055, std=9.3791
[Task 6] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.514, 'cv_acc': 0.11000000000000001, 'auc': 0.5159119999999999, 'task': 6}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([35, 36, 37, 35, 36, 39, 37, 38, 37, 37], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=3.0710, std=5.4438
[DEBUG][MIA] Test Set Loss:   mean=4.9495, std=5.3137
[Task 7] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.6171875, 'cv_acc': 0.1215686274509804, 'auc': 0.6409912109375, 'task': 7}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [35 35 38 36 35 36 35 39 39 35]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [36 36 35 39 38 36 39 38 35 38]
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG] Task idx: 7
[DEBUG][MIA] Forget Set Loss: mean=4.4383, std=5.9502
[DEBUG][MIA] Test Set Loss:   mean=4.9308, std=5.7549
[Task 7] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.46, 'cv_acc': 0.08399999999999999, 'auc': 0.458776, 'task': 7}
[DEBUG] forget_labels dtype: torch.int64 shape: torch.Size([256])
[DEBUG] forget_labels first 10: tensor([40, 43, 44, 44, 41, 41, 42, 40, 42, 44], device='cuda:0')
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=2.8886, std=4.9888
[DEBUG][MIA] Test Set Loss:   mean=3.6014, std=5.0198
[Task 8] Post-unlearn MIA (Buffer): {'type': 'basic', 'attack_acc': 0.55078125, 'cv_acc': 0.09803921568627451, 'auc': 0.555694580078125, 'task': 8}
[DEBUG] forget_labels dtype: int64 shape: (2500,)
[DEBUG] forget_labels first 10: [43 40 40 43 43 44 41 44 43 44]
[DEBUG] test_labels dtype: int64 shape: (500,)
[DEBUG] test_labels first 10: [44 41 41 40 40 43 41 44 43 40]
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG] Task idx: 8
[DEBUG][MIA] Forget Set Loss: mean=3.2106, std=5.0789
[DEBUG][MIA] Test Set Loss:   mean=3.5841, std=5.5655
[Task 8] Post-unlearn MIA (Train): {'type': 'basic', 'attack_acc': 0.512, 'cv_acc': 0.10200000000000001, 'auc': 0.497712, 'task': 8}
Total correct retain:  1399  Total retain:  2500
Total correct forget:  15406  Total forget:  47500
Total correct test:  258  Total test:  500
Total correct forget test:  2897  Total test forget:  9500
After unlearning task 2
Task accuracies: [0.516, 0.282, 0.35, 0.346, 0.488, 0.35, 0.282, 0.388, 0.494, 0.462, 0.542, 0.156, 0.182, 0.204, 0.222, 0.248, 0.236, 0.21, 0.172, 0.18]
Number of constraint violations:  0
